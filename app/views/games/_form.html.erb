<%= javascript_include_tag "sgame_at" %>
<%= stylesheet_link_tag "sgame_at" %>

<script type="text/javascript">
	var game_templates;
	var scormfiles;
	var options;
	$(document).ready(function(){
		SGAME_AT_Locales = {
			"i.cancel"		: "<%= t("dictionary.cancel") %>",
			"i.dialog_confirmation"		: "<%= t("dictionary.are_you_sure") %>",
			"i.upload_game_template"	: "<%= t("game_templates.new") %>",
			"i.upload_scormfile"		: "<%= t("documents.new") %>",
		}
		game_templates = <%=raw @game_templates.to_json( :include => [:events] )%>;
		scormfiles = <%=raw @scormfiles.to_json%>;
		options = {};
		options.user_logged_in = <%=raw user_signed_in?%>;
		options.language = "<%=I18n.locale.to_s%>";
		SGAME_AT.init(game_templates,scormfiles,options);
	});
</script>

<div id="sgame_at">
	<div step="1" class="game">
		<div class="stepTitle">
			<p>1. <%=t("at.step1.title")%></p>
		</div>
		<div class="stepContent">
			<div class="stepDescription">
				<p><%=t("at.step1.description")%></p>
			</div>
			<div class="carrousel_wrapper">
				<div id="games_carrousel"></div>
			</div>
			<div class="selected">
				<div class="r1 c1">		
					<table class="gmetadata">
						<tr class="gtitle">
							<th><%= t("dictionary.title") %></th>
							<td></td> 
						</tr>
						<tr class="gdescription">
							<th><%= t("dictionary.description") %></th>
							<td></td> 
						</tr>
						<tr class="glanguage">
							<th><%= t("dictionary.language") %></th>
							<td></td> 
						</tr>
					</table>
					<table class="gevents">
						<tr class="getitle">
							<th colspan="2"><%= t("events.title") %></th>
						</tr>
						<tr class="geheader">
							<th class="gename"><%= t("events.name") %></th>
							<th class="gedescription"><%= t("events.description") %></th>
						</tr>
					</table>
				</div>
				<div class="r1 c2">
					<img class="gthumbnail"/>
				</div>
			</div>
			<div class="step_actions">
				<button id="step1_confirmation" class="sgame_button"><%=t("at.step1.confirmation")%></button>
			</div>
		</div>
	</div>
	<a id="preview_gt_fancybox" class="fancybox" style="display:none"></a>
	<div step="2" class="scormfiles disabled">
		<div class="stepTitle">
			<p>2. <%=t("at.step2.title")%></p>
		</div>
		<div class="stepContent stephidden" style="display:none">
			<div class="stepDescription">
				<p><%=t("at.step2.description")%></p>
			</div>
			<div class="carrousel_wrapper">
				<div id="scormfiles_carrousel"></div>
			</div>
			<div class="selected">
				<ul id="scormfiles_list"></ul>
			</div>
			<div class="step_actions">
				<button id="step2_confirmation" class="sgame_button"><%=t("at.step2.confirmation")%></button>
			</div>
		</div>
	</div>
	<a id="preview_scormfile_fancybox" class="fancybox" style="display:none"></a>
</div>


<div id="update_document_form_wrapper" class="document_form_wrapper">
	<%= form_for game, url: {action: controller.action_name}, html: {class: "update_document_form document_form"} do |f| %>
		<div class="field">
			<p class="form_legend"><%=t("dictionary.title")%></p>
			<%= f.text_field :title, :maxlength => 60, :size => 70 %>
		</div>
		<div class="field">
			<p class="form_legend"><%=t("dictionary.description")%></p>
			<%= f.text_area :description, :cols => 73, :rows => 4, :maxlength => 280, :resize => "none" %>
		</div>
			<div class="actions">
				<%= f.submit(t("games.update"), {class: "sgame_button"}) %>
			</div>
			<br/>
			<%= link_to t("dictionary.back"), :back, :class=>"back_button" %>
	<% end %>
</div>