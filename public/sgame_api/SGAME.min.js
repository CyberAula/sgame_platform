iso8601Parser=function(d){return{getDuration:function(g){var d=[31104E3,2592E3,604800,86400,3600,60,1];try{var m;var a=g;g=[2,3,4,5,7,8,9];var t=[0,0,0,0,0,0,0],r;if(a=a.toUpperCase()){if("string"!==typeof a)throw Error("Invalid iso8601 period string '"+a+"'");if(r=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(a))for(a=0;a<g.length;a++){var n=g[a];t[a]=r[n]?+r[n].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+a+"' is not a valid ISO8601 period.");}m=t}catch(s){return null}for(n=
r=0;n<m.length;n++)r+=m[n]*d[n];return r}}}();function Local_API_1484_11(d){function g(a,b){c.diganostic="The "+a+" of "+b+" must be a proper vocabulary element.";c.errorCode=406;return"false"}function k(a){c.errorCode=402;c.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function m(a,b){c.errorCode=201;c.diagnostic="The value for key "+a+" is not valid.";return"false"}function a(b,c,h){b=b.split(/\./);2>b.length?h[b[0]]=c:(h[b[0]]||(h[b[0]]={}),h=h[b.shift()],a(b.join("."),c,h))}function t(a,b){var h=a.split(/\./),
c;if(2>h.length)try{return b[h[0]]}catch(f){return k(a),"false"}else{c=h.shift();if(b[c])return String(t(h.join("."),b[c]));k(a);return"false"}}function r(a){var b,h=0;for(b in a)a.hasOwnProperty(b)&&(h+=1);return h}function n(a,b){if(c.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(b){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);
break;case 3:console.log(a);break;default:return console.log(a),!1}return!0}3>b&&c.throw_alerts&&alert(a);return!1}function s(a,b){if("function"==typeof c.listeners[a]&&"undefined"!=typeof b)c.listeners[a](b)}function e(a,b){for(var h in b)b.hasOwnProperty(h)&&("object"==typeof a[h]?"object"==typeof b[h]&&(a[h]=e(a[h],b[h])):a[h]=b[h]);return a}function b(a,b){(function(){function a(b,h){h=h||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,h.bubbles,
h.cancelable,h.detail);return c}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:b}))}function p(a){return"object"!==type(a)||a.nodeType||isWindow(a)?!1:!(a.constructor&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))}var c=e({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,user:void 0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},d),f={},h={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},q=this;"object"===typeof c.user&&("string"===typeof c.user.name&&(c.CMI.learner_name=c.user.name),"string"===typeof c.user.id&&(c.CMI.learner_id=c.user.id));this.isRunning=function(){return 1===c.initialized&&0===c.terminated};this.Initialize=function(){n(c.prefix+
":  Initializing...",3);c.cmi?(f=c.cmi,"suspend"===f.exit&&(f.entry="resume")):f=c.CMI;c.initialized=1;c.terminated=0;return"true"};this.GetValue=function(a){c.errorCode=0;var b="false";a=a.toString();var h=[];if(this.isRunning()){h=a.split(".");if(0<="|exit|session_time|".indexOf("|"+h[h.length-1]+"|"))return n(c.prefix+": This "+a+" is write only",4),c.errorCode=405,"false";h=a.toLowerCase().split(".");switch(h[0]){case "cmi":switch(b="false",a){case "cmi.exit":case "cmi.session_time":c.errorCode=
405;c.diagnostic="Sorry, this has been specified as a read-only value for "+a;break;case "cmi.learner_name":b=c.CMI.learner_name;break;default:b=t(a.substr(4,a.length),f),"undefined"===b&&(c.errorCode=401,c.diagnostic="Sorry, there was a undefined response from "+a,b="false"),n(c.prefix+": GetValue "+a+" = "+b,4)}}return b}c.errorCode=123;return b};this.SetValue=function(b,h){n(c.prefix+": SetValue: "+b+" = "+h,4);c.errorCode=0;var e=[],q=b.toString(),l=h.toString(),d=0,k=0,d=[];if(this.isRunning()){d=
q.split(".");if("adl"===d[0]&&"id"===d[4]||"comments_from_lms"===d[1]||("comments_from_learner"===d[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+d[d.length-1]+"|")))return n(c.prefix+": This "+q+" is read only",4),c.errorCode=404,"false";e=q.split(".");switch(e[0]){case "cmi":switch(b){case "cmi.location":1E3<l.length&&n(c.prefix+": Some LMS's might truncate your bookmark as you've passed "+
l.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":d=parseFloat(l);if("number"!=typeof d||isNaN(d))return m(b,l);d=Math.max(0,Math.min(1,d));s(b,d);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+l+"|"))return g(b,l);s(b,l);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+l+"|"))return g(b,l);break;case "cmi.score.scaled":d=parseFloat(l);if("number"!=typeof d||isNaN(d))return m(b,l);d=Math.max(0,
Math.min(1,d));s(b,d);break;case "cmi.score.min":d=parseFloat(l);if("number"!=typeof d||isNaN(d))return m(b,l);c.CMI.score.min=d;break;case "cmi.score.max":d=parseFloat(l);if("number"!=typeof d||isNaN(d))return m(b,l);c.CMI.score.max=d;break;case "cmi.score.raw":d=parseFloat(l);if("number"!=typeof d||isNaN(d))return m(b,l);k=parseFloat(c.CMI.score.max);k="number"!=typeof k||isNaN(k)?100:k;e=parseFloat(c.CMI.score.min);e="number"!=typeof e||isNaN(e)?0:e;k-=e;0>=k&&(k=100);d=Math.max(0,Math.min(1,(d-
e)/k));s("cmi.score.scaled",d);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+l+"|"))return g(b,l);s(b,l);break;default:switch(e[1]){case "comments_from_lms":return c.errorCode="404",c.diagnostic="The cmi.comments_from_lms element is entirely read only.","false";case "comments_from_learner":if(-1===f.comments_from_learner._children.indexOf(e[3]))return g(b,l);a(q.substr(4,q.length),l,f);f.comments_from_learner._count=(r(f.comments_from_learner)-2).toString();return"true";
case "interactions":if(-1===f.interactions._children.indexOf(e[3]))return g(b,l);f.interactions._count=(r(f.interactions)-2).toString();if(isNaN(parseInt(e[2],10)))return"false";if(!p(f.interactions[e[2]])){if("id"===e[3])return f.interactions[e[2]]={},a(q.substr(4,q.length),l,f),f.interactions._count=(r(f.interactions)-2).toString(),p(f.interactions[e[2]].objectives)||(n(c.prefix+": Constructing objectives object for new interaction",4),f.interactions[e[2]].objectives={},f.interactions[e[2]].objectives._count=
"-1"),p(f.interactions[e[2]].correct_responses)||(n(c.prefix+": Constructing correct responses object for new interaction",4),f.interactions[e[2]].correct_responses={},f.interactions[e[2]].correct_responses._count="-1"),"true";n("Can't add interaction without ID first!",3);return"false"}if("objectives"===e[3]){if("id"===e[5])for(k=parseInt(f.interactions[e[2]].objectives._count,10),d=0;d<k;d+=1){if(f.interactions[e[2]].objectives[d].id===l)return q=b,c.errorCode="351",c.diagnostic="The "+q+" element must be unique.  The value '"+
l+"' has already been set in #"+d,"false"}else return g(b,l);a(q.substr(4,q.length),l,f);f.interactions[e[2]].objectives._count=(r(f.interactions[e[2]].objectives)-1).toString();return"true"}"correct_responses"===e[3]&&(a(q.substr(4,q.length),l,f),f.interactions[e[2]].correct_responses._count=(r(f.interactions[e[2]].correct_responses)-1).toString());a(q.substr(4,q.length),l,f);f.interactions._count=(r(f.interactions)-2).toString();return"true";case "objectives":if("id"===e[3])for(k=parseInt(f.objectives._count,
10),d=0;d<k;d+=1)if(f.objectives[d].id===l)return c.errorCode="351",c.diagnostic="The objectives.id element must be unique.  The value '"+l+"' has already been set in objective #"+d,"false";if("id"!==e[3]&&(d=parseInt(e[2],10),void 0===f.objectives[d]))return c.errorCode="408",c.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(e[2],10)))return"false";a(q.substr(4,q.length),l,f);f.objectives._count=(r(f.objectives)-2).toString();return"true"}}a(q.substr(4,
q.length),l,f)}return"true"}c.errorCode=c.terminated?133:132;return"false"};this.Commit=function(){n(c.prefix+": Commit CMI Object:",4);n(f);n(c.prefix+": Suspend Data Usage "+(Math.round(100*(f.suspend_data.length/64E3)*Math.pow(10,2))/Math.pow(10,2)+"%"));b("StoreData",{runtimedata:f});return"true"};this.Terminate=function(){q.Commit();c.terminated=1;c.initialized=0;return"true"};this.GetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==h[a])?h[a]:""};this.GetLastError=function(){return c.errorCode};
this.GetDiagnostic=function(){return c.diagnostic};this.setCMILMSValue=function(a,b){"string"==typeof a&&(c.CMI[a]=b)};this.addListener=function(a,b){"string"==typeof a&&"function"==typeof b&&(c.listeners[a]=b)}};function Local_API_SCORM_12(d){function g(a,e){b.diganostic="The "+a+" of "+e+" must be a proper vocabulary element.";b.errorCode=406;return"false"}function k(a){b.errorCode=402;b.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function m(a,e){b.errorCode=201;b.diagnostic="The value for key "+a+" is not valid.";return"false"}function a(b,e,c){b=b.split(/\./);2>b.length?c[b[0]]=e:(c[b[0]]||(c[b[0]]={}),c=c[b.shift()],a(b.join("."),e,c))}function t(a,b){var e=a.split(/\./),
c;if(2>e.length)try{return b[e[0]]}catch(f){return k(a),"false"}else{c=e.shift();if(b[c])return String(t(e.join("."),b[c]));k(a);return"false"}}function r(a,e){if(b.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(e){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);break;case 3:console.log(a);break;default:return console.log(a),
!1}return!0}3>e&&b.throw_alerts&&alert(a);return!1}function n(a,e){if("function"==typeof b.listeners[a]&&"undefined"!=typeof e)b.listeners[a](e)}function s(a,b){for(var e in b)b.hasOwnProperty(e)&&("object"==typeof a[e]?"object"==typeof b[e]&&(a[e]=s(a[e],b[e])):a[e]=b[e]);return a}function e(a,b){(function(){function a(b,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,e.bubbles,e.cancelable,e.detail);return c}if("function"===typeof window.CustomEvent)return!1;
a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:b}))}var b=s({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,user:void 0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},d),p={},c={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},f=this;"object"===typeof b.user&&("string"===typeof b.user.name&&(b.CMI.core.student_name=b.user.name),"string"===typeof b.user.id&&(b.CMI.core.student_id=b.user.id));this.isRunning=function(){return 1===b.initialized&&0===b.terminated};this.LMSInitialize=function(){r(b.prefix+":  Initializing...",3);p=b.CMI;b.initialized=1;b.terminated=
0;return"true"};this.LMSGetValue=function(a){b.errorCode=0;var e="false";a=a.toString();var c=[];if(this.isRunning()){c=a.split(".");if(0<="|exit|session_time|".indexOf("|"+c[c.length-1]+"|"))return b.errorCode=405,"false";c=a.toLowerCase().split(".");switch(c[0]){case "cmi":e=a;a="false";switch(e){case "cmi.core.exit":case "cmi.core.session_time":b.errorCode=405;b.diagnostic="Sorry, this has been specified as a read-only value for "+e;break;default:e=e.replace("cmi.",""),a=t(e,p),"undefined"===a&&
(b.errorCode=401,b.diagnostic="Sorry, there was a undefined response from "+e,a="false")}e=a}return e}b.errorCode=123;return e};this.LMSSetValue=function(e,c){r(b.prefix+": SetValue: "+e+" = "+c,4);b.errorCode=0;var f=[],d=e.toString(),k=c.toString();if(this.isRunning()){var f=d.split("."),s=f[f.length-1],f="adl"===f[0]&&"id"===f[4]?!0:"comments_from_lms"===f[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
s+"|");if(f)return b.errorCode=404,"false";f=d.split(".");switch(f[0]){case "cmi":switch(e){case "cmi.core.lesson_location":1E3<k.length&&r(b.prefix+": Some LMS's might truncate your bookmark as you've passed "+k.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+k+"|"))return g(e,k);n(e,k);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+k+"|"))return g(e,
k);break;case "cmi.core.score.min":f=parseFloat(k);if("number"!=typeof f||isNaN(f))return m(e,k);b.CMI.core.score.min=f;break;case "cmi.core.score.max":f=parseFloat(k);if("number"!=typeof f||isNaN(f))return m(e,k);b.CMI.core.score.max=f;break;case "cmi.core.score.raw":f=parseFloat(k);if("number"!=typeof f||isNaN(f))return m(e,k);var l=parseFloat(b.CMI.core.score.max),l="number"!=typeof l||isNaN(l)?100:l,s=parseFloat(b.CMI.core.score.min),s="number"!=typeof s||isNaN(s)?0:s,l=l-s;0>=l&&(l=100);f=Math.max(0,
Math.min(1,(f-s)/l));n("cmi.score.scaled",f)}d=d.replace("cmi.","");a(d,k,p)}return"true"}b.errorCode=b.terminated?133:132;return"false"};this.LMSCommit=function(){e("StoreData",{runtimedata:p});return"true"};this.LMSTerminate=function(){f.LMSCommit();b.terminated=1;b.initialized=0;return"true"};this.LMSFinish=function(){f.LMSCommit();b.terminated=1;b.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==c[a])?c[a]:""};this.LMSGetLastError=function(){return b.errorCode};
this.LMSGetDiagnostic=function(){return b.diagnostic};this.setCMILMSValue=function(a,e){"string"==typeof a&&(b.CMI[a]=e)};this.addListener=function(a,e){"string"==typeof a&&"function"==typeof e&&(b.listeners[a]=e)}};SGAME=function(){return{init:function(d){return SGAME.CORE.init(d)},loadSettings:function(d){return SGAME.CORE.loadSettings(d)},triggerLO:function(d,g){return SGAME.CORE.triggerLO(d,g)},showLO:function(d,g){return SGAME.CORE.showLO(d,g)},showRandomLO:function(d){return SGAME.CORE.showRandomLO(d)},closeLO:function(){return SGAME.CORE.closeLO()},getSettings:function(){return SGAME.CORE.getSettings()},losCanBeShown:function(d){return SGAME.CORE.losCanBeShown(d)},successWhenNoLOs:function(d){return SGAME.CORE.successWhenNoLOs(d)}}}();
SGAME.VERSION="1.0.1";SGAME.AUTHORS="Aldo Gordillo";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var d=!1;return{init:function(g){!0===g&&(d=g)},isDebugging:function(){return d},log:function(g){d&&window.console&&console.log(g)}}}();SGAME.Messenger=function(){function d(b,e){this.data=b||{};-1!==["PROTOCOL","APP"].indexOf(e)?this.type=e:this.type="APP";this.origin=m;this.destination=a}var g=["PROTOCOL","APP"],k=["SGAME_GATEWAY","SGAME_API"],m="SGAME_API",a="SGAME_GATEWAY",t=!1,r=!1,n=function(a){try{window.parent.parent.postMessage(a,"*")}catch(e){}},s=function(a){var p;p="object"!==typeof a||"string"!==typeof a.data?!1:e(a.data);if(p)switch(a=JSON.parse(a.data),a.type){case "PROTOCOL":if(a.data)switch(a.data.key){case "onIframeMessengerHello":"SGAME_GATEWAY"===
a.origin&&!0!==r&&(r=!0,a.data.settings=SGAME.CORE.getSettings(),a.destination=a.origin,a.origin=m,n(JSON.stringify(a)),SGAME.CORE.onConnectedToVLE())}break;case "APP":if(a.data&&"string"===typeof a.data.key)switch(a.data.key){case "lms_data":if("object"===typeof a.data.value){p=a.data.value;a={};if("string"===typeof p.name||"number"===typeof p.name)a.name=""+p.name;if("string"===typeof p.id||"number"===typeof p.id)a.id=""+p.id;p=SGAME.CORE.getVLEData();p.user=a;SGAME.CORE.setVLEData(p)}}}},e=function(a){try{if(a=
JSON.parse(a),-1===g.indexOf(a.type)||-1===k.indexOf(a.origin))return!1}catch(e){return!1}return!0};return{init:function(a){if(!t){t=!0;try{window.parent.addEventListener?window.parent.addEventListener("message",s,!1):window.attachEvent&&window.parent.attachEvent("message",s)}catch(e){}}},isConnected:function(){return r},sendMessage:function(a){t&&r&&(a=JSON.stringify(new d(a,void 0)),e(a)&&n(a))}}}();var API,API_1484_11;
SGAME.Fancybox=function(d){var g=d,k=d,m=d,a,t=function(){"undefined"!=typeof g&&(g.style.display="none",g.parentNode.removeChild(g),"lo"===k&&(API_1484_11=API=d),k=g=d)},r=function(){if("undefined"!=typeof g){var a=k;t();var r;r="lo"===a?SGAME.Observer.stop():!0;var e=m;m=d;setTimeout(function(){"function"===typeof e&&e(r)},50)}};return{init:function(d){"string"===typeof d&&(a=d)},create:function(n,s){t();m=s;var e="undefined"!==typeof n&&!0===n.dialog?"dialog":"lo",b=4/3,p,c,f=0.9*window.innerWidth,
h=0.9*window.innerHeight;h*b>f?(p=f,c=p/b):(c=h,p=c*b);if("lo"===e)var q={},u;else var v="";n&&(n.width&&(p=n.width),n.height&&(c=n.height),"lo"===e?n.lo&&(q=n.lo,"string"===typeof q.url&&(u=q.url)):"string"==typeof n.msg&&(v=n.msg));if("lo"===e){if("string"!=typeof u||"undefined"==typeof q.scorm_type)return;var x=d,b=API_1484_11=API=d,w=SGAME.CORE.getVLEData();"object"===typeof w.user&&(b=w.user);"sco"===q.scorm_type&&("1.2"===q.scorm_version?x=API=new Local_API_SCORM_12({user:b,debug:SGAME.Debugger.isDebugging()}):
"2004"===q.scorm_version&&(x=API_1484_11=new Local_API_1484_11({user:b,debug:SGAME.Debugger.isDebugging()})))}b=document.createElement("div");b.style.width=p+"px";b.style.height=c+"px";b.style.maxWidth=f+"px";b.style.maxHeight=h+"px";b.style.overflow="lo"===e?"hidden":"auto";b.style.background="white";b.style.position="absolute";b.style.top=0;b.style.zIndex=9999;b.style.borderRadius="1em";b.style.border="2px solid black";b.setAttribute("id","sgame_fancybox");b.style.marginLeft=(window.innerWidth-
p)/2+"px";b.style.marginTop=(window.innerHeight-c)/2+"px";h=document.createElement("img");h.src=a+"close.png";f=Math.max(25,Math.floor(0.05*c));h.style.width=f+"px";h.style.height=f+"px";h.style.padding="5px";h.style.cursor="pointer";h.style.position="absolute";h.style.right=0;h.onclick=function(){r()};b.appendChild(h);if("lo"===e){var l=document.createElement("img");l.id="trafficLight";l.src=a+"trafficLight/trafficLight_red.png";v=Math.max(40,Math.floor(0.085*c));h=Math.max(30,Math.floor(0.75*v));
l.style.height=v+"px";l.style.width=h+"px";l.style.padding="4px";l.style.position="absolute";l.style.left="0px";l.style.top="0px";l.style.background="#fff";l.style.borderRadius="0px 0px 20px 0px";l.style.borderRight="2px solid black";l.style.borderBottom="2px solid black";b.appendChild(l);l=document.createElement("iframe");l.src=u;u=Math.ceil(Math.max(f,v))+4;v=Math.floor(0.02*c);f=Math.floor(0.02*p);l.style.marginLeft=f+"px";l.style.marginTop=u+"px";l.style.width=Math.max(0,p-f-f)+"px";l.style.height=
Math.max(0,c-u-v)+"px";l.style.overflow="auto";l.scrolling="yes";l.style.frameBorder="0";l.style.borderStyle="none";l.setAttribute("allowfullscreen","false");b.appendChild(l)}else p=document.createElement("p"),p.id="dialog",p.innerHTML=v,p.style.padding="15px",p.style.marginTop="30px",p.style.marginBottom="20px",p.style.marginRight="20px",p.style.marginLeft="20px",p.style.textAlign="center",p.style.fontSize="24px",p.style.position="relative",p.style.cursor="default",p.style.color="#000",p.style.fontFamily=
"initial",b.appendChild(p);g=b;k=e;document.body.appendChild(b);"lo"===e&&SGAME.Observer.start(l,q,x)},closeCurrentFancybox:r}}();SGAME.TrafficLight=function(d){var g,k,m,a,t,r,n=function(a){var e=document.getElementById("trafficLight");e&&(g=a,e.src=s(a))},s=function(a){switch(a){case "green":return r+"trafficLight/trafficLight_green.png";case "yellow":return r+"trafficLight/trafficLight_yellow.png";case "red":return r+"trafficLight/trafficLight_red.png";default:return r+"trafficLight/trafficLight.png"}},e=function(b,e){var c=document.getElementById("trafficLight");if(c){var f=!1;a=setInterval(function(){c&&(f?(c.src=s(null),
f=!1):(c.src=s(b),f=!0))},500);t=setTimeout(function(){clearTimeout(a)},1E3*e)}};return{init:function(a){"string"===typeof a&&(r=a)},getCurrentColor:function(){return g},changeColor:function(a,e){e?k=setTimeout(function(){n(a)},1E3*e):n(a)},setUpBlink:function(a,p,c){c?m=setTimeout(function(){e(a,p)},1E3*c):e(a,p)},stop:function(){k&&clearTimeout(k);m&&clearTimeout(m);a&&clearTimeout(a);t&&clearTimeout(t)}}}();SGAME.Sequencing=function(){var d,g="completion completion_higher_inmediate success fail score_higher score_higher_inmediate score_lower".split(" "),k=function(a){if("object"!==typeof a)return a;a.met=!1;if("multiple"===a.type&&Array.isArray(a.conditions))for(var b=0;b<a.conditions.length;b++)a.conditions[b]=k(a.conditions[b]);return a},m=function(e){for(var b=Object.keys(e),p=b.length,c=0;c<p;c++){var f=e[b[c]];if("undefined"===typeof f.condition&&"undefined"!==typeof f.conditions){for(var d={type:"multiple",
operator:"AND",conditions:f.conditions},q=0;q<d.conditions.length;q++)d.conditions[q].type="single";f.condition=d;delete f.conditions}"undefined"!==typeof f.condition&&!1===a(f.condition,b)&&delete e[b[c]]}return Object.keys(e).length===p?e:m(e)},a=function(e,b){if("object"!==typeof e)return!1;switch(e.type){case "single":return-1===b.indexOf(e.group+"")||-1===g.indexOf(e.requirement)||-1!==["score_higher","score_lower"].indexOf(e.requirement)&&("number"!==typeof e.score||0>e.score||1<e.score||"score_higher"===
e.requirement&&1===e.score||"score_lower"===e.requirement&&0===e.score)?!1:e;case "multiple":var d;a:if(-1===["AND","OR"].indexOf(e.operator)||!1===Array.isArray(e.conditions)||1>e.conditions.length)d=!1;else{for(d=0;d<e.conditions.length;d++)if(!1===a(e.conditions[d],b)){d=!1;break a}d=e}return d;default:return!1}},t=function(a,b){if("undefined"===typeof a||!0===a.met)return a;switch(a.type){case "single":var d=a,c=b[d.group+""],f=!0===c.shown,h=!1;switch(d.requirement){case "completion":h=f;break;
case "completion_higher_inmediate":h=group.nshown>=d.nshown;break;case "success":h=f&&1===c.score;break;case "fail":h=f&&1>c.score;break;case "score_higher":h=f&&c.score>d.score;break;case "score_higher_inmediate":h=c.score>d.score;break;case "score_lower":h=f&&c.score<d.score}d.met=h;a=d;break;case "multiple":a:{d=a;for(c=0;c<d.conditions.length;c++)if(d.conditions[c]=t(d.conditions[c],b),"OR"===d.operator&&!0===d.conditions[c].met){d.met=!0;a=d;break a}else if("AND"===d.operator&&!1===d.conditions[c].met){d.met=
!1;a=d;break a}"OR"===d.operator?d.met=!1:"AND"===d.operator&&(d.met=!0);a=d}}return a},r=function(a,b){switch(a.type){case "single":if(a.group===b.id)return[a];break;case "multiple":for(var d=[],c=0;c<a.conditions.length;c++)d.concat(r(a.conditions[c],b));return d}},n=function(a,b){if(!0!==a.shown||!0!==a.can_be_shown)return!1;for(var p=Object.keys(b),c=!1,f=0;f<p.length;f++){var h=b[p[f]];if(h.id!=a.id&&"undefined"!==typeof h.condition)for(var h=r(h.condition,a),q=0;q<h.length;q++){if(!0===h[q].met)return!0;
c=!0}}if(!0===c)return!1;switch(d){case "linear_success":return 1===a.score;default:return!0}},s=function(a,b,d){for(var c=0;c<a.los.length;c++)b[a.los[c]].can_be_shown=d;return b};return{init:function(a){d=a.approach},initGroupSequence:function(a){a.can_be_shown="undefined"===typeof a.condition||0===Object.keys(a.condition).length;a.shown=!1;a.nshown=0;a.score=!1;a.performance=0;a.condition=k(a.condition);return a},validateSequence:function(a,b){if("object"!==typeof a||"object"!==typeof b)return!1;
for(var d=Object.keys(a),c=Object.keys(b),f=0;f<d.length;f++){var h;h=a[d[f]];for(var q=c,k=[],g=0;g<h.los.length;g++){var n=h.los[g];-1!==q.indexOf(n)&&k.push(n)}h.los=k;h=1>h.los.length?!1:h;!1!==h?a[d[f]]=h:delete a[d[f]]}a=m(a);d=Object.keys(a);c=[];for(f=0;f<d.length;f++)for(h=a[d[f]],q=0;q<h.los.length;q++)-1===c.indexOf(h.los[q])&&c.push(h.los[q]);return 2>typeof d.length||2>c.length?!1:a},updateGroupsTracking:function(a,b,d){for(var c=0;c<a.groups.length;c++){var f=b,h=a.groups[c]+"",g;g=
b[a.groups[c]+""];if(!g.shown||!1!==g.can_be_shown){for(var k=g.los.length,m=0,r=0,w=0;w<k;w++){var l=d[g.los[w]];!0===l.shown&&(m+=1);!0===l.successfully_consumed&&(r+=1)}g.shown=m===k;g.nshown=m;g.score=0<k?r/k:0;g.performance=0<m?r/m:0}f[h]=g}c=0;f=Object.keys(b);for(g=0;g<f.length;g++)h=b[f[g]],!1===h.can_be_shown&&!1===h.shown&&(c+=1,k=b,m=f[g],!0!==h.can_be_shown&&!0!==h.shown&&(h.condition=t(h.condition,b),!0===h.condition.met&&(h.can_be_shown=!0)),k[m]=h,!0===b[f[g]].can_be_shown&&(d=s(b[f[g]],
d,!0),c-=1));for(g=0;g<a.groups.length;g++)h=b[a.groups[g]+""],!0===h.can_be_shown&&(k=b,m=a.groups[g]+"",r=n(h,b),h.can_be_shown=!1===r,k[m]=h,!1===b[a.groups[g]+""].can_be_shown&&(d=s(b[a.groups[g]+""],d,!1),c+=1));if(a=c===f.length)for(c=Object.keys(d),f=0;f<c.length;f++)if("undefined"===typeof d[c[f]].groups||0===d[c[f]].groups.length)d[c[f]].can_be_shown=!0;return{groups:b,los:d,finished:a}}}}();SGAME.API=function(){var d=function(d,k){var m=new XMLHttpRequest;m.onreadystatechange=function(){if(4==m.readyState&&200==m.status){var a=JSON.parse(m.responseText);k(a)}};m.open("GET",d,!0);m.send("")};return{init:function(){},requestLOMetadata:function(g,k,m){try{d("undefined"==typeof g?"/lo/random/metadata.json":"/lo/"+g+"/metadata.json",function(a){k(a)})}catch(a){m(a)}}}}();SGAME.CORE=function(){var d={},g=void 0,k=!1,m="Congratulations. You have achieved the objectives of this educational game. You may close this window or continue playing.",a={},t=!1,r={},n={progress_measure:0,completion_status:"incompleted",score:0,success_status:"unknown"},s=["repeat","repeat_unless_successfully_consumed","no_repeat"],e=["no_restrictions","n_times","1_per_timeperiod"],b=["random","linear_completion","linear_success","custom"],p="all_los percentage_los n_los n_times disabled onstart".split(" "),
c="all_los percentage_los n_los n_times disabled onstart oncompletion".split(" "),f="no_more_los all_los_consumed all_los_successfully_consumed completion_status success_status never".split(" "),h=["success","failure","success_unless_damage","failure_unless_blocking"],q=!1,u=0,v=0,x=0,w=0,l=0,D=!1,z=void 0,E=function(d){a=d;"undefined"===typeof a.game_metadata&&(a.game_metadata={});"undefined"===typeof a.los&&(a.los={});"undefined"===typeof a.events&&(a.events={});"undefined"===typeof a.event_mapping&&
(a.event_mapping={});"undefined"===typeof a.sequencing&&(a.sequencing={});-1===s.indexOf(a.sequencing.repeat_lo)&&(a.sequencing.repeat_lo="repeat");-1===e.indexOf(a.sequencing.interruptions)&&(a.sequencing.interruptions="no_restrictions");-1===b.indexOf(a.sequencing.approach)&&(a.sequencing.approach="random");-1!==["n_times","1_per_timeperiod"].indexOf(a.sequencing.interruptions)&&"number"===typeof a.sequencing.interruptions_n||delete a.sequencing.interruptions_n;-1!==["n_times","1_per_timeperiod"].indexOf(a.sequencing.interruptions)&&
"number"!==typeof a.sequencing.interruptions_n&&(a.sequencing.interruptions="no_restrictions");"undefined"===typeof a.game_settings&&(a.game_settings={});-1===p.indexOf(a.game_settings.completion_status)&&(a.game_settings.completion_status="disabled");-1!==["percentage_los","n_los","n_times"].indexOf(a.game_settings.completion_status)&&"number"===typeof a.game_settings.completion_status_n||delete a.game_settings.completion_status_n;-1!==["percentage_los","n_los","n_times"].indexOf(a.game_settings.completion_status)&&
"number"!==typeof a.game_settings.completion_status_n&&(a.game_settings.completion_status="disabled",delete a.game_settings.completion_status_n);-1===c.indexOf(a.game_settings.success_status)&&(a.game_settings.success_status="disabled");-1!==["percentage_los","n_los","n_times"].indexOf(a.game_settings.success_status)&&"number"===typeof a.game_settings.success_status_n||delete a.game_settings.success_status_n;-1!==["percentage_los","n_los","n_times"].indexOf(a.game_settings.success_status)&&"number"!==
typeof a.game_settings.success_status_n&&(a.game_settings.success_status="disabled",delete a.game_settings.success_status_n);-1===f.indexOf(a.game_settings.completion_notification)&&(a.game_settings.completion_notification="never");-1===h.indexOf(a.game_settings.behaviour_when_no_more_los)&&(a.game_settings.behaviour_when_no_more_los="success_unless_damage");"string"===typeof a.game_settings.completion_notification_text&&(m=a.game_settings.completion_notification_text);if("object"===typeof a.los){d=
Object.keys(a.los);u=d.length;for(var g=0;g<u;g++)"undefined"!==typeof a.los[d[g]].url&&(a.los[d[g]].url=SGAME.Utils.checkUrlProtocol(a.los[d[g]].url)),a.los[d[g]].can_be_shown=!0,a.los[d[g]].shown=!1,a.los[d[g]].nshown=0,a.los[d[g]].successfully_consumed=!1,a.los[d[g]].nsuccess=0,a.los[d[g]].unsuccessfully_consumed=!1,a.los[d[g]].acts_as_asset="asset"===a.los[d[g]].scorm_type||"sco"===a.los[d[g]].scorm_type&&!1===a.los[d[g]].report_data,q=!0}"random"!==a.sequencing.approach&&(d=SGAME.Sequencing.validateSequence(a.sequencing.sequence,
a.los),!1===d?a.sequencing.approach="random":a.sequencing.sequence=d);"random"===a.sequencing.approach&&delete a.sequencing.sequence;if("object"===typeof a.sequencing.sequence){d=Object.keys(a.los);u=d.length;for(g=0;g<u;g++)a.los[d[g]].can_be_shown=!1,a.los[d[g]].groups=[];q=!1;d=Object.keys(a.sequencing.sequence);_nGroups=d.length;for(g=0;g<_nGroups;g++){a.sequencing.sequence[d[g]]=SGAME.Sequencing.initGroupSequence(a.sequencing.sequence[d[g]]);for(var k=a.sequencing.sequence[d[g]],l=0;l<k.los.length;l++)a.los[k.los[l]].groups.push(k.id),
a.los[k.los[l]].can_be_shown=!0===k.can_be_shown,!0===a.los[k.los[l]].can_be_shown&&(q=!0)}}"string"!==typeof a.assets_path&&(a.assets_path="/assets/sgame/");SGAME.Fancybox.init(a.assets_path);SGAME.TrafficLight.init(a.assets_path);SGAME.Sequencing.init(a.sequencing)},C=function(b,d){var c=F(b);if(1>c.length)return A(b,d);var f=G(c);if(0<f.length){c=void 0;switch(a.sequencing.approach){case "linear_completion":case "linear_success":case "custom":if(!1===k){for(var c=[],e=[],g=[],h=0;h<f.length;h++)g.push(f[h].id);
f=Object.keys(a.sequencing.sequence);for(h=0;h<f.length;h++){var l=a.sequencing.sequence[f[h]];if(!0===l.can_be_shown)for(var m=0;m<l.los.length;m++)-1!==g.indexOf(l.los[m])&&-1===e.indexOf(l.los[m])&&(e.push(l.los[m]),c.push(a.los[l.los[m]]))}}else c=f;c=H(c);break;default:c=H(f)}selectedLO=c;B(selectedLO,d)}else"function"===typeof d&&(c=I(b),d(c.success,c))},A=function(a,b){if("function"===typeof b){var d=I(a);b(d.success,d)}},F=function(b){var d=[];b=a.event_mapping[b];if("undefined"!==typeof b){var c=
b.length;if("number"===typeof c)for(var f=0;f<c;f++){if("*"===b[f]){d=[];b=Object.keys(a.los);for(c=0;c<b.length;c++)"undefined"!==typeof a.los[b[c]]&&d.push(a.los[b[c]]);break}"undefined"!==typeof a.los[b[f]]&&d.push(a.los[b[f]])}}return d},G=function(a){for(var b=[],d=a.length,c=0;c<d;c++)!0===a[c].can_be_shown&&b.push(a[c]);return b},B=function(b,d){"object"!==typeof b||"string"!==typeof b.url?"function"===typeof d&&d(null,null):(z=new Date,y(),a.los[b.id].shown=!0,a.los[b.id].nshown+=1,SGAME.Fancybox.create({lo:b},
function(c){!0!==a.los[b.id].successfully_consumed&&(a.los[b.id].successfully_consumed=c.success);!0===c.success?a.los[b.id].nsuccess+=1:a.los[b.id].unsuccessfully_consumed=!0;if("random"!==a.sequencing.approach&&!1===k){var f=SGAME.Sequencing.updateGroupsTracking(a.los[b.id],a.sequencing.sequence,a.los);a.sequencing.sequence=f.groups;a.los=f.los;f.finished&&(k=!0)}switch(a.sequencing.repeat_lo){case "repeat_unless_successfully_consumed":a.los[b.id].can_be_shown=!0!==a.los[b.id].successfully_consumed;
break;case "no_repeat":a.los[b.id].can_be_shown=!1}N();c.more_los=q;J(function(){"function"===typeof d&&d(c.success,c);y()})}))},y=function(){"function"===typeof g&&g()},N=function(){var b=Object.keys(a.los),d=b.length;l=w=x=v=0;q=!1;for(var c=0;c<d;c++)!0===a.los[b[c]].shown&&(v+=1,x+=a.los[b[c]].nshown),!0===a.los[b[c]].successfully_consumed&&(w+=1,l+=a.los[b[c]].nsuccess),!0===a.los[b[c]].can_be_shown&&(q=!0);b=0;d="incompleted";switch(a.game_settings.completion_status){case "all_los":a.game_settings.completion_status_n=
100;case "percentage_los":c=Math.min(100,Math.max(0,a.game_settings.completion_status_n))/100;b=0>=c||0>=u?1:v/u/c;break;case "n_los":c=Math.min(a.game_settings.completion_status_n,u);b=0===c?1:v/c;break;case "n_times":b=0>=a.game_settings.completion_status_n?1:x/a.game_settings.completion_status_n;break;case "onstart":b=1}b=Math.max(Math.min(1,+b.toFixed(2)),0);d=1===b?"completed":"incompleted";c=0;switch(a.game_settings.success_status){case "all_los":a.game_settings.success_status_n=100;case "percentage_los":c=
Math.min(100,Math.max(0,a.game_settings.success_status_n))/100;c=0>=c||0>=u?1:w/u/c;break;case "n_los":c=Math.min(a.game_settings.success_status_n,u);c=0===c?1:v/c;break;case "n_times":c=0>=a.game_settings.success_status_n?1:l/a.game_settings.success_status_n;break;case "oncompletion":c=b;break;case "onstart":c=1}c=Math.max(Math.min(1,+c.toFixed(2)),0);n={progress_measure:b,completion_status:d,score:c,success_status:1===c?"passed":"failed"};SGAME.Messenger.sendMessage({key:"tracking",value:n})},J=
function(a){!0!==K()?"function"===typeof a&&a(!1):O(a)},K=function(){if(!0===D)return!1;switch(a.game_settings.completion_notification){case "no_more_los":return!1===q;case "all_los_consumed":return v>=u;case "all_los_successfully_consumed":return w>=u;case "completion_status":return"completed"===n.completion_status;case "success_status":return"passed"===n.success_status;case "never":return!1;default:return!1}},O=function(a){D=!0;SGAME.Fancybox.create({dialog:!0,msg:m},function(){"function"===typeof a&&
a(!0)})},H=function(a){for(var b=[],c,d=0;d<a.length;d++)"undefined"===typeof c&&(c=a[d].nshown),a[d].nshown<c&&(c=a[d].nshown,b=[]),c===a[d].nshown&&b.push(a[d]);return SGAME.Utils.getRandomElement(b)},I=function(a){return{lo_metadata:void 0,time:void 0,scorm_success_status:void 0,scorm_scaled_score:void 0,scorm_completion_status:void 0,scorm_progress_measure:void 0,success:L(a),more_los:q}},L=function(b){var c;t&&"undefined"!==typeof a.game_settings.behaviour_when_no_more_los?c=a.game_settings.behaviour_when_no_more_los:
"undefined"!==typeof d.behaviour_when_no_more_los?c=d.behaviour_when_no_more_los:"undefined"!==typeof a.game_settings.behaviour_when_no_more_los&&(c=a.game_settings.behaviour_when_no_more_los);return P(c,b)},P=function(a,b){switch(a){case "success":return!0;case "failure":return!1;case "success_unless_damage":var c=M(b);return"undefined"!==typeof c&&"damage"===c.type?!1:!0;case "failure_unless_blocking":return c=M(b),"undefined"===typeof c||"blocking"!==c.type?!1:!0;default:return!1}},M=function(b){return"undefined"!==
typeof a.events[b]?a.events[b]:"object"===typeof d.events&&"undefined"!==typeof d.events[b]?d.events[b]:{}};SGAME.Debugger.init(!0);!1===t&&E({});SGAME.Messenger.init();return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);(d=a)&&"function"===typeof a.togglePause&&(g=a.togglePause)},loadSettings:function(b){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(b);t=!0;E(b);SGAME.Debugger.log("SGAME settings loaded");SGAME.Debugger.log(a)},triggerLO:function(b,
c){switch(a.sequencing.interruptions){case "no_restrictions":return C(b,c);case "n_times":return x>=a.sequencing.interruptions_n?A(b,c):C(b,c);case "1_per_timeperiod":return"undefined"!==typeof z&&(new Date-z)/1E3<=a.sequencing.interruptions_n?A(b,c):C(b,c)}},showLO:B,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,function(b){B(b,a)},function(){"function"===typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()},getSettings:function(){return a},losCanBeShown:function(a){return!1===
q?!1:"undefined"===typeof a?q:0<G(F(a)).length},successWhenNoLOs:function(a){return L(a)},onConnectedToVLE:function(){"onstart"===a.game_settings.completion_status&&(n.progress_measure=1,n.completion_status="completed");"onstart"===a.game_settings.success_status&&(n.score=1,n.success_status="passed");if("onstart"===a.game_settings.completion_status||"onstart"===a.game_settings.success_status)SGAME.Messenger.sendMessage({key:"tracking",value:n}),setTimeout(function(){!0===K()&&(y(),J(function(){y()}))},
500)},getVLEData:function(){return r},setVLEData:function(a){return r=a}}}();SGAME.Observer=function(d){var g=!0,k=d,m=d,a=d,t,r,n,s,e,b,p=function(){a=m=k=d;t=Date.now();r=!1;b=e=s=n=d},c=function(){!1===m.acts_as_asset&&"undefined"!==typeof a&&(a.addListener("cmi.success_status",function(a){n=a;"passed"===n&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),a.addListener("cmi.score.scaled",function(a){s=a;0.8<=s&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
a.addListener("cmi.completion_status",function(a){e=a}),a.addListener("cmi.progress_measure",function(a){b=a}))};return{start:function(b,d,e){if(!1===g||"undefined"!=typeof k)return null;g=!1;p();k=b;m=d;a=e;c();SGAME.TrafficLight.changeColor("red");if(!0===m.acts_as_asset){b:{b=m.lom_metadata;if(b.educational&&b.educational.typicalLearningTime&&b.educational.typicalLearningTime.duration&&(b=iso8601Parser.getDuration(b.educational.typicalLearningTime.duration)))break b;b=null}b=!b||0>=b?15:Math.min(0.5*
b,120);SGAME.TrafficLight.setUpBlink("yellow",0.5*b-0.5,0.5*b);SGAME.TrafficLight.changeColor("green",b)}},stop:function(){if(!0===g||"undefined"==typeof k)return null;g=!0;SGAME.TrafficLight.stop();var a=Math.round((Date.now()-t)/1E3);r="green"===SGAME.TrafficLight.getCurrentColor();a={lo_metadata:m,time:a,success:r};"undefined"!=typeof n&&(a.scorm_success_status=n);"undefined"!=typeof s&&(a.scorm_scaled_score=s);"undefined"!=typeof e&&(a.scorm_completion_status=e);"undefined"!=typeof b&&(a.scorm_progress_measure=
b);p();return a},isStopped:function(){return g}}}();SGAME.Utils=function(){var d=void 0;return{init:function(d){},getRandomElement:function(d){if("number"==typeof d)return d;var k;k=d.length-1;if("number"!=typeof k)throw{name:"Invalid number format exception"};k=Math.round(0+Math.random()*(k-0));return d[k]},loadScript:function(d,k){if("string"===typeof d&&"function"===typeof k){var m=document.getElementsByTagName("head")[0];if(m){var a=document.createElement("script");a.setAttribute("src",d);a.setAttribute("type","text/javascript");a.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||k()};a.onload=k;m.appendChild(a)}}},getProtocol:function(){if("undefined"!==typeof d)return d;var g;try{g=document.location.protocol}catch(k){}"string"===typeof g&&(g=g.match(/[\w]+/),g=g instanceof Array&&"string"===typeof g[0]?g[0]:void 0);return d="string"===typeof g?g:"unknown"},checkUrlProtocol:function(d){if("string"===typeof d){var k=d.match(/^https?:\/\//);if(k instanceof Array&&1===k.length){var k=k[0].replace("://",""),m=
SGAME.Utils.getProtocol();if(k!==m)switch(m){case "https":d="https"+d.replace(k,"")}}}return d}}}();
