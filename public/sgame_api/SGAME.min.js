iso8601Parser=function(k){return{getDuration:function(f){var d=[31104E3,2592E3,604800,86400,3600,60,1];try{var q;var n=f;f=[2,3,4,5,7,8,9];var k=[0,0,0,0,0,0,0],r;if(n=n.toUpperCase()){if("string"!==typeof n)throw Error("Invalid iso8601 period string '"+n+"'");if(r=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(n))for(n=0;n<f.length;n++){var a=f[n];k[n]=r[a]?+r[a].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+n+"' is not a valid ISO8601 period.");}q=k}catch(m){return null}for(a=
r=0;a<q.length;a++)r+=q[a]*d[a];return r}}}();function Local_API_1484_11(k){function f(b,a){g.diganostic="The "+b+" of "+a+" must be a proper vocabulary element.";g.errorCode=406;return"false"}function d(b){g.errorCode=402;g.diagnostic="The value for key "+b+" has not been created yet.";return"false"}function q(b,a){g.errorCode=201;g.diagnostic="The value for key "+b+" is not valid.";return"false"}function n(b,a,l){b=b.split(/\./);2>b.length?l[b[0]]=a:(l[b[0]]||(l[b[0]]={}),l=l[b.shift()],n(b.join("."),a,l))}function s(b,a){var l=b.split(/\./),
e;if(2>l.length)try{return a[l[0]]}catch(f){return d(b),"false"}else{e=l.shift();if(a[e])return String(s(l.join("."),a[e]));d(b);return"false"}}function r(b){var a,l=0;for(a in b)b.hasOwnProperty(a)&&(l+=1);return l}function a(b,a){if(g.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(a){case 1:console.error(b);break;case 2:console.warn(b);break;case 4:console.info(b);
break;case 3:console.log(b);break;default:return console.log(b),!1}return!0}3>a&&g.throw_alerts&&alert(b);return!1}function m(b,a){if("function"==typeof g.listeners[b]&&"undefined"!=typeof a)g.listeners[b](a)}function h(b,a){for(var l in a)a.hasOwnProperty(l)&&("object"==typeof b[l]?"object"==typeof a[l]&&(b[l]=h(b[l],a[l])):b[l]=a[l]);return b}function c(b,a){(function(){function b(a,l){l=l||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,l.bubbles,
l.cancelable,l.detail);return e}if("function"===typeof window.CustomEvent)return!1;b.prototype=window.Event.prototype;window.CustomEvent=b})();document.dispatchEvent(new CustomEvent(b,{detail:a}))}function u(b){return"object"!==type(b)||b.nodeType||isWindow(b)?!1:!(b.constructor&&!hasOwn.call(b.constructor.prototype,"isPrototypeOf"))}var g=h({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},k),e={},l={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},t=this;this.isRunning=function(){return 1===g.initialized&&0===g.terminated};this.Initialize=function(){a(g.prefix+":  Initializing...",3);g.cmi?(e=g.cmi,"suspend"===e.exit&&(e.entry="resume")):e=g.CMI;g.initialized=1;g.terminated=0;return"true"};this.GetValue=
function(b){g.errorCode=0;var l="false";b=b.toString();var f=[];if(this.isRunning()){f=b.split(".");if(0<="|exit|session_time|".indexOf("|"+f[f.length-1]+"|"))return a(g.prefix+": This "+b+" is write only",4),g.errorCode=405,"false";f=b.toLowerCase().split(".");switch(f[0]){case "cmi":switch(l="false",b){case "cmi.exit":case "cmi.session_time":g.errorCode=405;g.diagnostic="Sorry, this has been specified as a read-only value for "+b;break;case "cmi.learner_name":l=g.CMI.learner_name;break;default:l=
s(b.substr(4,b.length),e),"undefined"===l&&(g.errorCode=401,g.diagnostic="Sorry, there was a undefined response from "+b,l="false"),a(g.prefix+": GetValue "+b+" = "+l,4)}}return l}g.errorCode=123;return l};this.SetValue=function(b,l){a(g.prefix+": SetValue: "+b+" = "+l,4);g.errorCode=0;var c=[],h=b.toString(),d=l.toString(),p=0,t=0,p=[];if(this.isRunning()){p=h.split(".");if("adl"===p[0]&&"id"===p[4]||"comments_from_lms"===p[1]||("comments_from_learner"===p[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
p[p.length-1]+"|")))return a(g.prefix+": This "+h+" is read only",4),g.errorCode=404,"false";c=h.split(".");switch(c[0]){case "cmi":switch(b){case "cmi.location":1E3<d.length&&a(g.prefix+": Some LMS's might truncate your bookmark as you've passed "+d.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":p=parseFloat(d);if("number"!=typeof p||isNaN(p))return q(b,d);p=Math.max(0,Math.min(1,p));m(b,p);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+
d+"|"))return f(b,d);m(b,d);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+d+"|"))return f(b,d);break;case "cmi.score.scaled":p=parseFloat(d);if("number"!=typeof p||isNaN(p))return q(b,d);p=Math.max(0,Math.min(1,p));m(b,p);break;case "cmi.score.min":p=parseFloat(d);if("number"!=typeof p||isNaN(p))return q(b,d);g.CMI.score.min=p;break;case "cmi.score.max":p=parseFloat(d);if("number"!=typeof p||isNaN(p))return q(b,d);g.CMI.score.max=p;break;case "cmi.score.raw":p=parseFloat(d);
if("number"!=typeof p||isNaN(p))return q(b,d);t=parseFloat(g.CMI.score.max);t="number"!=typeof t||isNaN(t)?100:t;c=parseFloat(g.CMI.score.min);c="number"!=typeof c||isNaN(c)?0:c;t-=c;0>=t&&(t=100);p=Math.max(0,Math.min(1,(p-c)/t));m("cmi.score.scaled",p);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+d+"|"))return f(b,d);m(b,d);break;default:switch(c[1]){case "comments_from_lms":return g.errorCode="404",g.diagnostic="The cmi.comments_from_lms element is entirely read only.",
"false";case "comments_from_learner":if(-1===e.comments_from_learner._children.indexOf(c[3]))return f(b,d);n(h.substr(4,h.length),d,e);e.comments_from_learner._count=(r(e.comments_from_learner)-2).toString();return"true";case "interactions":if(-1===e.interactions._children.indexOf(c[3]))return f(b,d);e.interactions._count=(r(e.interactions)-2).toString();if(isNaN(parseInt(c[2],10)))return"false";if(!u(e.interactions[c[2]])){if("id"===c[3])return e.interactions[c[2]]={},n(h.substr(4,h.length),d,e),
e.interactions._count=(r(e.interactions)-2).toString(),u(e.interactions[c[2]].objectives)||(a(g.prefix+": Constructing objectives object for new interaction",4),e.interactions[c[2]].objectives={},e.interactions[c[2]].objectives._count="-1"),u(e.interactions[c[2]].correct_responses)||(a(g.prefix+": Constructing correct responses object for new interaction",4),e.interactions[c[2]].correct_responses={},e.interactions[c[2]].correct_responses._count="-1"),"true";a("Can't add interaction without ID first!",
3);return"false"}if("objectives"===c[3]){if("id"===c[5])for(t=parseInt(e.interactions[c[2]].objectives._count,10),p=0;p<t;p+=1){if(e.interactions[c[2]].objectives[p].id===d)return h=b,g.errorCode="351",g.diagnostic="The "+h+" element must be unique.  The value '"+d+"' has already been set in #"+p,"false"}else return f(b,d);n(h.substr(4,h.length),d,e);e.interactions[c[2]].objectives._count=(r(e.interactions[c[2]].objectives)-1).toString();return"true"}"correct_responses"===c[3]&&(n(h.substr(4,h.length),
d,e),e.interactions[c[2]].correct_responses._count=(r(e.interactions[c[2]].correct_responses)-1).toString());n(h.substr(4,h.length),d,e);e.interactions._count=(r(e.interactions)-2).toString();return"true";case "objectives":if("id"===c[3])for(t=parseInt(e.objectives._count,10),p=0;p<t;p+=1)if(e.objectives[p].id===d)return g.errorCode="351",g.diagnostic="The objectives.id element must be unique.  The value '"+d+"' has already been set in objective #"+p,"false";if("id"!==c[3]&&(p=parseInt(c[2],10),void 0===
e.objectives[p]))return g.errorCode="408",g.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(c[2],10)))return"false";n(h.substr(4,h.length),d,e);e.objectives._count=(r(e.objectives)-2).toString();return"true"}}n(h.substr(4,h.length),d,e)}return"true"}g.errorCode=g.terminated?133:132;return"false"};this.Commit=function(){a(g.prefix+": Commit CMI Object:",4);a(e);a(g.prefix+": Suspend Data Usage "+(Math.round(100*(e.suspend_data.length/64E3)*
Math.pow(10,2))/Math.pow(10,2)+"%"));c("StoreData",{runtimedata:e});return"true"};this.Terminate=function(){t.Commit();g.terminated=1;g.initialized=0;return"true"};this.GetErrorString=function(b){return""!==b&&(b=parseInt(b,10),void 0!==l[b])?l[b]:""};this.GetLastError=function(){return g.errorCode};this.GetDiagnostic=function(){return g.diagnostic};this.setCMILMSValue=function(b,a){"string"==typeof b&&(g.CMI[b]=a)};this.addListener=function(b,a){"string"==typeof b&&"function"==typeof a&&(g.listeners[b]=
a)}};function Local_API_SCORM_12(k){function f(a,e){c.diganostic="The "+a+" of "+e+" must be a proper vocabulary element.";c.errorCode=406;return"false"}function d(a){c.errorCode=402;c.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function q(a,e){c.errorCode=201;c.diagnostic="The value for key "+a+" is not valid.";return"false"}function n(a,c,b){a=a.split(/\./);2>a.length?b[a[0]]=c:(b[a[0]]||(b[a[0]]={}),b=b[a.shift()],n(a.join("."),c,b))}function s(a,c){var b=a.split(/\./),
e;if(2>b.length)try{return c[b[0]]}catch(h){return d(a),"false"}else{e=b.shift();if(c[e])return String(s(b.join("."),c[e]));d(a);return"false"}}function r(a,e){if(c.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(e){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);break;case 3:console.log(a);break;default:return console.log(a),
!1}return!0}3>e&&c.throw_alerts&&alert(a);return!1}function a(a,e){if("function"==typeof c.listeners[a]&&"undefined"!=typeof e)c.listeners[a](e)}function m(a,c){for(var b in c)c.hasOwnProperty(b)&&("object"==typeof a[b]?"object"==typeof c[b]&&(a[b]=m(a[b],c[b])):a[b]=c[b]);return a}function h(a,c){(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return e}if("function"===typeof window.CustomEvent)return!1;
a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:c}))}var c=m({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},k),u={},g={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},e=this;this.isRunning=function(){return 1===c.initialized&&0===c.terminated};this.LMSInitialize=function(){r(c.prefix+":  Initializing...",3);u=c.CMI;c.initialized=1;c.terminated=0;return"true"};this.LMSGetValue=function(a){c.errorCode=0;var e="false";a=a.toString();var b=[];if(this.isRunning()){b=a.split(".");if(0<="|exit|session_time|".indexOf("|"+
b[b.length-1]+"|"))return c.errorCode=405,"false";b=a.toLowerCase().split(".");switch(b[0]){case "cmi":e=a;a="false";switch(e){case "cmi.core.exit":case "cmi.core.session_time":c.errorCode=405;c.diagnostic="Sorry, this has been specified as a read-only value for "+e;break;default:e=e.replace("cmi.",""),a=s(e,u),"undefined"===a&&(c.errorCode=401,c.diagnostic="Sorry, there was a undefined response from "+e,a="false")}e=a}return e}c.errorCode=123;return e};this.LMSSetValue=function(e,d){r(c.prefix+": SetValue: "+
e+" = "+d,4);c.errorCode=0;var b=[],h=e.toString(),g=d.toString();if(this.isRunning()){var b=h.split("."),m=b[b.length-1],b="adl"===b[0]&&"id"===b[4]?!0:"comments_from_lms"===b[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+m+"|");if(b)return c.errorCode=404,"false";b=h.split(".");switch(b[0]){case "cmi":switch(e){case "cmi.core.lesson_location":1E3<
g.length&&r(c.prefix+": Some LMS's might truncate your bookmark as you've passed "+g.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+g+"|"))return f(e,g);a(e,g);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+g+"|"))return f(e,g);break;case "cmi.core.score.min":b=parseFloat(g);if("number"!=typeof b||isNaN(b))return q(e,g);c.CMI.core.score.min=
b;break;case "cmi.core.score.max":b=parseFloat(g);if("number"!=typeof b||isNaN(b))return q(e,g);c.CMI.core.score.max=b;break;case "cmi.core.score.raw":b=parseFloat(g);if("number"!=typeof b||isNaN(b))return q(e,g);var k=parseFloat(c.CMI.core.score.max),k="number"!=typeof k||isNaN(k)?100:k,m=parseFloat(c.CMI.core.score.min),m="number"!=typeof m||isNaN(m)?0:m,k=k-m;0>=k&&(k=100);b=Math.max(0,Math.min(1,(b-m)/k));a("cmi.score.scaled",b)}h=h.replace("cmi.","");n(h,g,u)}return"true"}c.errorCode=c.terminated?
133:132;return"false"};this.LMSCommit=function(){h("StoreData",{runtimedata:u});return"true"};this.LMSTerminate=function(){e.LMSCommit();c.terminated=1;c.initialized=0;return"true"};this.LMSFinish=function(){e.LMSCommit();c.terminated=1;c.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==g[a])?g[a]:""};this.LMSGetLastError=function(){return c.errorCode};this.LMSGetDiagnostic=function(){return c.diagnostic};this.setCMILMSValue=function(a,e){"string"==
typeof a&&(c.CMI[a]=e)};this.addListener=function(a,e){"string"==typeof a&&"function"==typeof e&&(c.listeners[a]=e)}};SGAME=function(){return{init:function(k){SGAME.CORE.init(k)},loadSettings:function(k){SGAME.CORE.loadSettings(k)},triggerLO:function(k,f){SGAME.CORE.triggerLO(k,f)},showLO:function(k,f){SGAME.CORE.showLO(k,f)},showRandomLO:function(k){SGAME.CORE.showRandomLO(k)},closeLO:function(){SGAME.CORE.closeLO()}}}();SGAME.VERSION="0.4";SGAME.AUTHORS="Aldo Gordillo, Enrique Barra";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var k=!1;return{init:function(f){!0===f&&(k=f)},isDebugging:function(){return k},log:function(f){k&&window.console&&console.log(f)}}}();SGAME.API=function(){var k=function(f,d){var k=new XMLHttpRequest;k.onreadystatechange=function(){if(4==k.readyState&&200==k.status){var f=JSON.parse(k.responseText);d(f)}};k.open("GET",f,!0);k.send("")};return{init:function(){},requestLOMetadata:function(f,d,q){try{k("undefined"==typeof f?"/lo/random/metadata.json":"/lo/"+f+"/metadata.json",function(f){d(f)})}catch(n){q(n)}}}}();SGAME.CORE=function(){var k={},f=[],d={},q=void 0;SGAME.Debugger.init(!0);var n=function(a,d){"object"!=typeof a||"string"!=typeof a.url?"function"==typeof d&&d(null,null):(s(),SGAME.Fancybox.create({lo:a},function(a){"function"==typeof d&&d(a.success,a);s()}))},s=function(){"function"===typeof q&&q()},r=function(a){var d;d=[];for(var h=0;h<a.length;h++)!1===a[h].marked&&d.push(a[h]);if(0<d.length)d=SGAME.Utils.getRandomElement(d);else{for(h=0;h<a.length;h++)a[h].marked=!1;d=SGAME.Utils.getRandomElement(a)}"undefined"!=
typeof d&&(a[a.indexOf(d)].marked=!0);return{lo:d,los:a}};return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);a&&"function"===typeof a.togglePause&&(q=a.togglePause)},loadSettings:function(a){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(a);k={};f=[];d={};if(a.lo_list)for(var m=0;m<a.lo_list.length;m++)"undefined"!==typeof a.lo_list[m].url&&(a.lo_list[m].url=SGAME.Utils.checkUrlProtocol(a.lo_list[m].url)),"undefined"!==typeof a.lo_list[m].id&&
(k[a.lo_list[m].id]=a.lo_list[m],f.push({id:a.lo_list[m].id,marked:!1}));if(a.event_mapping)for(m=0;m<a.event_mapping.length;m++){var h=a.event_mapping[m];d[h.event_id]={};d[h.event_id].los=[];for(var c=0;c<h.los_id.length;c++)d[h.event_id].los.push({id:h.los_id[c],marked:!1})}},triggerLO:function(a,m){var h=[];"undefined"!=typeof d[a]&&(h=d[a].los);if(h&&h instanceof Array&&0<h.length){var c;a:{for(c=0;c<h.length;c++)if("*"===h[c].id){c=!0;break a}c=!1}c?(h=r(f),f=h.los):(h=r(h),d[a].los=h.los);
"undefined"!=typeof h.lo?n(k[h.lo.id],m):"function"==typeof m&&m(null,null)}else"function"==typeof m&&m(null,null)},showLO:n,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,function(d){n(d,a)},function(){"function"==typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()}}}();var API,API_1484_11;
SGAME.Fancybox=function(k){var f=k,d=k,q=function(){"undefined"!=typeof f&&(f.style.display="none",f.parentNode.removeChild(f),API_1484_11=API=f=k)},n=function(){q();var f=SGAME.Observer.stop();"function"===typeof d&&d(f);d=k};return{init:function(){},create:function(s,r){q();d=r;var a=850,m=650,h={},c;s&&(s.width&&(a=s.width),s.height&&(m=s.height),s.lo&&(h=s.lo),"string"==typeof h.url&&(c=h.url));var u=window.innerHeight-8,g=window.innerWidth-8,m=Math.min(m,u),a=Math.min(a,g);if("string"==typeof c&&
"undefined"!=typeof h.scorm_type){var e=k;API_1484_11=API=k;"sco"===h.scorm_type&&("1.2"===h.scorm_version?e=API=new Local_API_SCORM_12({debug:SGAME.Debugger.isDebugging()}):"2004"===h.scorm_version&&(e=API_1484_11=new Local_API_1484_11({debug:SGAME.Debugger.isDebugging()})));var l=document.createElement("div");l.style.width=a+"px";l.style.height=m+"px";l.style.maxWidth=g+"px";l.style.maxHeight=u+"px";l.style.overflow="hidden";l.style.background="white";l.style.position="absolute";l.style.top=0;l.style.zIndex=
9999;l.style.borderRadius="1em";l.style.border="2px solid black";l.setAttribute("id","sgame_fancybox");l.style.marginLeft=(window.innerWidth-a)/2+"px";l.style.marginTop=(window.innerHeight-m)/2+"px";a=document.createElement("img");a.src="/assets/sgame/close.png";a.style.width="25px";a.style.height="25px";a.style.padding="5px";a.style.cursor="pointer";a.style.position="absolute";a.style.right=0;a.onclick=function(){n()};l.appendChild(a);a=document.createElement("img");a.id="trafficLight";a.src="/assets/sgame/trafficLight/trafficLight_red.png";
a.style.width="45px";a.style.height="40px";a.style.padding="5px";a.style.position="absolute";a.style.left="0px";a.style.top="0px";l.appendChild(a);a=document.createElement("iframe");a.src=c;a.style.width="94%";a.style.height="94%";a.style.marginLeft="3%";a.style.marginTop="3%";a.style.overflow="hidden";a.style.overflowY="auto";a.scrolling="yes";a.style.frameBorder="0";a.style.borderStyle="none";a.setAttribute("allowfullscreen","false");l.appendChild(a);f=l;document.body.appendChild(l);SGAME.Observer.start(a,
h,e)}},closeCurrentFancybox:n}}();SGAME.Observer=function(k){var f=!0,d=k,q=k,n=k,s,r,a,m,h,c,u=function(){n=q=d=k;s=Date.now();r=!1;c=h=m=a=k},g=function(){"sco"==q.scorm_type&&"undefined"!=typeof n&&(n.addListener("cmi.success_status",function(e){a=e;"passed"===a&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),n.addListener("cmi.score.scaled",function(a){m=a;0.8<=m&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
n.addListener("cmi.completion_status",function(a){h=a}),n.addListener("cmi.progress_measure",function(a){c=a}))};return{start:function(a,c,h){if(!1===f||"undefined"!=typeof d)return null;f=!1;u();d=a;q=c;n=h;g();SGAME.TrafficLight.changeColor("red");if("asset"==q.scorm_type){b:{a=q.lom_metadata;if(a.educational&&a.educational.typicalLearningTime&&a.educational.typicalLearningTime.duration&&a.educational.typicalLearningTime.duration.langstrings&&a.educational.typicalLearningTime.duration.langstrings["x-none"]&&
(a=iso8601Parser.getDuration(a.educational.typicalLearningTime.duration.langstrings["x-none"])))break b;a=null}a=a?Math.min(0.5*a,60):15;SGAME.TrafficLight.setUpBlink("yellow",0.5*a-0.5,0.5*a);SGAME.TrafficLight.changeColor("green",a)}},stop:function(){if(!0===f||"undefined"==typeof d)return null;f=!0;SGAME.TrafficLight.stop();var e=Math.round((Date.now()-s)/1E3);r="green"===SGAME.TrafficLight.getCurrentColor();e={lo_metadata:q,time:e,success:r};"undefined"!=typeof a&&(e.scorm_success_status=a);"undefined"!=
typeof m&&(e.scorm_scaled_score=m);"undefined"!=typeof h&&(e.scorm_completion_status=h);"undefined"!=typeof c&&(e.scorm_progress_measure=c);u();return e},isStopped:function(){return f}}}();SGAME.TrafficLight=function(k){var f,d,q,n,s,r=function(d){var c=document.getElementById("trafficLight");c&&(f=d,c.src=a(d))},a=function(a){switch(a){case "green":return"/assets/sgame/trafficLight/trafficLight_green.png";case "yellow":return"/assets/sgame/trafficLight/trafficLight_yellow.png";case "red":return"/assets/sgame/trafficLight/trafficLight_red.png";default:return"/assets/sgame/trafficLight/trafficLight.png"}},m=function(d,c){var f=document.getElementById("trafficLight");if(f){var g=!1;n=
setInterval(function(){f&&(g?(f.src=a(null),g=!1):(f.src=a(d),g=!0))},500);s=setTimeout(function(){clearTimeout(n)},1E3*c)}};return{getCurrentColor:function(){return f},changeColor:function(a,c){c?d=setTimeout(function(){r(a)},1E3*c):r(a)},setUpBlink:function(a,c,d){d?q=setTimeout(function(){m(a,c)},1E3*d):m(a,c)},stop:function(){d&&clearTimeout(d);q&&clearTimeout(q);n&&clearTimeout(n);s&&clearTimeout(s)}}}();SGAME.Utils=function(){var k=void 0;return{init:function(f){},getRandomElement:function(f){if("number"==typeof f)return f;var d;d=f.length-1;if("number"!=typeof d)throw{name:"Invalid number format exception"};d=Math.round(0+Math.random()*(d-0));return f[d]},loadScript:function(f,d){if("string"===typeof f&&"function"===typeof d){var k=document.getElementsByTagName("head")[0];if(k){var n=document.createElement("script");n.setAttribute("src",f);n.setAttribute("type","text/javascript");n.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||d()};n.onload=d;k.appendChild(n)}}},getProtocol:function(){if("undefined"!==typeof k)return k;var f;try{f=document.location.protocol}catch(d){}"string"===typeof f&&(f=f.match(/[\w]+/),f=f instanceof Array&&"string"===typeof f[0]?f[0]:void 0);return k="string"===typeof f?f:"unknown"},checkUrlProtocol:function(f){if("string"===typeof f){var d=f.match(/^https?:\/\//);if(d instanceof Array&&1===d.length){var d=d[0].replace("://",""),k=
SGAME.Utils.getProtocol();if(d!==k)switch(k){case "https":f="https"+f.replace(d,"")}}}return f}}}();
