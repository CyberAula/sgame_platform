iso8601Parser=function(e){return{getDuration:function(k){var e=[31104E3,2592E3,604800,86400,3600,60,1];try{var n;var b=k;k=[2,3,4,5,7,8,9];var v=[0,0,0,0,0,0,0],r;if(b=b.toUpperCase()){if("string"!==typeof b)throw Error("Invalid iso8601 period string '"+b+"'");if(r=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(b))for(b=0;b<k.length;b++){var l=k[b];v[b]=r[l]?+r[l].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+b+"' is not a valid ISO8601 period.");}n=v}catch(t){return null}for(l=
r=0;l<n.length;l++)r+=n[l]*e[l];return r}}}();function Local_API_1484_11(e){function k(a,b){c.diganostic="The "+a+" of "+b+" must be a proper vocabulary element.";c.errorCode=406;return"false"}function f(a){c.errorCode=402;c.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function n(a,b){c.errorCode=201;c.diagnostic="The value for key "+a+" is not valid.";return"false"}function b(a,d,c){a=a.split(/\./);2>a.length?c[a[0]]=d:(c[a[0]]||(c[a[0]]={}),c=c[a.shift()],b(a.join("."),d,c))}function v(a,b){var c=a.split(/\./),
d;if(2>c.length)try{return b[c[0]]}catch(g){return f(a),"false"}else{d=c.shift();if(b[d])return String(v(c.join("."),b[d]));f(a);return"false"}}function r(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&(c+=1);return c}function l(a,b){if(c.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(b){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);
break;case 3:console.log(a);break;default:return console.log(a),!1}return!0}3>b&&c.throw_alerts&&alert(a);return!1}function t(a,b){if("function"==typeof c.listeners[a]&&"undefined"!=typeof b)c.listeners[a](b)}function u(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof a[c]?"object"==typeof b[c]&&(a[c]=u(a[c],b[c])):a[c]=b[c]);return a}function a(a,b){(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(b,c.bubbles,
c.cancelable,c.detail);return d}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:b}))}function p(a){return"object"!==type(a)||a.nodeType||isWindow(a)?!1:!(a.constructor&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))}var c=u({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,user:void 0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},e),d={},m={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},g=this;"object"===typeof c.user&&("string"===typeof c.user.name&&(c.CMI.learner_name=c.user.name),"string"===typeof c.user.id&&(c.CMI.learner_id=c.user.id));this.isRunning=function(){return 1===c.initialized&&0===c.terminated};this.Initialize=function(){l(c.prefix+
":  Initializing...",3);c.cmi?(d=c.cmi,"suspend"===d.exit&&(d.entry="resume")):d=c.CMI;c.initialized=1;c.terminated=0;return"true"};this.GetValue=function(a){c.errorCode=0;var b="false";a=a.toString();var g=[];if(this.isRunning()){g=a.split(".");if(0<="|exit|session_time|".indexOf("|"+g[g.length-1]+"|"))return l(c.prefix+": This "+a+" is write only",4),c.errorCode=405,"false";g=a.toLowerCase().split(".");switch(g[0]){case "cmi":switch(b="false",a){case "cmi.exit":case "cmi.session_time":c.errorCode=
405;c.diagnostic="Sorry, this has been specified as a read-only value for "+a;break;case "cmi.learner_name":b=c.CMI.learner_name;break;default:b=v(a.substr(4,a.length),d),"undefined"===b&&(c.errorCode=401,c.diagnostic="Sorry, there was a undefined response from "+a,b="false"),l(c.prefix+": GetValue "+a+" = "+b,4)}}return b}c.errorCode=123;return b};this.SetValue=function(a,g){l(c.prefix+": SetValue: "+a+" = "+g,4);c.errorCode=0;var m=[],e=a.toString(),h=g.toString(),q=0,f=0,q=[];if(this.isRunning()){q=
e.split(".");if("adl"===q[0]&&"id"===q[4]||"comments_from_lms"===q[1]||("comments_from_learner"===q[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+q[q.length-1]+"|")))return l(c.prefix+": This "+e+" is read only",4),c.errorCode=404,"false";m=e.split(".");switch(m[0]){case "cmi":switch(a){case "cmi.location":1E3<h.length&&l(c.prefix+": Some LMS's might truncate your bookmark as you've passed "+
h.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":q=parseFloat(h);if("number"!=typeof q||isNaN(q))return n(a,h);q=Math.max(0,Math.min(1,q));t(a,q);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+h+"|"))return k(a,h);t(a,h);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+h+"|"))return k(a,h);break;case "cmi.score.scaled":q=parseFloat(h);if("number"!=typeof q||isNaN(q))return n(a,h);q=Math.max(0,
Math.min(1,q));t(a,q);break;case "cmi.score.min":q=parseFloat(h);if("number"!=typeof q||isNaN(q))return n(a,h);c.CMI.score.min=q;break;case "cmi.score.max":q=parseFloat(h);if("number"!=typeof q||isNaN(q))return n(a,h);c.CMI.score.max=q;break;case "cmi.score.raw":q=parseFloat(h);if("number"!=typeof q||isNaN(q))return n(a,h);f=parseFloat(c.CMI.score.max);f="number"!=typeof f||isNaN(f)?100:f;m=parseFloat(c.CMI.score.min);m="number"!=typeof m||isNaN(m)?0:m;f-=m;0>=f&&(f=100);q=Math.max(0,Math.min(1,(q-
m)/f));t("cmi.score.scaled",q);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+h+"|"))return k(a,h);t(a,h);break;default:switch(m[1]){case "comments_from_lms":return c.errorCode="404",c.diagnostic="The cmi.comments_from_lms element is entirely read only.","false";case "comments_from_learner":if(-1===d.comments_from_learner._children.indexOf(m[3]))return k(a,h);b(e.substr(4,e.length),h,d);d.comments_from_learner._count=(r(d.comments_from_learner)-2).toString();return"true";
case "interactions":if(-1===d.interactions._children.indexOf(m[3]))return k(a,h);d.interactions._count=(r(d.interactions)-2).toString();if(isNaN(parseInt(m[2],10)))return"false";if(!p(d.interactions[m[2]])){if("id"===m[3])return d.interactions[m[2]]={},b(e.substr(4,e.length),h,d),d.interactions._count=(r(d.interactions)-2).toString(),p(d.interactions[m[2]].objectives)||(l(c.prefix+": Constructing objectives object for new interaction",4),d.interactions[m[2]].objectives={},d.interactions[m[2]].objectives._count=
"-1"),p(d.interactions[m[2]].correct_responses)||(l(c.prefix+": Constructing correct responses object for new interaction",4),d.interactions[m[2]].correct_responses={},d.interactions[m[2]].correct_responses._count="-1"),"true";l("Can't add interaction without ID first!",3);return"false"}if("objectives"===m[3]){if("id"===m[5])for(f=parseInt(d.interactions[m[2]].objectives._count,10),q=0;q<f;q+=1){if(d.interactions[m[2]].objectives[q].id===h)return e=a,c.errorCode="351",c.diagnostic="The "+e+" element must be unique.  The value '"+
h+"' has already been set in #"+q,"false"}else return k(a,h);b(e.substr(4,e.length),h,d);d.interactions[m[2]].objectives._count=(r(d.interactions[m[2]].objectives)-1).toString();return"true"}"correct_responses"===m[3]&&(b(e.substr(4,e.length),h,d),d.interactions[m[2]].correct_responses._count=(r(d.interactions[m[2]].correct_responses)-1).toString());b(e.substr(4,e.length),h,d);d.interactions._count=(r(d.interactions)-2).toString();return"true";case "objectives":if("id"===m[3])for(f=parseInt(d.objectives._count,
10),q=0;q<f;q+=1)if(d.objectives[q].id===h)return c.errorCode="351",c.diagnostic="The objectives.id element must be unique.  The value '"+h+"' has already been set in objective #"+q,"false";if("id"!==m[3]&&(q=parseInt(m[2],10),void 0===d.objectives[q]))return c.errorCode="408",c.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(m[2],10)))return"false";b(e.substr(4,e.length),h,d);d.objectives._count=(r(d.objectives)-2).toString();return"true"}}b(e.substr(4,
e.length),h,d)}return"true"}c.errorCode=c.terminated?133:132;return"false"};this.Commit=function(){l(c.prefix+": Commit CMI Object:",4);l(d);l(c.prefix+": Suspend Data Usage "+(Math.round(100*(d.suspend_data.length/64E3)*Math.pow(10,2))/Math.pow(10,2)+"%"));a("StoreData",{runtimedata:d});return"true"};this.Terminate=function(){g.Commit();c.terminated=1;c.initialized=0;return"true"};this.GetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==m[a])?m[a]:""};this.GetLastError=function(){return c.errorCode};
this.GetDiagnostic=function(){return c.diagnostic};this.setCMILMSValue=function(a,b){"string"==typeof a&&(c.CMI[a]=b)};this.addListener=function(a,b){"string"==typeof a&&"function"==typeof b&&(c.listeners[a]=b)}};function Local_API_SCORM_12(e){function k(b,c){a.diganostic="The "+b+" of "+c+" must be a proper vocabulary element.";a.errorCode=406;return"false"}function f(b){a.errorCode=402;a.diagnostic="The value for key "+b+" has not been created yet.";return"false"}function n(b,c){a.errorCode=201;a.diagnostic="The value for key "+b+" is not valid.";return"false"}function b(a,c,d){a=a.split(/\./);2>a.length?d[a[0]]=c:(d[a[0]]||(d[a[0]]={}),d=d[a.shift()],b(a.join("."),c,d))}function v(a,b){var c=a.split(/\./),
d;if(2>c.length)try{return b[c[0]]}catch(p){return f(a),"false"}else{d=c.shift();if(b[d])return String(v(c.join("."),b[d]));f(a);return"false"}}function r(b,c){if(a.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(c){case 1:console.error(b);break;case 2:console.warn(b);break;case 4:console.info(b);break;case 3:console.log(b);break;default:return console.log(b),
!1}return!0}3>c&&a.throw_alerts&&alert(b);return!1}function l(b,c){if("function"==typeof a.listeners[b]&&"undefined"!=typeof c)a.listeners[b](c)}function t(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof a[c]?"object"==typeof b[c]&&(a[c]=t(a[c],b[c])):a[c]=b[c]);return a}function u(a,b){(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return d}if("function"===typeof window.CustomEvent)return!1;
a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:b}))}var a=t({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,user:void 0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},e),p={},c={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},d=this;"object"===typeof a.user&&("string"===typeof a.user.name&&(a.CMI.core.student_name=a.user.name),"string"===typeof a.user.id&&(a.CMI.core.student_id=a.user.id));this.isRunning=function(){return 1===a.initialized&&0===a.terminated};this.LMSInitialize=function(){r(a.prefix+":  Initializing...",3);p=a.CMI;a.initialized=1;a.terminated=
0;return"true"};this.LMSGetValue=function(b){a.errorCode=0;var c="false";b=b.toString();var d=[];if(this.isRunning()){d=b.split(".");if(0<="|exit|session_time|".indexOf("|"+d[d.length-1]+"|"))return a.errorCode=405,"false";d=b.toLowerCase().split(".");switch(d[0]){case "cmi":c=b;b="false";switch(c){case "cmi.core.exit":case "cmi.core.session_time":a.errorCode=405;a.diagnostic="Sorry, this has been specified as a read-only value for "+c;break;default:c=c.replace("cmi.",""),b=v(c,p),"undefined"===b&&
(a.errorCode=401,a.diagnostic="Sorry, there was a undefined response from "+c,b="false")}c=b}return c}a.errorCode=123;return c};this.LMSSetValue=function(c,d){r(a.prefix+": SetValue: "+c+" = "+d,4);a.errorCode=0;var s=[],e=c.toString(),f=d.toString();if(this.isRunning()){var s=e.split("."),t=s[s.length-1],s="adl"===s[0]&&"id"===s[4]?!0:"comments_from_lms"===s[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
t+"|");if(s)return a.errorCode=404,"false";s=e.split(".");switch(s[0]){case "cmi":switch(c){case "cmi.core.lesson_location":1E3<f.length&&r(a.prefix+": Some LMS's might truncate your bookmark as you've passed "+f.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+f+"|"))return k(c,f);l(c,f);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+f+"|"))return k(c,
f);break;case "cmi.core.score.min":s=parseFloat(f);if("number"!=typeof s||isNaN(s))return n(c,f);a.CMI.core.score.min=s;break;case "cmi.core.score.max":s=parseFloat(f);if("number"!=typeof s||isNaN(s))return n(c,f);a.CMI.core.score.max=s;break;case "cmi.core.score.raw":s=parseFloat(f);if("number"!=typeof s||isNaN(s))return n(c,f);var h=parseFloat(a.CMI.core.score.max),h="number"!=typeof h||isNaN(h)?100:h,t=parseFloat(a.CMI.core.score.min),t="number"!=typeof t||isNaN(t)?0:t,h=h-t;0>=h&&(h=100);s=Math.max(0,
Math.min(1,(s-t)/h));l("cmi.score.scaled",s)}e=e.replace("cmi.","");b(e,f,p)}return"true"}a.errorCode=a.terminated?133:132;return"false"};this.LMSCommit=function(){u("StoreData",{runtimedata:p});return"true"};this.LMSTerminate=function(){d.LMSCommit();a.terminated=1;a.initialized=0;return"true"};this.LMSFinish=function(){d.LMSCommit();a.terminated=1;a.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==c[a])?c[a]:""};this.LMSGetLastError=function(){return a.errorCode};
this.LMSGetDiagnostic=function(){return a.diagnostic};this.setCMILMSValue=function(b,c){"string"==typeof b&&(a.CMI[b]=c)};this.addListener=function(b,c){"string"==typeof b&&"function"==typeof c&&(a.listeners[b]=c)}};SGAME=function(){return{init:function(e){return SGAME.CORE.init(e)},loadSettings:function(e){return SGAME.CORE.loadSettings(e)},triggerLO:function(e,k){return SGAME.CORE.triggerLO(e,k)},showLO:function(e,k){return SGAME.CORE.showLO(e,k)},showRandomLO:function(e){return SGAME.CORE.showRandomLO(e)},closeLO:function(){return SGAME.CORE.closeLO()},getSettings:function(){return SGAME.CORE.getSettings()},losCanBeShown:function(e){return SGAME.CORE.losCanBeShown(e)},successWhenNoLOs:function(e){return SGAME.CORE.successWhenNoLOs(e)}}}();
SGAME.VERSION="1.0.1";SGAME.AUTHORS="Aldo Gordillo";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var e=!1;return{init:function(k){!0===k&&(e=k)},isDebugging:function(){return e},log:function(k){e&&window.console&&console.log(k)}}}();SGAME.Messenger=function(){function e(a,p){this.data=a||{};-1!==["PROTOCOL","APP"].indexOf(p)?this.type=p:this.type="APP";this.origin=n;this.destination=b}var k=["PROTOCOL","APP"],f=["SGAME_GATEWAY","SGAME_API"],n="SGAME_API",b="SGAME_GATEWAY",v=!1,r=!1,l=function(a){try{window.parent.parent.postMessage(a,"*")}catch(b){}},t=function(a){var b;b="object"!==typeof a||"string"!==typeof a.data?!1:u(a.data);if(b)switch(a=JSON.parse(a.data),a.type){case "PROTOCOL":if(a.data)switch(a.data.key){case "onIframeMessengerHello":"SGAME_GATEWAY"===
a.origin&&!0!==r&&(r=!0,a.data.settings=SGAME.CORE.getSettings(),a.destination=a.origin,a.origin=n,l(JSON.stringify(a)),SGAME.CORE.onConnectedToVLE())}break;case "APP":if(a.data&&"string"===typeof a.data.key)switch(a.data.key){case "lms_data":if("object"===typeof a.data.value){b=a.data.value;a={};if("string"===typeof b.name||"number"===typeof b.name)a.name=""+b.name;if("string"===typeof b.id||"number"===typeof b.id)a.id=""+b.id;b=SGAME.CORE.getVLEData();b.user=a;SGAME.CORE.setVLEData(b)}}}},u=function(a){try{if(a=
JSON.parse(a),-1===k.indexOf(a.type)||-1===f.indexOf(a.origin))return!1}catch(b){return!1}return!0};return{init:function(a){if(!v){v=!0;try{window.parent.addEventListener?window.parent.addEventListener("message",t,!1):window.attachEvent&&window.parent.attachEvent("message",t)}catch(b){}}},isConnected:function(){return r},sendMessage:function(a){v&&r&&(a=JSON.stringify(new e(a,void 0)),u(a)&&l(a))}}}();var API,API_1484_11;
SGAME.Fancybox=function(e){var k=e,f=e,n=e,b,v=function(){"undefined"!=typeof k&&(k.style.display="none",k.parentNode.removeChild(k),"lo"===f&&(API_1484_11=API=e),f=k=e)},r=function(){if("undefined"!=typeof k){var b=f;v();var r;r="lo"===b?SGAME.Observer.stop():!0;var u=n;n=e;setTimeout(function(){"function"===typeof u&&u(r)},50)}};return{init:function(e){"string"===typeof e&&(b=e)},create:function(l,t){v();n=t;var u="undefined"!==typeof l&&!0===l.dialog?"dialog":"lo",a=4/3,p,c,d=0.9*window.innerWidth,
m=0.9*window.innerHeight;m*a>d?(p=d,c=p/a):(c=m,p=c*a);if("lo"===u)var g={},s;else var x="";l&&(l.width&&(p=l.width),l.height&&(c=l.height),"lo"===u?l.lo&&(g=l.lo,"string"===typeof g.url&&(s=g.url)):"string"==typeof l.msg&&(x=l.msg));if("lo"===u){if("string"!=typeof s||"undefined"==typeof g.scorm_type)return;var y=e,a=API_1484_11=API=e,z=SGAME.CORE.getVLEData();"object"===typeof z.user&&(a=z.user);"sco"===g.scorm_type&&("1.2"===g.scorm_version?y=API=new Local_API_SCORM_12({user:a,debug:SGAME.Debugger.isDebugging()}):
"2004"===g.scorm_version&&(y=API_1484_11=new Local_API_1484_11({user:a,debug:SGAME.Debugger.isDebugging()})))}a=document.createElement("div");a.style.width=p+"px";a.style.height=c+"px";a.style.maxWidth=d+"px";a.style.maxHeight=m+"px";a.style.overflow="lo"===u?"hidden":"auto";a.style.background="white";a.style.position="absolute";a.style.top=0;a.style.zIndex=9999;a.style.borderRadius="1em";a.style.border="2px solid black";a.setAttribute("id","sgame_fancybox");a.style.marginLeft=(window.innerWidth-
p)/2+"px";a.style.marginTop=(window.innerHeight-c)/2+"px";m=document.createElement("img");m.src=b+"close.png";d=Math.max(25,Math.floor(0.05*c));m.style.width=d+"px";m.style.height=d+"px";m.style.padding="5px";m.style.cursor="pointer";m.style.position="absolute";m.style.right=0;m.onclick=function(){r()};a.appendChild(m);if("lo"===u){var h=document.createElement("img");h.id="trafficLight";h.src=b+"trafficLight/trafficLight_red.png";x=Math.max(40,Math.floor(0.085*c));m=Math.max(30,Math.floor(0.75*x));
h.style.height=x+"px";h.style.width=m+"px";h.style.padding="4px";h.style.position="absolute";h.style.left="0px";h.style.top="0px";h.style.background="#fff";h.style.borderRadius="0px 0px 20px 0px";h.style.borderRight="2px solid black";h.style.borderBottom="2px solid black";a.appendChild(h);h=document.createElement("iframe");h.src=s;s=Math.ceil(Math.max(d,x))+4;x=Math.floor(0.02*c);d=Math.floor(0.02*p);h.style.marginLeft=d+"px";h.style.marginTop=s+"px";h.style.width=Math.max(0,p-d-d)+"px";h.style.height=
Math.max(0,c-s-x)+"px";h.style.overflow="auto";h.scrolling="yes";h.style.frameBorder="0";h.style.borderStyle="none";h.setAttribute("allowfullscreen","false");a.appendChild(h)}else p=document.createElement("p"),p.id="dialog",p.innerHTML=x,p.style.padding="15px",p.style.marginTop="30px",p.style.marginBottom="20px",p.style.marginRight="20px",p.style.marginLeft="20px",p.style.textAlign="center",p.style.fontSize="24px",p.style.position="relative",p.style.cursor="default",p.style.color="#000",p.style.fontFamily=
"initial",a.appendChild(p);k=a;f=u;document.body.appendChild(a);"lo"===u&&SGAME.Observer.start(h,g,y)},closeCurrentFancybox:r}}();SGAME.TrafficLight=function(e){var k,f,n,b,v,r,l=function(a){var b=document.getElementById("trafficLight");b&&(k=a,b.src=t(a))},t=function(a){switch(a){case "green":return r+"trafficLight/trafficLight_green.png";case "yellow":return r+"trafficLight/trafficLight_yellow.png";case "red":return r+"trafficLight/trafficLight_red.png";default:return r+"trafficLight/trafficLight.png"}},u=function(a,p){var c=document.getElementById("trafficLight");if(c){var d=!1;b=setInterval(function(){c&&(d?(c.src=t(null),
d=!1):(c.src=t(a),d=!0))},500);v=setTimeout(function(){clearTimeout(b)},1E3*p)}};return{init:function(a){"string"===typeof a&&(r=a)},getCurrentColor:function(){return k},changeColor:function(a,b){b?f=setTimeout(function(){l(a)},1E3*b):l(a)},setUpBlink:function(a,b,c){c?n=setTimeout(function(){u(a,b)},1E3*c):u(a,b)},stop:function(){f&&clearTimeout(f);n&&clearTimeout(n);b&&clearTimeout(b);v&&clearTimeout(v)}}}();SGAME.Sequencing=function(){var e,k="completion completion_higher_inmediate success fail score_higher score_higher_inmediate score_lower".split(" "),f=function(a){if("object"!==typeof a)return a;a.met=!1;if("multiple"===a.type&&Array.isArray(a.conditions))for(var b=0;b<a.conditions.length;b++)a.conditions[b]=f(a.conditions[b]);return a},n=function(a){for(var p=Object.keys(a),c=p.length,d=0;d<c;d++){if("undefined"===typeof a[p[d]].condition&&"undefined"!==typeof a[p[d]].conditions){for(var m=a,g=p[d],
e=a[p[d]],f={id:1,type:"multiple",operator:"AND",conditions:e.conditions},k=0;k<f.conditions.length;k++)f.conditions[k].id=k+2,f.conditions[k].type="single";e.condition=f;delete e.conditions;m[g]=e}"undefined"!==typeof a[p[d]].condition&&(a[p[d]].condition=b(a[p[d]].condition,p),!1===a[p[d]].condition&&delete a[p[d]])}return Object.keys(a).length===c?a:n(a)},b=function(a,e){if("object"!==typeof a||"undefined"===typeof a.id)return!1;a.id+="";switch(a.type){case "single":return v(a,e);case "multiple":var c;
a:if(-1===["AND","OR"].indexOf(a.operator)||!1===Array.isArray(a.conditions)||1>a.conditions.length)c=!1;else{for(c=0;c<a.conditions.length;c++)if(a.conditions[c]=b(a.conditions[c],e),!1===a.conditions[c]){c=!1;break a}c=a}return c;default:return!1}},v=function(a,b){if("undefined"===typeof a.group)return!1;a.group+="";if(-1===b.indexOf(a.group)||-1===k.indexOf(a.requirement))return!1;if(-1!==["completion_higher_inmediate","score_higher","score_higher_inmediate","score_lower"].indexOf(a.requirement)){if("string"===
typeof a.threshold){if(!0===isNaN(a.threshold))return!1;a.threshold=parseInt(a.threshold)/100}if("number"!==typeof a.threshold||0>a.threshold||1<a.threshold||"score_lower"===a.requirement&&0===a.threshold)return!1}return a},r=function(a,b){if("undefined"===typeof a||!0===a.met)return a;switch(a.type){case "single":var c=a,d=b[c.group],e=!0===d.shown,g=!1;switch(c.requirement){case "completion":g=e;break;case "completion_higher_inmediate":g=d.nshown/d.los.length>=c.threshold;break;case "success":g=
e&&1===d.score;break;case "fail":g=e&&1>d.score;break;case "score_higher":g=e&&d.score>=c.threshold;break;case "score_higher_inmediate":g=d.score>=c.threshold;break;case "score_lower":g=e&&d.score<c.threshold}c.met=g;a=c;break;case "multiple":a:{c=a;for(d=0;d<c.conditions.length;d++)if(c.conditions[d]=r(c.conditions[d],b),"OR"===c.operator&&!0===c.conditions[d].met){c.met=!0;a=c;break a}else if("AND"===c.operator&&!1===c.conditions[d].met){c.met=!1;a=c;break a}"OR"===c.operator?c.met=!1:"AND"===c.operator&&
(c.met=!0);a=c}}return a},l=function(a,b){for(var c=Object.keys(b),d=!1,m=0;m<c.length;m++){var g=b[c[m]];if(g.id!=a.id&&"undefined"!==typeof g.condition)for(var k=t(g.condition,a),f=0;f<k.length;f++){if(!0===k[f].met)return!0;!1===g.unlocked&&(d=!0)}}if(!0===d)return!1;switch(e){case "linear_success":return 1===a.score;default:return!0===a.shown}},t=function(a,b){switch(a.type){case "single":if(a.group===b.id)return[a];break;case "multiple":for(var c=[],d=0;d<a.conditions.length;d++)c=c.concat(t(a.conditions[d],
b));return c}return[]},u=function(a,b,c){for(var d=0;d<a.los.length;d++)b[a.los[d]].can_be_shown=c;return b};return{init:function(a){e=a.approach},initGroupSequence:function(a){a.can_be_shown="undefined"===typeof a.condition||0===Object.keys(a.condition).length;a.locked=!1;a.unlocked=a.can_be_shown;a.shown=!1;a.nshown=0;a.score=!1;a.performance=0;a.condition=f(a.condition);return a},validateSequence:function(a,b){if("object"!==typeof a||"object"!==typeof b)return!1;for(var c=Object.keys(a),d=Object.keys(b),
e=0;e<c.length;e++){var g;g=a[c[e]];var f=d;if("undefined"===typeof g.id)g=!1;else{g.id+="";for(var k=[],l=0;l<g.los.length;l++){var r=g.los[l];-1!==f.indexOf(r)&&k.push(r)}g.los=k;g=1>g.los.length?!1:g}!1!==g?a[c[e]]=g:delete a[c[e]]}a=n(a);c=Object.keys(a);d=[];for(e=0;e<c.length;e++)for(g=a[c[e]],f=0;f<g.los.length;f++)-1===d.indexOf(g.los[f])&&d.push(g.los[f]);return 2>typeof c.length||2>d.length?!1:a},updateGroupsTracking:function(a,b,c){for(var d=0;d<a.groups.length;d++){var e=b[a.groups[d]];
if(!0===e.can_be_shown){for(var g=b,f=a.groups[d],k=e.los.length,n=0,t=0,h=0;h<k;h++){var q=c[e.los[h]];!0===q.shown&&(n+=1);!0===q.successfully_consumed&&(t+=1)}e.shown=n===k;e.nshown=n;e.score=0<k?t/k:0;e.performance=0<n?t/n:0;g[f]=e}}d=Object.keys(b);for(f=0;f<d.length;f++)g=b[d[f]],!1===g.unlocked&&!1===g.locked&&(e=b,k=d[f],!0!==g.locked&&!0!==g.unlocked&&("undefined"!==typeof g.condition?(g.condition=r(g.condition,b),!0===g.condition.met&&(g.unlocked=!0,g.can_be_shown=!0)):(g.unlocked=!0,g.can_be_shown=
!0)),e[k]=g,!0===b[d[f]].unlocked&&(c=u(b[d[f]],c,!0)));for(f=0;f<a.groups.length;f++)g=b[a.groups[f]],!0===g.unlocked&&!1===g.locked&&(e=b,k=a.groups[f],!0!==g.locked&&!1!==g.unlocked&&(n=l(g,b),g.locked=n,g.can_be_shown=!1===g.locked),e[k]=g,!0===b[a.groups[f]].locked&&(c=u(b[a.groups[f]],c,!1)));a=!0;for(f=0;f<d.length;f++)if(g=b[d[f]],!0===g.unlocked&&!1===g.locked){a=!1;break}if(a)for(d=Object.keys(c),g=0;g<d.length;g++)if("undefined"===typeof c[d[g]].groups||0===c[d[g]].groups.length)c[d[g]].can_be_shown=
!0;return{groups:b,los:c,finished:a}}}}();SGAME.API=function(){var e=function(e,f){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var b=JSON.parse(n.responseText);f(b)}};n.open("GET",e,!0);n.send("")};return{init:function(){},requestLOMetadata:function(k,f,n){try{e("undefined"==typeof k?"/lo/random/metadata.json":"/lo/"+k+"/metadata.json",function(b){f(b)})}catch(b){n(b)}}}}();SGAME.CORE=function(){var e={},k=void 0,f=!1,n="Congratulations. You have achieved the objectives of this educational game. You may close this window or continue playing.",b={},v=!1,r={},l={progress_measure:0,completion_status:"incompleted",score:0,success_status:"unknown"},t=["repeat","repeat_unless_successfully_consumed","no_repeat"],u=["no_restrictions","n_times","1_per_timeperiod"],a=["random","linear_completion","linear_success","custom"],p="all_los percentage_los n_los n_times disabled onstart".split(" "),
c="all_los percentage_los n_los n_times disabled onstart oncompletion".split(" "),d="no_more_los all_los_consumed all_los_successfully_consumed completion_status success_status never".split(" "),m=["success","failure","success_unless_damage","failure_unless_blocking"],g=!1,s=0,x=0,y=0,z=0,h=0,q=!1,B=void 0,F=function(w){b=w;"undefined"===typeof b.game_metadata&&(b.game_metadata={});"undefined"===typeof b.los&&(b.los={});"undefined"===typeof b.events&&(b.events={});"undefined"===typeof b.event_mapping&&
(b.event_mapping={});"undefined"===typeof b.sequencing&&(b.sequencing={});-1===t.indexOf(b.sequencing.repeat_lo)&&(b.sequencing.repeat_lo="repeat");-1===u.indexOf(b.sequencing.interruptions)&&(b.sequencing.interruptions="no_restrictions");-1===a.indexOf(b.sequencing.approach)&&(b.sequencing.approach="random");-1!==["n_times","1_per_timeperiod"].indexOf(b.sequencing.interruptions)&&"number"===typeof b.sequencing.interruptions_n||delete b.sequencing.interruptions_n;-1!==["n_times","1_per_timeperiod"].indexOf(b.sequencing.interruptions)&&
"number"!==typeof b.sequencing.interruptions_n&&(b.sequencing.interruptions="no_restrictions");"undefined"===typeof b.game_settings&&(b.game_settings={});-1===p.indexOf(b.game_settings.completion_status)&&(b.game_settings.completion_status="disabled");-1!==["percentage_los","n_los","n_times"].indexOf(b.game_settings.completion_status)&&"number"===typeof b.game_settings.completion_status_n||delete b.game_settings.completion_status_n;-1!==["percentage_los","n_los","n_times"].indexOf(b.game_settings.completion_status)&&
"number"!==typeof b.game_settings.completion_status_n&&(b.game_settings.completion_status="disabled",delete b.game_settings.completion_status_n);-1===c.indexOf(b.game_settings.success_status)&&(b.game_settings.success_status="disabled");-1!==["percentage_los","n_los","n_times"].indexOf(b.game_settings.success_status)&&"number"===typeof b.game_settings.success_status_n||delete b.game_settings.success_status_n;-1!==["percentage_los","n_los","n_times"].indexOf(b.game_settings.success_status)&&"number"!==
typeof b.game_settings.success_status_n&&(b.game_settings.success_status="disabled",delete b.game_settings.success_status_n);-1===d.indexOf(b.game_settings.completion_notification)&&(b.game_settings.completion_notification="never");-1===m.indexOf(b.game_settings.behaviour_when_no_more_los)&&(b.game_settings.behaviour_when_no_more_los="success_unless_damage");"string"===typeof b.game_settings.completion_notification_text&&(n=b.game_settings.completion_notification_text);if("object"===typeof b.los){w=
Object.keys(b.los);s=w.length;for(var e=0;e<s;e++)"undefined"!==typeof b.los[w[e]].url&&(b.los[w[e]].url=SGAME.Utils.checkUrlProtocol(b.los[w[e]].url)),b.los[w[e]].can_be_shown=!0,b.los[w[e]].shown=!1,b.los[w[e]].nshown=0,b.los[w[e]].successfully_consumed=!1,b.los[w[e]].nsuccess=0,b.los[w[e]].unsuccessfully_consumed=!1,b.los[w[e]].acts_as_asset="asset"===b.los[w[e]].scorm_type||"sco"===b.los[w[e]].scorm_type&&!1===b.los[w[e]].report_data,g=!0}"random"!==b.sequencing.approach&&(w=SGAME.Sequencing.validateSequence(b.sequencing.sequence,
b.los),!1===w?b.sequencing.approach="random":b.sequencing.sequence=w);"random"===b.sequencing.approach&&delete b.sequencing.sequence;if("object"===typeof b.sequencing.sequence){w=Object.keys(b.los);s=w.length;for(e=0;e<s;e++)b.los[w[e]].can_be_shown=!1,b.los[w[e]].groups=[];g=!1;e=Object.keys(b.sequencing.sequence);_nGroups=e.length;for(var f=0;f<_nGroups;f++){b.sequencing.sequence[e[f]]=SGAME.Sequencing.initGroupSequence(b.sequencing.sequence[e[f]]);for(var k=b.sequencing.sequence[e[f]],h=0;h<k.los.length;h++)b.los[k.los[h]].groups.push(k.id),
b.los[k.los[h]].can_be_shown=!0===k.can_be_shown,!0===b.los[k.los[h]].can_be_shown&&(g=!0)}for(e=0;e<s;e++)"undefined"!==typeof b.los[w[e]].groups&&0!==b.los[w[e]].groups.length||delete b.los[w[e]]}"string"!==typeof b.assets_path&&(b.assets_path="/assets/sgame/");SGAME.Fancybox.init(b.assets_path);SGAME.TrafficLight.init(b.assets_path);SGAME.Sequencing.init(b.sequencing)},E=function(a,c){var d=G(a);if(1>d.length)return C(a,c);var e=H(d);if(0<e.length){d=void 0;switch(b.sequencing.approach){case "linear_completion":case "linear_success":case "custom":if(!1===
f){for(var d=[],k=[],g=[],h=0;h<e.length;h++)g.push(e[h].id);e=Object.keys(b.sequencing.sequence);for(h=0;h<e.length;h++){var m=b.sequencing.sequence[e[h]];if(!0===m.can_be_shown)for(var l=0;l<m.los.length;l++)-1!==g.indexOf(m.los[l])&&-1===k.indexOf(m.los[l])&&(k.push(m.los[l]),d.push(b.los[m.los[l]]))}}else d=e;d=I(d);break;default:d=I(e)}selectedLO=d;D(selectedLO,c)}else"function"===typeof c&&(d=J(a),c(d.success,d))},C=function(a,b){if("function"===typeof b){var c=J(a);b(c.success,c)}},G=function(a){var c=
[];a=b.event_mapping[a];if("undefined"!==typeof a){var d=a.length;if("number"===typeof d)for(var e=0;e<d;e++){if("*"===a[e]){c=[];a=Object.keys(b.los);for(d=0;d<a.length;d++)"undefined"!==typeof b.los[a[d]]&&c.push(b.los[a[d]]);break}"undefined"!==typeof b.los[a[e]]&&c.push(b.los[a[e]])}}return c},H=function(a){for(var b=[],c=a.length,d=0;d<c;d++)!0===a[d].can_be_shown&&b.push(a[d]);return b},D=function(a,c){"object"!==typeof a||"string"!==typeof a.url?"function"===typeof c&&c(null,null):(B=new Date,
A(),b.los[a.id].shown=!0,b.los[a.id].nshown+=1,SGAME.Fancybox.create({lo:a},function(d){!0!==b.los[a.id].successfully_consumed&&(b.los[a.id].successfully_consumed=d.success);!0===d.success?b.los[a.id].nsuccess+=1:b.los[a.id].unsuccessfully_consumed=!0;if("random"!==b.sequencing.approach&&!1===f){var e=SGAME.Sequencing.updateGroupsTracking(b.los[a.id],b.sequencing.sequence,b.los);b.sequencing.sequence=e.groups;b.los=e.los;e.finished&&(f=!0)}switch(b.sequencing.repeat_lo){case "repeat_unless_successfully_consumed":b.los[a.id].can_be_shown=
!0!==b.los[a.id].successfully_consumed;break;case "no_repeat":b.los[a.id].can_be_shown=!1}O();d.more_los=g;K(function(){"function"===typeof c&&c(d.success,d);A()})}))},A=function(){"function"===typeof k&&k()},O=function(){var a=Object.keys(b.los),c=a.length;h=z=y=x=0;g=!1;for(var d=0;d<c;d++)!0===b.los[a[d]].shown&&(x+=1,y+=b.los[a[d]].nshown),!0===b.los[a[d]].successfully_consumed&&(z+=1,h+=b.los[a[d]].nsuccess),!0===b.los[a[d]].can_be_shown&&(g=!0);a=0;c="incompleted";switch(b.game_settings.completion_status){case "all_los":b.game_settings.completion_status_n=
100;case "percentage_los":d=Math.min(100,Math.max(0,b.game_settings.completion_status_n))/100;a=0>=d||0>=s?1:x/s/d;break;case "n_los":d=Math.min(b.game_settings.completion_status_n,s);a=0===d?1:x/d;break;case "n_times":a=0>=b.game_settings.completion_status_n?1:y/b.game_settings.completion_status_n;break;case "onstart":a=1}a=Math.max(Math.min(1,+a.toFixed(2)),0);c=1===a?"completed":"incompleted";d=0;switch(b.game_settings.success_status){case "all_los":b.game_settings.success_status_n=100;case "percentage_los":d=
Math.min(100,Math.max(0,b.game_settings.success_status_n))/100;d=0>=d||0>=s?1:z/s/d;break;case "n_los":d=Math.min(b.game_settings.success_status_n,s);d=0===d?1:x/d;break;case "n_times":d=0>=b.game_settings.success_status_n?1:h/b.game_settings.success_status_n;break;case "oncompletion":d=a;break;case "onstart":d=1}d=Math.max(Math.min(1,+d.toFixed(2)),0);l={progress_measure:a,completion_status:c,score:d,success_status:1===d?"passed":"failed"};SGAME.Messenger.sendMessage({key:"tracking",value:l})},K=
function(a){!0!==L()?"function"===typeof a&&a(!1):P(a)},L=function(){if(!0===q)return!1;switch(b.game_settings.completion_notification){case "no_more_los":return!1===g;case "all_los_consumed":return x>=s;case "all_los_successfully_consumed":return z>=s;case "completion_status":return"completed"===l.completion_status;case "success_status":return"passed"===l.success_status;case "never":return!1;default:return!1}},P=function(a){q=!0;SGAME.Fancybox.create({dialog:!0,msg:n},function(){"function"===typeof a&&
a(!0)})},I=function(a){for(var b=[],c,d=0;d<a.length;d++)"undefined"===typeof c&&(c=a[d].nshown),a[d].nshown<c&&(c=a[d].nshown,b=[]),c===a[d].nshown&&b.push(a[d]);return SGAME.Utils.getRandomElement(b)},J=function(a){return{lo_metadata:void 0,time:void 0,scorm_success_status:void 0,scorm_scaled_score:void 0,scorm_completion_status:void 0,scorm_progress_measure:void 0,success:M(a),more_los:g}},M=function(a){var c;v&&"undefined"!==typeof b.game_settings.behaviour_when_no_more_los?c=b.game_settings.behaviour_when_no_more_los:
"undefined"!==typeof e.behaviour_when_no_more_los?c=e.behaviour_when_no_more_los:"undefined"!==typeof b.game_settings.behaviour_when_no_more_los&&(c=b.game_settings.behaviour_when_no_more_los);return Q(c,a)},Q=function(a,b){switch(a){case "success":return!0;case "failure":return!1;case "success_unless_damage":var c=N(b);return"undefined"!==typeof c&&"damage"===c.type?!1:!0;case "failure_unless_blocking":return c=N(b),"undefined"===typeof c||"blocking"!==c.type?!1:!0;default:return!1}},N=function(a){return"undefined"!==
typeof b.events[a]?b.events[a]:"object"===typeof e.events&&"undefined"!==typeof e.events[a]?e.events[a]:{}};SGAME.Debugger.init(!1);!1===v&&F({});SGAME.Messenger.init();return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);(e=a)&&"function"===typeof a.togglePause&&(k=a.togglePause)},loadSettings:function(a){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(a);v=!0;F(a);SGAME.Debugger.log("SGAME settings loaded");SGAME.Debugger.log(b)},triggerLO:function(a,
c){switch(b.sequencing.interruptions){case "no_restrictions":return E(a,c);case "n_times":return y>=b.sequencing.interruptions_n?C(a,c):E(a,c);case "1_per_timeperiod":return"undefined"!==typeof B&&(new Date-B)/1E3<=b.sequencing.interruptions_n?C(a,c):E(a,c)}},showLO:D,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,function(b){D(b,a)},function(){"function"===typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()},getSettings:function(){return b},losCanBeShown:function(a){return!1===
g?!1:"undefined"===typeof a?g:0<H(G(a)).length},successWhenNoLOs:function(a){return M(a)},onConnectedToVLE:function(){"onstart"===b.game_settings.completion_status&&(l.progress_measure=1,l.completion_status="completed");"onstart"===b.game_settings.success_status&&(l.score=1,l.success_status="passed");if("onstart"===b.game_settings.completion_status||"onstart"===b.game_settings.success_status)SGAME.Messenger.sendMessage({key:"tracking",value:l}),setTimeout(function(){!0===L()&&(A(),K(function(){A()}))},
500)},getVLEData:function(){return r},setVLEData:function(a){return r=a}}}();SGAME.Observer=function(e){var k=!0,f=e,n=e,b=e,v,r,l,t,u,a,p=function(){b=n=f=e;v=Date.now();r=!1;a=u=t=l=e},c=function(){!1===n.acts_as_asset&&"undefined"!==typeof b&&(b.addListener("cmi.success_status",function(a){l=a;"passed"===l&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),b.addListener("cmi.score.scaled",function(a){t=a;0.8<=t&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
b.addListener("cmi.completion_status",function(a){u=a}),b.addListener("cmi.progress_measure",function(b){a=b}))};return{start:function(a,e,g){if(!1===k||"undefined"!=typeof f)return null;k=!1;p();f=a;n=e;b=g;c();SGAME.TrafficLight.changeColor("red");if(!0===n.acts_as_asset){b:{a=n.lom_metadata;if(a.educational&&a.educational.typicalLearningTime&&a.educational.typicalLearningTime.duration&&(a=iso8601Parser.getDuration(a.educational.typicalLearningTime.duration)))break b;a=null}a=!a||0>=a?15:Math.min(0.5*
a,120);SGAME.TrafficLight.setUpBlink("yellow",0.5*a-0.5,0.5*a);SGAME.TrafficLight.changeColor("green",a)}},stop:function(){if(!0===k||"undefined"==typeof f)return null;k=!0;SGAME.TrafficLight.stop();var b=Math.round((Date.now()-v)/1E3);r="green"===SGAME.TrafficLight.getCurrentColor();b={lo_metadata:n,time:b,success:r};"undefined"!=typeof l&&(b.scorm_success_status=l);"undefined"!=typeof t&&(b.scorm_scaled_score=t);"undefined"!=typeof u&&(b.scorm_completion_status=u);"undefined"!=typeof a&&(b.scorm_progress_measure=
a);p();return b},isStopped:function(){return k}}}();SGAME.Utils=function(){var e=void 0;return{init:function(e){},getRandomElement:function(e){if("number"==typeof e)return e;var f;f=e.length-1;if("number"!=typeof f)throw{name:"Invalid number format exception"};f=Math.round(0+Math.random()*(f-0));return e[f]},loadScript:function(e,f){if("string"===typeof e&&"function"===typeof f){var n=document.getElementsByTagName("head")[0];if(n){var b=document.createElement("script");b.setAttribute("src",e);b.setAttribute("type","text/javascript");b.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||f()};b.onload=f;n.appendChild(b)}}},getProtocol:function(){if("undefined"!==typeof e)return e;var k;try{k=document.location.protocol}catch(f){}"string"===typeof k&&(k=k.match(/[\w]+/),k=k instanceof Array&&"string"===typeof k[0]?k[0]:void 0);return e="string"===typeof k?k:"unknown"},checkUrlProtocol:function(e){if("string"===typeof e){var f=e.match(/^https?:\/\//);if(f instanceof Array&&1===f.length){var f=f[0].replace("://",""),n=
SGAME.Utils.getProtocol();if(f!==n)switch(n){case "https":e="https"+e.replace(f,"")}}}return e}}}();
