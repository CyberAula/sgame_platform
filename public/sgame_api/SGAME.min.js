iso8601Parser=function(f){return{getDuration:function(a){var t=[31104E3,2592E3,604800,86400,3600,60,1];try{var n;var l=a;a=[2,3,4,5,7,8,9];var f=[0,0,0,0,0,0,0],m;if(l=l.toUpperCase()){if("string"!==typeof l)throw Error("Invalid iso8601 period string '"+l+"'");if(m=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(l))for(l=0;l<a.length;l++){var q=a[l];f[l]=m[q]?+m[q].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+l+"' is not a valid ISO8601 period.");}n=f}catch(s){return null}for(q=
m=0;q<n.length;q++)m+=n[q]*t[q];return m}}}();function Local_API_1484_11(f){function a(d,a){g.diganostic="The "+d+" of "+a+" must be a proper vocabulary element.";g.errorCode=406;return"false"}function t(d){g.errorCode=402;g.diagnostic="The value for key "+d+" has not been created yet.";return"false"}function n(d,a){g.errorCode=201;g.diagnostic="The value for key "+d+" is not valid.";return"false"}function l(d,a,b){d=d.split(/\./);2>d.length?b[d[0]]=a:(b[d[0]]||(b[d[0]]={}),b=b[d.shift()],l(d.join("."),a,b))}function w(d,a){var b=d.split(/\./),
c;if(2>b.length)try{return a[b[0]]}catch(p){return t(d),"false"}else{c=b.shift();if(a[c])return String(w(b.join("."),a[c]));t(d);return"false"}}function m(d){var a,b=0;for(a in d)d.hasOwnProperty(a)&&(b+=1);return b}function q(d,a){if(g.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(a){case 1:console.error(d);break;case 2:console.warn(d);break;case 4:console.info(d);
break;case 3:console.log(d);break;default:return console.log(d),!1}return!0}3>a&&g.throw_alerts&&alert(d);return!1}function s(d,a){if("function"==typeof g.listeners[d]&&"undefined"!=typeof a)g.listeners[d](a)}function k(d,a){for(var b in a)a.hasOwnProperty(b)&&("object"==typeof d[b]?"object"==typeof a[b]&&(d[b]=k(d[b],a[b])):d[b]=a[b]);return d}function e(d,a){(function(){function b(b,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(b,a.bubbles,
a.cancelable,a.detail);return d}if("function"===typeof window.CustomEvent)return!1;b.prototype=window.Event.prototype;window.CustomEvent=b})();document.dispatchEvent(new CustomEvent(d,{detail:a}))}function u(a){return"object"!==type(a)||a.nodeType||isWindow(a)?!1:!(a.constructor&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))}var g=k({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},f),c={},r={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},v=this;this.isRunning=function(){return 1===g.initialized&&0===g.terminated};this.Initialize=function(){q(g.prefix+":  Initializing...",3);g.cmi?(c=g.cmi,"suspend"===c.exit&&(c.entry="resume")):c=g.CMI;g.initialized=1;g.terminated=0;return"true"};this.GetValue=
function(a){g.errorCode=0;var e="false";a=a.toString();var b=[];if(this.isRunning()){b=a.split(".");if(0<="|exit|session_time|".indexOf("|"+b[b.length-1]+"|"))return q(g.prefix+": This "+a+" is write only",4),g.errorCode=405,"false";b=a.toLowerCase().split(".");switch(b[0]){case "cmi":switch(e="false",a){case "cmi.exit":case "cmi.session_time":g.errorCode=405;g.diagnostic="Sorry, this has been specified as a read-only value for "+a;break;case "cmi.learner_name":e=g.CMI.learner_name;break;default:e=
w(a.substr(4,a.length),c),"undefined"===e&&(g.errorCode=401,g.diagnostic="Sorry, there was a undefined response from "+a,e="false"),q(g.prefix+": GetValue "+a+" = "+e,4)}}return e}g.errorCode=123;return e};this.SetValue=function(d,e){q(g.prefix+": SetValue: "+d+" = "+e,4);g.errorCode=0;var b=[],r=d.toString(),p=e.toString(),h=0,v=0,h=[];if(this.isRunning()){h=r.split(".");if("adl"===h[0]&&"id"===h[4]||"comments_from_lms"===h[1]||("comments_from_learner"===h[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
h[h.length-1]+"|")))return q(g.prefix+": This "+r+" is read only",4),g.errorCode=404,"false";b=r.split(".");switch(b[0]){case "cmi":switch(d){case "cmi.location":1E3<p.length&&q(g.prefix+": Some LMS's might truncate your bookmark as you've passed "+p.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":h=parseFloat(p);if("number"!=typeof h||isNaN(h))return n(d,p);h=Math.max(0,Math.min(1,h));s(d,h);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+
p+"|"))return a(d,p);s(d,p);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+p+"|"))return a(d,p);break;case "cmi.score.scaled":h=parseFloat(p);if("number"!=typeof h||isNaN(h))return n(d,p);h=Math.max(0,Math.min(1,h));s(d,h);break;case "cmi.score.min":h=parseFloat(p);if("number"!=typeof h||isNaN(h))return n(d,p);g.CMI.score.min=h;break;case "cmi.score.max":h=parseFloat(p);if("number"!=typeof h||isNaN(h))return n(d,p);g.CMI.score.max=h;break;case "cmi.score.raw":h=parseFloat(p);
if("number"!=typeof h||isNaN(h))return n(d,p);v=parseFloat(g.CMI.score.max);v="number"!=typeof v||isNaN(v)?100:v;b=parseFloat(g.CMI.score.min);b="number"!=typeof b||isNaN(b)?0:b;v-=b;0>=v&&(v=100);h=Math.max(0,Math.min(1,(h-b)/v));s("cmi.score.scaled",h);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+p+"|"))return a(d,p);s(d,p);break;default:switch(b[1]){case "comments_from_lms":return g.errorCode="404",g.diagnostic="The cmi.comments_from_lms element is entirely read only.",
"false";case "comments_from_learner":if(-1===c.comments_from_learner._children.indexOf(b[3]))return a(d,p);l(r.substr(4,r.length),p,c);c.comments_from_learner._count=(m(c.comments_from_learner)-2).toString();return"true";case "interactions":if(-1===c.interactions._children.indexOf(b[3]))return a(d,p);c.interactions._count=(m(c.interactions)-2).toString();if(isNaN(parseInt(b[2],10)))return"false";if(!u(c.interactions[b[2]])){if("id"===b[3])return c.interactions[b[2]]={},l(r.substr(4,r.length),p,c),
c.interactions._count=(m(c.interactions)-2).toString(),u(c.interactions[b[2]].objectives)||(q(g.prefix+": Constructing objectives object for new interaction",4),c.interactions[b[2]].objectives={},c.interactions[b[2]].objectives._count="-1"),u(c.interactions[b[2]].correct_responses)||(q(g.prefix+": Constructing correct responses object for new interaction",4),c.interactions[b[2]].correct_responses={},c.interactions[b[2]].correct_responses._count="-1"),"true";q("Can't add interaction without ID first!",
3);return"false"}if("objectives"===b[3]){if("id"===b[5])for(v=parseInt(c.interactions[b[2]].objectives._count,10),h=0;h<v;h+=1){if(c.interactions[b[2]].objectives[h].id===p)return r=d,g.errorCode="351",g.diagnostic="The "+r+" element must be unique.  The value '"+p+"' has already been set in #"+h,"false"}else return a(d,p);l(r.substr(4,r.length),p,c);c.interactions[b[2]].objectives._count=(m(c.interactions[b[2]].objectives)-1).toString();return"true"}"correct_responses"===b[3]&&(l(r.substr(4,r.length),
p,c),c.interactions[b[2]].correct_responses._count=(m(c.interactions[b[2]].correct_responses)-1).toString());l(r.substr(4,r.length),p,c);c.interactions._count=(m(c.interactions)-2).toString();return"true";case "objectives":if("id"===b[3])for(v=parseInt(c.objectives._count,10),h=0;h<v;h+=1)if(c.objectives[h].id===p)return g.errorCode="351",g.diagnostic="The objectives.id element must be unique.  The value '"+p+"' has already been set in objective #"+h,"false";if("id"!==b[3]&&(h=parseInt(b[2],10),void 0===
c.objectives[h]))return g.errorCode="408",g.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(b[2],10)))return"false";l(r.substr(4,r.length),p,c);c.objectives._count=(m(c.objectives)-2).toString();return"true"}}l(r.substr(4,r.length),p,c)}return"true"}g.errorCode=g.terminated?133:132;return"false"};this.Commit=function(){q(g.prefix+": Commit CMI Object:",4);q(c);q(g.prefix+": Suspend Data Usage "+(Math.round(100*(c.suspend_data.length/64E3)*
Math.pow(10,2))/Math.pow(10,2)+"%"));e("StoreData",{runtimedata:c});return"true"};this.Terminate=function(){v.Commit();g.terminated=1;g.initialized=0;return"true"};this.GetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==r[a])?r[a]:""};this.GetLastError=function(){return g.errorCode};this.GetDiagnostic=function(){return g.diagnostic};this.setCMILMSValue=function(a,r){"string"==typeof a&&(g.CMI[a]=r)};this.addListener=function(a,r){"string"==typeof a&&"function"==typeof r&&(g.listeners[a]=
r)}};function Local_API_SCORM_12(f){function a(a,c){e.diganostic="The "+a+" of "+c+" must be a proper vocabulary element.";e.errorCode=406;return"false"}function t(a){e.errorCode=402;e.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function n(a,c){e.errorCode=201;e.diagnostic="The value for key "+a+" is not valid.";return"false"}function l(a,c,d){a=a.split(/\./);2>a.length?d[a[0]]=c:(d[a[0]]||(d[a[0]]={}),d=d[a.shift()],l(a.join("."),c,d))}function w(a,c){var d=a.split(/\./),
e;if(2>d.length)try{return c[d[0]]}catch(b){return t(a),"false"}else{e=d.shift();if(c[e])return String(w(d.join("."),c[e]));t(a);return"false"}}function m(a,c){if(e.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(c){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);break;case 3:console.log(a);break;default:return console.log(a),
!1}return!0}3>c&&e.throw_alerts&&alert(a);return!1}function q(a,c){if("function"==typeof e.listeners[a]&&"undefined"!=typeof c)e.listeners[a](c)}function s(a,c){for(var d in c)c.hasOwnProperty(d)&&("object"==typeof a[d]?"object"==typeof c[d]&&(a[d]=s(a[d],c[d])):a[d]=c[d]);return a}function k(a,c){(function(){function a(d,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(d,b.bubbles,b.cancelable,b.detail);return c}if("function"===typeof window.CustomEvent)return!1;
a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:c}))}var e=s({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},f),u={},g={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},c=this;this.isRunning=function(){return 1===e.initialized&&0===e.terminated};this.LMSInitialize=function(){m(e.prefix+":  Initializing...",3);u=e.CMI;e.initialized=1;e.terminated=0;return"true"};this.LMSGetValue=function(a){e.errorCode=0;var c="false";a=a.toString();var d=[];if(this.isRunning()){d=a.split(".");if(0<="|exit|session_time|".indexOf("|"+
d[d.length-1]+"|"))return e.errorCode=405,"false";d=a.toLowerCase().split(".");switch(d[0]){case "cmi":c=a;a="false";switch(c){case "cmi.core.exit":case "cmi.core.session_time":e.errorCode=405;e.diagnostic="Sorry, this has been specified as a read-only value for "+c;break;default:c=c.replace("cmi.",""),a=w(c,u),"undefined"===a&&(e.errorCode=401,e.diagnostic="Sorry, there was a undefined response from "+c,a="false")}c=a}return c}e.errorCode=123;return c};this.LMSSetValue=function(c,g){m(e.prefix+": SetValue: "+
c+" = "+g,4);e.errorCode=0;var d=[],k=c.toString(),b=g.toString();if(this.isRunning()){var d=k.split("."),f=d[d.length-1],d="adl"===d[0]&&"id"===d[4]?!0:"comments_from_lms"===d[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+f+"|");if(d)return e.errorCode=404,"false";d=k.split(".");switch(d[0]){case "cmi":switch(c){case "cmi.core.lesson_location":1E3<
b.length&&m(e.prefix+": Some LMS's might truncate your bookmark as you've passed "+b.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+b+"|"))return a(c,b);q(c,b);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+b+"|"))return a(c,b);break;case "cmi.core.score.min":d=parseFloat(b);if("number"!=typeof d||isNaN(d))return n(c,b);e.CMI.core.score.min=
d;break;case "cmi.core.score.max":d=parseFloat(b);if("number"!=typeof d||isNaN(d))return n(c,b);e.CMI.core.score.max=d;break;case "cmi.core.score.raw":d=parseFloat(b);if("number"!=typeof d||isNaN(d))return n(c,b);var p=parseFloat(e.CMI.core.score.max),p="number"!=typeof p||isNaN(p)?100:p,f=parseFloat(e.CMI.core.score.min),f="number"!=typeof f||isNaN(f)?0:f,p=p-f;0>=p&&(p=100);d=Math.max(0,Math.min(1,(d-f)/p));q("cmi.score.scaled",d)}k=k.replace("cmi.","");l(k,b,u)}return"true"}e.errorCode=e.terminated?
133:132;return"false"};this.LMSCommit=function(){k("StoreData",{runtimedata:u});return"true"};this.LMSTerminate=function(){c.LMSCommit();e.terminated=1;e.initialized=0;return"true"};this.LMSFinish=function(){c.LMSCommit();e.terminated=1;e.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==g[a])?g[a]:""};this.LMSGetLastError=function(){return e.errorCode};this.LMSGetDiagnostic=function(){return e.diagnostic};this.setCMILMSValue=function(a,c){"string"==
typeof a&&(e.CMI[a]=c)};this.addListener=function(a,c){"string"==typeof a&&"function"==typeof c&&(e.listeners[a]=c)}};SGAME=function(){return{init:function(f){SGAME.CORE.init(f)},loadSettings:function(f){SGAME.CORE.loadSettings(f)},triggerLO:function(f,a){SGAME.CORE.triggerLO(f,a)},showLO:function(f,a){SGAME.CORE.showLO(f,a)},showRandomLO:function(f){SGAME.CORE.showRandomLO(f)},closeLO:function(){SGAME.CORE.closeLO()}}}();SGAME.VERSION="0.5";SGAME.AUTHORS="Aldo Gordillo, Enrique Barra";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var f=!1;return{init:function(a){!0===a&&(f=a)},isDebugging:function(){return f},log:function(a){f&&window.console&&console.log(a)}}}();SGAME.API=function(){var f=function(a,f){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var a=JSON.parse(n.responseText);f(a)}};n.open("GET",a,!0);n.send("")};return{init:function(){},requestLOMetadata:function(a,t,n){try{f("undefined"==typeof a?"/lo/random/metadata.json":"/lo/"+a+"/metadata.json",function(a){t(a)})}catch(l){n(l)}}}}();SGAME.CORE=function(){var f=void 0,a={},t=!1,n=["repeat","repeat_unless_successfully_consumed","no_repeat"],l=["no_more_los","all_los_consumed","all_los_succesfully_consumed","never"],w=["success","failure","failure_unless_blocking"],m=!1,q=!1,s="Congratulations. You have achieved the objectives of this educational game. You may close this window or continue playing.",k=function(b){a=b;"undefined"===typeof a.game_metadata&&(a.game_metadata={});"undefined"===typeof a.los&&(a.los={});"undefined"===
typeof a.events&&(a.events={});"undefined"===typeof a.event_mapping&&(a.event_mapping={});"undefined"===typeof a.sequencing&&(a.sequencing={});-1===n.indexOf(a.sequencing.repeat_lo)&&(a.sequencing.repeat_lo="repeat");"undefined"===typeof a.game_settings&&(a.game_settings={});-1===l.indexOf(a.game_settings.completion_notification)&&(a.game_settings.completion_notification="never");-1===w.indexOf(a.game_settings.behaviour_when_no_more_los)&&(a.game_settings.behaviour_when_no_more_los="failure_unless_blocking");
"string"===typeof a.game_settings.completion_notification_text&&(s=a.game_settings.completion_notification_text);if("object"===typeof a.los){b=Object.keys(a.los);for(var c=b.length,d=0;d<c;d++)"undefined"!==typeof a.los[b[d]].url&&(a.los[b[d]].url=SGAME.Utils.checkUrlProtocol(a.los[b[d]].url)),a.los[b[d]].can_be_shown=!0,a.los[b[d]].shown=!1,a.los[b[d]].nshown=0,a.los[b[d]].succesfully_consumed=!1,a.los[b[d]].acts_as_asset="asset"===a.los[b[d]].scorm_type||"sco"===a.los[b[d]].scorm_type&&!1===a.los[b[d]].report_data,
m=!0}},e=function(b,d){"object"!==typeof b||"string"!==typeof b.url?"function"===typeof d&&d(null,null):(u(),a.los[b.id].shown=!0,a.los[b.id].nshown+=1,SGAME.Fancybox.create({lo:b},function(e){a.los[b.id].succesfully_consumed=e.success;switch(a.sequencing.repeat_lo){case "repeat_unless_successfully_consumed":a.los[b.id].can_be_shown=!0!==a.los[b.id].succesfully_consumed;break;case "no_repeat":a.los[b.id].can_be_shown=!1}g();e.more_los=m;c(function(){"function"===typeof d&&d(e.success,e);u()})}))},
u=function(){"function"===typeof f&&f()},g=function(){for(var b=Object.keys(a.los),c=b.length,d=0;d<c;d++)if(!0===a.los[b[d]].can_be_shown){m=!0;return}m=!1},c=function(a){!0!==r()?"function"===typeof a&&a(!1):v(a)},r=function(){if(!0===q)return!1;switch(a.game_settings.completion_notification){case "no_more_los":return!1===m;case "all_los_consumed":for(var b=Object.keys(a.los),c=b.length,d=0;d<c;d++)if(!1===a.los[b[d]].shown)return!1;return!0;case "all_los_succesfully_consumed":b=Object.keys(a.los);
c=b.length;for(d=0;d<c;d++)if(!1===a.los[b[d]].succesfully_consumed)return!1;return!0;case "never":return!1;default:return!1}},v=function(a){q=!0;SGAME.Fancybox.create({dialog:!0,msg:s},function(){"function"===typeof a&&a(!0)})},d=function(a){return{lo_metadata:void 0,time:void 0,scorm_success_status:void 0,scorm_scaled_score:void 0,scorm_completion_status:void 0,scorm_progress_measure:void 0,success:x(a),more_los:m}},x=function(b){switch(a.game_settings.behaviour_when_no_more_los){case "success":return!0;
case "failure":return!1;case "failure_unless_blocking":return b=a.events[b],"undefined"===typeof b||"blocking"!==b.type?!1:!0;default:return!1}};SGAME.Debugger.init(!0);!1===t&&k({});return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);a&&"function"===typeof a.togglePause&&(f=a.togglePause)},loadSettings:function(a){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(a);t=!0;k(a)},triggerLO:function(b,c){var g=[],h=[],f=a.event_mapping[b];if("undefined"!==
typeof f){var k=f.length;if("number"===typeof k)for(var l=0;l<k;l++){if("*"===f[l]){g=[];f=Object.keys(a.los);for(k=0;k<f.length;k++)"undefined"!==typeof a.los[f[k]]&&g.push(a.los[f[k]]);break}"undefined"!==typeof a.los[f[l]]&&g.push(a.los[f[l]])}}f=g.length;if(1>f.length)"function"===typeof c&&(h=d(b),c(h.success,h));else{for(k=0;k<f;k++)!0===g[k].can_be_shown&&h.push(g[k]);if(h&&h instanceof Array&&0<h.length){for(var g=[],m,f=0;f<h.length;f++)"undefined"===typeof m&&(m=h[f].nshown),h[f].nshown<
m&&(m=h[f].nshown,g=[]),m===h[f].nshown&&g.push(h[f]);selectedLO=SGAME.Utils.getRandomElement(g);e(selectedLO,c)}else"function"===typeof c&&(h=d(b),c(h.success,h))}},showLO:e,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,function(c){e(c,a)},function(){"function"===typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()}}}();var API,API_1484_11;
SGAME.Fancybox=function(f){var a=f,t=f,n=f,l=function(){"undefined"!=typeof a&&(a.style.display="none",a.parentNode.removeChild(a),"lo"===t&&(API_1484_11=API=f),t=a=f)},w=function(){if("undefined"!=typeof a){var m=t;l();var q;q="lo"===m?SGAME.Observer.stop():!0;var s=n;n=f;setTimeout(function(){"function"===typeof s&&s(q)},50)}};return{init:function(){},create:function(m,q){l();n=q;var s="undefined"!==typeof m&&!0===m.dialog?"dialog":"lo",k=4/3,e,u,g=0.9*window.innerWidth,c=0.9*window.innerHeight;
c*k>g?(e=g,u=e/k):(u=c,e=u*k);if("lo"===s)var r={},v;else var d="";m&&(m.width&&(e=m.width),m.height&&(u=m.height),"lo"===s?m.lo&&(r=m.lo,"string"===typeof r.url&&(v=r.url)):"string"==typeof m.msg&&(d=m.msg));if("lo"===s){if("string"!=typeof v||"undefined"==typeof r.scorm_type)return;var x=f;API_1484_11=API=f;"sco"===r.scorm_type&&("1.2"===r.scorm_version?x=API=new Local_API_SCORM_12({debug:SGAME.Debugger.isDebugging()}):"2004"===r.scorm_version&&(x=API_1484_11=new Local_API_1484_11({debug:SGAME.Debugger.isDebugging()})))}k=
document.createElement("div");k.style.width=e+"px";k.style.height=u+"px";k.style.maxWidth=g+"px";k.style.maxHeight=c+"px";k.style.overflow="lo"===s?"hidden":"auto";k.style.background="white";k.style.position="absolute";k.style.top=0;k.style.zIndex=9999;k.style.borderRadius="1em";k.style.border="2px solid black";k.setAttribute("id","sgame_fancybox");k.style.marginLeft=(window.innerWidth-e)/2+"px";k.style.marginTop=(window.innerHeight-u)/2+"px";c=document.createElement("img");c.src="/assets/sgame/close.png";
g=Math.max(25,Math.floor(0.05*u));c.style.width=g+"px";c.style.height=g+"px";c.style.padding="5px";c.style.cursor="pointer";c.style.position="absolute";c.style.right=0;c.onclick=function(){w()};k.appendChild(c);if("lo"===s){var b=document.createElement("img");b.id="trafficLight";b.src="/assets/sgame/trafficLight/trafficLight_red.png";d=Math.max(40,Math.floor(0.085*u));c=Math.max(30,Math.floor(0.75*d));b.style.height=d+"px";b.style.width=c+"px";b.style.padding="4px";b.style.position="absolute";b.style.left=
"0px";b.style.top="0px";b.style.background="#fff";b.style.borderRadius="0px 0px 20px 0px";b.style.borderRight="2px solid black";b.style.borderBottom="2px solid black";k.appendChild(b);b=document.createElement("iframe");b.src=v;v=Math.ceil(Math.max(g,d))+4;d=Math.floor(0.02*u);g=Math.floor(0.02*e);b.style.marginLeft=g+"px";b.style.marginTop=v+"px";b.style.width=Math.max(0,e-g-g)+"px";b.style.height=Math.max(0,u-v-d)+"px";b.style.overflow="auto";b.scrolling="yes";b.style.frameBorder="0";b.style.borderStyle=
"none";b.setAttribute("allowfullscreen","false");k.appendChild(b)}else e=document.createElement("p"),e.id="dialog",e.innerHTML=d,e.style.padding="15px",e.style.marginTop="30px",e.style.marginBottom="20px",e.style.marginRight="20px",e.style.marginLeft="20px",e.style.textAlign="center",e.style.fontSize="24px",e.style.position="relative",e.style.cursor="default",e.style.color="#000",e.style.fontFamily="initial",k.appendChild(e);a=k;t=s;document.body.appendChild(k);"lo"===s&&SGAME.Observer.start(b,r,
x)},closeCurrentFancybox:w}}();SGAME.Observer=function(f){var a=!0,t=f,n=f,l=f,w,m,q,s,k,e,u=function(){l=n=t=f;w=Date.now();m=!1;e=k=s=q=f},g=function(){!1===n.acts_as_asset&&"undefined"!==typeof l&&(l.addListener("cmi.success_status",function(a){q=a;"passed"===q&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),l.addListener("cmi.score.scaled",function(a){s=a;0.8<=s&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
l.addListener("cmi.completion_status",function(a){k=a}),l.addListener("cmi.progress_measure",function(a){e=a}))};return{start:function(c,e,f){if(!1===a||"undefined"!=typeof t)return null;a=!1;u();t=c;n=e;l=f;g();SGAME.TrafficLight.changeColor("red");if(!0===n.acts_as_asset){b:{c=n.lom_metadata;if(c.educational&&c.educational.typicalLearningTime&&c.educational.typicalLearningTime.duration&&(c=iso8601Parser.getDuration(c.educational.typicalLearningTime.duration)))break b;c=null}c=!c||0>=c?15:Math.min(0.5*
c,120);SGAME.TrafficLight.setUpBlink("yellow",0.5*c-0.5,0.5*c);SGAME.TrafficLight.changeColor("green",c)}},stop:function(){if(!0===a||"undefined"==typeof t)return null;a=!0;SGAME.TrafficLight.stop();var c=Math.round((Date.now()-w)/1E3);m="green"===SGAME.TrafficLight.getCurrentColor();c={lo_metadata:n,time:c,success:m};"undefined"!=typeof q&&(c.scorm_success_status=q);"undefined"!=typeof s&&(c.scorm_scaled_score=s);"undefined"!=typeof k&&(c.scorm_completion_status=k);"undefined"!=typeof e&&(c.scorm_progress_measure=
e);u();return c},isStopped:function(){return a}}}();SGAME.TrafficLight=function(f){var a,t,n,l,w,m=function(f){var e=document.getElementById("trafficLight");e&&(a=f,e.src=q(f))},q=function(a){switch(a){case "green":return"/assets/sgame/trafficLight/trafficLight_green.png";case "yellow":return"/assets/sgame/trafficLight/trafficLight_yellow.png";case "red":return"/assets/sgame/trafficLight/trafficLight_red.png";default:return"/assets/sgame/trafficLight/trafficLight.png"}},s=function(a,e){var f=document.getElementById("trafficLight");if(f){var g=!1;l=
setInterval(function(){f&&(g?(f.src=q(null),g=!1):(f.src=q(a),g=!0))},500);w=setTimeout(function(){clearTimeout(l)},1E3*e)}};return{getCurrentColor:function(){return a},changeColor:function(a,e){e?t=setTimeout(function(){m(a)},1E3*e):m(a)},setUpBlink:function(a,e,f){f?n=setTimeout(function(){s(a,e)},1E3*f):s(a,e)},stop:function(){t&&clearTimeout(t);n&&clearTimeout(n);l&&clearTimeout(l);w&&clearTimeout(w)}}}();SGAME.Utils=function(){var f=void 0;return{init:function(a){},getRandomElement:function(a){if("number"==typeof a)return a;var f;f=a.length-1;if("number"!=typeof f)throw{name:"Invalid number format exception"};f=Math.round(0+Math.random()*(f-0));return a[f]},loadScript:function(a,f){if("string"===typeof a&&"function"===typeof f){var n=document.getElementsByTagName("head")[0];if(n){var l=document.createElement("script");l.setAttribute("src",a);l.setAttribute("type","text/javascript");l.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||f()};l.onload=f;n.appendChild(l)}}},getProtocol:function(){if("undefined"!==typeof f)return f;var a;try{a=document.location.protocol}catch(t){}"string"===typeof a&&(a=a.match(/[\w]+/),a=a instanceof Array&&"string"===typeof a[0]?a[0]:void 0);return f="string"===typeof a?a:"unknown"},checkUrlProtocol:function(a){if("string"===typeof a){var f=a.match(/^https?:\/\//);if(f instanceof Array&&1===f.length){var f=f[0].replace("://",""),n=
SGAME.Utils.getProtocol();if(f!==n)switch(n){case "https":a="https"+a.replace(f,"")}}}return a}}}();
