iso8601Parser=function(g){return{getDuration:function(a){var m=[31104E3,2592E3,604800,86400,3600,60,1];try{var q;var k=a;a=[2,3,4,5,7,8,9];var g=[0,0,0,0,0,0,0],n;if(k=k.toUpperCase()){if("string"!==typeof k)throw Error("Invalid iso8601 period string '"+k+"'");if(n=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(k))for(k=0;k<a.length;k++){var p=a[k];g[k]=n[p]?+n[p].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+k+"' is not a valid ISO8601 period.");}q=g}catch(r){return null}for(p=
n=0;p<q.length;p++)n+=q[p]*m[p];return n}}}();function Local_API_1484_11(g){function a(b,a){e.diganostic="The "+b+" of "+a+" must be a proper vocabulary element.";e.errorCode=406;return"false"}function m(b){e.errorCode=402;e.diagnostic="The value for key "+b+" has not been created yet.";return"false"}function q(b,a){e.errorCode=201;e.diagnostic="The value for key "+b+" is not valid.";return"false"}function k(b,a,d){b=b.split(/\./);2>b.length?d[b[0]]=a:(d[b[0]]||(d[b[0]]={}),d=d[b.shift()],k(b.join("."),a,d))}function t(b,a){var d=b.split(/\./),
c;if(2>d.length)try{return a[d[0]]}catch(e){return m(b),"false"}else{c=d.shift();if(a[c])return String(t(d.join("."),a[c]));m(b);return"false"}}function n(b){var a,d=0;for(a in b)b.hasOwnProperty(a)&&(d+=1);return d}function p(b,a){if(e.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(a){case 1:console.error(b);break;case 2:console.warn(b);break;case 4:console.info(b);
break;case 3:console.log(b);break;default:return console.log(b),!1}return!0}3>a&&e.throw_alerts&&alert(b);return!1}function r(b,a){if("function"==typeof e.listeners[b]&&"undefined"!=typeof a)e.listeners[b](a)}function s(b,a){for(var d in a)a.hasOwnProperty(d)&&("object"==typeof b[d]?"object"==typeof a[d]&&(b[d]=s(b[d],a[d])):b[d]=a[d]);return b}function f(b,a){(function(){function b(a,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(a,d.bubbles,
d.cancelable,d.detail);return c}if("function"===typeof window.CustomEvent)return!1;b.prototype=window.Event.prototype;window.CustomEvent=b})();document.dispatchEvent(new CustomEvent(b,{detail:a}))}function u(b){return"object"!==type(b)||b.nodeType||isWindow(b)?!1:!(b.constructor&&!hasOwn.call(b.constructor.prototype,"isPrototypeOf"))}var e=s({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},g),c={},x={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},v=this;this.isRunning=function(){return 1===e.initialized&&0===e.terminated};this.Initialize=function(){p(e.prefix+":  Initializing...",3);e.cmi?(c=e.cmi,"suspend"===c.exit&&(c.entry="resume")):c=e.CMI;e.initialized=1;e.terminated=0;return"true"};this.GetValue=
function(b){e.errorCode=0;var a="false";b=b.toString();var d=[];if(this.isRunning()){d=b.split(".");if(0<="|exit|session_time|".indexOf("|"+d[d.length-1]+"|"))return p(e.prefix+": This "+b+" is write only",4),e.errorCode=405,"false";d=b.toLowerCase().split(".");switch(d[0]){case "cmi":switch(a="false",b){case "cmi.exit":case "cmi.session_time":e.errorCode=405;e.diagnostic="Sorry, this has been specified as a read-only value for "+b;break;case "cmi.learner_name":a=e.CMI.learner_name;break;default:a=
t(b.substr(4,b.length),c),"undefined"===a&&(e.errorCode=401,e.diagnostic="Sorry, there was a undefined response from "+b,a="false"),p(e.prefix+": GetValue "+b+" = "+a,4)}}return a}e.errorCode=123;return a};this.SetValue=function(b,x){p(e.prefix+": SetValue: "+b+" = "+x,4);e.errorCode=0;var d=[],f=b.toString(),l=x.toString(),h=0,v=0,h=[];if(this.isRunning()){h=f.split(".");if("adl"===h[0]&&"id"===h[4]||"comments_from_lms"===h[1]||("comments_from_learner"===h[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
h[h.length-1]+"|")))return p(e.prefix+": This "+f+" is read only",4),e.errorCode=404,"false";d=f.split(".");switch(d[0]){case "cmi":switch(b){case "cmi.location":1E3<l.length&&p(e.prefix+": Some LMS's might truncate your bookmark as you've passed "+l.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":h=parseFloat(l);if("number"!=typeof h||isNaN(h))return q(b,l);h=Math.max(0,Math.min(1,h));r(b,h);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+
l+"|"))return a(b,l);r(b,l);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+l+"|"))return a(b,l);break;case "cmi.score.scaled":h=parseFloat(l);if("number"!=typeof h||isNaN(h))return q(b,l);h=Math.max(0,Math.min(1,h));r(b,h);break;case "cmi.score.min":h=parseFloat(l);if("number"!=typeof h||isNaN(h))return q(b,l);e.CMI.score.min=h;break;case "cmi.score.max":h=parseFloat(l);if("number"!=typeof h||isNaN(h))return q(b,l);e.CMI.score.max=h;break;case "cmi.score.raw":h=parseFloat(l);
if("number"!=typeof h||isNaN(h))return q(b,l);v=parseFloat(e.CMI.score.max);v="number"!=typeof v||isNaN(v)?100:v;d=parseFloat(e.CMI.score.min);d="number"!=typeof d||isNaN(d)?0:d;v-=d;0>=v&&(v=100);h=Math.max(0,Math.min(1,(h-d)/v));r("cmi.score.scaled",h);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+l+"|"))return a(b,l);r(b,l);break;default:switch(d[1]){case "comments_from_lms":return e.errorCode="404",e.diagnostic="The cmi.comments_from_lms element is entirely read only.",
"false";case "comments_from_learner":if(-1===c.comments_from_learner._children.indexOf(d[3]))return a(b,l);k(f.substr(4,f.length),l,c);c.comments_from_learner._count=(n(c.comments_from_learner)-2).toString();return"true";case "interactions":if(-1===c.interactions._children.indexOf(d[3]))return a(b,l);c.interactions._count=(n(c.interactions)-2).toString();if(isNaN(parseInt(d[2],10)))return"false";if(!u(c.interactions[d[2]])){if("id"===d[3])return c.interactions[d[2]]={},k(f.substr(4,f.length),l,c),
c.interactions._count=(n(c.interactions)-2).toString(),u(c.interactions[d[2]].objectives)||(p(e.prefix+": Constructing objectives object for new interaction",4),c.interactions[d[2]].objectives={},c.interactions[d[2]].objectives._count="-1"),u(c.interactions[d[2]].correct_responses)||(p(e.prefix+": Constructing correct responses object for new interaction",4),c.interactions[d[2]].correct_responses={},c.interactions[d[2]].correct_responses._count="-1"),"true";p("Can't add interaction without ID first!",
3);return"false"}if("objectives"===d[3]){if("id"===d[5])for(v=parseInt(c.interactions[d[2]].objectives._count,10),h=0;h<v;h+=1){if(c.interactions[d[2]].objectives[h].id===l)return f=b,e.errorCode="351",e.diagnostic="The "+f+" element must be unique.  The value '"+l+"' has already been set in #"+h,"false"}else return a(b,l);k(f.substr(4,f.length),l,c);c.interactions[d[2]].objectives._count=(n(c.interactions[d[2]].objectives)-1).toString();return"true"}"correct_responses"===d[3]&&(k(f.substr(4,f.length),
l,c),c.interactions[d[2]].correct_responses._count=(n(c.interactions[d[2]].correct_responses)-1).toString());k(f.substr(4,f.length),l,c);c.interactions._count=(n(c.interactions)-2).toString();return"true";case "objectives":if("id"===d[3])for(v=parseInt(c.objectives._count,10),h=0;h<v;h+=1)if(c.objectives[h].id===l)return e.errorCode="351",e.diagnostic="The objectives.id element must be unique.  The value '"+l+"' has already been set in objective #"+h,"false";if("id"!==d[3]&&(h=parseInt(d[2],10),void 0===
c.objectives[h]))return e.errorCode="408",e.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(d[2],10)))return"false";k(f.substr(4,f.length),l,c);c.objectives._count=(n(c.objectives)-2).toString();return"true"}}k(f.substr(4,f.length),l,c)}return"true"}e.errorCode=e.terminated?133:132;return"false"};this.Commit=function(){p(e.prefix+": Commit CMI Object:",4);p(c);p(e.prefix+": Suspend Data Usage "+(Math.round(100*(c.suspend_data.length/64E3)*
Math.pow(10,2))/Math.pow(10,2)+"%"));f("StoreData",{runtimedata:c});return"true"};this.Terminate=function(){v.Commit();e.terminated=1;e.initialized=0;return"true"};this.GetErrorString=function(b){return""!==b&&(b=parseInt(b,10),void 0!==x[b])?x[b]:""};this.GetLastError=function(){return e.errorCode};this.GetDiagnostic=function(){return e.diagnostic};this.setCMILMSValue=function(b,a){"string"==typeof b&&(e.CMI[b]=a)};this.addListener=function(b,a){"string"==typeof b&&"function"==typeof a&&(e.listeners[b]=
a)}};function Local_API_SCORM_12(g){function a(a,c){f.diganostic="The "+a+" of "+c+" must be a proper vocabulary element.";f.errorCode=406;return"false"}function m(a){f.errorCode=402;f.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function q(a,c){f.errorCode=201;f.diagnostic="The value for key "+a+" is not valid.";return"false"}function k(a,c,b){a=a.split(/\./);2>a.length?b[a[0]]=c:(b[a[0]]||(b[a[0]]={}),b=b[a.shift()],k(a.join("."),c,b))}function t(a,c){var b=a.split(/\./),
e;if(2>b.length)try{return c[b[0]]}catch(d){return m(a),"false"}else{e=b.shift();if(c[e])return String(t(b.join("."),c[e]));m(a);return"false"}}function n(a,c){if(f.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(c){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);break;case 3:console.log(a);break;default:return console.log(a),
!1}return!0}3>c&&f.throw_alerts&&alert(a);return!1}function p(a,c){if("function"==typeof f.listeners[a]&&"undefined"!=typeof c)f.listeners[a](c)}function r(a,c){for(var b in c)c.hasOwnProperty(b)&&("object"==typeof a[b]?"object"==typeof c[b]&&(a[b]=r(a[b],c[b])):a[b]=c[b]);return a}function s(a,c){(function(){function b(b,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,a.bubbles,a.cancelable,a.detail);return c}if("function"===typeof window.CustomEvent)return!1;
b.prototype=window.Event.prototype;window.CustomEvent=b})();document.dispatchEvent(new CustomEvent(a,{detail:c}))}var f=r({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},g),u={},e={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},c=this;this.isRunning=function(){return 1===f.initialized&&0===f.terminated};this.LMSInitialize=function(){n(f.prefix+":  Initializing...",3);u=f.CMI;f.initialized=1;f.terminated=0;return"true"};this.LMSGetValue=function(a){f.errorCode=0;var c="false";a=a.toString();var b=[];if(this.isRunning()){b=a.split(".");if(0<="|exit|session_time|".indexOf("|"+
b[b.length-1]+"|"))return f.errorCode=405,"false";b=a.toLowerCase().split(".");switch(b[0]){case "cmi":c=a;a="false";switch(c){case "cmi.core.exit":case "cmi.core.session_time":f.errorCode=405;f.diagnostic="Sorry, this has been specified as a read-only value for "+c;break;default:c=c.replace("cmi.",""),a=t(c,u),"undefined"===a&&(f.errorCode=401,f.diagnostic="Sorry, there was a undefined response from "+c,a="false")}c=a}return c}f.errorCode=123;return c};this.LMSSetValue=function(c,e){n(f.prefix+": SetValue: "+
c+" = "+e,4);f.errorCode=0;var b=[],g=c.toString(),d=e.toString();if(this.isRunning()){var b=g.split("."),m=b[b.length-1],b="adl"===b[0]&&"id"===b[4]?!0:"comments_from_lms"===b[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+m+"|");if(b)return f.errorCode=404,"false";b=g.split(".");switch(b[0]){case "cmi":switch(c){case "cmi.core.lesson_location":1E3<
d.length&&n(f.prefix+": Some LMS's might truncate your bookmark as you've passed "+d.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+d+"|"))return a(c,d);p(c,d);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+d+"|"))return a(c,d);break;case "cmi.core.score.min":b=parseFloat(d);if("number"!=typeof b||isNaN(b))return q(c,d);f.CMI.core.score.min=
b;break;case "cmi.core.score.max":b=parseFloat(d);if("number"!=typeof b||isNaN(b))return q(c,d);f.CMI.core.score.max=b;break;case "cmi.core.score.raw":b=parseFloat(d);if("number"!=typeof b||isNaN(b))return q(c,d);var l=parseFloat(f.CMI.core.score.max),l="number"!=typeof l||isNaN(l)?100:l,m=parseFloat(f.CMI.core.score.min),m="number"!=typeof m||isNaN(m)?0:m,l=l-m;0>=l&&(l=100);b=Math.max(0,Math.min(1,(b-m)/l));p("cmi.score.scaled",b)}g=g.replace("cmi.","");k(g,d,u)}return"true"}f.errorCode=f.terminated?
133:132;return"false"};this.LMSCommit=function(){s("StoreData",{runtimedata:u});return"true"};this.LMSTerminate=function(){c.LMSCommit();f.terminated=1;f.initialized=0;return"true"};this.LMSFinish=function(){c.LMSCommit();f.terminated=1;f.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==e[a])?e[a]:""};this.LMSGetLastError=function(){return f.errorCode};this.LMSGetDiagnostic=function(){return f.diagnostic};this.setCMILMSValue=function(a,c){"string"==
typeof a&&(f.CMI[a]=c)};this.addListener=function(a,c){"string"==typeof a&&"function"==typeof c&&(f.listeners[a]=c)}};SGAME=function(){return{init:function(g){SGAME.CORE.init(g)},loadSettings:function(g){SGAME.CORE.loadSettings(g)},triggerLO:function(g,a){SGAME.CORE.triggerLO(g,a)},showLO:function(g,a){SGAME.CORE.showLO(g,a)},showRandomLO:function(g){SGAME.CORE.showRandomLO(g)},closeLO:function(){SGAME.CORE.closeLO()}}}();SGAME.VERSION="0.5";SGAME.AUTHORS="Aldo Gordillo, Enrique Barra";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var g=!1;return{init:function(a){!0===a&&(g=a)},isDebugging:function(){return g},log:function(a){g&&window.console&&console.log(a)}}}();SGAME.API=function(){var g=function(a,m){var g=new XMLHttpRequest;g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){var a=JSON.parse(g.responseText);m(a)}};g.open("GET",a,!0);g.send("")};return{init:function(){},requestLOMetadata:function(a,m,q){try{g("undefined"==typeof a?"/lo/random/metadata.json":"/lo/"+a+"/metadata.json",function(a){m(a)})}catch(k){q(k)}}}}();SGAME.CORE=function(){var g=void 0,a={},m=["repeat","repeat_unless_successfully_consumed","no_repeat"],q=["no_more_los","all_los_consumed","all_los_succesfully_consumed","never"],k=["success","failure","failure_unless_blocking"],t=!1,n=!1,p="Congratulations. You have achieved the objectives of this educational game. You may close this window or continue playing.";SGAME.Debugger.init(!0);var r=function(b,c){"object"!==typeof b||"string"!==typeof b.url?"function"==typeof c&&c(null,null):(s(),a.los[b.id].shown=
!0,a.los[b.id].nshown+=1,SGAME.Fancybox.create({lo:b},function(d){a.los[b.id].succesfully_consumed=d.success;switch(a.sequencing.repeat_lo){case "repeat_unless_successfully_consumed":a.los[b.id].can_be_shown=!0!==a.los[b.id].succesfully_consumed;break;case "no_repeat":a.los[b.id].can_be_shown=!1}f();d.more_los=t;u(function(){"function"==typeof c&&c(d.success,d);s()})}))},s=function(){"function"===typeof g&&g()},f=function(){for(var b=Object.keys(a.los),c=b.length,d=0;d<c;d++)if(!0===a.los[b[d]].can_be_shown){t=
!0;return}t=!1},u=function(a){!0!==e()?"function"===typeof a&&a(!1):c(a)},e=function(){if(!0===n)return!1;switch(a.game_settings.completion_notification){case "no_more_los":return!1===t;case "all_los_consumed":for(var b=Object.keys(a.los),c=b.length,d=0;d<c;d++)if(!1===a.los[b[d]].shown)return!1;return!0;case "all_los_succesfully_consumed":b=Object.keys(a.los);c=b.length;for(d=0;d<c;d++)if(!1===a.los[b[d]].succesfully_consumed)return!1;return!0;case "never":return!1;default:return!1}},c=function(a){n=
!0;SGAME.Fancybox.create({dialog:!0,msg:p},function(){"function"===typeof a&&a(!0)})},x=function(a){return{lo_metadata:void 0,time:void 0,scorm_success_status:void 0,scorm_scaled_score:void 0,scorm_completion_status:void 0,scorm_progress_measure:void 0,success:v(a),more_los:t}},v=function(b){switch(a.game_settings.behaviour_when_no_more_los){case "success":return!0;case "failure":return!1;case "failure_unless_blocking":return b=a.events[b],"undefined"===typeof b||"blocking"!==b.type?!1:!0;default:return!1}};
return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);a&&"function"===typeof a.togglePause&&(g=a.togglePause)},loadSettings:function(b){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(b);a=b;"undefined"===typeof a.game_metadata&&(a.game_metadata={});"undefined"===typeof a.los&&(a.los={});"undefined"===typeof a.events&&(a.events={});"undefined"===typeof a.event_mapping&&(a.event_mapping={});"undefined"===typeof a.sequencing&&(a.sequencing={});-1===
m.indexOf(a.sequencing.repeat_lo)&&(a.sequencing.repeat_lo="repeat");"undefined"===typeof a.game_settings&&(a.game_settings={});-1===q.indexOf(a.game_settings.completion_notification)&&(a.game_settings.completion_notification="never");-1===k.indexOf(a.game_settings.behaviour_when_no_more_los)&&(a.game_settings.behaviour_when_no_more_los="failure_unless_blocking");"string"===typeof a.game_settings.completion_notification_text&&(p=a.game_settings.completion_notification_text);if("object"===typeof a.los){b=
Object.keys(a.los);for(var c=b.length,d=0;d<c;d++)"undefined"!==typeof a.los[b[d]].url&&(a.los[b[d]].url=SGAME.Utils.checkUrlProtocol(a.los[b[d]].url)),a.los[b[d]].can_be_shown=!0,a.los[b[d]].shown=!1,a.los[b[d]].nshown=0,a.los[b[d]].succesfully_consumed=!1,t=!0}},triggerLO:function(b,c){var d=[],e=[],f=a.event_mapping[b],h=f.length;if("undefined"!==typeof f&&"number"===typeof h)for(var g=0;g<h;g++){if("*"===f[g]){d=[];f=Object.keys(a.los);for(h=0;h<f.length;h++)"undefined"!==typeof a.los[f[h]]&&
d.push(a.los[f[h]]);break}"undefined"!==typeof a.los[f[g]]&&d.push(a.los[f[g]])}f=d.length;if(1>f.length)"function"==typeof c&&(e=x(b),c(e.success,e));else{for(h=0;h<f;h++)!0===d[h].can_be_shown&&e.push(d[h]);if(e&&e instanceof Array&&0<e.length){for(var d=[],m,f=0;f<e.length;f++)"undefined"===typeof m&&(m=e[f].nshown),e[f].nshown<m&&(m=e[f].nshown,d=[]),m===e[f].nshown&&d.push(e[f]);selectedLO=SGAME.Utils.getRandomElement(d);r(selectedLO,c)}else"function"==typeof c&&(e=x(b),c(e.success,e))}},showLO:r,
showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,function(c){r(c,a)},function(){"function"==typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()}}}();var API,API_1484_11;
SGAME.Fancybox=function(g){var a=g,m=g,q=g,k=function(){"undefined"!=typeof a&&(a.style.display="none",a.parentNode.removeChild(a),"lo"===m&&(API_1484_11=API=g),m=a=g)},t=function(){if("undefined"!=typeof a){var n=m;k();var p;p="lo"===n?SGAME.Observer.stop():!0;var r=q;q=g;setTimeout(function(){"function"===typeof r&&r(p)},50)}};return{init:function(){},create:function(n,p){k();q=p;var r="undefined"!==typeof n&&!0===n.dialog?"dialog":"lo",s=850,f=650;if("lo"===r)var u={},e;else var c="";n&&(n.width&&
(s=n.width),n.height&&(f=n.height),"lo"===r?n.lo&&(u=n.lo,"string"===typeof u.url&&(e=u.url)):"string"==typeof n.msg&&(c=n.msg));var x=window.innerHeight-8,v=window.innerWidth-8,f=Math.min(f,x),s=Math.min(s,v);if("lo"===r){if("string"!=typeof e||"undefined"==typeof u.scorm_type)return;var b=g;API_1484_11=API=g;"sco"===u.scorm_type&&("1.2"===u.scorm_version?b=API=new Local_API_SCORM_12({debug:SGAME.Debugger.isDebugging()}):"2004"===u.scorm_version&&(b=API_1484_11=new Local_API_1484_11({debug:SGAME.Debugger.isDebugging()})))}var w=
document.createElement("div");w.style.width=s+"px";w.style.height=f+"px";w.style.maxWidth=v+"px";w.style.maxHeight=x+"px";w.style.overflow="log"===r?"hidden":"auto";w.style.background="white";w.style.position="absolute";w.style.top=0;w.style.zIndex=9999;w.style.borderRadius="1em";w.style.border="2px solid black";w.setAttribute("id","sgame_fancybox");w.style.marginLeft=(window.innerWidth-s)/2+"px";w.style.marginTop=(window.innerHeight-f)/2+"px";s=document.createElement("img");s.src="/assets/sgame/close.png";
s.style.width="25px";s.style.height="25px";s.style.padding="5px";s.style.cursor="pointer";s.style.position="absolute";s.style.right=0;s.onclick=function(){t()};w.appendChild(s);if("lo"===r){c=document.createElement("img");c.id="trafficLight";c.src="/assets/sgame/trafficLight/trafficLight_red.png";c.style.width="45px";c.style.height="40px";c.style.padding="5px";c.style.position="absolute";c.style.left="0px";c.style.top="0px";w.appendChild(c);var d=document.createElement("iframe");d.src=e;d.style.width=
"94%";d.style.height="94%";d.style.marginLeft="3%";d.style.marginTop="3%";d.style.overflow="hidden";d.style.overflowY="auto";d.scrolling="yes";d.style.frameBorder="0";d.style.borderStyle="none";d.setAttribute("allowfullscreen","false");w.appendChild(d)}else e=document.createElement("p"),e.id="dialog",e.innerHTML=c,e.style.padding="15px",e.style.marginTop="30px",e.style.marginBottom="20px",e.style.marginRight="20px",e.style.marginLeft="20px",e.style.textAlign="center",e.style.fontSize="24px",e.style.position=
"relative",e.style.cursor="default",e.style.color="#000",e.style.fontFamily="initial",w.appendChild(e);a=w;m=r;document.body.appendChild(w);"lo"===r&&SGAME.Observer.start(d,u,b)},closeCurrentFancybox:t}}();SGAME.Observer=function(g){var a=!0,m=g,q=g,k=g,t,n,p,r,s,f,u=function(){k=q=m=g;t=Date.now();n=!1;f=s=r=p=g},e=function(){"sco"==q.scorm_type&&"undefined"!=typeof k&&(k.addListener("cmi.success_status",function(a){p=a;"passed"===p&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),k.addListener("cmi.score.scaled",function(a){r=a;0.8<=r&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
k.addListener("cmi.completion_status",function(a){s=a}),k.addListener("cmi.progress_measure",function(a){f=a}))};return{start:function(c,f,g){if(!1===a||"undefined"!=typeof m)return null;a=!1;u();m=c;q=f;k=g;e();SGAME.TrafficLight.changeColor("red");if("asset"==q.scorm_type){b:{c=q.lom_metadata;if(c.educational&&c.educational.typicalLearningTime&&c.educational.typicalLearningTime.duration&&c.educational.typicalLearningTime.duration.langstrings&&c.educational.typicalLearningTime.duration.langstrings["x-none"]&&
(c=iso8601Parser.getDuration(c.educational.typicalLearningTime.duration.langstrings["x-none"])))break b;c=null}c=c?Math.min(0.5*c,60):15;SGAME.TrafficLight.setUpBlink("yellow",0.5*c-0.5,0.5*c);SGAME.TrafficLight.changeColor("green",c)}},stop:function(){if(!0===a||"undefined"==typeof m)return null;a=!0;SGAME.TrafficLight.stop();var c=Math.round((Date.now()-t)/1E3);n="green"===SGAME.TrafficLight.getCurrentColor();c={lo_metadata:q,time:c,success:n};"undefined"!=typeof p&&(c.scorm_success_status=p);"undefined"!=
typeof r&&(c.scorm_scaled_score=r);"undefined"!=typeof s&&(c.scorm_completion_status=s);"undefined"!=typeof f&&(c.scorm_progress_measure=f);u();return c},isStopped:function(){return a}}}();SGAME.TrafficLight=function(g){var a,m,q,k,t,n=function(g){var f=document.getElementById("trafficLight");f&&(a=g,f.src=p(g))},p=function(a){switch(a){case "green":return"/assets/sgame/trafficLight/trafficLight_green.png";case "yellow":return"/assets/sgame/trafficLight/trafficLight_yellow.png";case "red":return"/assets/sgame/trafficLight/trafficLight_red.png";default:return"/assets/sgame/trafficLight/trafficLight.png"}},r=function(a,f){var g=document.getElementById("trafficLight");if(g){var e=!1;k=
setInterval(function(){g&&(e?(g.src=p(null),e=!1):(g.src=p(a),e=!0))},500);t=setTimeout(function(){clearTimeout(k)},1E3*f)}};return{getCurrentColor:function(){return a},changeColor:function(a,f){f?m=setTimeout(function(){n(a)},1E3*f):n(a)},setUpBlink:function(a,f,g){g?q=setTimeout(function(){r(a,f)},1E3*g):r(a,f)},stop:function(){m&&clearTimeout(m);q&&clearTimeout(q);k&&clearTimeout(k);t&&clearTimeout(t)}}}();SGAME.Utils=function(){var g=void 0;return{init:function(a){},getRandomElement:function(a){if("number"==typeof a)return a;var g;g=a.length-1;if("number"!=typeof g)throw{name:"Invalid number format exception"};g=Math.round(0+Math.random()*(g-0));return a[g]},loadScript:function(a,g){if("string"===typeof a&&"function"===typeof g){var q=document.getElementsByTagName("head")[0];if(q){var k=document.createElement("script");k.setAttribute("src",a);k.setAttribute("type","text/javascript");k.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||g()};k.onload=g;q.appendChild(k)}}},getProtocol:function(){if("undefined"!==typeof g)return g;var a;try{a=document.location.protocol}catch(m){}"string"===typeof a&&(a=a.match(/[\w]+/),a=a instanceof Array&&"string"===typeof a[0]?a[0]:void 0);return g="string"===typeof a?a:"unknown"},checkUrlProtocol:function(a){if("string"===typeof a){var g=a.match(/^https?:\/\//);if(g instanceof Array&&1===g.length){var g=g[0].replace("://",""),q=
SGAME.Utils.getProtocol();if(g!==q)switch(q){case "https":a="https"+a.replace(g,"")}}}return a}}}();
