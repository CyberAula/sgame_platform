iso8601Parser=function(d){return{getDuration:function(b){var f=[31104E3,2592E3,604800,86400,3600,60,1];try{var p;var m=b;b=[2,3,4,5,7,8,9];var d=[0,0,0,0,0,0,0],s;if(m=m.toUpperCase()){if("string"!==typeof m)throw Error("Invalid iso8601 period string '"+m+"'");if(s=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(m))for(m=0;m<b.length;m++){var g=b[m];d[m]=s[g]?+s[g].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+m+"' is not a valid ISO8601 period.");}p=d}catch(t){return null}for(g=
s=0;g<p.length;g++)s+=p[g]*f[g];return s}}}();function Local_API_1484_11(d){function b(e,c){a.diganostic="The "+e+" of "+c+" must be a proper vocabulary element.";a.errorCode=406;return"false"}function f(e){a.errorCode=402;a.diagnostic="The value for key "+e+" has not been created yet.";return"false"}function p(e,c){a.errorCode=201;a.diagnostic="The value for key "+e+" is not valid.";return"false"}function m(e,c,a){e=e.split(/\./);2>e.length?a[e[0]]=c:(a[e[0]]||(a[e[0]]={}),a=a[e.shift()],m(e.join("."),c,a))}function r(e,c){var a=e.split(/\./),
b;if(2>a.length)try{return c[a[0]]}catch(h){return f(e),"false"}else{b=a.shift();if(c[b])return String(r(a.join("."),c[b]));f(e);return"false"}}function s(e){var c,a=0;for(c in e)e.hasOwnProperty(c)&&(a+=1);return a}function g(e,c){if(a.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(c){case 1:console.error(e);break;case 2:console.warn(e);break;case 4:console.info(e);
break;case 3:console.log(e);break;default:return console.log(e),!1}return!0}3>c&&a.throw_alerts&&alert(e);return!1}function t(e,c){if("function"==typeof a.listeners[e]&&"undefined"!=typeof c)a.listeners[e](c)}function l(e,c){for(var a in c)c.hasOwnProperty(a)&&("object"==typeof e[a]?"object"==typeof c[a]&&(e[a]=l(e[a],c[a])):e[a]=c[a]);return e}function k(e,c){(function(){function e(c,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");b.initCustomEvent(c,a.bubbles,
a.cancelable,a.detail);return b}if("function"===typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype;window.CustomEvent=e})();document.dispatchEvent(new CustomEvent(e,{detail:c}))}function u(e){return"object"!==type(e)||e.nodeType||isWindow(e)?!1:!(e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf"))}var a=l({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},d),h={},c={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},q=this;this.isRunning=function(){return 1===a.initialized&&0===a.terminated};this.Initialize=function(){g(a.prefix+":  Initializing...",3);a.cmi?(h=a.cmi,"suspend"===h.exit&&(h.entry="resume")):h=a.CMI;a.initialized=1;a.terminated=0;return"true"};this.GetValue=
function(e){a.errorCode=0;var c="false";e=e.toString();var b=[];if(this.isRunning()){b=e.split(".");if(0<="|exit|session_time|".indexOf("|"+b[b.length-1]+"|"))return g(a.prefix+": This "+e+" is write only",4),a.errorCode=405,"false";b=e.toLowerCase().split(".");switch(b[0]){case "cmi":switch(c="false",e){case "cmi.exit":case "cmi.session_time":a.errorCode=405;a.diagnostic="Sorry, this has been specified as a read-only value for "+e;break;case "cmi.learner_name":c=a.CMI.learner_name;break;default:c=
r(e.substr(4,e.length),h),"undefined"===c&&(a.errorCode=401,a.diagnostic="Sorry, there was a undefined response from "+e,c="false"),g(a.prefix+": GetValue "+e+" = "+c,4)}}return c}a.errorCode=123;return c};this.SetValue=function(c,k){g(a.prefix+": SetValue: "+c+" = "+k,4);a.errorCode=0;var q=[],d=c.toString(),f=k.toString(),n=0,l=0,n=[];if(this.isRunning()){n=d.split(".");if("adl"===n[0]&&"id"===n[4]||"comments_from_lms"===n[1]||("comments_from_learner"===n[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
n[n.length-1]+"|")))return g(a.prefix+": This "+d+" is read only",4),a.errorCode=404,"false";q=d.split(".");switch(q[0]){case "cmi":switch(c){case "cmi.location":1E3<f.length&&g(a.prefix+": Some LMS's might truncate your bookmark as you've passed "+f.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":n=parseFloat(f);if("number"!=typeof n||isNaN(n))return p(c,f);n=Math.max(0,Math.min(1,n));t(c,n);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+
f+"|"))return b(c,f);t(c,f);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+f+"|"))return b(c,f);break;case "cmi.score.scaled":n=parseFloat(f);if("number"!=typeof n||isNaN(n))return p(c,f);n=Math.max(0,Math.min(1,n));t(c,n);break;case "cmi.score.min":n=parseFloat(f);if("number"!=typeof n||isNaN(n))return p(c,f);a.CMI.score.min=n;break;case "cmi.score.max":n=parseFloat(f);if("number"!=typeof n||isNaN(n))return p(c,f);a.CMI.score.max=n;break;case "cmi.score.raw":n=parseFloat(f);
if("number"!=typeof n||isNaN(n))return p(c,f);l=parseFloat(a.CMI.score.max);l="number"!=typeof l||isNaN(l)?100:l;q=parseFloat(a.CMI.score.min);q="number"!=typeof q||isNaN(q)?0:q;l-=q;0>=l&&(l=100);n=Math.max(0,Math.min(1,(n-q)/l));t("cmi.score.scaled",n);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+f+"|"))return b(c,f);t(c,f);break;default:switch(q[1]){case "comments_from_lms":return a.errorCode="404",a.diagnostic="The cmi.comments_from_lms element is entirely read only.",
"false";case "comments_from_learner":if(-1===h.comments_from_learner._children.indexOf(q[3]))return b(c,f);m(d.substr(4,d.length),f,h);h.comments_from_learner._count=(s(h.comments_from_learner)-2).toString();return"true";case "interactions":if(-1===h.interactions._children.indexOf(q[3]))return b(c,f);h.interactions._count=(s(h.interactions)-2).toString();if(isNaN(parseInt(q[2],10)))return"false";if(!u(h.interactions[q[2]])){if("id"===q[3])return h.interactions[q[2]]={},m(d.substr(4,d.length),f,h),
h.interactions._count=(s(h.interactions)-2).toString(),u(h.interactions[q[2]].objectives)||(g(a.prefix+": Constructing objectives object for new interaction",4),h.interactions[q[2]].objectives={},h.interactions[q[2]].objectives._count="-1"),u(h.interactions[q[2]].correct_responses)||(g(a.prefix+": Constructing correct responses object for new interaction",4),h.interactions[q[2]].correct_responses={},h.interactions[q[2]].correct_responses._count="-1"),"true";g("Can't add interaction without ID first!",
3);return"false"}if("objectives"===q[3]){if("id"===q[5])for(l=parseInt(h.interactions[q[2]].objectives._count,10),n=0;n<l;n+=1){if(h.interactions[q[2]].objectives[n].id===f)return d=c,a.errorCode="351",a.diagnostic="The "+d+" element must be unique.  The value '"+f+"' has already been set in #"+n,"false"}else return b(c,f);m(d.substr(4,d.length),f,h);h.interactions[q[2]].objectives._count=(s(h.interactions[q[2]].objectives)-1).toString();return"true"}"correct_responses"===q[3]&&(m(d.substr(4,d.length),
f,h),h.interactions[q[2]].correct_responses._count=(s(h.interactions[q[2]].correct_responses)-1).toString());m(d.substr(4,d.length),f,h);h.interactions._count=(s(h.interactions)-2).toString();return"true";case "objectives":if("id"===q[3])for(l=parseInt(h.objectives._count,10),n=0;n<l;n+=1)if(h.objectives[n].id===f)return a.errorCode="351",a.diagnostic="The objectives.id element must be unique.  The value '"+f+"' has already been set in objective #"+n,"false";if("id"!==q[3]&&(n=parseInt(q[2],10),void 0===
h.objectives[n]))return a.errorCode="408",a.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(q[2],10)))return"false";m(d.substr(4,d.length),f,h);h.objectives._count=(s(h.objectives)-2).toString();return"true"}}m(d.substr(4,d.length),f,h)}return"true"}a.errorCode=a.terminated?133:132;return"false"};this.Commit=function(){g(a.prefix+": Commit CMI Object:",4);g(h);g(a.prefix+": Suspend Data Usage "+(Math.round(100*(h.suspend_data.length/64E3)*
Math.pow(10,2))/Math.pow(10,2)+"%"));k("StoreData",{runtimedata:h});return"true"};this.Terminate=function(){q.Commit();a.terminated=1;a.initialized=0;return"true"};this.GetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==c[a])?c[a]:""};this.GetLastError=function(){return a.errorCode};this.GetDiagnostic=function(){return a.diagnostic};this.setCMILMSValue=function(c,b){"string"==typeof c&&(a.CMI[c]=b)};this.addListener=function(c,b){"string"==typeof c&&"function"==typeof b&&(a.listeners[c]=
b)}};function Local_API_SCORM_12(d){function b(c,a){k.diganostic="The "+c+" of "+a+" must be a proper vocabulary element.";k.errorCode=406;return"false"}function f(c){k.errorCode=402;k.diagnostic="The value for key "+c+" has not been created yet.";return"false"}function p(c,a){k.errorCode=201;k.diagnostic="The value for key "+c+" is not valid.";return"false"}function m(c,a,b){c=c.split(/\./);2>c.length?b[c[0]]=a:(b[c[0]]||(b[c[0]]={}),b=b[c.shift()],m(c.join("."),a,b))}function r(c,a){var b=c.split(/\./),
h;if(2>b.length)try{return a[b[0]]}catch(g){return f(c),"false"}else{h=b.shift();if(a[h])return String(r(b.join("."),a[h]));f(c);return"false"}}function s(c,a){if(k.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(a){case 1:console.error(c);break;case 2:console.warn(c);break;case 4:console.info(c);break;case 3:console.log(c);break;default:return console.log(c),
!1}return!0}3>a&&k.throw_alerts&&alert(c);return!1}function g(c,a){if("function"==typeof k.listeners[c]&&"undefined"!=typeof a)k.listeners[c](a)}function t(c,a){for(var b in a)a.hasOwnProperty(b)&&("object"==typeof c[b]?"object"==typeof a[b]&&(c[b]=t(c[b],a[b])):c[b]=a[b]);return c}function l(c,a){(function(){function c(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return e}if("function"===typeof window.CustomEvent)return!1;
c.prototype=window.Event.prototype;window.CustomEvent=c})();document.dispatchEvent(new CustomEvent(c,{detail:a}))}var k=t({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},d),u={},a={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},h=this;this.isRunning=function(){return 1===k.initialized&&0===k.terminated};this.LMSInitialize=function(){s(k.prefix+":  Initializing...",3);u=k.CMI;k.initialized=1;k.terminated=0;return"true"};this.LMSGetValue=function(c){k.errorCode=0;var a="false";c=c.toString();var b=[];if(this.isRunning()){b=c.split(".");if(0<="|exit|session_time|".indexOf("|"+
b[b.length-1]+"|"))return k.errorCode=405,"false";b=c.toLowerCase().split(".");switch(b[0]){case "cmi":a=c;c="false";switch(a){case "cmi.core.exit":case "cmi.core.session_time":k.errorCode=405;k.diagnostic="Sorry, this has been specified as a read-only value for "+a;break;default:a=a.replace("cmi.",""),c=r(a,u),"undefined"===c&&(k.errorCode=401,k.diagnostic="Sorry, there was a undefined response from "+a,c="false")}a=c}return a}k.errorCode=123;return a};this.LMSSetValue=function(a,h){s(k.prefix+": SetValue: "+
a+" = "+h,4);k.errorCode=0;var e=[],f=a.toString(),d=h.toString();if(this.isRunning()){var e=f.split("."),l=e[e.length-1],e="adl"===e[0]&&"id"===e[4]?!0:"comments_from_lms"===e[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+l+"|");if(e)return k.errorCode=404,"false";e=f.split(".");switch(e[0]){case "cmi":switch(a){case "cmi.core.lesson_location":1E3<
d.length&&s(k.prefix+": Some LMS's might truncate your bookmark as you've passed "+d.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+d+"|"))return b(a,d);g(a,d);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+d+"|"))return b(a,d);break;case "cmi.core.score.min":e=parseFloat(d);if("number"!=typeof e||isNaN(e))return p(a,d);k.CMI.core.score.min=
e;break;case "cmi.core.score.max":e=parseFloat(d);if("number"!=typeof e||isNaN(e))return p(a,d);k.CMI.core.score.max=e;break;case "cmi.core.score.raw":e=parseFloat(d);if("number"!=typeof e||isNaN(e))return p(a,d);var r=parseFloat(k.CMI.core.score.max),r="number"!=typeof r||isNaN(r)?100:r,l=parseFloat(k.CMI.core.score.min),l="number"!=typeof l||isNaN(l)?0:l,r=r-l;0>=r&&(r=100);e=Math.max(0,Math.min(1,(e-l)/r));g("cmi.score.scaled",e)}f=f.replace("cmi.","");m(f,d,u)}return"true"}k.errorCode=k.terminated?
133:132;return"false"};this.LMSCommit=function(){l("StoreData",{runtimedata:u});return"true"};this.LMSTerminate=function(){h.LMSCommit();k.terminated=1;k.initialized=0;return"true"};this.LMSFinish=function(){h.LMSCommit();k.terminated=1;k.initialized=0;return"true"};this.LMSGetErrorString=function(c){return""!==c&&(c=parseInt(c,10),void 0!==a[c])?a[c]:""};this.LMSGetLastError=function(){return k.errorCode};this.LMSGetDiagnostic=function(){return k.diagnostic};this.setCMILMSValue=function(a,b){"string"==
typeof a&&(k.CMI[a]=b)};this.addListener=function(a,b){"string"==typeof a&&"function"==typeof b&&(k.listeners[a]=b)}};SGAME=function(){return{init:function(d){SGAME.CORE.init(d)},loadSettings:function(d){SGAME.CORE.loadSettings(d)},triggerLO:function(d,b){SGAME.CORE.triggerLO(d,b)},showLO:function(d,b){SGAME.CORE.showLO(d,b)},showRandomLO:function(d){SGAME.CORE.showRandomLO(d)},closeLO:function(){SGAME.CORE.closeLO()}}}();SGAME.VERSION="0.5";SGAME.AUTHORS="Aldo Gordillo, Enrique Barra";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var d=!1;return{init:function(b){!0===b&&(d=b)},isDebugging:function(){return d},log:function(b){d&&window.console&&console.log(b)}}}();SGAME.API=function(){var d=function(b,f){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var b=JSON.parse(d.responseText);f(b)}};d.open("GET",b,!0);d.send("")};return{init:function(){},requestLOMetadata:function(b,f,p){try{d("undefined"==typeof b?"/lo/random/metadata.json":"/lo/"+b+"/metadata.json",function(b){f(b)})}catch(m){p(m)}}}}();SGAME.CORE=function(){var d=void 0,b={},f=["repeat","repeat_unless_successfully_consumed","no_repeat"],p=["no_more_los","all_los_consumed","all_los_succesfully_consumed","never"],m=["success","failure","failure_unless_blocking"],r=!1;SGAME.Debugger.init(!0);var s=function(a,h){"object"!==typeof a||"string"!==typeof a.url?"function"==typeof h&&h(null,null):(b.los[a.id].shown=!0,b.los[a.id].nshown+=1,g(),SGAME.Fancybox.create({lo:a},function(c){b.los[a.id].succesfully_consumed=c.success;switch(b.sequencing.repeat_lo){case "repeat_unless_successfully_consumed":b.los[a.id].can_be_shown=
!0!==b.los[a.id].succesfully_consumed;break;case "no_repeat":b.los[a.id].can_be_shown=!1}t(function(){"function"==typeof h&&h(c.success,c);g()})}))},g=function(){"function"===typeof d&&d()},t=function(a){!0!==l()?"function"===typeof a&&a(!1):(r=!0,alert("Final screen"),"function"===typeof a&&a(!0))},l=function(){if(!0===r)return!1;switch(b.game_settings.completion_notification){case "no_more_los":for(var a=Object.keys(b.los),h=a.length,c=0;c<h;c++)if(!0===b.los[a[c]].can_be_shown)return!1;return!0;
case "all_los_consumed":a=Object.keys(b.los);h=a.length;for(c=0;c<h;c++)if(!1===b.los[a[c]].shown)return!1;return!0;case "all_los_succesfully_consumed":a=Object.keys(b.los);h=a.length;for(c=0;c<h;c++)if(!1===b.los[a[c]].succesfully_consumed)return!1;return!0;case "never":return!1;default:return!1}},k=function(a){return{lo_metadata:void 0,time:void 0,scorm_success_status:void 0,scorm_scaled_score:void 0,scorm_completion_status:void 0,scorm_progress_measure:void 0,success:u(a)}},u=function(a){switch(b.game_settings.behaviour_when_no_more_los){case "success":return!0;
case "failure":return!1;case "failure_unless_blocking":return a=b.events[a],"undefined"===typeof a||"blocking"!==a.type?!1:!0;default:return!1}};return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);a&&"function"===typeof a.togglePause&&(d=a.togglePause)},loadSettings:function(a){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(a);b=a;void 0===typeof b.game_metadata&&(b.game_metadata={});void 0===typeof b.los&&(b.los={});void 0===typeof b.events&&
(b.events={});void 0===typeof b.event_mapping&&(b.event_mapping={});void 0===typeof b.sequencing&&(b.sequencing={},-1!==f.indexOf(b.sequencing.repeat_lo)&&(b.sequencing.repeat_lo="repeat"));void 0===typeof b.game_settings&&(b.game_settings={},-1!==p.indexOf(b.game_settings.completion_notification)&&(b.game_settings.completion_notification="never"),-1!==m.indexOf(b.game_settings.behaviour_when_no_more_los)&&(b.game_settings.behaviour_when_no_more_los="failure_unless_blocking"));if("object"===typeof b.los){a=
Object.keys(b.los);for(var h=a.length,c=0;c<h;c++)"undefined"!==typeof b.los[a[c]].url&&(b.los[a[c]].url=SGAME.Utils.checkUrlProtocol(b.los[a[c]].url)),b.los[a[c]].can_be_shown=!0,b.los[a[c]].shown=!1,b.los[a[c]].nshown=0,b.los[a[c]].succesfully_consumed=!1}},triggerLO:function(a,h){var c=[],d=[],e=b.event_mapping[a],f=e.length;if("undefined"!==typeof e&&"number"===typeof f)for(var g=0;g<f;g++){if("*"===e[g]){c=[];e=Object.keys(b.los);for(f=0;f<e.length;f++)"undefined"!==typeof b.los[e[f]]&&c.push(b.los[e[f]]);
break}"undefined"!==typeof b.los[e[g]]&&c.push(b.los[e[g]])}e=c.length;if(1>e.length)"function"==typeof h&&(d=k(a),h(d.success,d));else{for(f=0;f<e;f++)!0===c[f].can_be_shown&&d.push(c[f]);if(d&&d instanceof Array&&0<d.length){for(var c=[],l,e=0;e<d.length;e++)"undefined"===typeof l&&(l=d[e].nshown),d[e].nshown<l&&(l=d[e].nshown,c=[]),l===d[e].nshown&&c.push(d[e]);selectedLO=SGAME.Utils.getRandomElement(c);s(selectedLO,h)}else"function"==typeof h&&(d=k(a),h(d.success,d))}},showLO:s,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,
function(b){s(b,a)},function(){"function"==typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()}}}();var API,API_1484_11;
SGAME.Fancybox=function(d){var b=d,f=d,p=function(){"undefined"!=typeof b&&(b.style.display="none",b.parentNode.removeChild(b),API_1484_11=API=b=d)},m=function(){p();var b=SGAME.Observer.stop();setTimeout(function(){"function"===typeof f&&f(b);f=d},50)};return{init:function(){},create:function(r,s){p();f=s;var g=850,t=650,l={},k;r&&(r.width&&(g=r.width),r.height&&(t=r.height),r.lo&&(l=r.lo),"string"==typeof l.url&&(k=l.url));var u=window.innerHeight-8,a=window.innerWidth-8,t=Math.min(t,u),g=Math.min(g,
a);if("string"==typeof k&&"undefined"!=typeof l.scorm_type){var h=d;API_1484_11=API=d;"sco"===l.scorm_type&&("1.2"===l.scorm_version?h=API=new Local_API_SCORM_12({debug:SGAME.Debugger.isDebugging()}):"2004"===l.scorm_version&&(h=API_1484_11=new Local_API_1484_11({debug:SGAME.Debugger.isDebugging()})));var c=document.createElement("div");c.style.width=g+"px";c.style.height=t+"px";c.style.maxWidth=a+"px";c.style.maxHeight=u+"px";c.style.overflow="hidden";c.style.background="white";c.style.position=
"absolute";c.style.top=0;c.style.zIndex=9999;c.style.borderRadius="1em";c.style.border="2px solid black";c.setAttribute("id","sgame_fancybox");c.style.marginLeft=(window.innerWidth-g)/2+"px";c.style.marginTop=(window.innerHeight-t)/2+"px";g=document.createElement("img");g.src="/assets/sgame/close.png";g.style.width="25px";g.style.height="25px";g.style.padding="5px";g.style.cursor="pointer";g.style.position="absolute";g.style.right=0;g.onclick=function(){m()};c.appendChild(g);g=document.createElement("img");
g.id="trafficLight";g.src="/assets/sgame/trafficLight/trafficLight_red.png";g.style.width="45px";g.style.height="40px";g.style.padding="5px";g.style.position="absolute";g.style.left="0px";g.style.top="0px";c.appendChild(g);g=document.createElement("iframe");g.src=k;g.style.width="94%";g.style.height="94%";g.style.marginLeft="3%";g.style.marginTop="3%";g.style.overflow="hidden";g.style.overflowY="auto";g.scrolling="yes";g.style.frameBorder="0";g.style.borderStyle="none";g.setAttribute("allowfullscreen",
"false");c.appendChild(g);b=c;document.body.appendChild(c);SGAME.Observer.start(g,l,h)}},closeCurrentFancybox:m}}();SGAME.Observer=function(d){var b=!0,f=d,p=d,m=d,r,s,g,t,l,k,u=function(){m=p=f=d;r=Date.now();s=!1;k=l=t=g=d},a=function(){"sco"==p.scorm_type&&"undefined"!=typeof m&&(m.addListener("cmi.success_status",function(a){g=a;"passed"===g&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),m.addListener("cmi.score.scaled",function(a){t=a;0.8<=t&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
m.addListener("cmi.completion_status",function(a){l=a}),m.addListener("cmi.progress_measure",function(a){k=a}))};return{start:function(d,c,g){if(!1===b||"undefined"!=typeof f)return null;b=!1;u();f=d;p=c;m=g;a();SGAME.TrafficLight.changeColor("red");if("asset"==p.scorm_type){b:{d=p.lom_metadata;if(d.educational&&d.educational.typicalLearningTime&&d.educational.typicalLearningTime.duration&&d.educational.typicalLearningTime.duration.langstrings&&d.educational.typicalLearningTime.duration.langstrings["x-none"]&&
(d=iso8601Parser.getDuration(d.educational.typicalLearningTime.duration.langstrings["x-none"])))break b;d=null}d=d?Math.min(0.5*d,60):15;SGAME.TrafficLight.setUpBlink("yellow",0.5*d-0.5,0.5*d);SGAME.TrafficLight.changeColor("green",d)}},stop:function(){if(!0===b||"undefined"==typeof f)return null;b=!0;SGAME.TrafficLight.stop();var a=Math.round((Date.now()-r)/1E3);s="green"===SGAME.TrafficLight.getCurrentColor();a={lo_metadata:p,time:a,success:s};"undefined"!=typeof g&&(a.scorm_success_status=g);"undefined"!=
typeof t&&(a.scorm_scaled_score=t);"undefined"!=typeof l&&(a.scorm_completion_status=l);"undefined"!=typeof k&&(a.scorm_progress_measure=k);u();return a},isStopped:function(){return b}}}();SGAME.TrafficLight=function(d){var b,f,p,m,r,s=function(d){var f=document.getElementById("trafficLight");f&&(b=d,f.src=g(d))},g=function(b){switch(b){case "green":return"/assets/sgame/trafficLight/trafficLight_green.png";case "yellow":return"/assets/sgame/trafficLight/trafficLight_yellow.png";case "red":return"/assets/sgame/trafficLight/trafficLight_red.png";default:return"/assets/sgame/trafficLight/trafficLight.png"}},t=function(b,d){var f=document.getElementById("trafficLight");if(f){var a=!1;m=
setInterval(function(){f&&(a?(f.src=g(null),a=!1):(f.src=g(b),a=!0))},500);r=setTimeout(function(){clearTimeout(m)},1E3*d)}};return{getCurrentColor:function(){return b},changeColor:function(b,d){d?f=setTimeout(function(){s(b)},1E3*d):s(b)},setUpBlink:function(b,d,f){f?p=setTimeout(function(){t(b,d)},1E3*f):t(b,d)},stop:function(){f&&clearTimeout(f);p&&clearTimeout(p);m&&clearTimeout(m);r&&clearTimeout(r)}}}();SGAME.Utils=function(){var d=void 0;return{init:function(b){},getRandomElement:function(b){if("number"==typeof b)return b;var d;d=b.length-1;if("number"!=typeof d)throw{name:"Invalid number format exception"};d=Math.round(0+Math.random()*(d-0));return b[d]},loadScript:function(b,d){if("string"===typeof b&&"function"===typeof d){var p=document.getElementsByTagName("head")[0];if(p){var m=document.createElement("script");m.setAttribute("src",b);m.setAttribute("type","text/javascript");m.onreadystatechange=
function(){"complete"!=this.readyState&&"loaded"!=this.readyState||d()};m.onload=d;p.appendChild(m)}}},getProtocol:function(){if("undefined"!==typeof d)return d;var b;try{b=document.location.protocol}catch(f){}"string"===typeof b&&(b=b.match(/[\w]+/),b=b instanceof Array&&"string"===typeof b[0]?b[0]:void 0);return d="string"===typeof b?b:"unknown"},checkUrlProtocol:function(b){if("string"===typeof b){var d=b.match(/^https?:\/\//);if(d instanceof Array&&1===d.length){var d=d[0].replace("://",""),p=
SGAME.Utils.getProtocol();if(d!==p)switch(p){case "https":b="https"+b.replace(d,"")}}}return b}}}();
