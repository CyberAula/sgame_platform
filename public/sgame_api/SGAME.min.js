iso8601Parser=function(d){return{getDuration:function(k){var d=[31104E3,2592E3,604800,86400,3600,60,1];try{var n;var p=k;k=[2,3,4,5,7,8,9];var s=[0,0,0,0,0,0,0],r;if(p=p.toUpperCase()){if("string"!==typeof p)throw Error("Invalid iso8601 period string '"+p+"'");if(r=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(p))for(p=0;p<k.length;p++){var a=k[p];s[p]=r[a]?+r[a].replace(/[A-Za-z]+/g,""):0}else throw Error("String '"+p+"' is not a valid ISO8601 period.");}n=s}catch(l){return null}for(a=
r=0;a<n.length;a++)r+=n[a]*d[a];return r}}}();function Local_API_1484_11(d){function k(b,a){f.diganostic="The "+b+" of "+a+" must be a proper vocabulary element.";f.errorCode=406;return"false"}function q(b){f.errorCode=402;f.diagnostic="The value for key "+b+" has not been created yet.";return"false"}function n(b,a){f.errorCode=201;f.diagnostic="The value for key "+b+" is not valid.";return"false"}function p(b,a,h){b=b.split(/\./);2>b.length?h[b[0]]=a:(h[b[0]]||(h[b[0]]={}),h=h[b.shift()],p(b.join("."),a,h))}function s(b,a){var h=b.split(/\./),
e;if(2>h.length)try{return a[h[0]]}catch(c){return q(b),"false"}else{e=h.shift();if(a[e])return String(s(h.join("."),a[e]));q(b);return"false"}}function r(b){var a,h=0;for(a in b)b.hasOwnProperty(a)&&(h+=1);return h}function a(b,a){if(f.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(a){case 1:console.error(b);break;case 2:console.warn(b);break;case 4:console.info(b);
break;case 3:console.log(b);break;default:return console.log(b),!1}return!0}3>a&&f.throw_alerts&&alert(b);return!1}function l(b,a){if("function"==typeof f.listeners[b]&&"undefined"!=typeof a)f.listeners[b](a)}function g(b,a){for(var h in a)a.hasOwnProperty(h)&&("object"==typeof b[h]?"object"==typeof a[h]&&(b[h]=g(b[h],a[h])):b[h]=a[h]);return b}function c(b,a){(function(){function b(a,h){h=h||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(a,h.bubbles,
h.cancelable,h.detail);return e}if("function"===typeof window.CustomEvent)return!1;b.prototype=window.Event.prototype;window.CustomEvent=b})();document.dispatchEvent(new CustomEvent(b,{detail:a}))}function u(b){return"object"!==type(b)||b.nodeType||isWindow(b)?!1:!(b.constructor&&!hasOwn.call(b.constructor.prototype,"isPrototypeOf"))}var f=g({version:"2.4",prefix:"Local_API_1484_11",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"1.0",comments_from_learner:{_children:"comment,location,timestamp",
_count:"0"},comments_from_lms:{_children:"comment,location,timestamp",_count:"0"},completion_status:"unknown",completion_threshold:"0.7",credit:"credit",entry:"ab-initio",exit:"",interactions:{_children:"id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description",_count:"0"},launch_data:"",learner_id:"100",learner_name:"Simulated User",learner_preference:{_children:"audio_level,language,delivery_speed,audio_captioning",audio_level:"1",language:"",delivery_speed:"1",
audio_captioning:"0"},location:"",max_time_allowed:"",mode:"normal",objectives:{_children:"id,score,success_status,completion_status,description",_count:"0"},progress_measure:"",scaled_passing_score:"0.5",score:{_children:"scaled,raw,min,max",scaled:"",raw:"",min:"",max:""},session_time:"PT0H0M0S",success_status:"unknown",suspend_data:"",time_limit_action:"",total_time:"PT0H0M0S"}},d),e={},h={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",
111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",
403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},t=this;this.isRunning=function(){return 1===f.initialized&&0===f.terminated};this.Initialize=function(){a(f.prefix+":  Initializing...",3);f.cmi?(e=f.cmi,"suspend"===e.exit&&(e.entry="resume")):e=f.CMI;f.initialized=1;f.terminated=0;return"true"};this.GetValue=
function(b){f.errorCode=0;var h="false";b=b.toString();var c=[];if(this.isRunning()){c=b.split(".");if(0<="|exit|session_time|".indexOf("|"+c[c.length-1]+"|"))return a(f.prefix+": This "+b+" is write only",4),f.errorCode=405,"false";c=b.toLowerCase().split(".");switch(c[0]){case "cmi":switch(h="false",b){case "cmi.exit":case "cmi.session_time":f.errorCode=405;f.diagnostic="Sorry, this has been specified as a read-only value for "+b;break;case "cmi.learner_name":h=f.CMI.learner_name;break;default:h=
s(b.substr(4,b.length),e),"undefined"===h&&(f.errorCode=401,f.diagnostic="Sorry, there was a undefined response from "+b,h="false"),a(f.prefix+": GetValue "+b+" = "+h,4)}}return h}f.errorCode=123;return h};this.SetValue=function(b,h){a(f.prefix+": SetValue: "+b+" = "+h,4);f.errorCode=0;var c=[],g=b.toString(),d=h.toString(),m=0,t=0,m=[];if(this.isRunning()){m=g.split(".");if("adl"===m[0]&&"id"===m[4]||"comments_from_lms"===m[1]||("comments_from_learner"===m[1]?0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+
m[m.length-1]+"|")))return a(f.prefix+": This "+g+" is read only",4),f.errorCode=404,"false";c=g.split(".");switch(c[0]){case "cmi":switch(b){case "cmi.location":1E3<d.length&&a(f.prefix+": Some LMS's might truncate your bookmark as you've passed "+d.length+" characters of bookmarking data",2);break;case "cmi.progress_measure":m=parseFloat(d);if("number"!=typeof m||isNaN(m))return n(b,d);m=Math.max(0,Math.min(1,m));l(b,m);break;case "cmi.completion_status":if(-1==="|completed|incomplete|not attempted|unknown|".indexOf("|"+
d+"|"))return k(b,d);l(b,d);break;case "cmi.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+d+"|"))return k(b,d);break;case "cmi.score.scaled":m=parseFloat(d);if("number"!=typeof m||isNaN(m))return n(b,d);m=Math.max(0,Math.min(1,m));l(b,m);break;case "cmi.score.min":m=parseFloat(d);if("number"!=typeof m||isNaN(m))return n(b,d);f.CMI.score.min=m;break;case "cmi.score.max":m=parseFloat(d);if("number"!=typeof m||isNaN(m))return n(b,d);f.CMI.score.max=m;break;case "cmi.score.raw":m=parseFloat(d);
if("number"!=typeof m||isNaN(m))return n(b,d);t=parseFloat(f.CMI.score.max);t="number"!=typeof t||isNaN(t)?100:t;c=parseFloat(f.CMI.score.min);c="number"!=typeof c||isNaN(c)?0:c;t-=c;0>=t&&(t=100);m=Math.max(0,Math.min(1,(m-c)/t));l("cmi.score.scaled",m);break;case "cmi.success_status":if(-1==="|passed|failed|unknown|".indexOf("|"+d+"|"))return k(b,d);l(b,d);break;default:switch(c[1]){case "comments_from_lms":return f.errorCode="404",f.diagnostic="The cmi.comments_from_lms element is entirely read only.",
"false";case "comments_from_learner":if(-1===e.comments_from_learner._children.indexOf(c[3]))return k(b,d);p(g.substr(4,g.length),d,e);e.comments_from_learner._count=(r(e.comments_from_learner)-2).toString();return"true";case "interactions":if(-1===e.interactions._children.indexOf(c[3]))return k(b,d);e.interactions._count=(r(e.interactions)-2).toString();if(isNaN(parseInt(c[2],10)))return"false";if(!u(e.interactions[c[2]])){if("id"===c[3])return e.interactions[c[2]]={},p(g.substr(4,g.length),d,e),
e.interactions._count=(r(e.interactions)-2).toString(),u(e.interactions[c[2]].objectives)||(a(f.prefix+": Constructing objectives object for new interaction",4),e.interactions[c[2]].objectives={},e.interactions[c[2]].objectives._count="-1"),u(e.interactions[c[2]].correct_responses)||(a(f.prefix+": Constructing correct responses object for new interaction",4),e.interactions[c[2]].correct_responses={},e.interactions[c[2]].correct_responses._count="-1"),"true";a("Can't add interaction without ID first!",
3);return"false"}if("objectives"===c[3]){if("id"===c[5])for(t=parseInt(e.interactions[c[2]].objectives._count,10),m=0;m<t;m+=1){if(e.interactions[c[2]].objectives[m].id===d)return g=b,f.errorCode="351",f.diagnostic="The "+g+" element must be unique.  The value '"+d+"' has already been set in #"+m,"false"}else return k(b,d);p(g.substr(4,g.length),d,e);e.interactions[c[2]].objectives._count=(r(e.interactions[c[2]].objectives)-1).toString();return"true"}"correct_responses"===c[3]&&(p(g.substr(4,g.length),
d,e),e.interactions[c[2]].correct_responses._count=(r(e.interactions[c[2]].correct_responses)-1).toString());p(g.substr(4,g.length),d,e);e.interactions._count=(r(e.interactions)-2).toString();return"true";case "objectives":if("id"===c[3])for(t=parseInt(e.objectives._count,10),m=0;m<t;m+=1)if(e.objectives[m].id===d)return f.errorCode="351",f.diagnostic="The objectives.id element must be unique.  The value '"+d+"' has already been set in objective #"+m,"false";if("id"!==c[3]&&(m=parseInt(c[2],10),void 0===
e.objectives[m]))return f.errorCode="408",f.diagnostic="The objectives.id element must be set before other elements can be set","false";if(isNaN(parseInt(c[2],10)))return"false";p(g.substr(4,g.length),d,e);e.objectives._count=(r(e.objectives)-2).toString();return"true"}}p(g.substr(4,g.length),d,e)}return"true"}f.errorCode=f.terminated?133:132;return"false"};this.Commit=function(){a(f.prefix+": Commit CMI Object:",4);a(e);a(f.prefix+": Suspend Data Usage "+(Math.round(100*(e.suspend_data.length/64E3)*
Math.pow(10,2))/Math.pow(10,2)+"%"));c("StoreData",{runtimedata:e});return"true"};this.Terminate=function(){t.Commit();f.terminated=1;f.initialized=0;return"true"};this.GetErrorString=function(b){return""!==b&&(b=parseInt(b,10),void 0!==h[b])?h[b]:""};this.GetLastError=function(){return f.errorCode};this.GetDiagnostic=function(){return f.diagnostic};this.setCMILMSValue=function(b,a){"string"==typeof b&&(f.CMI[b]=a)};this.addListener=function(b,a){"string"==typeof b&&"function"==typeof a&&(f.listeners[b]=
a)}};function Local_API_SCORM_12(d){function k(a,e){c.diganostic="The "+a+" of "+e+" must be a proper vocabulary element.";c.errorCode=406;return"false"}function q(a){c.errorCode=402;c.diagnostic="The value for key "+a+" has not been created yet.";return"false"}function n(a,e){c.errorCode=201;c.diagnostic="The value for key "+a+" is not valid.";return"false"}function p(a,c,b){a=a.split(/\./);2>a.length?b[a[0]]=c:(b[a[0]]||(b[a[0]]={}),b=b[a.shift()],p(a.join("."),c,b))}function s(a,c){var b=a.split(/\./),
e;if(2>b.length)try{return c[b[0]]}catch(d){return q(a),"false"}else{e=b.shift();if(c[e])return String(s(b.join("."),c[e]));q(a);return"false"}}function r(a,e){if(c.debug){window.console||(window.console={},window.console.info=noconsole,window.console.log=noconsole,window.console.warn=noconsole,window.console.error=noconsole,window.console.trace=noconsole);switch(e){case 1:console.error(a);break;case 2:console.warn(a);break;case 4:console.info(a);break;case 3:console.log(a);break;default:return console.log(a),
!1}return!0}3>e&&c.throw_alerts&&alert(a);return!1}function a(a,e){if("function"==typeof c.listeners[a]&&"undefined"!=typeof e)c.listeners[a](e)}function l(a,c){for(var b in c)c.hasOwnProperty(b)&&("object"==typeof a[b]?"object"==typeof c[b]&&(a[b]=l(a[b],c[b])):a[b]=c[b]);return a}function g(a,c){(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");e.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return e}if("function"===typeof window.CustomEvent)return!1;
a.prototype=window.Event.prototype;window.CustomEvent=a})();document.dispatchEvent(new CustomEvent(a,{detail:c}))}var c=l({version:"1.1",prefix:"Local_API_SCORM_12",errorCode:0,diagnostic:"",initialized:0,terminated:0,debug:!0,listeners:{},CMI:{_version:"3.4",comments:"",comments_from_lms:"",launch_data:"",suspend_data:"",core:{entry:"ab-initio",credit:"credit",lesson_status:"not attempted",lesson_mode:"normal",lesson_location:"",student_id:"100",student_name:"Simulated User",student_preference:{_children:"audio,language,speed,text",
audio:"0",language:"",speed:"0",text:"0"},score:{_children:"raw,min,max",raw:"",max:"",min:""},total_time:"0000:00:00.00",session_time:"",exit:""},student_data:{_children:"mastery_score,time_limit_action,max_time_allowed",mastery_score:"50",max_time_allowed:"",time_limit_action:"continue,no message"}}},d),u={},f={0:"No error",101:"General exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",
113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",
405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established"},e=this;this.isRunning=function(){return 1===c.initialized&&0===c.terminated};this.LMSInitialize=function(){r(c.prefix+":  Initializing...",3);u=c.CMI;c.initialized=1;c.terminated=0;return"true"};this.LMSGetValue=function(a){c.errorCode=0;var e="false";a=a.toString();var b=[];if(this.isRunning()){b=a.split(".");if(0<="|exit|session_time|".indexOf("|"+
b[b.length-1]+"|"))return c.errorCode=405,"false";b=a.toLowerCase().split(".");switch(b[0]){case "cmi":e=a;a="false";switch(e){case "cmi.core.exit":case "cmi.core.session_time":c.errorCode=405;c.diagnostic="Sorry, this has been specified as a read-only value for "+e;break;default:e=e.replace("cmi.",""),a=s(e,u),"undefined"===a&&(c.errorCode=401,c.diagnostic="Sorry, there was a undefined response from "+e,a="false")}e=a}return e}c.errorCode=123;return e};this.LMSSetValue=function(e,d){r(c.prefix+": SetValue: "+
e+" = "+d,4);c.errorCode=0;var b=[],g=e.toString(),f=d.toString();if(this.isRunning()){var b=g.split("."),l=b[b.length-1],b="adl"===b[0]&&"id"===b[4]?!0:"comments_from_lms"===b[1]?!0:0<="|_version|completion_threshold|credit|entry|launch_data|learner_id|learner_name|_children|_count|mode|maximum_time_allowed|scaled_passing_score|time_limit_action|total_time|comment|".indexOf("|"+l+"|");if(b)return c.errorCode=404,"false";b=g.split(".");switch(b[0]){case "cmi":switch(e){case "cmi.core.lesson_location":1E3<
f.length&&r(c.prefix+": Some LMS's might truncate your bookmark as you've passed "+f.length+" characters of bookmarking data",2);break;case "cmi.core.lesson_status":if(-1==="|passed|completed|failed|incomplete|browsed|not attempted|unknown|".indexOf("|"+f+"|"))return k(e,f);a(e,f);break;case "cmi.core.exit":if(-1==="|time-out|suspend|logout|normal||".indexOf("|"+f+"|"))return k(e,f);break;case "cmi.core.score.min":b=parseFloat(f);if("number"!=typeof b||isNaN(b))return n(e,f);c.CMI.core.score.min=
b;break;case "cmi.core.score.max":b=parseFloat(f);if("number"!=typeof b||isNaN(b))return n(e,f);c.CMI.core.score.max=b;break;case "cmi.core.score.raw":b=parseFloat(f);if("number"!=typeof b||isNaN(b))return n(e,f);var q=parseFloat(c.CMI.core.score.max),q="number"!=typeof q||isNaN(q)?100:q,l=parseFloat(c.CMI.core.score.min),l="number"!=typeof l||isNaN(l)?0:l,q=q-l;0>=q&&(q=100);b=Math.max(0,Math.min(1,(b-l)/q));a("cmi.score.scaled",b)}g=g.replace("cmi.","");p(g,f,u)}return"true"}c.errorCode=c.terminated?
133:132;return"false"};this.LMSCommit=function(){g("StoreData",{runtimedata:u});return"true"};this.LMSTerminate=function(){e.LMSCommit();c.terminated=1;c.initialized=0;return"true"};this.LMSFinish=function(){e.LMSCommit();c.terminated=1;c.initialized=0;return"true"};this.LMSGetErrorString=function(a){return""!==a&&(a=parseInt(a,10),void 0!==f[a])?f[a]:""};this.LMSGetLastError=function(){return c.errorCode};this.LMSGetDiagnostic=function(){return c.diagnostic};this.setCMILMSValue=function(a,e){"string"==
typeof a&&(c.CMI[a]=e)};this.addListener=function(a,e){"string"==typeof a&&"function"==typeof e&&(c.listeners[a]=e)}};SGAME=function(){return{init:function(d){SGAME.CORE.init(d)},loadSettings:function(d){SGAME.CORE.loadSettings(d)},triggerLO:function(d,k){SGAME.CORE.triggerLO(d,k)},showLO:function(d,k){SGAME.CORE.showLO(d,k)},showRandomLO:function(d){SGAME.CORE.showRandomLO(d)},closeLO:function(){SGAME.CORE.closeLO()}}}();SGAME.VERSION="0.4";SGAME.AUTHORS="Aldo Gordillo, Enrique Barra";SGAME.URL="https://github.com/ging/sgame_platform";SGAME.Debugger=function(){var d=!1;return{init:function(k){!0===k&&(d=k)},isDebugging:function(){return d},log:function(k){d&&window.console&&console.log(k)}}}();SGAME.API=function(){var d=function(d,q){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var d=JSON.parse(n.responseText);q(d)}};n.open("GET",d,!0);n.send("")};return{init:function(){},requestLOMetadata:function(k,q,n){try{d("undefined"==typeof k?"/lo/random/metadata.json":"/lo/"+k+"/metadata.json",function(d){q(d)})}catch(p){n(p)}}}}();SGAME.CORE=function(){var d={},k=[],q={},n=void 0;SGAME.Debugger.init(!0);var p=function(a,d){"object"!=typeof a||"string"!=typeof a.url?"function"==typeof d&&d(null,null):(s(),SGAME.Fancybox.create({lo:a},function(a){"function"==typeof d&&d(a.success,a);s()}))},s=function(){"function"===typeof n&&n()},r=function(a){var d;d=[];for(var g=0;g<a.length;g++)!1===a[g].marked&&d.push(a[g]);if(0<d.length)d=SGAME.Utils.getRandomElement(d);else{for(g=0;g<a.length;g++)a[g].marked=!1;d=SGAME.Utils.getRandomElement(a)}"undefined"!=
typeof d&&(a[a.indexOf(d)].marked=!0);return{lo:d,los:a}};return{init:function(a){SGAME.Debugger.log("SGAME init with options ");SGAME.Debugger.log(a);a&&"function"===typeof a.togglePause&&(n=a.togglePause)},loadSettings:function(a){SGAME.Debugger.log("SGAME load settings ");SGAME.Debugger.log(a);d={};k=[];q={};if(a.lo_list)for(var l=0;l<a.lo_list.length;l++)"undefined"!=typeof a.lo_list[l].id&&(d[a.lo_list[l].id]=a.lo_list[l],k.push({id:a.lo_list[l].id,marked:!1}));if(a.event_mapping)for(l=0;l<a.event_mapping.length;l++){var g=
a.event_mapping[l];q[g.event_id]={};q[g.event_id].los=[];for(var c=0;c<g.los_id.length;c++)q[g.event_id].los.push({id:g.los_id[c],marked:!1})}},triggerLO:function(a,l){var g=[];"undefined"!=typeof q[a]&&(g=q[a].los);if(g&&g instanceof Array&&0<g.length){var c;a:{for(c=0;c<g.length;c++)if("*"===g[c].id){c=!0;break a}c=!1}c?(g=r(k),k=g.los):(g=r(g),q[a].los=g.los);"undefined"!=typeof g.lo?p(d[g.lo.id],l):"function"==typeof l&&l(null,null)}else"function"==typeof l&&l(null,null)},showLO:p,showRandomLO:function(a){SGAME.API.requestLOMetadata(void 0,
function(d){p(d,a)},function(){"function"==typeof a&&a(null,null)})},closeLO:function(){SGAME.Fancybox.closeCurrentFancybox()}}}();var API,API_1484_11;
SGAME.Fancybox=function(d){var k=d,q=d,n=function(){"undefined"!=typeof k&&(k.style.display="none",k.parentNode.removeChild(k),API_1484_11=API=k=d)},p=function(){n();var k=SGAME.Observer.stop();"function"===typeof q&&q(k);q=d};return{init:function(){},create:function(s,r){n();q=r;var a=850,l=650,g={},c;s&&(s.width&&(a=s.width),s.height&&(l=s.height),s.lo&&(g=s.lo),"string"==typeof g.url&&(c=g.url));var u=window.innerHeight-8,f=window.innerWidth-8,l=Math.min(l,u),a=Math.min(a,f);if("string"==typeof c&&
"undefined"!=typeof g.scorm_type){var e=d;API_1484_11=API=d;"sco"===g.scorm_type&&("1.2"===g.scorm_version?e=API=new Local_API_SCORM_12({debug:SGAME.Debugger.isDebugging()}):"2004"===g.scorm_version&&(e=API_1484_11=new Local_API_1484_11({debug:SGAME.Debugger.isDebugging()})));var h=document.createElement("div");h.style.width=a+"px";h.style.height=l+"px";h.style.maxWidth=f+"px";h.style.maxHeight=u+"px";h.style.overflow="hidden";h.style.background="white";h.style.position="absolute";h.style.top=0;h.style.zIndex=
9999;h.style.borderRadius="1em";h.style.border="2px solid black";h.setAttribute("id","sgame_fancybox");h.style.marginLeft=(window.innerWidth-a)/2+"px";h.style.marginTop=(window.innerHeight-l)/2+"px";a=document.createElement("img");a.src="/assets/sgame/close.png";a.style.width="25px";a.style.height="25px";a.style.padding="5px";a.style.cursor="pointer";a.style.position="absolute";a.style.right=0;a.onclick=function(){p()};h.appendChild(a);a=document.createElement("img");a.id="trafficLight";a.src="/assets/sgame/trafficLight/trafficLight_red.png";
a.style.width="45px";a.style.height="40px";a.style.padding="5px";a.style.position="absolute";a.style.left="0px";a.style.top="0px";h.appendChild(a);a=document.createElement("iframe");a.src=c;a.style.width="94%";a.style.height="94%";a.style.marginLeft="3%";a.style.marginTop="3%";a.style.overflow="hidden";a.style.overflowY="auto";a.scrolling="yes";a.style.frameBorder="0";a.style.borderStyle="none";a.setAttribute("allowfullscreen","false");h.appendChild(a);k=h;document.body.appendChild(h);SGAME.Observer.start(a,
g,e)}},closeCurrentFancybox:p}}();SGAME.Observer=function(d){var k=!0,q=d,n=d,p=d,s,r,a,l,g,c,u=function(){p=n=q=d;s=Date.now();r=!1;c=g=l=a=d},f=function(){"sco"==n.scorm_type&&"undefined"!=typeof p&&(p.addListener("cmi.success_status",function(c){a=c;"passed"===a&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),p.addListener("cmi.score.scaled",function(a){l=a;0.8<=l&&"green"!=SGAME.TrafficLight.getCurrentColor()&&(SGAME.TrafficLight.stop(),SGAME.TrafficLight.changeColor("green"))}),
p.addListener("cmi.completion_status",function(a){g=a}),p.addListener("cmi.progress_measure",function(a){c=a}))};return{start:function(a,c,d){if(!1===k||"undefined"!=typeof q)return null;k=!1;u();q=a;n=c;p=d;f();SGAME.TrafficLight.changeColor("red");if("asset"==n.scorm_type){b:{a=n.lom_metadata;if(a.educational&&a.educational.typicalLearningTime&&a.educational.typicalLearningTime.duration&&a.educational.typicalLearningTime.duration.langstrings&&a.educational.typicalLearningTime.duration.langstrings["x-none"]&&
(a=iso8601Parser.getDuration(a.educational.typicalLearningTime.duration.langstrings["x-none"])))break b;a=null}a=a?Math.min(0.5*a,60):15;SGAME.TrafficLight.setUpBlink("yellow",0.5*a-0.5,0.5*a);SGAME.TrafficLight.changeColor("green",a)}},stop:function(){if(!0===k||"undefined"==typeof q)return null;k=!0;SGAME.TrafficLight.stop();var d=Math.round((Date.now()-s)/1E3);r="green"===SGAME.TrafficLight.getCurrentColor();d={lo_metadata:n,time:d,success:r};"undefined"!=typeof a&&(d.scorm_success_status=a);"undefined"!=
typeof l&&(d.scorm_scaled_score=l);"undefined"!=typeof g&&(d.scorm_completion_status=g);"undefined"!=typeof c&&(d.scorm_progress_measure=c);u();return d},isStopped:function(){return k}}}();SGAME.TrafficLight=function(d){var k,q,n,p,s,r=function(d){var c=document.getElementById("trafficLight");c&&(k=d,c.src=a(d))},a=function(a){switch(a){case "green":return"/assets/sgame/trafficLight/trafficLight_green.png";case "yellow":return"/assets/sgame/trafficLight/trafficLight_yellow.png";case "red":return"/assets/sgame/trafficLight/trafficLight_red.png";default:return"/assets/sgame/trafficLight/trafficLight.png"}},l=function(d,c){var k=document.getElementById("trafficLight");if(k){var f=!1;p=
setInterval(function(){k&&(f?(k.src=a(null),f=!1):(k.src=a(d),f=!0))},500);s=setTimeout(function(){clearTimeout(p)},1E3*c)}};return{getCurrentColor:function(){return k},changeColor:function(a,c){c?q=setTimeout(function(){r(a)},1E3*c):r(a)},setUpBlink:function(a,c,d){d?n=setTimeout(function(){l(a,c)},1E3*d):l(a,c)},stop:function(){q&&clearTimeout(q);n&&clearTimeout(n);p&&clearTimeout(p);s&&clearTimeout(s)}}}();SGAME.Utils=function(){return{init:function(d){},getRandomElement:function(d){if("number"==typeof d)return d;var k;k=d.length-1;if("number"!=typeof k)throw{name:"Invalid number format exception"};k=Math.round(0+Math.random()*(k-0));return d[k]},loadScript:function(d,k){if("string"===typeof d&&"function"===typeof k){var q=document.getElementsByTagName("head")[0];if(q){var n=document.createElement("script");n.setAttribute("src",d);n.setAttribute("type","text/javascript");n.onreadystatechange=function(){"complete"!=
this.readyState&&"loaded"!=this.readyState||k()};n.onload=k;q.appendChild(n)}}}}}();
