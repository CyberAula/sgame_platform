var VISH = VISH || {};
VISH.Locales = {"en":{"i.About":"About", "i.About2":"Code available at", "i.About3":"visit our YouTube Channel", "i.About4":"Developed by", "i.VESurvey1":"Help us to improve ViSH Editor", "i.VESurvey2":"Please fill", "i.VESurvey3":"this survey", "i.VESurvey4":"Thank you for your collaboration", "i.accept":"accept", "i.add":"add", "i.Add":"Add", "i.Addanavatar":"Add an avatar *", "i.AddanavatarHover":"Click to add an avatar. You should select an avatar to identify your excursion", "i.addatitle":"add a title", 
"i.AddContent":"Add Content", "i.addembeddedobject":"add embedded object", "i.AddePackage":"Add an e-Learning package from a ZIP file. Supported formats: SCORM and custom HTML5 Web Applications.", "i.addpicurl":"add image url", "i.AddSlide":"Add Slide", "i.AddSlideMin":"Add Slide", "i.AddSlides":"Add Slides", "i.AddslideshowPDF":"Add slideshow from PDF file", "i.AddTags":"Add tags", "i.AddTimestampLink":"Add timestamp link", "i.addvideourl":"add video url (YouTube, HTML5)", "i.advancedSettings":"Advanced", 
"i.AgeRange":"Age Range", "i.allowUsersTo":"Allow other users to:", "i.AllowClone":"Clone", "i.allowComment":"Comment", "i.allowDownload":"Download", "i.Animations":"Animations", "i.areyousureNotification":"are you sure?", "i.Art":"Art", "i.Astronomy":"Astronomy", "i.Attatchment":"Attatchment", "i.AudienceResponseSystem":"Audience Response System", "i.Author":"Author", "i.Background":"Background", "i.biology":"biology", "i.Biology":"Biology", "i.browserrequirements":"Your browser does not meet the minimum requirements to init ViSH Editor, please update your browser.", 
"i.by":"by", "i.cancel":"cancel", "i.Cancel":"Cancel", "i.Catalog":"Catalog", "i.CatalogueTitle":"Catalogue", "i.Chemistry":"Chemistry", "i.Citizenship":"Citizenship", "i.ClassicalLanguages":"Classical Languages", "i.close":"close", "i.Close":"Close", "i.CloseWSaving":"close without saving", "i.content":"content", "i.Content":"Content", "i.Context":"Context", "i.continue":"continue", "i.Continue":"Continue", "i.CrossCurricularEducation":"Cross Curricular Education", "i.ComputerScience":"Computer Science", 
"i.delete":"delete", "i.Description":"Description", "i.Diagonal1":"Diagonal #1", "i.Diagonal2":"Diagonal #2", "i.difficult":"difficult", "i.Difficulty":"Difficulty", "i.Documentation":"Documentation", "i.done":"done", "i.Done":"Done", "i.draft":"draft", "i.easy":"easy", "i.Economics":"Economics", "i.edit":"edit", "i.Education":"Education", "i.EducationalObjectives":"Educational objectives", "i.EducationalObjectivesPlaceholder":"Please describe the educational objectives you aim to fulfil by using this excursion...", 
"i.Electronics":"Electronics", "i.Elements":"Elements", "i.embedwebsite":"embed website", "i.embedWebSnapshot":"embed Web Snapshot", "i.Enable":"Enable", "i.enableRTE":"Enable object tracking when it is exported to SCORM", "i.EnrichedVideo":"Enriched Video", "i.EnvironmentalEducation":"Environmental Education", "i.ePackage":"e-Learning Package", "i.ePackageError1":"An error ocurred when uploading the e&#8209;Learning package.", "i.errorFlickrConnection":"Error connecting to Flickr", "i.errorEuropeanaConnection":"Error connecting to Europeana", 
"i.errorLREConnection":"Error connecting to the LRE repository", "i.errorViSHConnection":"Error connecting to ViSH server", "i.errorYoutubeConnection":"Error connecting to YouTube", "i.errorSoundCloudConnection":"Error connecting to SoundCloud", "i.Ethics":"Ethics", "i.Evaluate":"Evaluate", "i.evaluateTitle":"Want to contribute evaluating the excursion?", "i.eVideoChangeNotification":"If you change the v\u00eddeo source you will lose all the timestamp links you have added. In any case, you will keep the slides you have created. Are you sure you want to continue?", 
"i.Exit":"Exit", "i.exitConfirmation":"You are about to leave ViSH Editor. You will lose any changes you have not saved.", "i.exitConfirmation2":"Are you sure you want to leave this page?", "i.exitConfirmationMenu":"The Virtual Excursion has been modified. If you close without saving you will lose all changes. What would you like to do?", "i.ExitWSaving":"exit without saving", "i.Export":"Export", "i.exportPresToJSONerrorNotification":"An error has ocurred. Is not possible to export the presentation to a JSON file.", 
"i.exportPresToSCORMerrorNotification":"An error has ocurred. Is not possible to export the presentation to a SCORM package.", "i.exportQuizToQTIerrorNotification":"An error has ocurred. Is not possible to export the quiz to the IMS QTI 2.1 format.", "i.exportQuizToMoodleXMLerrorNotification":"An error has ocurred. Is not possible to export the quiz to Moodle XML format.", "i.ExportToIMSQTI":"Export to IMS QTI 2.1", "i.ExportToMoodleXML":"Export to Moodle XML", "i.exviews":"views", "i.File":"File", 
"i.Filllater":"Fill later", "i.Finish":"Finish", "i.Flip1":"Flip #1", "i.Flip2":"Flip #2", "i.ForeignLanguages":"Foreign Languages", "i.Game":"Game", "i.GeneralCulture":"General Culture", "i.Geography":"Geography", "i.Geology":"Geology", "i.GotoSettings":"Go to Settings", "i.HealthEducation":"Health Education", "i.Help":"Help", "i.HigherEducation":"Higher Education", "i.History":"History", "i.HomeEconomics":"Home Economics", "i.Horizontal":"Horizontal", "i.Hours":"Hours", "i.Image":"Image", "i.Images":"Images", 
"i.Import":"Import", "i.ImportFromEFile":"Import resources from external files:", "i.ImportFromEFileVEJSON":"ViSH Editor Presentations and Slides from JSON files", "i.ImportFromEFileIMSQTI":"Quizzes from IMS QTI 2.1 compliant XML files", "i.ImportFromEFileMoodleXML":"Quizzes from MoodleXML compliant XML files", "i.Insert":"Insert", "i.Inside":"Inside", "i.invalidvalue":"invalid value", "i.ItemAndBall":"This item is linked to the #{letter} slide of the Enriched Video.", "i.Language":"Language", "i.Languageindependent":"Language independent", 
"i.Law":"Law", "i.License":"License", "i.License_public":"Public Domain", "i.License_cc-by":"Creative Commons Attribution", "i.License_cc-by-sa":"Creative Commons Attribution-ShareAlike", "i.License_cc-by-nd":"Creative Commons Attribution-NoDerivs", "i.License_cc-by-nc":"Creative Commons Attribution-NonCommercial", "i.License_cc-by-nc-sa":"Creative Commons Attribution-NonCommercial-ShareAlike", "i.License_cc-by-nc-nd":"Creative Commons Attribution-NonCommercial-NoDerivs", "i.License_private":"None (All rights reserved)", 
"i.limitReached":"limit reached", "i.link":"link", "i.Link":"Link", "i.Literature":"Literature", "i.LiveQuiz":"Live Quiz", "i.LiveResources":"Live Resources", "i.MandatoryFieldsNotification":"You need to write a title for the excursion and select an avatar before publish the excursion", "i.math":"math", "i.Mathematics":"Mathematics", "i.medium":"medium", "i.Minutes":"Minutes", "i.Music":"Music", "i.nanoscience":"nanoscience", "i.NaturalSciences":"Natural Sciences", "i.NAttempts":"Number of Attempts", 
"i.next":"next", "i.Next":"Next", "i.no":"no", "i.notify_teacher":"Notify", "i.notifed_teacher":"Notified", "i.notify_teacher_confirmation":"Did you finish your work and want to notify teacher for publishing it?", "i.No":"No", "i.NoFileError":"You have not selected any file to import.", "i.NoJSONFileError":"You have to select a file to import in JSON format", "i.Noresultsfound":"No results found", "i.NoSlidesOnSaveNotification":"Create at least one slide before saving.", "i.NoThanks":"No thanks", 
"i.NoSupportedFileError":"The file cannot be imported. The format is not supported.", "i.Object":"Object", "i.Objects":"Objects", "i.Ok":"Ok", "i.OK":"OK", "i.Opacity":"Opacity", "i.Options":"Options", "i.or":"or", "i.OSettingsUnload":"Unload the object when the slide disappears", "i.Other":"Other", "i.Others":"Others", "i.Package":"Package", "i.pasteEmbedObject":"paste SWF or PDF file URL", "i.pasteImageURL":"paste image URL", "i.pasteVideoURL":"paste HTML5 or YouTube v\u00eddeo URL", "i.pasteWeb":"paste website URL", 
"i.pdfErrorNotification":"An error has occurred. Ensure that the PDF file is valid.", "i.pdfErrorNotificationFormat":"An error has occurred. The file format is not valid.", "i.pdfErrorNotificationSize":"An error has occurred. The size of the PDF file must be smaller than 8 Mb.", "i.pdfErrorNotificationPages":"An error has occurred. The PDF file have too many pages.", "i.PDFSlideshow":"PDF Slideshow", "i.MetadataAspects":"Metadata", "i.pEducation":"Primary Education", "i.Philosophy":"Philosophy", 
"i.PhysicalEducation":"Physical Education", "i.Physics":"Physics", "i.Politics":"Politics", "i.Preschool":"Preschool Education", "i.Presentation":"Presentation", "i.PresentationsRepository":"Search on the repository the presentation you would like to import", "i.presDescriptionPlaceHolder":"Please describe in a few words what your excursion is about", "i.presTitle":"Excursion title", "i.Preview":"Preview", "i.Psychology":"Psychology", "i.PTraining":"Professional Training", "i.Publication":"Publication", 
"i.publish":"publish", "i.Publish":"Publish", "i.Published":"Published", "i.publishing":"publishing", "i.Publishing":"Publishing", "i.Publish_confirmation":"You are going to save and publish this Virtual Excursion on the ViSH Platform. After this, the excursion will be public and anyone will be able to access it. What would you like to do?", "i.Quiz":"Quiz", "i.QuizButtonAnswer":"Answer", "i.QuizButtonContinue":"Continue", "i.QuizButtonLaunch":"Launch", "i.QuizButtonOptions":"Options", "i.QuizButtonRetry":"Retry", 
"i.QuizCreateSessionError":"Sorry, an error occurred while creating the new Live Quiz", "i.QuizEmptyAnswerAlert":"Please, answer the quiz before send", "i.QuizErrorQuestionsUnsupported":"Some items are not supported by ViSH Editor and couldn't be converted", "i.QuizLaunch":"Launch", "i.QuizMultipleLaunchAlert":"Please stop all live quizzes before launch another one", "i.QuizNotSubmittedAlert":"Sorry, your answer couldn't be sent", "i.QuizResults":"Results", "i.QuizRetry":"Retry", "i.QuizSaveConfirmation":"Do you want to save the quiz results?", 
"i.QuizScore":"Score", "i.QuizSessionName":"Live Quiz Name", "i.QuizSettings":"Quiz Settings", "i.QuizSettingsToolbar":"Quiz Settings", "i.QuizStop":"Stop", "i.QuizSubmittedAlert":"Your answer has been submitted", "i.Quizzes":"Quizzes", "i.QuizzesWriteOptions":"Write options here", "i.QuizzesWriteOptionsOpen":"Write the answer here", "i.QuizzesWriteOptionsSorting":"Write the first item of the sequence here", "i.readJSONfileError":"Error reading JSON file", "i.recommendationsTitle":"Recommended excursions:", 
"i.Religion":"Religion", "i.Remove":"Remove", "i.Resize+":"Resize+", "i.Resize-":"Resize-", "i.resourceNonCompatibleNotification":"This resource is corrupt or is not compatible with the current version of ViSH Editor and cannot be opened.", "i.Response":"Response", "i.ResponseCorrect":"Correct response", "i.Rotate":"Rotate", "i.save":"save", "i.Save":"Save", "i.SaveAndExit":"save and exit", "i.Saved":"Saved", "i.Saving":"Saving", "i.School":"School", "i.SearchContent":"Search Content", "i.Searchplaces":"Search places", 
"i.Seconds":"Seconds", "i.sEducation":"Secondary Education", "i.SelectAll":"Select All", "i.selectObjectUpload":"Select a file to upload", "i.selectObjectUpload2":"Supported formats: SWF (flash), PDF", "i.selectPicture":"Select picture to upload", "i.SelectSlide":"Select Slide", "i.SelectTheme":"Select Theme", "i.Settings":"Settings", "i.SettingsToolbar":"Settings", "i.ShuffleChoices":"Shuffle choices", "i.Slide":"Slide", "i.Slides":"Slides", "i.SocialSciences":"Social Sciences", "i.SoftwareEngineering":"Software Engineering", 
"i.Style":"Style", "i.Subject":"Subject", "i.Tags":"Tags", "i.Technology":"Technology", "i.Templates":"Templates", "i.text":"text", "i.Text":"Text", "i.Telecommunications":"Telecommunications", "i.Themes":"Themes", "i.thumbnails":"gallery", "i.Time":"Time", "i.Title":"Title", "i.TitleM":"Title *", "i.toJSON":"to JSON", "i.toSCORM12":"to SCORM 1.2", "i.toSCORM2004":"to SCORM 2004", "i.Typicallearningtime":"Typical learning time", "i.University":"University", "i.unpublish":"unpublish", "i.Unpublish":"Unpublish", 
"i.unpublishing":"unpublishing", "i.Unpublishing":"Unpublishing", "i.Unpublish_confirmation":"You are going to unpublish this Virtual Excursion from the ViSH Platform. After this, the excursion will be private and only you will be able to access it. What would you like to do?", "i.Unknown":"Unknown", "i.Unlimited":"Unlimited", "i.UnselectAll":"Unselect All", "i.UnselectSlide":"Unselect Slide", "i.unspecified":"unspecified", "i.Unspecified":"Unspecified", "i.Untitled":"Untitled", "i.upload":"upload", 
"i.Upload":"Upload", "i.uploadErrorWrongServer":"Server returned an error status", "i.uploadErrorTooBig":"Current file is bigger than 8MB, try again", "i.uploadErrorCantReach":"File request can't reach server", "i.uploadHasToSaveFirst":"You must save Excursion first, before uploading any file", "i.url":"url", "i.Url":"Url", "i.Version":"Version", "i.Vertical":"Vertical", "i.verydifficult":"very difficult", "i.veryeasy":"very easy", "i.Video":"Video", "i.Videos":"videos", "i.VirtualTour":"VirtualTour", 
"i.wappSettings":"Web Application Settings", "i.wappSettingsEnableAPI":"Enable Web Application API", "i.wappSettingsSecores":"This app send scores", "i.yes":"yes", "i.Yes":"Yes", "i.YouTubePlayAlert":"Click on the video to start playing", "i.ZoneTooltip":"Click here to add content", "i.Zoom":"Zoom", "i.Zoom-":"Zoom-", "i.Zoom+":"Zoom+", "i.tooltip.continueDisabled":"Write a title and choose an avatar to continue", "i.tooltip.QSInput":"Enter a name for the live quiz", "i.tooltip.UploadAttachment":"If this button is disabled, you need to save your excursion first", 
"i.vtTitle_GStarted":"Getting Started with ViSH Editor", "i.last":"last"}, "es":{"i.walkMenuHelp1a":"Para aprender a utilizar ViSH Editor tienes a tu disposici\u00f3n varios videotutoriales en nuestro", "i.YouTubeChannel":"canal de YouTube", "i.walkMenuHelp1b":"Estos tutoriales cubren desde el uso b\u00e1sico para principiantes hasta funcionalidades avanzadas de la herramienta.", "i.walkMenuHelp2":"El siguiente videotutorial te ense\u00f1ar\u00e1 como empezar a utilizar esta herramienta en unos pocos minutos.", 
"i.walkMenuHelp3":"Si lo prefieres puedes hacer click aqu\u00ed para ver un tutorial textual que te ense\u00f1ar\u00e1 r\u00e1pidamente los conceptos b\u00e1sicos para empezar a utilizar ViSH Editor.", "i.walkWelcome1_1":"\u00a1Bienvenido a ViSH Editor!", "i.walkWelcome1_2":"ViSH Editor es una aplicaci\u00f3n web innovadora que permite crear increibles presentaciones web y recursos educativos novedosos como Excursiones Virtuales.", "i.walkWelcome1_3":"En este tutorial aprender\u00e1s como empezar a utilizar esta herramienta.", 
"i.walkWelcome2_1":"Panel de diapositivas", "i.walkWelcome2_2":"En este panel aparecen las diapositivas actuales de tu presentaci\u00f3n. Si seleccionas cualquiera de ellas podr\u00e1s visualizarla, editar y borrarla.", "i.walkWelcome3_1":"A\u00f1adir una nueva diapositiva", "i.walkWelcome3_2":"Puedes a\u00f1adir una nueva diapositiva a tu presentaci\u00f3n mediante este bot\u00f3n.", "i.walkWelcome3_3":"Despu\u00e9s de pulsarlo, aparecer\u00e1 una nueva pantalla para que elijas la plantilla de tu nueva diapositiva.", 
"i.walkWelcome4_1":"Importar contenido", "i.walkWelcome4_2":"Este icono mostrar\u00e1 la pantalla de importaci\u00f3n, que te permitir\u00e1 importar diapositivas de diferentes fuentes.", "i.walkWelcome4_3":"Importar diapositivas de una presentaci\u00f3n en formato PDF.", "i.walkWelcome4_4":"Importar diapositivas de otras presentaciones creadas con ViSH Editor.", "i.walkWelcome5_1":"Barra de Herramientas de ViSH Editor", "i.walkWelcome5_2":"Esta barra de herramientas ofrece diferentes funcionalidades para gestionar y componer la presentaci\u00f3n.", 
"i.walkWelcome5_3":"Pulsa en siguiente para ver una explicaci\u00f3n de los diferentes elementos de esta barra de herramientas.", "i.walkWelcome6_1":"Este bot\u00f3n te permite salvar tu presentaci\u00f3n como borrador.", "i.walkWelcome7_1":"Este bot\u00f3n te permite publicar tu presentaci\u00f3n en la plataforma ViSH. Si no has terminado tu presentaci\u00f3n, puedes guardarla como borrador para mantenerla privada y terminarla despu\u00e9s.", "i.walkWelcome8_1":"Este bot\u00f3n te permite previsualizar la presentaci\u00f3n. Podr\u00e1s ver la presentaci\u00f3n de la misma forma que lo har\u00e1n los usuarios tras su publicaci\u00f3n.", 
"i.walkWelcome9_1":"Este bot\u00f3n te permite elegir un tema visual para la presentaci\u00f3n.", "i.walkWelcome10_1":"Define un fondo personalizado para la diapositiva actual.", "i.walkWelcome11_1":"Herramientas para Elementos", "i.walkWelcome11_2":"Esta zona contiene herramientas para editar los contenidos o elementos de las diapositivas. Las herramientas mostradas variar\u00e1n dependiendo del tipo de elemento seleccionado (imagen, web, ...).", "i.walkWelcome11_3":"Cada vez que a\u00f1adas o selecciones un elemento en la presentaci\u00f3n, esta zona de la barra de herramientas te mostarar\u00e1 las herramientas disponibles para interactuar con ese elemento.", 
"i.walkWelcome11_4":"A continuaci\u00f3n se listan todas las herramientas disponibles", "i.walkWelcome11_a_1":"Enlazar elemento a una URL", "i.walkWelcome11_a_2":"Redimensionar un elemento", "i.walkWelcome11_a_3":"Zoom", "i.walkWelcome11_a_4":"Barra de herramientas para texto", "i.walkWelcome12_1":"Men\u00fa de ViSH Editor", "i.walkWelcome12_2":"Este bot\u00f3n muestra el men\u00fa de ViSH Editor, donde encontrar\u00e1s todas las funcionalidades de la aplicaci\u00f3n.", "i.walkWelcome12_3":"Muchas de estas opciones tambi\u00e9n se encuentran disponibles en la barra de herramientas de ViSH Editor, pero siempre podr\u00e1s acceder a cualquiera de ellas a trav\u00e9s de este men\u00fa.", 
"i.walkWelcome12_4":"En este men\u00fa puedes guardar y publicar tu presentaci\u00f3n asi como exportarla a un fichero externo, tambi\u00e9n puedes previsualizar la presentaci\u00f3n antes de publicarla o exportarla, a\u00f1adir nuevas diapositivas, importar nuevos contenidos, cambiar la informaci\u00f3n de la presentaci\u00f3n a trav\u00e9s de la opci\u00f3n 'Ajustes', y empezar otra vez este tutorial cuando quieras con la opci\u00f3n 'Ayuda'. ", "i.walkWelcome13_1":"Ayuda Contextual", "i.walkWelcome13_2":'Si tienes cualquier duda, siempre puedes hacer click en cualquiera de los "iconos de ayuda contextual" para ver ayuda e instrucciones adicionales relativas a la pantalla donde te encuentras o al elemento sobre el cual el icono se encuentra situado.', 
"i.walkWelcome13_3":"Icono de Ayuda Contextual", "i.walkSettings1_1":"Bienvenido a la pantalla de Ajustes", "i.walkSettings1_2":"Aqu\u00ed puedes especificar informaci\u00f3n acerca de tu Excursi\u00f3n Virtual.", "i.walkSettings1_3":"El t\u00edtulo y el avatar (una imagen que identifica tu excursi\u00f3n en la plataforma ViSH) son campos obligatorios, de modo que debes rellenarlos antes de publicar la excursi\u00f3n.", "i.walkSettings1_4":"A la izquierda, puedes ver una previsualizaci\u00f3n de como tu excursi\u00f3n ser\u00e1 mostrada en la plataforma ViSH.", 
"i.walkSettings2_1":"Escribe un t\u00edtulo (Obligatorio)", "i.walkSettings2_2":"Escribe el t\u00edtulo de tu excursi\u00f3n en esta caja de texto. Este titulo es importante porque es el que se mostrar\u00e1 en la plataforma ViSH y el que ver\u00e1n el resto de usuarios.", "i.walkSettings3_1":"A\u00f1ade un avatar para tu excursi\u00f3n (Obligatorio)", "i.walkSettings3_2":"Pulsa sobre este bot\u00f3n para elegir una imagen que represente a tu excursi\u00f3n. Esta imagen ser\u00e1 el avatar de tu excursi\u00f3n y es importante porque ser\u00e1 mostrada en la plataforma ViSH, permitiendo a los usuarios identificar la excursi\u00f3n.", 
"i.walkSettings4_1":"A\u00f1ade una licencia para esta excursi\u00f3n (Obligatorio)", "i.walkSettings4_2":"Ya que eres el autor de esta excursi\u00f3n, necesitas que tenga una licencia. Para ello puedes incluir una de las siguientes licencias de Creative Commons desde el men\u00fa desplegable. Esta es la p\u00e1gina de licencias Creative Commons (https://creativecommons.org/licenses/) donde te explican las diferentes licencias en profundidad.", "i.walkSettings4_3":"Recuerda que solamente puedes cambiar la licencia antes de publicar la excursi\u00f3n. Si ya la has publicado, el men\u00fa desplegable permanecer\u00e1 desactivado y no podr\u00e1s cambiarla.", 
"i.walkSettings5_1":"Escribe una descripci\u00f3n", "i.walkSettings5_2":"Aqui puedes explicar en detalle sobre qu\u00e9 trata la excursi\u00f3n.", "i.walkSettings5_3":"Esta descripci\u00f3n ser\u00e1 mostrada en la plataforma ViSH en la p\u00e1gina de esta excursi\u00f3n. Por lo tanto, todos los usuarios que accedan a esta excursi\u00f3n podr\u00e1n leerla.", "i.walkSettings6_1":"Selecciona un tema para tu presentaci\u00f3n", "i.walkSettings6_2":"Un tema define la apariencia visual de la presentaci\u00f3n. ViSH Editor ofrece diferentes temas entre los cuales puedes elegir.", 
"i.walkSettings6_3":"Para seleccionar un tema, simplemente pulsa sobre el icono que quieras de esta galer\u00eda.", "i.walkSettings6_4":"Recuerda que puedes cambiar el tema de la presentaci\u00f3n en cualquier momento accediendo a esta pantalla o pulsando sobre el bot\u00f3n 'Estilo' en la barra de herramientas.", "i.walkSettings7_1":"A\u00f1ade etiquetas a tu excursi\u00f3n", "i.walkSettings7_2":"Aqui puedes a\u00f1adir etiquetas (o palabras clave) a tu excursi\u00f3n.", "i.walkSettings7_3":"Estas palabras clave son muy \u00fatiles para categorizar la excursi\u00f3n. Adem\u00e1s, tambi\u00e9n se emplean como t\u00e9rminos de b\u00fasqueda en la plataforma ViSH (asi como en otros repositorios), y por lo tanto a\u00f1adir palabras clave a una excursi\u00f3n facilita su b\u00fasqueda y acceso.", 
"i.walkSettings7_4":"Ejemplos de etiquetas", "i.walkSettings8_1":"Fichero Adjunto", "i.walkSettings8_2":"Puedes a\u00f1adir materiales complementarios para tu excursi\u00f3n mediante un fichero adjunto.", "i.walkSettings8_3":"Para subir un fichero adjunto debes haber guardado previamente la excursi\u00f3n. Una vez subido el fichero adjunto, los usuarios podr\u00e1n descargarlo desde la p\u00e1gina de la excursi\u00f3n en la plataforma ViSH.", "i.walkSettings9_1":"Opciones avanzadas", "i.walkSettings9_2":"Al pulsar sobre este bot\u00f3n aparecer\u00e1 la pantalla de Opciones Avanzadas.", 
"i.walkSettings9_3":"En esta pantalla podr\u00e1s especificar m\u00e1s informaci\u00f3n pedag\u00f3gica, permisos y otros aspectos acerca de tu excursi\u00f3n.", "i.walkSettings9_4":"Los detalles sobre la informaci\u00f3n que puede ser especificada se describen en la ayuda contextual de las pantallas de opciones avanzadas.", "i.walkSettings10_1":"Empezar a utilizar ViSH Editor", "i.walkSettings10_2":"Una vez que hayas rellenado la informaci\u00f3n de tu excursi\u00f3n, por lo menos el t\u00edtulo y el avatar, puedes empezar a crear tu excursi\u00f3n con ViSH Editor pulsando sobre el bot\u00f3n 'Continuar'.", 
"i.walkSettings10_3":"Si no deseas rellenar la informaci\u00f3n en este momento, tambi\u00e9n puedes empezar a usar ViSH Editor pulsando sobre el bot\u00f3n 'Rellenar despu\u00e9s', en este caso recuerda que deber\u00e1s volver a la pantalla de Ajustes y completar todos los campos obligatorios antes de publicar la excursi\u00f3n.", "i.walkMetadata1_1":"Bienvenido a la pantalla de Metadatos", "i.walkMetadata1_2_1":"En esta pantalla puedes especificar m\u00e1s informaci\u00f3n pedag\u00f3gica acerca de tu excursi\u00f3n. Estos metadatos est\u00e1n basados y son conformes al est\u00e1ndar LOM (Learning Object Metadata). La \u00faltima especificaci\u00f3n de este est\u00e1ndar, en la cual se explica de una manera detallada todos los campos de esta pantalla, se puede encontrar", 
"i.walkMetadata1_2_2":"aqu\u00ed", "i.walkMetadata1_3":"A continuaci\u00f3n se ofrece una breve explicaci\u00f3n de cada uno de los campos que se pueden especificar en esta pantalla.", "i.walkMetadata1_4":"El idioma de tu excursi\u00f3n.", "i.walkMetadata1_5":"El entorno principal dentro del cual est\u00e1 destinado a tener lugar el aprendizaje y uso de este objeto de aprendizaje (es decir, la excursi\u00f3n).", "i.walkMetadata1_6":"Edad del usuario t\u00edpico esperado.", "i.walkMetadata1_7":"Como de complicado es trabajar con o a trav\u00e9s de este objeto de aprendizaje.", 
"i.walkMetadata1_8":"Tiempo aproximado o t\u00edpico que se necesita para trabajar con este objeto de aprendizaje.", "i.walkMetadata1_9":"El tema (o temas) de esta excursi\u00f3n.", "i.walkMetadata1_10":"Comentarios acerca de como este objeto de aprendizaje puede o va a ser utilizado.", "i.walkPublication1_1":"Bienvenido a la pantalla de permisos en ViSH Editor", "i.walkPublication1_2":"En esta pantalla podr\u00e1s cambiar los permisos que tendr\u00e1n el resto de usuarios de la plataforma ViSH sobre tu excursi\u00f3n una vez publicada. Podr\u00e1s cambiar esta configuraci\u00f3n en cualquier momento.", 
"i.walkPublication1_3":"permite activar o desactivar los comentarios de la excursi\u00f3n.", "i.walkPublication1_4":"permite a otros usuarios descargar la excursi\u00f3n en cualquier formato.", "i.walkPublication1_5":"permite a otros usuarios obtener una copia de la excursi\u00f3n en su propia cuenta manteniendo la cadena de autor\u00eda e incluyendo una referencia al autor (o autores) original.", "i.walkRTE1_1":"Bienvenido a la pantalla de opciones del RTE", "i.walkRTE1_2":"En esta pantalla podr\u00e1s especificar las opciones de integraci\u00f3n e interacci\u00f3n del objeto de aprendizaje (es decir, la excursi\u00f3n) con el RTE (Run-Time Environment) o entorno de ejecuci\u00f3n.", 
"i.walkRTE1_3":"Cuando el objeto de aprendizaje se exporta a un formato est\u00e1ndar de e-Learning como SCORM y se integra en un sistema externo (por ejemplo, un LMS como Moodle o Blackboard), este se comunica con el entorno de ejecuci\u00f3n del sistema externo. Las opciones de esta pantalla permiten configurar diferentes aspectos de esa comunicaci\u00f3n.", "i.walkSlide1_1":"A\u00f1adiendo contenido a una diapositiva", "i.walkSlide1_2":"Para a\u00f1adir contenido a una diapositiva, primero tienes que pulsar sobre cualquiera de las areas editables disponibles en ella. Estas \u00e1reas tienen un borde punteado y un texto que dice ", 
"i.walkSlide1_3":"Una vez que hayas seleccionado una de estas \u00e1reas, aparecer\u00e1n varios iconos dentro.", "i.walkSlide1_4":"Cada uno de estos iconos permite a\u00f1adir un tipo de contenido diferente. ", "i.walkSlide1_5":"Si seleccionas el icono de texto, una barra de herramientas de texto aparecer\u00e1 en la zona superior, permitiendo definir, entre otras caracter\u00edsticas, la tipograf\u00eda, el estilo y el tama\u00f1o del texto.", "i.walkSlide1_6":"Si seleccionas el icono de quizzes (cuestionarios), aparecer\u00e1 una nueva pantalla para que elijas el tipo de cuestionario (respuesta m\u00faltiple, verdadero/falso) a a\u00f1adir.", 
"i.walkSlide1_7":"En cualquier otro caso (im\u00e1genes, v\u00eddeos, ...), una nueva pantalla aparecer\u00e1 para que elijas el contenido a a\u00f1adir. Puedes a\u00f1adir un recurso mediante su URL, subiendo un archivo propio o buscando en proveedores externos de contenidos como Flickr o YouTube.", "i.walkSlide1_8":'Una vez que hayas a\u00f1adido contenido a un \u00e1rea, puedes borrarlo empleando el icono de "borrar contenido"', "i.walkSlide1_9":'Finalmente, si quieres borrar la diapositiva entera, puedes hacerlo usando el icono de "borrar diapositiva"', 
"i.walkImagesMain_1":"A\u00f1adiendo im\u00e1genes", "i.walkImagesMain_2":"Esta pantalla te permite a\u00f1adir im\u00e1genes a la diapositiva. Puedes seleccionar la imagen a a\u00f1adir de diferentes fuentes:", "i.walkImagesMain_Url":"a\u00f1adir una imagen pegando un enlace (url)", "i.walkImagesMain_Upload":"sube una imagen propia de tu ordenador", "i.walkImagesMain_ViSH":"busca im\u00e1genes en el repositorio del ViSH", "i.walkImagesMain_Flickr":"busca im\u00e1genes en Flickr", "i.walkImagesMain_Europeana":"busca im\u00e1genes en Europeana", 
"i.walkImagesMain_LRE":"busca im\u00e1genes en el repositorio del LRE", "i.walkImagesUrl1_1":'Ahora te encuentras en la pesta\u00f1a de enlace, haz click en "Siguiente" para continuar.', "i.walkImagesUrl2_1":"A\u00f1adiendo im\u00e1genes por enlace (url)", "i.walkImagesUrl2_2":"Si quieres a\u00f1adir una imagen mediante su url, debes escribir o pegar la url de la imagen en esta caja de texto, por ejemplo:", "i.walkImagesUrl2_3":"Practicamente todos los formatos de im\u00e1genes (jpg, png, gif, tiff, bmp, ...) est\u00e1n soportados.", 
"i.walkImagesUrl3_1":"Previsualizar la imagen antes de a\u00f1adirla", "i.walkImagesUrl3_2":'Despu\u00e9s de escribir o pegar el enlace (url) de la imagen deseada debes de hacer click en este bot\u00f3n de "Vista previa". Despu\u00e9s de eso, se mostrar\u00e1 una previsualizaci\u00f3n de la imagen y aparecer\u00e1 un nuevo bot\u00f3n "A\u00f1adir Contenido". Para terminar y a\u00f1adir la imagen a la diapositiva, debes hacer click en el bot\u00f3n "A\u00f1adir Contenido".', "i.walkImagesUpload1_1":'Ahora te encuentras en la pesta\u00f1a de subida de im\u00e1genes, haz click en "Siguiente" para continuar.', 
"i.walkImagesUpload2_1":"Subiendo im\u00e1genes", "i.walkImagesUpload2_2":'Aqu\u00ed puedes a\u00f1adir una imagen propia de tu dispositivo. Para ello, en primer lugar debes seleccionar la imagen que quieras empleando el selector de ficheros. Opcionalmente, puedes escribir etiquetas para clasificar la imagen seleccionada. Despu\u00e9s debes de hacer click en el bot\u00f3n "subir" para subir la imagen a la plataforma ViSH. Cuando la imagen se haya subido, se mostrar\u00e1 una vista previa de la misma en la parte inferior. Finalmente, para a\u00f1adir la imagen a la diapositiva debes de pulsar sobre el bot\u00f3n "A\u00f1adir Contenido".', 
"i.walkImagesViSH1_1":'Ahora te encuentras en la pesta\u00f1a de ViSH, haz click en "Siguiente" para continuar.', "i.walkImagesViSH2_1":"Buscar im\u00e1genes en el repositorio del ViSH", "i.walkImagesViSH2_2":"Esta pantalla te permite buscar im\u00e1genes en el repositorio del ViSH (http://vishub.org).", "i.walkSearch1":"Escribe el nombre que quieras buscar dentro de la caja de texto, por ejemplo", "i.nature":"nature", "i.walkImagesSearch2":"y pulsa la tecla 'intro' para comenzar la b\u00fasqueda. Cuando termine la b\u00fasqueda, las im\u00e1genes encontradas ser\u00e1n mostradas en esta pantalla. Para a\u00f1adir cualquiera de ellas a la diapositiva, simplemente haz click sobre la que desees.", 
"i.walkImagesFlickr1_1":'Ahora te encuentras en la pesta\u00f1a de Flickr, haz click en "Siguiente" para continuar.', "i.walkImagesFlickr2_1":"Buscar im\u00e1genes en Flickr", "i.walkImagesFlickr2_2":"Esta pantalla te permite buscar im\u00e1genes en Flickr.", "i.walkImagesEuropeana1_1":'Ahora te encuentras en la pesta\u00f1a de Europeana, haz click en "Siguiente" para continuar.', "i.walkImagesEuropeana2_1":"Buscar im\u00e1genes en Europeana", "i.walkImagesEuropeana2_2":"Esta pantalla te permite buscar im\u00e1genes en Europeana.", 
"i.walkImagesLRE1_1":'Ahora te encuentras en la pesta\u00f1a del repositorio del LRE, haz click en "Siguiente" para continuar.', "i.walkImagesLRE2_1":"Buscar im\u00e1genes en el repositorio del LRE", "i.walkImagesLRE2_2":"Esta pantalla te permite buscar im\u00e1genes en el repositorio del LRE.", "i.walkObjectsMain_1":"A\u00f1adiendo objetos", "i.walkObjectsMain_2":"Esta pantalla te permite a\u00f1adir diferentes tipos de objetos a las diapositivas. Puedes seleccionar el objeto a insertar de diferentes fuentes.", 
"i.walkObjectsMain_Web":"a\u00f1adir una web pegando su enlace (url)", "i.walkObjectsMain_WebSnapshot":'un "web snapshot" es un fragmento de una p\u00e1gina web. Este fragmento aparecer\u00e1 sin barras de desplazamiento (barras de scroll) y te permitir\u00e1 insertar un \u00e1rea o zona espec\u00edfica de una p\u00e1gina web en lugar de la p\u00e1gina completa', "i.walkObjectsMain_Embed":"a\u00f1ade un objeto embedido. Puedes escribir o pegar tanto el c\u00f3digo HTML del objeto como su enlace o url", 
"i.walkObjectsMain_Upload":"sube un fichero propio en formato PDF o SWF (flash) de tu ordenador", "i.walkObjectsMain_ViSH":"busca objetos en el repositorio del ViSH", "i.walkObjectsMain_LRE":"busca objetos en el repositorio del LRE", "i.walkVideosMain_1":"A\u00f1adiendo videos", "i.walkVideosMain_2":"La pantalla de recursos multimedia te permite a\u00f1adir videos a las diapositivas. Puedes seleccionar el v\u00eddeo a a\u00f1adir de diferentes fuentes:", "i.walkVideosMain_Url":"a\u00f1ade un v\u00eddeo pegando su enlace (url). Solo est\u00e1n admitidos videos HTML5 y de YouTube", 
"i.walkVideosMain_ViSH":"busca videos HTML5 en el repositorio del ViSH", "i.walkVideosMain_YouTube":"busca videos en YouTube", "i.walkVideosMain_Upload":"Haz click aqu\u00ed para aprender como subir v\u00eddeos", "i.walkVideosMain_Videos":"Haz click aqu\u00ed para aprender m\u00e1s sobre videos en ViSH Editor", "i.walkVideosUpload_1":"Subiendo v\u00eddeos", "i.walkVideosUpload_2":"Puedes subir un v\u00eddeo propio desde tu ordenador. Para hacer esto, vete a", "i.walkVideosUpload_3":"y sube tu archivo de v\u00eddeo al repositorio del ViSH. Varios formatos de v\u00eddeo (mp4, flv, mpg, avi, ...) est\u00e1n soportados. Cuando termines de subir el v\u00eddeo al ViSH este ser\u00e1 convertido a todos los formatos de video compatibles con HTML5 (mp4, webm y ogg). Tenga en cuenta que este proceso puede tardar varios minutos o incluso horas, dependiendo del tama\u00f1o del v\u00eddeo. Esta es una buena forma de insertar los videos porque de este modo estar\u00e1n disponibles en varios formatos y funcionar\u00e1n en todos los navegadores web que soporten HTML5. Una vez que el proceso haya finalizado, tienes dos formas de a\u00f1adir un v\u00eddeo", 
"i.walkVideosUpload_4":"Buscar tu v\u00eddeo en el repositorio del ViSH desde el ViSH Editor a trav\u00e9s de la pesta\u00f1a 'ViSH'. En este caso tendr\u00e1s que esperar varias horas (como m\u00e1ximo) hasta que el motor de b\u00fasqueda del ViSH haya indexado el nuevo v\u00eddeo.", "i.walkVideosUpload_5":"Otra forma es acceder a la p\u00e1gina del v\u00eddeo en ViSH (por ejemplo http://vishub.org/videos/3366), y seleccionar la tab 'insertar'. Despu\u00e9s hay que copiar el c\u00f3digo de inserci\u00f3n proporcionado y pegarlo en la caja de texto de la tab 'url' en el ViSH Editor. De esta forma, el video ser\u00e1 insertado de forma inmediata.", 
"i.walkVideosUpload_6":"Dado que ViSH Editor permite insertar videos de YouTube, tambi\u00e9n puedes subir tus videos a YouTube", "i.walkVideosUpload_7":"Una vez que hayas subido un video satisfactoriamente a YouTube, puedes insertarlo mediante su url, el c\u00f3digo de inserci\u00f3n proporcionado por YouTube o b\u00fascandolo desde el ViSH Editor mediante la tab 'YouTube'. YouTube tambi\u00e9n proporciona los videos en formatos de v\u00eddeo HTML5, por lo que funcionar\u00e1n en practicamente todos los dispositivos incluyendo tel\u00e9fonos m\u00f3viles.", 
"i.walkQuiz_1":"A\u00f1adiendo cuestionarios (Quizzes)", "i.walkQuiz_2":"Puedes a\u00f1adir diferentes tipos de cuestionarios o quizzes a tu presentaci\u00f3n. Los cuestionarios actualmente disponibles se muestran a continuaci\u00f3n", "i.walkQuiz_MC1":"Respuesta m\u00faltiple", "i.walkQuiz_MC2":"Los cuestionarios de respuesta m\u00faltiple son una forma de evaluaci\u00f3n en la que se les solicita a los encuestados que seleccionen la mejor respuesta posible  (o respuestas) de una lista de posibles opciones.", 
"i.walkQuiz_TF1":"Verdadero / Falso", "i.walkQuiz_TF2":"Un cuestionario de verdadero/falso es una forma de evaluaci\u00f3n en la que se solicita a los encuestados que seleccionen, para cada afirmaci\u00f3n o sentencia, si esta es verdadera o falsa.", "i.walkQuiz_Sorting1":"Ordenaci\u00f3n", "i.walkQuiz_Sorting2":"Los cuestionarios de ordenaci\u00f3n o secuencia son una forma de evaluaci\u00f3n en la que se requiere a los encuestados arrastrar y soltar una serie de elementos para ordenarlos de acuerdo a una secuencia determinada. Todos los elementos deben estar en el orden correcto para que la pregunta pueda ser calificada como correcta.", 
"i.walkQuiz_Open1":"Respuesta Abierta", "i.walkQuiz_Open2":"En un cuestionario de respuesta abierta, los estudiantes escriben una palabra o frase en respuesta a una pregunta. Los cuestionarios de respuesta abierta pueden ser autoevaluados cuando la respuesta es corta. En este caso los cuestionarios se llaman 'Cuestionarios de Respuesta Corta'. La respuesta puede ser una palabra o una frase, pero debe coincidir con la respuesta propuesta de forma exacta.", "i.walkQuiz_3":"Ademas de los contenidos, tambi\u00e9n puedes definir las respuestas correctas del cuestionario o quiz, permitiendo de esta manera la autoevaluaci\u00f3n y el seguimiento autom\u00e1tico del progreso de los estudiantes en plataformas de aprendizaje como Moodle.", 
"i.walkLive_1":"A\u00f1adiendo contenidos en directo", "i.walkLive_2":"ViSH ofrece recursos especiales como webcams en vivo, microscopios o laboratorios virtuales provistos por determinadas ciberinfraestructuras.", "i.walkLive_3":"En esta pantalla podr\u00e1s buscar recursos de este tipo en el repositorio del ViSH.", "i.walkLive_4":"Si quieres descubrir m\u00e1s recursos de ciberinfraestructuras o atender a eventos de ciencia en directo puedes visitar", "i.walkAddSlide_1":"A\u00f1adiendo Diapositivas", 
"i.walkAddSlide_2":"Aqu\u00ed puedes a\u00f1adir a tu presentaci\u00f3n una nueva diapositiva vac\u00eda con una plantilla espec\u00edfica. Para esto, simplemente selecciona la plantilla que quieras de las disponibles en el panel 'Plantillas'. Ten en cuenta que la plantilla define la posici\u00f3n y tama\u00f1o de las zonas en las cuales podr\u00e1s a\u00f1adir contenidos en la nueva diapositiva.", "i.walkAddSlide_3":"Adem\u00e1s de diapositivas normales, tambi\u00e9n puedes a\u00f1adir a tu presentaci\u00f3n elementos m\u00e1s interactivos llamados 'Smartcards'. Para insertar cualquiera de estos elementos, simplemente haz click en el que desees dentro del panel de 'Smartcards'. Una vez que hayas insertado una Smartcard podr\u00e1s personalizarla con el contenido que quieras.", 
"i.walkAddSlide_4":"Haz click aqu\u00ed para ver m\u00e1s informaci\u00f3n sobre los tipos disponibles de Smartcards y para aprender c\u00f3mo crearlas.", "i.walkSmartcards_1":"Las Smartcards son elementos interactivos que pueden ser insertados en la presentaci\u00f3n como si fueran diapositivas normales.", "i.walkSmartcards_2":"Los siguientes tipos de Smartcards est\u00e1n disponibles", "i.flashcardDef":"Las Flashcards son recursos presentados como una imagen de fondo con 'zonas calientes' se\u00f1aladas por flechas sobre las que el usuario puede hacer click para ver contenidos adicionales que han sido previamente etiquetados.", 
"i.vtDef":"Los Tours Virtuales son similares a las Flashcards, pero en lugar de ser presentados como im\u00e1genes de fondo est\u00e1ticas, se presentan como mapas interactivos donde las 'zonas calientes' son lugares se\u00f1alados por pines en el mapa. De esta forma, cuando los usuarios hacen click sobre un pin en el mapa (sobre una localizaci\u00f3n marcada) ven contenidos adicionales.", "i.EVideoDef":"Los Videos Enriquecidos son v\u00eddeos aumentados con otros recursos (cuestionarios/quizzes, diapositivas, im\u00e1genes, etc) que pueden ser seleccionados y personalizados por el autor, y que pueden ser mostrados autom\u00e1ticamente cuando el v\u00eddeo llega a un instante espec\u00edfico de tiempo o bien de forma explicita cuando el usuario selecciona uno de ellos en un men\u00fa lateral.", 
"i.flashcardLearnHow":"Haz click aqu\u00ed para aprender como crear una Flashcard.", "i.vtLearnHow":"Haz click aqu\u00ed para aprender como crear un Tour Virtual.", "i.eVideoLearnHow":"Haz click aqu\u00ed para aprender como crear un V\u00eddeo Enriquecido.", "i.walkPdf2ex_1":"Insertar una presentaci\u00f3n PDF", "i.walkPdf2ex_2":"Selecciona una presentaci\u00f3n en formato PDF y sube el archivo. \u00danicamente se admiten archivos en formato PDF. Si quieres insertar una presentaci\u00f3n en otro formato como PowerPoint (.ppt) debes de convertir el archivo a PDF primero.", 
"i.walkPdf2ex_3":"Una vez que la subida del fichero PDF haya finalizado, aparecer\u00e1 una nueva ventana para que elijas las diapositivas que quieres insertar de la presentaci\u00f3n que has subido.", "i.walkPdf2ex_4":"Esta funcionalidad convertir\u00e1 la presentaci\u00f3n PDF en una presentaci\u00f3n de ViSH Editor, esto quiere decir que cada una de las diapositivas seleccionadas de la presentaci\u00f3n PDF ser\u00e1 insertada en la presentaci\u00f3n actual como una diapositiva nueva.", "i.walkPdf2ex_5":"Si lo que quiere es insertar un documento PDF entero en la misma diapositiva para que pueda ser leido como un libro, debe de subir el archivo PDF desde el panel 'Objectos'.", 
"i.walkInsertingViSHPres_1":"A\u00f1adiendo Diapositivas de Excursiones Virtuales", "i.walkInsertingViSHPres_2":"Aqu\u00ed puedes buscar Excursiones Virtuales en la plataforma ViSH para a\u00f1adirlas (o a\u00f1adir determinadas diapositivas de ellas) a tu presentaci\u00f3n.", "i.walkInsertingViSHPres_3":"Haz click en cualquiera de las Excursiones Virtuales para seleccionarla. Despu\u00e9s, se mostrar\u00e1 un nuevo bot\u00f3n 'Vista Previa'. Cuando pulses este bot\u00f3n, aparecer\u00e1 una nueva ventana para que elijas las diapositivas que quieres insertar en tu presentaci\u00f3n.", 
"i.walkPresSearch2":"y pulsa la tecla 'intro' para comenzar la b\u00fasqueda. Cuando termine la b\u00fasqueda, las Excursiones Virtuales encontradas ser\u00e1n mostradas en esta pantalla.", "i.walkLearnMoreSmartcards":"Pulsa aqu\u00ed para aprender m\u00e1s sobre las Smartcards.", "i.walkEPackage_1":"Insertar un paquete de e-Learning", "i.walkEPackage_2":"Selecciona un paquete de e-Learning en formato ZIP y sube el archivo. Solo est\u00e1n admitidos archivos en formato ZIP. Puedes subir paquetes SCORM o aplicaciones web HTML5 personalizadas. Para subir una aplicaci\u00f3n web personalizada, el archivo HTML principal debe ser renombrado como 'index.html' y debe ser incluido en el archivo ZIP junto con todos los archivos necesarios.", 
"i.walkEPackage_3":"Una vez que la subida del archivo ZIP se haya completado, una nueva ventana aparecer\u00e1 para que previsualices y confirmes el contenido que se va a insertar.", "i.walkInsertEfile_1":"Importar recursos de ficheros externos", "i.walkInsertEfile_2":"Esta pantalla te permite importar diferentes tipos de recursos mediante ficheros externos.", "i.walkInsertEfile_3":"Las siguientes opciones se encuentran disponibles:", "i.walkInsertJSONfile_1":"A\u00f1adir una presentaci\u00f3n de ViSH Editor de un fichero JSON", 
"i.walkInsertJSONfile_2":"Selecciona el archivo en formato JSON (.json) en el cual est\u00e1 guardada la presentaci\u00f3n que quieres insertar. A continuaci\u00f3n, pulsa sobre el bot\u00f3n 'Vista Previa'. Aparecer\u00e1 una nueva pantalla para que elijas las diapositivas a importar.", "i.walkInsertJSONfile_3":"Puedes salvar tu presentaci\u00f3n en formato JSON haciendo click en 'Men\u00fa -> Exportar -> a JSON'. Se descargar\u00e1 a tu dispositivo un fichero JSON conteniendo tu presentaci\u00f3n. De esta forma puedes compartir tu presentaci\u00f3n mediante un archivo (por ejemplo envi\u00e1ndolo por email) y almacenarla donde quieras.", 
"i.walkInsertIMSQTI_1":"A\u00f1adir un Cuestionario (Quiz) mediante un archivo XML compatible con IMS QTI 2.1", "i.walkInsertIMSQTI_2":"Selecciona el archivo en formato XML (.xml) en el cual est\u00e1 guardado el cuestionario/quiz que quieres insertar acorde al est\u00e1ndar IMS QTI 2.1. A continuaci\u00f3n, pulsa sobre el bot\u00f3n 'Vista Previa'. Aparecer\u00e1 una nueva pantalla en la que podr\u00e1s previsualizar el cuestionario antes de a\u00f1adirlo.", "i.walkThemes_1":"Temas de ViSH Editor", 
"i.walkThemes_4":"Recuerda que puedes cambiar el tema de la presentaci\u00f3n en cualquier momento accediendo a esta pantalla o seleccionando la opci\u00f3n 'Ajustes' en el menu.", "i.walkAnimations_1":"Animaciones de ViSH Editor", "i.walkAnimations_2":"Una animaci\u00f3n define las transiciones visuales entre las slides de la presentaci\u00f3n. ViSH Editor ofrece diferentes animaciones entre las cuales puedes escojer.", "i.walkAnimations_3":"Para escojer una animaci\u00f3n, solamente debes pasar con el cursor por encima de los iconos para previsualizar la animaci\u00f3n que te gustar\u00eda a\u00f1adir dentro de esta galer\u00eda.", 
"i.walkAnimations_4":"Recuerda que puedes cambiar la animaci\u00f3n entre las slides en cualquier momento accediendo a esta pantalla desde el icono superior.", "i.CreatingFlashcards":"Creando Flashcards", "i.walkFlashcard_1":"Para empezar a crear una Flashcard debes hacer click en el bot\u00f3n 'A\u00f1adir' situado a la izquierda (el bot\u00f3n utilizado para a\u00f1adir nuevas diapositivas), y a continuaci\u00f3n debes pulsar sobre el icono de Flashcard en el panel 'Smartcards'. Despu\u00e9s de esto, se mostrar\u00e1 una Flashcard vacia en la pantalla.", 
"i.FlashcardIcon":"Icono de Flashcard", "i.walkFlashcard_2":"Para seleccionar la imagen de fondo de la Flashcard debes pulsar sobre el siguiente bot\u00f3n", "i.walkFlashcard_3":"Puedes cambiar el fondo seleccionado en cualquier momento haciendo click en el bot\u00f3n 'Fondo' de la barra de herramientas.", "i.walkContinueWalkthrough":"Haz click en 'Siguiente' para continuar con este tutorial.", "i.walkFlashcard_4":"Cuando est\u00e1s creando una Flashcard, se muestra un nuevo panel en la parte inferior de la pantalla. Nos referiremos a este panel como el 'panel de Flashcard'.", 
"i.walkFlashcard_5":"Para a\u00f1adir una nueva diapositiva a la Flashcard pulsa sobre el bot\u00f3n 'A\u00f1adir' situado en el 'panel de Flashcard' y contin\u00faa con el procedimiento habitual para a\u00f1adir una diapositiva. Despu\u00e9s de a\u00f1adirla, la miniatura de la nueva diapositiva aparecer\u00e1 en el panel y se mostrar\u00e1 la diapositiva en la pantalla.", "i.walkFlashcard_6":"Cuando la diapositiva est\u00e1 seleccionada, se muestra en la pantalla y puedes editarla y borrarla de la misma forma que las diapositivas normales. Para seleccionar una diapositiva simplemente pulsa sobre ella en el 'panel de Flashcard'. Si quieres seleccionar la Flashcard nuevamente para editarla, debes hacer click en el icono de Flashcard situado a la izquierda del 'panel de Flashcard'.", 
"i.walkFlashcard_7":"Las diapositivas tienen flechas arrastrables en su parte superior. Puedes arrastrar cualquiera de ellas a la imagen de fondo de la Flashcard para crear una nueva 'zona caliente'. De este modo, cuando los usuarios hagan click sobre una flecha ver\u00e1n la diapositiva asociada. ", "i.walkRememberPreview":"Recuerda que puedes previsualizar el objeto que est\u00e1s creando en cualquier momento haciendo click sobre el bot\u00f3n 'Vista Previa' situado en la barra de herramientas", 
"i.CreatingVirtualTours":"Creando Tours Virtuales", "i.walkVirtualTour_1":"Para empezar a crear un Tour Virtual debes hacer click en el bot\u00f3n 'A\u00f1adir' situado a la izquierda (el bot\u00f3n utilizado para a\u00f1adir nuevas diapositivas), y a continuaci\u00f3n debes pulsar sobre el icono de Tour Virtual en el panel 'Smartcards'. Despu\u00e9s de esto, se mostrar\u00e1 un Tour Virtual vacio en la pantalla.", "i.VirtualTourIcon":"Icono de Tour Virtual", "i.walkVirtualTour_2a":"Cuando estas creando un Tour Virtual, se muestra un mapa interactivo con una caja de b\u00fasqueda en su parte superior. Puedes usar esta caja de texto para buscar lugares y localizaciones. Escribe la localizaci\u00f3n que quieras buscar, por ejemplo", 
"i.walkVirtualTour_2b":"Se mostrar\u00e1 una lista de resultados en la parte inferior de la caja de b\u00fasqueda. Puedes elegir cualquier de ellos o  pulsar la tecla 'intro' para seleccionar autom\u00e1ticamente el primero. El mapa mostrar\u00e1 la localizaci\u00f3n seleccionada.", "i.walkVirtualTour_3":"Cuando est\u00e1s creando un Tour Virtual, se muestra un nuevo panel en la parte inferior de la pantalla. Nos referiremos a este panel como el 'panel de Tour Virtual'.", "i.walkVirtualTour_4":"Para a\u00f1adir una nueva diapositiva al Tour Virtual pulsa sobre el bot\u00f3n 'A\u00f1adir' situado en el 'panel de Tour Virtual' y contin\u00faa con el procedimiento habitual para a\u00f1adir una diapositiva. Despu\u00e9s de a\u00f1adirla, la miniatura de la nueva diapositiva aparecer\u00e1 en el panel y se mostrar\u00e1 la diapositiva en la pantalla.", 
"i.walkVirtualTour_5":"Cuando la diapositiva est\u00e1 seleccionada, se muestra en la pantalla y puedes editarla y borrarla de la misma forma que las diapositivas normales. Para seleccionar una diapositiva simplemente pulsa sobre ella en el 'panel de Tour Virtual'. Si quieres seleccionar el Tour Virtual nuevamente para editarlo, debes hacer click en el icono de Tour Virtual situado a la izquierda del 'panel de Tour Virtual'.", "i.walkVirtualTour_6":"Las diapositivas tienen flechas arrastrables en su parte superior. Puedes arrastrar cualquiera de ellas dentro del mapa para crear una nueva localizaci\u00f3n. Cuando arrastres una flecha dentro del mapa, un nuevo 'pin' aparecer\u00e1 en la localizaci\u00f3n seleccionada. De esta forma, cuando los usuarios hagan click sobre un 'pin' en el mapa ver\u00e1n la diapositiva asociada. Los 'pins' tambi\u00e9n son arrastrables, de modo que puedes moverlos a lo largo del mapa. Para eliminar un 'pin' en el mapa, simplemente haz click sobre \u00e9l.", 
"i.CreatingEnrichedVideos":"Creando Videos Enriquecidos", "i.EVideoDef2":"Los Videos Enriquecidos han sido dise\u00f1ados para ser usados en MOOCs (Cursos Online Masivos y Abiertos), con el objetivo de integrar preguntas y cuestionarios en videos de clases asi como contenidos adicionales. Sin embargo, su flexibilidad les permite ser usados en muchos otros entornos educativos.", "i.walkEVideo_1":"Para empezar a crear un V\u00eddeo Enriquecido debes hacer click en el bot\u00f3n 'A\u00f1adir' situado a la izquierda (el bot\u00f3n utilizado para a\u00f1adir nuevas diapositivas), y a continuaci\u00f3n debes pulsar sobre el icono de V\u00eddeo Enriquecido en el panel 'Smartcards'. Despu\u00e9s de esto, se mostrar\u00e1 un V\u00eddeo Enriquecido vacio en la pantalla.", 
"i.EVideoIcon":"Icono de V\u00eddeo Enriquecido", "i.walkEVideo_2":"En primer lugar, debes selecconar la fuente del v\u00eddeo para el V\u00eddeo Enriquecido pulsando sobre el siguiente bot\u00f3n", "i.walkEVideo_3":"Puedes cambiar la fuente de v\u00eddeo seleccionada en cualquier momento haciendo click en el bot\u00f3n 'Video' de la barra de herramientas.", "i.walkEVideo_4":"Puedes usar videos de YouTube y HTML5 (formatos mp4, webm y ogg). Adem\u00e1s, puedes subir tu propio v\u00eddeo al repositorio del ViSH para que sea convertido en formatos compatibles con HTML5 asegurando una compatibilidad completa en todos los dispositivos", 
"i.walkEVideo_5":"Cuando est\u00e1s creando un V\u00eddeo Enriquecido se muestran, principalmente, dos elementos en la pantalla: el reproductor de v\u00eddeo situado en el lado izquierdo, y la 'Tabla de Contenidos' situada en el lado derecho. El reproductor de v\u00eddeo permite reproducir el v\u00eddeo de la misma forma que un reproductor multimedia cl\u00e1sico. La 'Tabla de Contenidos' permite a\u00f1adir 'Enlaces a Marcas de Tiempo'. Un enlace a una marca de tiempo permite a los espectadores saltar a un punto espec\u00edfico del v\u00eddeo. Los enlaces a marcas de tiempo se representan por l\u00edneas dibujadas sobre la barra de progreso del v\u00eddeo, y sus t\u00edtulos se muestran en la tabla de contenidos. Para editar o borrar una marca de tiempo puedes usar los iconos situados a su lado en la tabla de contenidos.", 
"i.walkEVideo_6":"Tambi\u00e9n puedes crear enlaces a marcas de tiempo m\u00e1s avanzados, que se encuentren enlazados no solamente con un punto espec\u00edfico del tiempo, sino tambi\u00e9n con una diapositiva que contenga contenidos adicionales. En este caso, la diapositiva se mostrar\u00e1 de forma autom\u00e1tica cuando el v\u00eddeo alcance la marca de tiempo o cuando el usuario pulse sobre el t\u00edtulo correspondiente en la tabla de contenidos. Este tipo de enlaces se representan por bolas (en lugar de simples lineas), las cuales se muestran en la barra de progreso del v\u00eddeo.  Los siguientes pasos explican como crear este tipo de enlaces.", 
"i.walkEVideo_7":"Cuando est\u00e1s creando un V\u00eddeo Enriquecido, se muestra un nuevo panel en la parte inferior de la pantalla. Nos referiremos a este panel como el 'panel de V\u00eddeo Enriquecido'.", "i.walkEVideo_8":"Para a\u00f1adir una nueva diapositiva al V\u00eddeo Enriquecido pulsa sobre el bot\u00f3n 'A\u00f1adir' situado en el 'panel de V\u00eddeo Enriquecido' y contin\u00faa con el procedimiento habitual para a\u00f1adir una diapositiva. Despu\u00e9s de a\u00f1adirla, la miniatura de la nueva diapositiva aparecer\u00e1 en el panel y se mostrar\u00e1 la diapositiva en la pantalla.", 
"i.walkEVideo_9":"Cuando la diapositiva est\u00e1 seleccionada, se muestra en la pantalla y puedes editarla y borrarla de la misma forma que las diapositivas normales. Para seleccionar una diapositiva simplemente pulsa sobre ella en el 'panel de V\u00eddeo Enriquecido'. Si quieres seleccionar el V\u00eddeo Enriquecido nuevamente para editarlo, debes hacer click en el icono de V\u00eddeo Enriquecido situado a la izquierda del 'panel de V\u00eddeo Enriquecido'.", "i.walkEVideo_10":"Las diapositivas tienen flechas arrastrables en su parte superior. Puedes arrastrar cualquiera de ellas a cualquier zona del V\u00eddeo Enriquecido para crear un nuevo enlace a una marca de tiempo asociado con su diapositiva. Este enlace ser\u00e1 a\u00f1adido automaticamente al v\u00eddeo y a la 'Tabla de Contenidos'. El enlace se representa en el v\u00eddeo como una bola con la letra de su diapositiva asociada dentro. Puedes deslizar la bola a lo largo de la barra de progreso del v\u00eddeo para ajustar la marca de tiempo. Tambi\u00e9n puedes editar la marca de tiempo y el t\u00edtulo del enlace mediante los iconos situados a su lado en la tabla de contenidos. Si una diapositiva del V\u00eddeo Enriquecido es eliminada, su enlace a marca de tiempo asociado (y por tanto la bola) tambi\u00e9n ser\u00e1 eliminado.", 
"i.walkEVideo_11":"Puedes a\u00f1adir varias diapositivas  en el mismo instante de tiempo. Esto resulta de gran utilidad para incluir grandes cuestionarios divididos en varias diapositivas o para combinar diferentes tipos de recursos. Para ello, simplemente ponga la misma marca de tiempo a todos los enlaces que se encuentren asociados con las diapositivas que quiera mostrar juntas. Despu\u00e9s, se mostrar\u00e1n un par de flechas en la tabla de contenidos al lado de estos enlaces. Puedes usar estas flechas para especificar el orden en el cual los contenidos ser\u00e1n mostrados cuando el v\u00eddeo alcance esa marca de tiempo.", 
"i.walkSelectSlides_1":"A\u00f1adiendo diapositivas externas a tu presentaci\u00f3n", "i.walkSelectSlides_2":"Aqu\u00ed puedes previsualizar la presentaci\u00f3n que has decidido importar. Puedes insertar todas las diapositivas de la presentaci\u00f3n o seleccionar solo aquellas que quieras insertar.", "i.walkSelectSlides_3":"Teniendo en cuenta que por defecto se seleccionan todas las diapositivas, si quieres insertar la presentaci\u00f3m completa solamente tienes que hacer click sobre el bot\u00f3n 'A\u00f1adir Diapositivas' situado en la zona inferior derecha de la pantalla.", 
"i.walkSelectSlides_4":"Si quieres seleccionar de forma espec\u00edfica las diapositivas a importar, las siguientes instrucciones te servir\u00e1n de ayuda", "i.walkSelectSlides_5a":"Utiliza las flechas", "i.walkSelectSlides_5b":"situadas en la zona inferior para recorrer las diapositivas de la presentaci\u00f3n.", "i.walkSelectSlides_6a":"Las diapositivas seleccionadas tienen un borde verde", "i.walkSelectSlides_6b":"mientras que las diapositivas no seleccionadas tienen un borde rojo.", "i.walkSelectSlides_7":"Para seleccionar o deseleccionar la diapositiva actual que est\u00e1s viendo, pulsa sobre el bot\u00f3n 'Seleccionar/Deseleccionar Diapositiva' situado en el centro de la zona inferior.", 
"i.walkSelectSlides_8":"Adem\u00e1s, puedes hacer uso de los siguientes botones para seleccionar o deseleccionar de golpe todas las diapositivas.", "i.walkSelectSlides_9":"Finalmente, para insertar todas las diapositivas que has seleccionado debes de hacer click en el bot\u00f3n 'A\u00f1adir Diapositivas' situado en la zona inferior derecha de la pantalla. La cantidad de diapositivas a insertar se indica a la izquierda de este bot\u00f3n.", "i.walkQuizzes_1":"Cuestionarios en Vivo", "i.walkQuizzes_2":"Los Cuestionarios en Vivo permiten lanzar cuestionarios y sondeos en tiempo real para obtener respuestas de forma inmediata.", 
"i.walkQuizzes_3":"Para lanzar un 'Cuestionario en Vivo' tienes que acceder a una presentaci\u00f3n y hacer click en el bot\u00f3n 'Lanzar' situado en la parte inferior del cuestionario que quieras usar. Ten en cuenta que el bot\u00f3n 'Lanzar' no se muestra cuando previsualizas una presentaci\u00f3n con el editor. Cuando lanzas un cuestionario en vivo, se crea una 'sesi\u00f3n de cuestionario' en la plataforma ViSH, la cual almacenar\u00e1 todos los resultados y estad\u00edsticas del cuestionario. Una vez que una 'sesi\u00f3n de cuestionario' haya sido creada, podr\u00e1s acceder a ella (y por tanto ver los resultados y estad\u00edsticas) en cualquier momento en la plataforma ViSH.", 
"i.walkQuizzes_4":"Despu\u00e9s de que lances un cuestionario en vivo usando el bot\u00f3n 'Lanzar' situado en la parte inferior del cuestionario, una nueva pantalla aparecer\u00e1 ('pantalla de cuestionario en vivo') mostrando diversos elementos", "i.walkQuizzes_5a":"Un hiperenlace al cuestionario en vivo, por ejemplo", "i.walkQuizzes_5b":"Este hiperenlace es utilizado para responder al cuestionario. Cualquier persona que acceda a esta direcci\u00f3n de internet podr\u00e1 responder al cuestionario en vivo. Por lo tanto puedes compartir tu cuestionario en vivo mediante este hiperenlace, por ejemplo envi\u00e1ndolo por correo electr\u00f3nico o peg\u00e1ndolo en un foro.", 
"i.walkQuizzes_6":"Algunos logos de redes sociales populares (Twitter, Facebook, Google+, ...). Puedes compartir el hiperenalce del cuestionario en vivo en cualquiera de estas redes sociales pulsando sobre el logo correspondiente.", "i.walkQuizzes_7":"Un c\u00f3digo QR para dispositivos m\u00f3viles. Cualquier dispositivo puede obtener autom\u00e1ticamente el hiperenlace del cuestionario en vivo escaneando este c\u00f3digo QR.", "i.walkQuizzes_8":"Una pesta\u00f1a 'Resultados' situada en la parte superior, que permite ver en tiempo real los resultados del cuestionario. Dependiendo del tipo de cuestionario, la representaci\u00f3n de los resultados ser\u00e1 diferente (gr\u00e1fico circular, de barras, etc.).", 
"i.walkQuizzes_9":"Si quieres 'cerrar' el cuestionario en vivo debes hacer click en el bot\u00f3n 'Detener' situado en la parte inferior derecha. Despu\u00e9s de cerrar un cuestionario, no se admitir\u00e1n ni guardar\u00e1n m\u00e1s respuestas. Tambi\u00e9n puedes cerrar un cuestionario en cualquier momento desde la plataforma ViSH. Cuando cierras un cuestionario en vivo, puedes, opcionalmente, especificar un nombre para facilitar su b\u00fasqueda posterior en el ViSH.", "i.walkQuizzes_10":"Si sales de la pantalla de cuestionarios en vivo, puedes regresar en cualquier momento haciendo click sobre el bot\u00f3n 'Opciones' situado en la parte inferior del cuestionario. Tenga en cuenta que si un cuestionario ha sido lanzado, el bot\u00f3n 'Lanzar' es reemplazado por un bot\u00f3n 'Opciones'. Cuando se cierre el cuestionario, el bot\u00f3n 'Lanzar' volver\u00e1 a aparecer. Finalmente, tenga en cuenta que no puede lanzar m\u00e1s de un cuestionario en vivo a la vez.", 
"i.About":"About", "i.About2":"C\u00f3digo disponible en", "i.About3":"visita nuestro canal de YouTube", "i.About4":"Desarrollado por", "i.VESurvey1":"Ay\u00fadanos a mejorar ViSH Editor", "i.VESurvey2":"Por favor, rellena", "i.VESurvey3":"esta encuesta", "i.VESurvey4":"\u00a1Gracias por tu colaboraci\u00f3n", "i.VESurveyURL":"http://docs.google.com/forms/d/e/1FAIpQLSdJpv7o323BY5TFoZrKKQXczRBXko1YD066CAjKkTBqAJremw/viewform", "i.accept":"aceptar", "i.add":"a\u00f1adir", "i.Add":"A\u00f1adir", "i.Addanavatar":"A\u00f1adir avatar *", 
"i.AddanavatarHover":"Haz clic para a\u00f1adir un avatar. Debes seleccionar un avatar para identificar tu excursi\u00f3n", "i.addatitle":"a\u00f1ade un t\u00edtulo", "i.AddContent":"A\u00f1adir Contenido", "i.addembeddedobject":"a\u00f1adir objeto embebido", "i.AddePackage":"A\u00f1adir un paquete de e-Learning mediante un archivo ZIP. Formatos soportados: SCORM y aplicaciones web HTML5 personalizadas.", "i.AddFromJSONfile":"A\u00f1adir una presentaci\u00f3n de ViSH Editor de un fichero JSON", "i.addpicurl":"a\u00f1adir URL de imagen", 
"i.AddSlide":"A\u00f1adir diapositiva", "i.AddSlideMin":"A\u00f1adir", "i.AddSlides":"A\u00f1adir Diapositivas", "i.AddslideshowPDF":"A\u00f1adir presentaci\u00f3n de un fichero PDF", "i.AddTags":"A\u00f1adir etiquetas", "i.AddTimestampLink":"A\u00f1adir marca de tiempo", "i.addvideourl":"a\u00f1adir URL de v\u00eddeo (YouTube, HTML5)", "i.advancedSettings":"Avanzado", "i.AgeRange":"Rango de edad", "i.allowUsersTo":"Permitir a otros usuarios:", "i.allowClone":"Clonar", "i.allowComment":"Comentar", 
"i.allowDownload":"Descargar", "i.Animations":"Animaciones", "i.areyousureNotification":"\u00bfest\u00e1s seguro?", "i.Art":"Arte", "i.Astronomy":"Astronom\u00eda", "i.Attatchment":"Fichero Adjunto", "i.AudienceResponseSystem":"Sistema de Respuesta de Audiencia", "i.Author":"Autor", "i.Background":"Fondo", "i.biology":"biolog\u00eda", "i.Biology":"Biolog\u00eda", "i.browserrequirements":"El navegador que estas utilizando no cumple los requisitos minimos para utilizar esta aplicaci\u00f3n. Por favor, actualiza tu navegador", 
"i.by":"por", "i.cancel":"cancelar", "i.Cancel":"Cancelar", "i.Catalog":"Cat\u00e1logo", "i.CatalogueTitle":"Cat\u00e1logo", "i.Chemistry":"Qu\u00edmica", "i.ChooseFile":"Seleccionar", "i.ChooseFileTip":"Elije un archivo", "i.Citizenship":"Educaci\u00f3n para la Ciudadan\u00eda", "i.ClassicalLanguages":"Lenguas Cl\u00e1sicas", "i.close":"cerrar", "i.Close":"Cerrar", "i.CloseWSaving":"cerrar sin guardar", "i.content":"contenido", "i.Content":"Contenido", "i.Context":"Contexto", "i.continue":"continuar", 
"i.Continue":"Continuar", "i.CrossCurricularEducation":"Educaci\u00f3n Multidisciplinar", "i.ComputerScience":"Inform\u00e1tica", "i.delete":"borrar", "i.Description":"Descripci\u00f3n", "i.Diagonal1":"Diagonal #1", "i.Diagonal2":"Diagonal #2", "i.difficult":"dif\u00edcil", "i.Difficulty":"Dificultad", "i.Documentation":"Documentaci\u00f3n", "i.done":"hecho", "i.Done":"Hecho", "i.draft":"borrador", "i.easy":"f\u00e1cil", "i.Economics":"Econom\u00eda", "i.edit":"editar", "i.Education":"Educaci\u00f3n", 
"i.EducationalObjectives":"Objetivos educativos", "i.EducationalObjectivesPlaceholder":"Describa los objetivos educativos que pretende cumplir con esta excursi\u00f3n...", "i.Electronics":"Electr\u00f3nica", "i.Elements":"Elementos", "i.embedwebsite":"embeber web", "i.embedWebSnapshot":"embeber Web Snapshot", "i.Enable":"Habilitar", "i.enableRTE":"Habilitar seguimiento del objeto cuando se exporta a SCORM", "i.EnrichedVideo":"V\u00eddeo Enriquecido", "i.EnvironmentalEducation":"Educaci\u00f3n Ambiental", 
"i.ePackage":"Paquete e-Learning", "i.ePackageError1":"Ocurri\u00f3 un error al subir el paquete de e&#8209;Learning.", "i.errorFlickrConnection":"Error conectando con Flickr", "i.errorEuropeanaConnection":"Error conectando con Europeana", "i.errorLREConnection":"Error al conectarse con el repositorio del LRE", "i.errorViSHConnection":"Error al conectarse con el servidor de ViSH", "i.errorYoutubeConnection":"Error conectando con YouTube", "i.errorSoundCloudConnection":"Error conectando con SoundCloud", 
"i.Ethics":"\u00c9tica", "i.Evaluate":"Evaluar", "i.evaluateTitle":"\u00bfQuieres contribuir evaluando esta excursi\u00f3n?", "i.eVideoChangeNotification":"Si cambias la fuente del v\u00eddeo perder\u00e1s todas las marcas de tiempo que hayas a\u00f1adido. En cualquier caso, conservar\u00e1s las diapositivas que hayas creado. \u00bfEst\u00e1s seguro de que quieres continuar?", "i.Exit":"Salir", "i.exitConfirmation":"Vas a abandonar ViSH Editor. Se perder\u00e1n todos los cambios que no hayas salvado.", 
"i.exitConfirmation2":"\u00bfSeguro que quieres abandonar esta p\u00e1gina?", "i.exitConfirmationMenu":"La Excursi\u00f3n Virtual se ha modificado. Si la cierra sin guardar perder\u00e1 todos los cambios. \u00bfQu\u00e9 desea hacer?", "i.ExitWSaving":"salir sin guardar", "i.Export":"Exportar", "i.exportPresToJSONerrorNotification":"Ha ocurrido un error. No ha sido posible exportar la presentaci\u00f3n a un fichero JSON.", "i.exportPresToSCORMerrorNotification":"Ha ocurrido un error. No ha sido posible exportar la presentaci\u00f3n a un paquete SCORM.", 
"i.exportQuizToQTIerrorNotification":"Ha ocurrido un error. No ha sido posible exportar el cuestionario al formato IMS QTI 2.1.", "i.exportQuizToMoodleXMLerrorNotification":"Ha ocurrido un error. No ha sido posible exportar el cuestionario al formato Moodle XML.", "i.ExportToIMSQTI":"Exportar a IMS QTI 2.1", "i.ExportToMoodleXML":"Exportar a Moodle XML", "i.exviews":"visitas", "i.File":"Archivo", "i.Filllater":"Rellenar despu\u00e9s", "i.Finish":"Terminar", "i.Flashcard":"Flashcard", "i.Flashcards":"Flashcards", 
"i.Flip1":"Vuelta #1", "i.Flip2":"Vuelta #2", "i.ForeignLanguages":"Idiomas", "i.Game":"Juego", "i.GeneralCulture":"Cultura General", "i.Geography":"Geograf\u00eda", "i.Geology":"Geolog\u00eda", "i.GotoSettings":"Ir a Ajustes", "i.HealthEducation":"Educaci\u00f3n para la Salud", "i.Help":"Ayuda", "i.HigherEducation":"Educaci\u00f3n Superior", "i.History":"Histor\u00eda", "i.HomeEconomics":"Econom\u00eda Dom\u00e9stica", "i.Horizontal":"Horizontal", "i.Hours":"Horas", "i.Image":"Imagen", "i.Images":"Im\u00e1genes", 
"i.Import":"Importar", "i.ImportFromEFile":"Importar recursos mediante archivos externos:", "i.ImportFromEFileVEJSON":"Presentaciones y Diapositivas de ViSH Editor de archivos JSON", "i.ImportFromEFileIMSQTI":"Cuestionarios (Quizzes) de archivos XML compatibles con IMS QTI 2.1", "i.ImportFromEFileMoodleXML":"Cuestionarios (Quizzes) de archivos XML compatibles con MoodleXML", "i.Insert":"Insertar", "i.Inside":"Dentro", "i.invalidvalue":"valor inv\u00e1lido", "i.ItemAndBall":"Esta entrada est\u00e1 enlazada con la diapositiva #{letter} del V\u00eddeo Enriquecido.", 
"i.Language":"Idioma", "i.Languageindependent":"Independiente del idioma", "i.Law":"Derecho", "i.License":"Licencia", "i.License_public":"Dominio P\u00fablico", "i.License_cc-by":"Creative Commons Reconocimiento", "i.License_cc-by-sa":"Creative Commons Reconocimiento-CompartirIgual", "i.License_cc-by-nd":"Creative Commons Reconocimiento-SinObraDerivada", "i.License_cc-by-nc":"Creative Commons Reconocimiento-NoComercial", "i.License_cc-by-nc-sa":"Creative Commons Reconocimiento-NoComercial-CompartirIgual", 
"i.License_cc-by-nc-nd":"Creative Commons Reconocimiento-NoComercial-SinObraDerivada", "i.License_private":"Ninguna (Todos los derechos reservados)", "i.limitReached":"limite alcanzado", "i.link":"enlace", "i.Link":"Enlace", "i.Literature":"Literatura", "i.LiveQuiz":"Cuestionario en Vivo", "i.LiveResources":"Contenidos en directo", "i.MandatoryFieldsNotification":"Tienes que escribir un t\u00edtulo y escoger un avatar para la excursi\u00f3n antes de publicarla.", "i.math":"matem\u00e1ticas", "i.Mathematics":"Matem\u00e1ticas", 
"i.medium":"medio", "i.Minutes":"Minutos", "i.Music":"M\u00fasica", "i.nanoscience":"nanociencia", "i.NaturalSciences":"Ciencias Naturales", "i.NAttempts":"N\u00famero de intentos", "i.next":"siguiente", "i.Next":"Siguiente", "i.no":"no", "i.notify_teacher":"Notificar", "i.notified_teacher":"Notificado", "i.notify_teacher_confirmation":"\u00bfHa acabado el trabajo y desea notificar al profesor para que lo publique?", "i.No":"No", "i.NoFileError":"No has seleccionado ning\u00fan archivo para importar.", 
"i.NoJSONFileError":"Tienes que seleccionar un archivo para importar en formato JSON.", "i.Noresultsfound":"No se encontraron resultados", "i.NoSlidesOnSaveNotification":"Antes de guardar tienes que crear por lo menos una diapositiva.", "i.NoThanks":"No gracias", "i.NoSupportedFileError":"El archivo no puede ser importado. El formato no est\u00e1 soportado.", "i.Object":"Objeto", "i.Objects":"Objetos", "i.Ok":"Ok", "i.OK":"OK", "i.Opacity":"Opacidad", "i.Options":"Opciones", "i.OSettingsUnload":"Desactivar el objeto cuando la diapositiva desaparezca", 
"i.or":"o", "i.Other":"Otro", "i.Others":"Otros", "i.Package":"Paquete", "i.pasteEmbedObject":"pega la URL de un archivo SWF o PDF", "i.pasteImageURL":"pega la URL de una imagen", "i.pasteVideoURL":"pega la URL de un v\u00eddeo HTML5 o de YouTube", "i.pasteWeb":"pega la URL de una p\u00e1gina web", "i.pdfErrorNotification":"Ha ocurrido un error. Aseg\u00farese de que el fichero PDF es v\u00e1lido.", "i.pdfErrorNotificationFormat":"Ha ocurrido un error. El formato del fichero no es v\u00e1lido.", 
"i.pdfErrorNotificationSize":"Ha ocurrido un error. El fichero PDF debe tener un tama\u00f1o inferior a 8 Mb.", "i.pdfErrorNotificationPages":"Ha ocurrido un error. El fichero PDF tiene demasiadas p\u00e1ginas.", "i.PDFSlideshow":"Presentaci\u00f3n PDF", "i.MetadataAspects":"Metadatos", "i.pEducation":"Educaci\u00f3n Primaria", "i.Philosophy":"Filosof\u00eda", "i.PhysicalEducation":"Educaci\u00f3n F\u00edsica", "i.Physics":"F\u00edsica", "i.pNotValid":"Este recurso no puede ser abierto porque est\u00e1 da\u00f1ado o no es compatible con la versi\u00f3n actual de ViSH Editor.", 
"i.Politics":"Ciencias Pol\u00edticas", "i.Preschool":"Educaci\u00f3n Preescolar", "i.Presentation":"Presentaci\u00f3n", "i.PresentationsRepository":"Busque en el repositorio la presentaci\u00f3n que desea importar", "i.presDescriptionPlaceHolder":"Describa brevemente sobre qu\u00e9 trata la excursi\u00f3n", "i.presTitle":"T\u00edtulo de la excursi\u00f3n", "i.Preview":"Vista previa", "i.Psychology":"Psicolog\u00eda", "i.PTraining":"Formaci\u00f3n Laboral", "i.Publication":"Publicaci\u00f3n", "i.publish":"publicar", 
"i.Publish":"Publicar", "i.Published":"Publicado", "i.publishing":"Publicando", "i.Publishing":"Publicando", "i.Publish_confirmation":"Vas a guardar y publicar esta Excursi\u00f3n Virtual en la plataforma ViSH. Despu\u00e9s de esto, la excursi\u00f3n ser\u00e1 p\u00fablica y cualquiera podr\u00e1 acceder a ella. \u00bfQu\u00e9 deseas hacer?", "i.Quiz":"Quiz", "i.QuizButtonAnswer":"Responder", "i.QuizButtonContinue":"Continuar", "i.QuizButtonLaunch":"Lanzar", "i.QuizButtonOptions":"Opciones", "i.QuizButtonRetry":"Reintentar", 
"i.QuizCreateSessionError":"Lo sentimos, ha ocurrido un error al crear un nuevo cuestionario en vivo", "i.QuizEmptyAnswerAlert":"Por favor, responde el cuestionario antes de enviar tu respuesta", "i.QuizErrorQuestionsUnsupported":"Algunos elementos no est\u00e1n soportados por ViSH Editor y no pudieron ser convertidos.", "i.QuizLaunch":"Lanzar", "i.QuizMultipleLaunchAlert":"Por favor, det\u00e9n todos los cuestionarios en vivo antes de lanzar uno nuevo", "i.QuizNotSubmittedAlert":"Lo sentimos, tu respuesta no ha podido ser enviada", 
"i.QuizResults":"Resultados", "i.QuizRetry":"Reintentar", "i.QuizSaveConfirmation":"\u00bfQuieres guardar los resultados del cuestionario?", "i.QuizScore":"Puntuaci\u00f3n", "i.QuizSessionName":"Nombre del Cuestionario en Vivo", "i.QuizSettings":"Ajustes de Quiz", "i.QuizSettingsToolbar":"Ajustes de Quiz", "i.QuizStop":"Detener", "i.QuizSubmittedAlert":"Tu respuesta ha sido enviada", "i.Quizzes":"Quizzes (Cuestionarios)", "i.QuizzesWriteOptions":"Escribe aqu\u00ed las opciones", "i.QuizzesWriteOptionsOpen":"Escribe aqu\u00ed la respuesta", 
"i.QuizzesWriteOptionsSorting":"Escribe aqu\u00ed el primer elemento de la secuencia", "i.readJSONfileError":"Error al leer el fichero JSON", "i.recommendationsTitle":"Excursiones recomendadas:", "i.Religion":"Religi\u00f3n", "i.Remove":"Borrar", "i.Resize+":"Escalar+", "i.Resize-":"Escalar-", "i.resourceNonCompatibleNotification":"El recurso no puede ser abierto porque est\u00e1 corrupto o no es compatible con la versi\u00f3n actual de ViSH Editor", "i.Response":"Respuesta", "i.ResponseCorrect":"Respuesta correcta", 
"i.Rotate":"Rotar", "i.save":"guardar", "i.Save":"Guardar", "i.SaveAndExit":"guardar y salir", "i.Saved":"Guardado", "i.Saving":"Guardando", "i.School":"Colegio", "i.SearchContent":"Buscar contenido", "i.Searchplaces":"Buscar lugares", "i.Seconds":"Segundos", "i.sEducation":"Educaci\u00f3n Secundaria", "i.SelectAll":"Seleccionar Todas", "i.selectObjectUpload":"Selecciona un archivo para subir", "i.selectObjectUpload2":"Formatos soportados: SWF (flash), PDF", "i.selectPicture":"Seleccionar imagen para subir", 
"i.SelectSlide":"Seleccionar Diapositiva", "i.SelectTheme":"Seleccionar Tema", "i.Settings":"Ajustes", "i.SettingsToolbar":"Ajustes", "i.ShuffleChoices":"Barajar opciones", "i.Slide":"Diapositiva", "i.Slides":"Diapositivas", "i.Smartcards":"Smartcards", "i.SocialSciences":"Ciencias Sociales", "i.SoftwareEngineering":"Ingenier\u00eda del Software", "i.Style":"Estilo", "i.Subject":"Tema", "i.Tags":"Etiquetas", "i.Technology":"Tecnolog\u00eda", "i.Templates":"Plantillas", "i.text":"texto", "i.Text":"Texto", 
"i.Telecommunications":"Telecomunicaciones", "i.Themes":"Temas", "i.thumbnails":"galer\u00eda", "i.Time":"Tiempo", "i.Title":"T\u00edtulo", "i.TitleM":"T\u00edtulo *", "i.toJSON":"a JSON", "i.toSCORM12":"a SCORM 1.2", "i.toSCORM2004":"a SCORM 2004", "i.TypicalLearningTime":"Tiempo de aprendizaje t\u00edpico", "i.University":"Universidad", "i.unpublish":"retirar publicaci\u00f3n", "i.Unpublish":"Retirar", "i.unpublishing":"retirando", "i.Unpublishing":"Retirando", "i.Unpublish_confirmation":"Vas a retirar la publicaci\u00f3n de esta Excursi\u00f3n Virtual de la plataforma ViSH.  Despu\u00e9s de esto la excursi\u00f3n ser\u00e1 privada y solo t\u00fa podras acceder a ella. \u00bfQu\u00e9 deseas hacer?", 
"i.Unknown":"Desconocido", "i.Unlimited":"Ilimitado", "i.UnselectAll":"Deseleccionar Todas", "i.UnselectSlide":"Deseleccionar Diapositiva", "i.unspecified":"sin especificar", "i.Unspecified":"Sin especificar", "i.Untitled":"Sin T\u00edtulo", "i.upload":"subir", "i.Upload":"Subir", "i.uploadErrorWrongServer":"El servidor a respondido con un error", "i.uploadErrorTooBig":"El archivo supera los 8MB pruebe a intentarlo de nuevo", "i.uploadErrorCantReach":"La petici\u00f3n no puede llegar al servidor", 
"i.uploadHasToSaveFirst":"Debe guardar primero la excursi\u00f3n antes de poder subir un archivo adjunto.", "i.url":"enlace", "i.Url":"Enlace", "i.Version":"Versi\u00f3n", "i.Vertical":"Vertical", "i.verydifficult":"muy dif\u00edcil", "i.veryeasy":"muy f\u00e1cil", "i.Video":"v\u00eddeo", "i.Videos":"v\u00eddeos", "i.VirtualTour":"Tour Virtual", "i.wappSettings":"Ajustes de la Aplicaci\u00f3n Web", "i.wappSettingsEnableAPI":"Activar API de Aplicaci\u00f3n Web", "i.wappSettingsSecores":"Esta aplicaci\u00f3n env\u00eda puntuaciones", 
"i.yes":"si", "i.Yes":"Si", "i.YouTubePlayAlert":"Haz click sobre el v\u00eddeo para empezar la reproducci\u00f3n", "i.ZoneTooltip":"Haz click aqu\u00ed para a\u00f1adir contenido", "i.Zoom":"Ampliar", "i.Zoom-":"Ampliar-", "i.Zoom+":"Ampliar+", "i.tooltip.continueDisabled":"Escribe un t\u00edtulo y escoge un avatar para continuar", "i.tooltip.QSInput":"Introduce un nombre para el cuestionario en vivo", "i.tooltip.Help":"Ayuda", "i.tooltip.UploadAttachment":"Si no puedes subir un archivo adjunto, guarda primero la excursi\u00f3n", 
"i.vtTitle_GStarted":"Introducci\u00f3n a ViSH Editor", "i.img.tut_menu":"tutorial/tut_menu_es.png", "i.img.tut_selects":"tutorial/tut_selects_es.png", "i.img.tut_unselects":"tutorial/tut_unselects_es.png", "i.img.tut_selectAll":"tutorial/tut_selectall_es.png", "i.img.tut_unselectAll":"tutorial/tut_unselectall_es.png", "i.last":"\u00faltimo"}, "fr":{"i.Saved":"Enregistr\u00e9", "i.Saving":"Enregistrement", "i.Unpublish_confirmation":"Vous allez d\u00e9publier ce Excursion virtuelle de la plate-forme ViSH. Apr\u00e8s cela, l'excursion sera priv\u00e9 et ne vous sera en mesure d'y acc\u00e9der. Que souhaitez-vous faire?", 
"i.Animations":"Animation", "i.Opacity":"Opacit\u00e9", "i.Elements":"\u00c9l\u00e9ments", "i.Rotate":"tourner", "i.Diagonal1":"Diagonale #1", "i.Diagonal2":"Diagonale #2", "i.Inside":"Int\u00e9rieur", "i.Zoom":"Ampliar", "i.Flip1":"Tour #1", "i.Flip2":"Tour #2", "i.accept":"accepter", "i.AddSlideMin":"Ajouter", "i.add":"ajouter", "i.Add":"Ajouter", "i.Addanavatar":"Ajouter un avatar*", "i.addatitle":"ajouter un titre", "i.AddContent":"Ajouter un contenu", "i.addembeddedobject":"ajouter un objet incorpor\u00e9", 
"i.AddFromJSONfile":"Ajouter une pr\u00e9sentation ViSH editor \u00e0 partir d'un fichier JSON", "i.addpicurl":"ajouter l'URL d'une image", "i.AddSlide":"Ajouter une diapositive", "i.AddSlides":"Ajouter des diapositives", "i.AddslideshowPDF":"Ajouter un diaporama \u00e0 partir d'un fichier PDF", "i.AddTags":"Ajouter des mots-cl\u00e9s", "i.addvideourl":"ajouter l'URL d'une vid\u00e9o (YouTube, HTML5)", "i.AgeRange":"Tranche d'\u00e2ge", "i.areyousureNotification":"\u00cates-vous s\u00fbr(e)\u00a0?", 
"i.Art":"Art", "i.Astronomy":"Astronomie", "i.Author":"Auteur", "i.Background":"Arri\u00e8re-plan", "i.biology":"biologie", "i.Biology":"Biologie", "i.browserrequirements":"Votre navigateur ne r\u00e9pond pas aux exigences minimales pour lancer ViSH editor, veuillez mettre \u00e0 jour votre navigateur.", "i.by":"par", "i.cancel":"annuler", "i.Cancel":"Annuler", "i.Catalog":"Catalogue", "i.Chemistry":"Chimie", "i.Citizenship":"Citoyennet\u00e9", "i.ClassicalLanguages":"Langues classiques", "i.close":"fermer", 
"i.Close":"Fermer", "i.content":"contenu", "i.Content":"Contenu", "i.Context":"Contexte", "i.continue":"continuer", "i.Continue":"Continuer", "i.CrossCurricularEducation":"\u00c9ducation interdisciplinaire", "i.ComputerScience":"Informatique", "i.delete":"supprimer", "i.Description":"Description", "i.difficult":"difficile", "i.Difficulty":"Difficult\u00e9", "i.done":"termin\u00e9", "i.Done":"Termin\u00e9", "i.draft":"brouillon", "i.easy":"facile", "i.Economics":"\u00c9conomie", "i.edit":"\u00e9diter", 
"i.Education":"\u00c9ducation", "i.EducationalObjectives":"Objectifs \u00e9ducatifs", "i.EducationalObjectivesPlaceholder":"Veuillez d\u00e9crire les objectifs \u00e9ducatifs que vous entendez remplir avec cette excursion...", "i.Electronics":"\u00c9lectronique", "i.embedwebsite":"int\u00e9grer une page web", "i.embedWebSnapshot":"int\u00e9grer la capture instantan\u00e9e d'une page web", "i.EnvironmentalEducation":"\u00c9ducation \u00e0 l'environnement", "i.errorFlickrConnection":"Erreur de connexion \u00e0 Flickr", 
"i.errorLREConnection":"Erreur de connexion \u00e0 la biblioth\u00e8que LRE", "i.errorViSHConnection":"Erreur de connexion au serveur ViSH", "i.errorYoutubeConnection":"Erreur de connexion \u00e0 YouTube", "i.Ethics":"\u00c9thique", "i.exitConfirmation":"Vous \u00eates sur le point de quitter ViSH editor. Vous perdrez toutes les modifications que vous n'avez pas enregistr\u00e9es.", "i.exitConfirmation2":"Souhaitez-vous vraiment quitter cette page\u00a0?", "i.Export":"Exporter", "i.exportPresToJSONerrorNotification":"Une erreur s'est produite. Il est impossible d'exporter la pr\u00e9sentation vers un fichier JSON.", 
"i.Filllater":"Remplir plus tard", "i.Finish":"Terminer", "i.ForeignLanguages":"Langues \u00e9trang\u00e8res", "i.Game":"Jeu", "i.GeneralCulture":"Culture g\u00e9n\u00e9rale", "i.Geography":"G\u00e9ographie", "i.Geology":"G\u00e9ologie", "i.GotoSettings":"Acc\u00e9der aux param\u00e8tres", "i.HealthEducation":"\u00c9ducation \u00e0 la sant\u00e9", "i.Help":"Aide", "i.HigherEducation":"Enseignement sup\u00e9rieur", "i.History":"Histoire", "i.HomeEconomics":"\u00c9conomie domestique", "i.Horizontal":"Horizontal", 
"i.Hours":"Heures", "i.Image":"Image", "i.Images":"Images", "i.Import":"Importer", "i.Insert":"Ins\u00e9rer", "i.invalidvalue":"valeur invalide", "i.Language":"Langue", "i.Languageindependent":"Ind\u00e9pendante de la langue", "i.Law":"Droit", "i.limitReached":"limite atteinte", "i.link":"lien", "i.Literature":"Litt\u00e9rature", "i.LiveQuiz":"Quiz en direct", "i.LiveResources":"Ressources en direct", "i.MandatoryFieldsNotification":"Vous devez saisir un titre et choisir un avatar avant de publier l'excursion.", 
"i.math":"math\u00e9matiques", "i.Mathematics":"Math\u00e9matiques", "i.medium":"moyennement difficile", "i.Minutes":"Minutes", "i.Music":"Musique", "i.nanoscience":"nanosciences", "i.NaturalSciences":"Sciences naturelles", "i.next":"suivant", "i.Next":"Suivant", "i.no":"non", "i.No":"Non", "i.NoJSONFileError":"Vous devez s\u00e9lectionner un fichier \u00e0 importer au format JSON.", "i.Noresultsfound":"Aucun r\u00e9sultat trouv\u00e9", "i.NoSlidesOnSaveNotification":"Avant d'enregistrer votre excursion, vous devez cr\u00e9er au moins une diapositive.", 
"i.Object":"Objet", "i.Objects":"Objets", "i.or":"ou", "i.Other":"Autre", "i.Others":"Autres", "i.pasteEmbedObject":"coller l'URL du fichier SWF ou PDF", "i.pasteImageURL":"coller l'URL de l'image", "i.pasteVideoURL":"coller l'URL de la vid\u00e9o HTML5 ou YouTube", "i.pasteWeb":"coller l'URL de la page web", "i.pdfErrorNotification":"Une erreur s'est produite. Assurez-vous que le fichier PDF est valide.", "i.PDFNotValid":"Une erreur s'est produite. Assurez-vous que le fichier PDF s\u00e9lectionn\u00e9 est valide.", 
"i.PDFSlideshow":"Diaporama PDF", "i.MetadataAspects":"Aspects p\u00e9dagogiques", "i.Philosophy":"Philosophie", "i.PhysicalEducation":"\u00c9ducation physique", "i.Physics":"Physique", "i.pNotValid":"Il est impossible d'ouvrir cette ressource, car elle est corrompue ou incompatible avec la version actuelle de ViSH editor.", "i.Politics":"Politique", "i.Preschool":"Enseignement pr\u00e9scolaire", "i.Presentation":"Pr\u00e9sentation", "i.presDescriptionPlaceHolder":"Veuillez d\u00e9crire bri\u00e8vement sur quel sujet porte votre excursion...", 
"i.presTitle":"Titre de l'excursion", "i.Preview":"Aper\u00e7u", "i.Psychology":"Psychologie", "i.publish":"publier", "i.Publish":"Publier", "i.Quiz":"Quiz", "i.QuizButtonAnswer":"R\u00e9pondre", "i.QuizButtonLaunch":"Lancer", "i.QuizButtonOptions":"Options", "i.QuizButtonRetry":"R\u00e9essayer", "i.QuizEmptyAnswerAlert":"Veuillez r\u00e9pondre au quiz avant de l'envoyer.", "i.QuizLaunch":"Lancer", "i.QuizMultipleLaunchAlert":"Veuillez arr\u00eater tous les quiz en direct avant d'en lancer un nouveau.", 
"i.QuizNotSubmittedAlert":"D\u00e9sol\u00e9, votre r\u00e9ponse n'a pas pu \u00eatre envoy\u00e9e.", "i.QuizResults":"R\u00e9sultats", "i.QuizSaveConfirmation":"Souhaitez-vous enregistrer les r\u00e9sultats du quiz\u00a0?", "i.QuizSessionName":"Nom du quiz en direct", "i.QuizStop":"Arr\u00eater", "i.QuizSubmittedAlert":"Votre r\u00e9ponse a \u00e9t\u00e9 envoy\u00e9e", "i.Quizzes":"Quiz", "i.readJSONfileError":"Erreur de lecture du fichier JSON", "i.Religion":"Religion", "i.Remove":"Supprimer", "i.resourceNonCompatibleNotification":"Il est impossible d'ouvrir cette ressource, car elle est corrompue ou incompatible avec la version actuelle de ViSH editor.", 
"i.save":"enregistrer", "i.Save":"Enregistrer", "i.Saving":"Enregistrement", "i.School":"\u00c9cole", "i.SearchContent":"Rechercher du contenu", "i.Searchplaces":"Rechercher des endroits", "i.Seconds":"Secondes", "i.SelectAll":"Tout s\u00e9lectionner", "i.selectObjectUpload":"S\u00e9lectionner un fichier \u00e0 t\u00e9l\u00e9charger", "i.selectObjectUpload2":"Formats pris en charge\u00a0: SWF (flash), PDF", "i.selectPicture":"S\u00e9lectionner une photo \u00e0 t\u00e9l\u00e9charger", "i.SelectSlide":"S\u00e9lectionner une diapositive", 
"i.SelectTheme":"S\u00e9lectionner un th\u00e8me", "i.Settings":"Param\u00e8tres", "i.Slides":"Diapositives", "i.SocialSciences":"Sciences sociales", "i.SoftwareEngineering":"G\u00e9nie logiciel", "i.Style":"Mod\u00e8le", "i.Subject":"Mati\u00e8re", "i.Tags":"Mots-cl\u00e9s", "i.Technology":"Technologies", "i.Templates":"Mod\u00e8les", "i.text":"texte", "i.Text":"Texte", "i.Telecommunications":"T\u00e9l\u00e9communications", "i.Themes":"Th\u00e8mes", "i.Title":"Titre*", "i.toJSON":"au format JSON", 
"i.Training":"Formation", "i.Typicallearningtime":"Temps d'apprentissage moyen", "i.unpublish":"d\u00e9publier", "i.Unpublish":"D\u00e9publier", "i.unpublishing":"annulation", "i.Unpublishing":"Annulation", "i.University":"Universit\u00e9", "i.UnselectAll":"D\u00e9s\u00e9lectionner tout", "i.UnselectSlide":"D\u00e9s\u00e9lectionner la diapositive", "i.unspecified":"non sp\u00e9cifi\u00e9", "i.Unspecified":"Non sp\u00e9cifi\u00e9", "i.upload":"t\u00e9l\u00e9charger", "i.Upload":"T\u00e9l\u00e9charger", 
"i.verydifficult":"tr\u00e8s difficile", "i.veryeasy":"tr\u00e8s facile", "i.Vertical":"Vertical", "i.Video":"vid\u00e9o", "i.Videos":"vid\u00e9os", "i.VirtualTour":"Tour virtuel", "i.yes":"oui", "i.Yes":"Oui", "i.ZoneTooltip":"Cliquez pour ajouter un contenu", "i.tooltip.QSInput":"Saisir le nom du quiz en direct"}, "nl":{"i.Saved":"Opgeslagen", "i.Saving":"Besparing", "i.Unpublish_confirmation":"U gaat naar deze Virtuele Excursie depubliceren van de ViSH Platform. Hierna zal de excursie prive en alleen u zult in staat zijn om toegang te krijgen zijn. Wat wilt u doen?", 
"i.Animations":"Animatie", "i.Opacity":"Ondoorzichtigheid", "i.Elements":"Communie", "i.Rotate":"Draaien", "i.Diagonal1":"Diagonaal #1", "i.Diagonal2":"Diagonaal #2", "i.Inside":"Binnen", "i.Zoom":"Ampliar", "i.Flip1":"Beurt #1", "i.Flip2":"Beurt #2", "i.accept":"accepteren", "i.AddSlideMin":"Toevoegen", "i.add":"toevoegen", "i.Add":"Toevoegen", "i.Addanavatar":"Een avatar toevoegen *", "i.addatitle":"een titel toevoegen", "i.AddContent":"Inhoud toevoegen", "i.addembeddedobject":"embedded object toevoegen", 
"i.AddFromJSONfile":"ViSH Editor-Presentatie toevoegen vanuit JSON-bestand", "i.addpicurl":"afbeeldings-url toevoegen", "i.AddSlide":"Dia toevoegen", "i.AddSlides":"Dia\u2019s toevoegen", "i.AddslideshowPDF":"Diavoorstelling toevoegen vanuit PDF-bestand", "i.AddTags":"Tags toevoegen", "i.addvideourl":"Video-url toevoegen (YouTube, HTML5)", "i.AgeRange":"Leeftijdscategorie", "i.areyousureNotification":"Weet u het zeker?", "i.Art":"Kunst", "i.Astronomy":"Astronomie", "i.Author":"Auteur", "i.Background":"Achtergrond", 
"i.biology":"Biologie", "i.Biology":"Biologie", "i.browserrequirements":"Uw browser voldoet niet aan de minimumeisen om de ViSH Editor op te starten, update uw browser.", "i.by":"door", "i.cancel":"annuleren", "i.Cancel":"Annuleren", "i.Chemistry":"Scheikunde", "i.Citizenship":"Burgerschap", "i.ClassicalLanguages":"Klassieke Talen", "i.close":"sluiten", "i.Close":"Sluiten", "i.content":"inhoud", "i.Content":"Inhoud", "i.Context":"Context", "i.continue":"doorgaan", "i.Continue":"Doorgaan", "i.CrossCurricularEducation":"Vakoverschrijdend Onderwijs", 
"i.ComputerScience":"Informatica", "i.delete":"verwijderen", "i.Description":"Beschrijving", "i.difficult":"moeilijk", "i.Difficulty":"Moeilijkheid", "i.done":"klaar", "i.Done":"Klaar", "i.draft":"ontwerp", "i.easy":"gemakkelijk", "i.Economics":"Economie", "i.edit":"bewerken", "i.Education":"Onderwijs", "i.EducationalObjectives":"Onderwijskundige Doelstellingen", "i.EducationalObjectivesPlaceholder":"Beschrijf de onderwijskundige doelstellingen die u beoogt te verwezenlijken met deze excursie...", 
"i.Electronics":"Elektronica", "i.embedwebsite":"web embedden", "i.embedWebSnapshot":"Websnapshot embedden", "i.EnvironmentalEducation":"Milieueducatie", "i.errorFlickrConnection":"Fout met betrekking tot Flickr", "i.errorLREConnection":"Fout met betrekking tot LRE-opslagbank", "i.errorViSHConnection":"Fout met betrekking tot ViSH server", "i.errorYoutubeConnection":"Fout met betrekking tot YouTube", "i.Ethics":"Ethiek", "i.ExcursionDetails":"Bijzonderheden Excursie", "i.Excursions":"Excursies", 
"i.exitConfirmation":"U staat op het punt ViSH Editor te verlaten. U raakt alle veranderingen kwijt die u niet hebt opgeslagen.", "i.exitConfirmation2":"Weet u zeker dat u deze pagina wilt verlaten?", "i.Export":"Exporteren", "i.exportPresToJSONerrorNotification":"Er is een fout opgetreden. Het is niet mogelijk de presentatie te exporteren naar een JSON-bestand.", "i.Filllater":"Later invullen", "i.Finish":"Voltooien", "i.ForeignLanguages":"Vreemde Talen", "i.Game":"Spel", "i.GeneralCulture":"Algemene Cultuur", 
"i.Geography":"Aardrijkskunde", "i.Geology":"Geologie", "i.GotoSettings":"Ga naar Instellingen", "i.HealthEducation":"Gezondheidsonderwijs", "i.Help":"Hulp", "i.HigherEducation":"Hoger Onderwijs", "i.History":"Geschiedenis", "i.HomeEconomics":"Huishoudkunde", "i.Horizontal":"Horizontaal", "i.Hours":"Uren", "i.Image":"Afbeelding", "i.Images":"Afbeeldingen", "i.Import":"Importeren", "i.Insert":"Invoegen", "i.invalidvalue":"ongeldige waarde", "i.Language":"Taal", "i.Languageindependent":"Taalonafhankelijk", 
"i.Law":"Wet", "i.limitReached":"limiet bereikt", "i.link":"link", "i.Literature":"Literatuur", "i.LiveQuiz":"Live Quiz", "i.LiveResources":"Live Hulpbronnen", "i.MandatoryFieldsNotification":"U moet een titel invoeren voor de excursie en een avatar selecteren voordat u de excursie publiceert", "i.math":"wiskunde", "i.Mathematics":"Wiskunde", "i.medium":"medium", "i.Minutes":"Minuten", "i.Music":"Muziek", "i.nanoscience":"nanowetenschap", "i.NaturalSciences":"NatuurWetenschappen", "i.next":"volgende", 
"i.Next":"Volgende", "i.no":"nee", "i.No":"Nee", "i.NoJSONFileError":"U moet een bestand selecteren om in JSON-formaat te importeren", "i.Noresultsfound":"Geen resultaten gevonden", "i.NoSlidesOnSaveNotification":"Voordat u opslaat, moet u ten minste \u00e9\u00e9n dia cre\u00ebren.", "i.Object":"Object", "i.Objects":"Objecten", "i.or":"of", "i.Other":"Overige", "i.Others":"Overige", "i.pasteEmbedObject":"SWF of PDF bestand URL plakken", "i.pasteImageURL":"afbeeldings-URL plakken", "i.pasteVideoURL":"HTML5 of YouTube video-URL plakken", 
"i.pasteWeb":"website-URL plakken", "i.pdfErrorNotification":"Er is een fout opgetreden. Zorg ervoor dat het PDF-bestand geldig is.", "i.PDFNotValid":"Er is een fout opgetreden. Zorg ervoor dat het geselecteerde PDF-bestand correct is.", "i.PDFSlideshow":"PDF-diaserie", "i.MetadataAspects":"Pedagogische Aspecten", "i.Philosophy":"Filosofie", "i.PhysicalEducation":"Lichamelijke Oefening", "i.Physics":"Natuurkunde", "i.pNotValid":"Deze hulpbron kan niet worden geopend omdat zij corrupt is of niet compatibel is met de huidige versie van ViSH Editor.", 
"i.Politics":"Politiek", "i.Preschool":"Voorschools", "i.Presentation":"Presentatie", "i.presDescriptionPlaceHolder":"Beschrijf in een paar woorden waar uw excursie over gaat...", "i.presTitle":"Titel Excursie", "i.Preview":"Vooruitblik", "i.Psychology":"Psychologie", "i.publish":"publiceren", "i.Publish":"Publiceren", "i.Quiz":"Quiz", "i.QuizButtonAnswer":"Antwoorden", "i.QuizButtonLaunch":"Starten", "i.QuizButtonOptions":"Opties", "i.QuizButtonRetry":"Opnieuw proberen", "i.QuizEmptyAnswerAlert":"De quiz beantwoorden voordat u deze verzendt", 
"i.QuizLaunch":"Starten", "i.QuizMultipleLaunchAlert":"Alle live quizzen be\u00ebindigen voordat u een andere start", "i.QuizNotSubmittedAlert":"Sorry, uw antwoord kon niet verzonden worden", "i.QuizResults":"Resultaten", "i.QuizSaveConfirmation":"Wilt u de resultaten van de quiz opslaan?", "i.QuizSessionName":"Naam Live Quiz", "i.QuizStop":"Stoppen", "i.QuizSubmittedAlert":"Uw antwoord is verzonden", "i.Quizzes":"Quizzen", "i.readJSONfileError":"Er is een fout opgetreden bij het lezen van het JSON-bestand", 
"i.Religion":"Godsdienst", "i.Remove":"Verwijderen", "i.resourceNonCompatibleNotification":"Deze hulpbron is corrupt of is niet compatibel met de huidige versie van ViSH Editor en kan niet worden geopend.", "i.save":"opslaan", "i.Save":"Opslaan", "i.Saving":"Bestand", "i.School":"School", "i.SearchContent":"Inhoud zoeken", "i.Searchplaces":"Plaatsen zoeken", "i.Seconds":"Seconden", "i.SelectAll":"Alles selecteren", "i.selectObjectUpload":"Een bestand selecteren om te uploaden", "i.selectObjectUpload2":"Ondersteunde formaten: SWF (flash), PDF", 
"i.selectPicture":"Afbeelding selecteren om te uploaden", "i.SelectSlide":"Dia selecteren", "i.SelectTheme":"Thema selecteren", "i.Settings":"Instellingen", "i.Slides":"Dia\u2019s", "i.SocialSciences":"Sociale Wetenschappen", "i.SoftwareEngineering":"Software Engineering", "i.Style":"Stijl", "i.Subject":"Vak", "i.Tags":"Tags", "i.Technology":"Technologie", "i.Templates":"Sjablonen", "i.text":"tekst", "i.Text":"Tekst", "i.Telecommunications":"Telecommunicatie", "i.Themes":"Thema's", "i.Title":"Titel *", 
"i.toJSON":"naar JSON", "i.Training":"Opleiding", "i.Typicallearningtime":"Typische leertijd", "i.unpublish":"depubliceren", "i.Unpublish":"Depubliceren", "i.unpublishing":"verwijderen", "i.Unpublishing":"Verwijderen", "i.University":"Universiteit", "i.UnselectAll":"Alles deselecteren", "i.UnselectSlide":"Dia deselecteren", "i.unspecified":"ongespecificeerd", "i.Unspecified":"Ongespecificeerd", "i.upload":"uploaden", "i.Upload":"Uploaden", "i.verydifficult":"zeer moeilijk", "i.veryeasy":"zeer gemakkelijk", 
"i.Vertical":"Verticaal", "i.Video":"video", "i.Videos":"video\u2019s", "i.VirtualTour":"Virtuele Rondleiding", "i.yes":"ja", "i.Yes":"Ja", "i.ZoneTooltip":"Klik hier om inhoud toe te voegen", "i.tooltip.QSInput":"Voor een naam in voor de live quiz"}, "hu":{"i.Saved":"Mentett", "i.Saving":"Ment\u00e9se", "i.Unpublish_confirmation":"Fogsz publik\u00e1lni ezt a virtu\u00e1lis kir\u00e1ndul\u00e1s a ViSH Platform. Ezt k\u00f6vet\u0151en a kir\u00e1ndul\u00e1s lesz mag\u00e1n, \u00e9s csak akkor lesz k\u00e9pes hozz\u00e1f\u00e9rni. Mit szeretn\u00e9l csin\u00e1lni?", 
"i.Animations":"\u00c9l\u00e9nks\u00e9g", "i.Opacity":"Hom\u00e1lyoss\u00e1g", "i.Elements":"Alapismeretek", "i.Rotate":"Forgat", "i.Diagonal1":"\u00c1tl\u00f3s #1", "i.Diagonal2":"\u00c1tl\u00f3s #2", "i.Inside":"Bels\u0151", "i.Zoom":"Zoomol\u00e1s", "i.Flip1":"Megfricsk\u00e1z #1", "i.Flip2":"Megfricsk\u00e1z #2", "i.About2":"A k\u00f3d el\u00e9rhet\u0151 itt: ", "i.About3":"l\u00e1togasd meg a YouTube csatorn\u00e1nkat", "i.About4":"K\u00e9sz\u00edtette", "i.accept":"elfogad", "i.AddSlideMin":"Hozz\u00e1ad\u00e1s", 
"i.add":"hozz\u00e1ad\u00e1s", "i.Add":"Hozz\u00e1ad\u00e1s", "i.Addanavatar":"Adj meg egy k\u00e9pet *", "i.addatitle":"adj meg egy c\u00edmet", "i.AddContent":"Adj hozz\u00e1 tartalmat", "i.addembeddedobject":"adj hozz\u00e1 be\u00e1gyazott k\u00f3dot", "i.AddFromJSONfile":"ViSH Szerkeszt\u0151 prezent\u00e1ci\u00f3 hozz\u00e1ad\u00e1sa JSON f\u00e1jlb\u00f3l", "i.addpicurl":"k\u00e9p URL hozz\u00e1ad\u00e1sa", "i.AddSlide":"Dia hozz\u00e1ad\u00e1sa", "i.AddSlides":"Di\u00e1k hozz\u00e1ad\u00e1sa", 
"i.AddslideshowPDF":"Diasor hozz\u00e1ad\u00e1sa PDF-b\u0151l", "i.AddTags":"C\u00edmke hozz\u00e1ad\u00e1sa", "i.addvideourl":"video URL hozz\u00e1ad\u00e1sa (YouTube, HTML5)", "i.AgeRange":"Koroszt\u00e1ly", "i.areyousureNotification":"biztos vagy benne?", "i.Art":"M\u0171v\u00e9szetek", "i.Astronomy":"Csillag\u00e1szat", "i.Author":"Szerz\u0151", "i.Background":"H\u00e1tt\u00e9r", "i.biology":"biol\u00f3gia", "i.Biology":"Biol\u00f3gia", "i.browserrequirements":"A b\u00f6ng\u00e9sz\u0151d sajnos nem felel meg azoknak a k\u00f6vetelm\u00e9nyeknek ami a ViSH szerkeszt\u0151 megnyit\u00e1s\u00e1hoz sz\u00fcks\u00e9gesek. K\u00e9rlek, friss\u00edtsd a b\u00f6ng\u00e9sz\u0151det.", 
"i.by":"k\u00e9sz\u00edtette", "i.cancel":"m\u00e9gsem", "i.Cancel":"M\u00e9gsem", "i.Chemistry":"K\u00e9mia", "i.Citizenship":"\u00c1llampolg\u00e1rs\u00e1g", "i.ClassicalLanguages":"Klasszikus nyelvek", "i.close":"bez\u00e1r", "i.Close":"Bez\u00e1r", "i.content":"tartalom", "i.Content":"Tartalom", "i.Context":"\u00d6sszef\u00fcgg\u00e9s", "i.continue":"tov\u00e1bb", "i.Continue":"Tov\u00e1bb", "i.CrossCurricularEducation":"Cross Curricular Education", "i.ComputerScience":"Informatika", "i.delete":"t\u00f6r\u00f6l", 
"i.Description":"Le\u00edr\u00e1s", "i.difficult":"neh\u00e9z", "i.Difficulty":"Neh\u00e9zs\u00e9g", "i.Documentation":"Dokument\u00e1ci\u00f3", "i.done":"k\u00e9sz", "i.Done":"K\u00e9sz", "i.draft":"piszkozat", "i.easy":"k\u00f6nny\u0171", "i.Economics":"K\u00f6zgazdas\u00e1gtan", "i.edit":"szerkeszt\u00e9s", "i.Education":"Oktat\u00e1s", "i.EducationalObjectives":"Oktat\u00e1si c\u00e9lok", "i.EducationalObjectivesPlaceholder":"K\u00e9rlek r\u00e9szletezd az oktat\u00e1si c\u00e9lokat amiket ezzel a virtu\u00e1lis s\u00e9t\u00e1val szeretn\u00e9l el\u00e9rni...", 
"i.Electronics":"Elektronika", "i.embedwebsite":"be\u00e1gyazott weboldal", "i.embedWebSnapshot":"be\u00e1gyazott weboldal k\u00e9p", "i.EnvironmentalEducation":"K\u00f6rnyezeti tanulm\u00e1nyok", "i.errorFlickrConnection":"Hiba a Flickr-hez val\u00f3 csatlakoz\u00e1skor", "i.errorLREConnection":"Hiba az LRE t\u00e1rh\u00e1zhoz val\u00f3 csatlakoz\u00e1skor", "i.errorViSHConnection":"Hiba a ViSH szerverhez val\u00f3 csatlakoz\u00e1skor", "i.errorYoutubeConnection":"Hiba a YouTube-hoz val\u00f3 csatlakoz\u00e1skor", 
"i.Ethics":"Etika", "i.exitConfirmation":"A ViSH szerkeszt\u0151 elhagy\u00e1s\u00e1ra k\u00e9sz\u00fclsz. Minden nem mentett v\u00e1ltoztat\u00e1s el fog veszni.", "i.exitConfirmation2":"Biztosan el akarod hagyni ezt az oldalt?", "i.Export":"Export\u00e1l\u00e1s", "i.exportPresToJSONerrorNotification":"Hiba l\u00e9pett fel. Nem lehet JSON f\u00e1jlba export\u00e1lni.", "i.Filllater":"K\u00e9s\u0151bb t\u00f6lt\u00f6m ki", "i.Finish":"Befejez\u00e9s", "i.ForeignLanguages":"Idegen nyelvek", "i.Game":"J\u00e1t\u00e9k", 
"i.GeneralCulture":"\u00c1ltal\u00e1nos kult\u00fara", "i.Geography":"F\u00f6ldrajz", "i.Geology":"Geol\u00f3gia", "i.GotoSettings":"Menj a be\u00e1ll\u00edt\u00e1sokhoz", "i.HealthEducation":"Eg\u00e9szs\u00e9g\u00fcgyi oktat\u00e1s", "i.Help":"Seg\u00edts\u00e9g", "i.HigherEducation":"Fels\u0151oktat\u00e1s", "i.History":"T\u00f6rt\u00e9nelem", "i.HomeEconomics":"H\u00e1ztart\u00e1stan", "i.Horizontal":"V\u00edzszintes", "i.Hours":"\u00d3r\u00e1k", "i.Image":"K\u00e9p", "i.Images":"K\u00e9pek", 
"i.Import":"Import\u00e1l\u00e1s", "i.Insert":"Beilleszt\u00e9s", "i.invalidvalue":"\u00e9rv\u00e9nytelen \u00e9rt\u00e9k", "i.Language":"Nyelv", "i.Languageindependent":"Nyelv f\u00fcggetlen", "i.Law":"T\u00f6rv\u00e9ny", "i.License":"Enged\u00e9ly", "i.limitReached":"limit el\u00e9rve", "i.link":"link", "i.Literature":"Irodalom", "i.LiveQuiz":"\u00c9l\u0151 Kv\u00edz", "i.LiveResources":"\u00c9l\u0151 Tartalom", "i.MandatoryFieldsNotification":"K\u00e9rlek adj meg egy c\u00edmet \u00e9s egy k\u00e9pet miel\u0151tt publik\u00e1lod a Virtu\u00e1lis S\u00e9t\u00e1t.", 
"i.math":"matek", "i.Mathematics":"Matematika", "i.medium":"k\u00f6zepes", "i.Minutes":"Percek", "i.Music":"Zene", "i.nanoscience":"nano tudom\u00e1ny", "i.NaturalSciences":"Term\u00e9szettudom\u00e1nyok", "i.next":"k\u00f6vetkez\u0151", "i.Next":"K\u00f6vetkez\u0151", "i.no":"nem", "i.No":"Nem", "i.NoJSONFileError":"Ki kell v\u00e1lasztanod egy f\u00e1jl a JSON import\u00e1l\u00e1shoz.", "i.Noresultsfound":"Nincs tal\u00e1lat", "i.NoSlidesOnSaveNotification":"Ment\u00e9s el\u0151tt legal\u00e1bb egy di\u00e1t k\u00e9sz\u00edtened kell.", 
"i.Object":"T\u00e1rgy", "i.Objects":"T\u00e1rgyak", "i.or":"vagy", "i.Other":"T\u00f6bbi", "i.Others":"T\u00f6bbi", "i.pasteEmbedObject":"illeszd be az SWF vagy a PDF f\u00e1jl URL-j\u00e9t", "i.pasteImageURL":"illeszd be a k\u00e9p URL-j\u00e9t", "i.pasteVideoURL":"illeszd be a HTML5 vagy YouTube vide\u00f3 URL-j\u00e9t", "i.pasteWeb":"illeszd be a weboldal URL-j\u00e9t", "i.pdfErrorNotification":"Hiba l\u00e9pett fel, k\u00e9rlek ellen\u0151rizd le, hogy a PDF f\u00e1jl rendben van-e.", "i.PDFNotValid":" Hiba l\u00e9pett fel, k\u00e9rlek ellen\u0151rizd le, hogy a PDF f\u00e1jl rendben van-e.", 
"i.PDFSlideshow":"PDF diasor", "i.MetadataAspects":"Pedag\u00f3gia Szempontok", "i.Philosophy":"Filoz\u00f3fia", "i.PhysicalEducation":"Testnevel\u00e9s", "i.Physics":"Fizika", "i.pNotValid":"Ez a tartalom nem nyithat\u00f3 meg, mert vagy hib\u00e1s, vagy nem kompatibilis a ViSH szerkeszt\u0151 ezen verzi\u00f3j\u00e1val.", "i.Politics":"Politol\u00f3gia", "i.Preschool":"\u00c1ltal\u00e1nos iskola", "i.Presentation":"Prezent\u00e1ci\u00f3", "i.presDescriptionPlaceHolder":"K\u00e9rlek n\u00e9h\u00e1ny sz\u00f3ban ismertesd mir\u0151l sz\u00f3l a Virtu\u00e1lis S\u00e9t\u00e1d...", 
"i.presTitle":"Virtu\u00e1lis S\u00e9ta c\u00edme", "i.Preview":"El\u0151n\u00e9zet", "i.Psychology":"Pszichol\u00f3gia", "i.publish":"publik\u00e1l\u00e1s", "i.Publish":"Publik\u00e1l\u00e1s", "i.Quiz":"Kv\u00edz", "i.QuizButtonAnswer":"V\u00e1lasz", "i.QuizButtonLaunch":"Ind\u00edt\u00e1s", "i.QuizButtonOptions":"Be\u00e1ll\u00edt\u00e1sok", "i.QuizButtonRetry":"\u00dajra", "i.QuizEmptyAnswerAlert":"K\u00fcld\u00e9s el\u0151tt k\u00e9rlek v\u00e1laszolj a kv\u00edzre", "i.QuizLaunch":"Ind\u00edt\u00e1s", 
"i.QuizMultipleLaunchAlert":"K\u00e9rlek fejezz be minden fut\u00f3 kv\u00edzt miel\u0151tt egy \u00fajat ind\u00edtasz", "i.QuizNotSubmittedAlert":"Sajn\u00e1lom, a v\u00e1laszod nem tudtuk elk\u00fcldeni", "i.QuizResults":"Eredm\u00e9nyek", "i.QuizSaveConfirmation":"Szeretn\u00e9d elmenteni a kv\u00edz eredm\u00e9nyeit?", "i.QuizSessionName":"\u00c9l\u0151 kv\u00edz neve", "i.QuizStop":"Le\u00e1ll\u00edt\u00e1s", "i.QuizSubmittedAlert":"A v\u00e1laszaid el lettek mentve", "i.Quizzes":"Kv\u00edzek", 
"i.readJSONfileError":"JSON f\u00e1jl olvas\u00e1si hiba", "i.Religion":"Vall\u00e1s", "i.Remove":"Elt\u00e1vol\u00edt\u00e1s", "i.resourceNonCompatibleNotification":" Ez a tartalom nem nyithat\u00f3 meg, mert vagy hib\u00e1s, vagy nem kompatibilis a ViSH szerkeszt\u0151 ezen verzi\u00f3j\u00e1val.", "i.save":"ment\u00e9s", "i.Save":"Ment\u00e9s", "i.Saving":"Megtakar\u00edt\u00e1s", "i.School":"Iskola", "i.SearchContent":"Tartalom keres\u00e9s", "i.Searchplaces":"Helyek keres\u00e9se", "i.Seconds":"M\u00e1sodpercek", 
"i.SelectAll":"Mindegyik kiv\u00e1laszt\u00e1sa", "i.selectObjectUpload":"V\u00e1laszd ki a felt\u00f6lteni k\u00edv\u00e1nt f\u00e1jlt", "i.selectObjectUpload2":"T\u00e1mogatott form\u00e1tumok: SWF (flash), PDF", "i.selectPicture":"V\u00e1laszd ki a felt\u00f6lteni k\u00edv\u00e1nt k\u00e9pet", "i.SelectSlide":"V\u00e1lassz di\u00e1t", "i.SelectTheme":"V\u00e1lassz kin\u00e9zetet", "i.Settings":"Be\u00e1ll\u00edt\u00e1sok", "i.Slides":"Di\u00e1k", "i.SocialSciences":"Szociol\u00f3gia", "i.SoftwareEngineering":"Szoftverfejleszt\u00e9s", 
"i.Style":"St\u00edlus", "i.Subject":"T\u00e1rgy", "i.Tags":"C\u00edmk\u00e9k", "i.Technology":"Technol\u00f3gia", "i.Templates":"Sablonok", "i.text":"sz\u00f6veg", "i.Text":"Sz\u00f6veg", "i.Telecommunications":"Telekommunik\u00e1ci\u00f3", "i.Themes":"T\u00e9m\u00e1k", "i.Title":"C\u00edm *", "i.toJSON":"JSON-ba", "i.Training":"Gyakorlat", "i.Typicallearningtime":"Tipikus megtanul\u00e1si id\u0151", "i.unpublish":"visszavon\u00e1s", "i.Unpublish":"Visszavon\u00e1s", "i.unpublishing":"publik\u00e1l\u00e1s\u00e1nak", 
"i.Unpublishing":"Publik\u00e1l\u00e1s\u00e1nak", "i.University":"Egyetem", "i.UnselectAll":"\u00d6sszes kiv\u00e1laszt\u00e1s t\u00f6rl\u00e9se", "i.UnselectSlide":"Dia kiv\u00e1laszt\u00e1s\u00e1nak t\u00f6rl\u00e9se", "i.unspecified":"nem meghat\u00e1rozott", "i.Unspecified":"Nem meghat\u00e1rozott", "i.upload":"felt\u00f6lt\u00e9s", "i.Upload":"Felt\u00f6lt\u00e9s", "i.Version":"Verzi\u00f3", "i.verydifficult":"nagyon neh\u00e9z", "i.veryeasy":"nagyon k\u00f6nny\u0171", "i.Vertical":"F\u00fcgg\u0151leges", 
"i.VESurvey1":"Seg\u00edts nek\u00fcnk, hogy tov\u00e1bb fejleszthess\u00fck a ViSH szerkeszt\u0151t", "i.VESurvey2":"Kit\u00f6ltend\u0151", "i.VESurvey3":"ez a k\u00e9rd\u0151\u00edv", "i.VESurvey4":"K\u00f6sz\u00f6nj\u00fck az egy\u00fcttm\u0171k\u00f6d\u00e9st", "i.Video":"vide\u00f3", "i.Videos":"vide\u00f3k", "i.VirtualTour":"Virtu\u00e1lis T\u00fara", "i.yes":"igen", "i.Yes":"Igen", "i.ZoneTooltip":"Kattinsd ide a tartalom hozz\u00e1ad\u00e1s\u00e1hoz", "i.tooltip.QSInput":"Adj meg egy nevet az \u00e9l\u0151 kv\u00edzhez"}, 
"de":{"i.Saved":"Gespeicherte", "i.Saving":"Speichern", "i.Unpublish_confirmation":"Sie sind dabei, diese Virtual Excursion von der Plattform vish unpublish. Danach wird der Ausflug privat sein und nur Sie werden in der Lage, darauf zuzugreifen. Was w\u00fcrden Sie tun?", "i.Animations":"Lebhaftigkeit", "i.Opacity":"Opazit\u00e4t", "i.Elements":"Elemente", "i.Rotate":"Drehen", "i.Diagonal1":"Diagonale #1", "i.Diagonal2":"Diagonale #2", "i.Inside":"Innen", "i.Zoom":"Zoomol\u00e1s", "i.Flip1":"Drehen #1", 
"i.Flip2":"Drehen #2", "i.About2":"Code nicht verf\u00fcgbar", "i.About3":"Besuche unseren Kanal auf YouTube", "i.About4":"Erstellt von", "i.accept":"Akzeptieren", "i.AddSlideMin":"Hinzuf\u00fcgen", "i.add":"Hinzuf\u00fcgen", "i.Add":"Hinzuf\u00fcgen", "i.Addanavatar":"Einen Avatar hinzuf\u00fcgen *", "i.addatitle":"Einen Titel hinzuf\u00fcgen", "i.AddContent":"Inhalt hinzuf\u00fcgen", "i.addembeddedobject":"Ein eingebettetes Objekt hinzuf\u00fcgen", "i.AddFromJSONfile":"Eine ViSH Editor Pr\u00e4sentation von einer JSON Datei", 
"i.addpicurl":"Ein Bild URL hinzuf\u00fcgen", "i.AddSlide":"Eine Folie hinzuf\u00fcgen", "i.AddSlides":"Folien hinzuf\u00fcgen", "i.AddslideshowPDF":"Eine Pr\u00e4sentation von einer PDF Datei hinzuf\u00fcgen", "i.AddTags":"Schlagw\u00f6rter hinzuf\u00fcgen", "i.addvideourl":"Video URL (YouTube, HTML5) hinzuf\u00fcgen", "i.AgeRange":"Altersgruppe", "i.areyousureNotification":"Sicher?", "i.Art":"Kunst", "i.Astronomy":"Astronomie", "i.Author":"Autor", "i.Background":"Background", "i.biology":"Biologie", 
"i.Biology":"Biologie", "i.browserrequirements":"Dein Browser ist leider zu alt, um den ViSH Editor zu starten. Bitte mache ein Update von deinem Browser.", "i.by":"von", "i.cancel":"L\u00f6schen", "i.Cancel":"L\u00f6schen", "i.Chemistry":"Chemie", "i.Citizenship":"Nationalit\u00e4t", "i.ClassicalLanguages":"klassische Sprachen", "i.close":"Schlie\u00dfen", "i.Close":"Schlie\u00dfen", "i.content":"Inhalt", "i.Content":"Inhalt", "i.Context":"Kontext", "i.continue":"Fortfahren", "i.Continue":"Fortfahren", 
"i.CrossCurricularEducation":"Curriculum-\u00fcbergreifender Unterricht", "i.ComputerScience":"Computerwissenschaften", "i.delete":"L\u00f6schen", "i.Description":"Beschreibung", "i.difficult":"Schwierig", "i.Difficulty":"Schwierigkeitsgrad", "i.Documentation":"Dokumentation", "i.done":"Erledigt", "i.Done":"Erledigt", "i.draft":"Draft", "i.easy":"Einfach", "i.Economics":"Wirtschaft", "i.edit":"Editieren", "i.Education":"Unterricht", "i.EducationalObjectives":"Lernziele", "i.EducationalObjectivesPlaceholder":"Bitte beschreibe die Lernziele, die mit dieser Exkursion erreicht werden sollen...", 
"i.Electronics":"Elektronik", "i.embedwebsite":"eingebettete web", "i.embedWebSnapshot":"eingebettete Web Snapshot", "i.EnvironmentalEducation":"Umweltwissenschaften", "i.errorFlickrConnection":"Fehler bei der Verbindung zu FlickR", "i.errorLREConnection":" Fehler bei der Verbindung zum LRE Speicher", "i.errorViSHConnection":" Fehler bei der Verbindung zum ViSH Server", "i.errorYoutubeConnection":" Fehler bei der Verbindung zu YouTube", "i.Ethics":"Ethik", "i.exitConfirmation":"Du willst den ViSH Editor verlassen? S\u00e4mtliche \u00c4nderungen werden nicht gespeichert und gehen verloren.", 
"i.exitConfirmation2":"Bist du sicher, dass du diese Seite verlassen willst?", "i.Export":"Exportieren", "i.exportPresToJSONerrorNotification":"Ein Fehler ist aufgetreten. Die Pr\u00e4sentation kann nicht als JSON Datei exportiert werden.", "i.Filllater":"Sp\u00e4ter ausf\u00fcllen", "i.Finish":"Fertig", "i.ForeignLanguages":"Fremdsprachen", "i.Game":"Spiel", "i.GeneralCulture":"Kultur allgemein", "i.Geography":"Geographie", "i.Geology":"Geologie", "i.GotoSettings":"Zu Einstellungen gehen", "i.HealthEducation":"Sozialkunde", 
"i.Help":"Hilfe", "i.HigherEducation":"Hochschulbildung", "i.History":"Geschichte", "i.HomeEconomics":"Hauswirtschaft", "i.Horizontal":"Horizontal", "i.Hours":"Stunden", "i.Image":"Bild", "i.Images":"Bilder", "i.Import":"Importieren", "i.Insert":"Einf\u00fcgen", "i.invalidvalue":"ung\u00fcltiger Eintrag", "i.Language":"Sprache", "i.Languageindependent":"Sprachunabh\u00e4ngig", "i.Law":"Jura", "i.License":"Lizenz", "i.limitReached":"Limit erreicht", "i.link":"Link", "i.Literature":"Literatur", "i.LiveQuiz":"Live Quiz", 
"i.LiveResources":"Live Ressourcen", "i.MandatoryFieldsNotification":"Du musst der Exkursion einen Titel geben und einen Avatar zuweisen bevor du sie ver\u00f6ffentlichen kannst.", "i.math":"Mathe", "i.Mathematics":"Mathematik", "i.medium":"medium", "i.Minutes":"Minuten", "i.Music":"Musik", "i.nanoscience":"Nanowissenschaften", "i.NaturalSciences":"Naturwissenschaften", "i.next":"N\u00e4chstes", "i.Next":"N\u00e4chstes", "i.no":"Nein", "i.No":"Nein", "i.NoJSONFileError":"W\u00e4hle eine Datei aus, um sie im JSON Format zu importieren", 
"i.Noresultsfound":"Keine Ergebnisse", "i.NoSlidesOnSaveNotification":"Bevor du speichern kannst, musst du zumindest eine Folie erstellen.", "i.Object":"Objekt", "i.Objects":"Objekte", "i.or":"oder", "i.Other":"Andere", "i.Others":"Andere", "i.pasteEmbedObject":"Eine URL f\u00fcr SWF oder PDF Datei einf\u00fcgen", "i.pasteImageURL":"Eine Bild URL einf\u00fcgen", "i.pasteVideoURL":"Eine HTML5 oder YouTube Video URL einf\u00fcgen", "i.pasteWeb":"Eine Webseiten URL einf\u00fcgen", "i.pdfErrorNotification":"Ein Fehler ist aufgetreten. Stelle sicher, dass die PDF Datei g\u00fcltig ist.", 
"i.PDFNotValid":" Ein Fehler ist aufgetreten. Stelle sicher, dass die PDF Datei korrekt ist.", "i.PDFSlideshow":"PDF Pr\u00e4sentation", "i.MetadataAspects":"P\u00e4dagogische Aspekte", "i.Philosophy":"Philosophie", "i.PhysicalEducation":"Sport", "i.Physics":"Physik", "i.pNotValid":"Diese Ressource kann nicht ge\u00f6ffnet werden. Sie ist entweder besch\u00e4digt oder nicht mit der Version des ViSH Editors kompatibel.", "i.Politics":"Politik", "i.Preschool":"Vorschule", "i.Presentation":"Pr\u00e4sentation", 
"i.presDescriptionPlaceHolder":"Bitte gib kurz an, um was es bei dieser Exkursion geht...", "i.presTitle":"Titel der Exkursion", "i.Preview":"Vorschau", "i.Psychology":"Psychologie", "i.publish":"Ver\u00f6ffentlichen", "i.Publish":"Ver\u00f6ffentlichen", "i.Quiz":"Quizz", "i.QuizButtonAnswer":"Antwort", "i.QuizButtonLaunch":"Starten", "i.QuizButtonOptions":"Optionen", "i.QuizButtonRetry":"Neuer Versuch", "i.QuizEmptyAnswerAlert":"Bitte beantworte die Fragen, bevor du das Quizz abschickst", "i.QuizLaunch":"Starten", 
"i.QuizMultipleLaunchAlert":"Bitte stoppe alle laufenden Quizze bevor du ein weiteres Quizz startest", "i.QuizNotSubmittedAlert":"Sorry, deine Antwort konnte nicht geschickt werden", "i.QuizResults":"Ergebnisse", "i.QuizSaveConfirmation":"Willst du die Ergebnisse vom Quizz speichern?", "i.QuizSessionName":"Name des live Quizz", "i.QuizSettings":"Quiz", "i.QuizStop":"Stop", "i.QuizSubmittedAlert":"Deine Antwort wurde zugestellt", "i.Quizzes":"Quizze", "i.readJSONfileError":"Fehler beim Lesen der JSON Datei", 
"i.Religion":"Religion", "i.Remove":"L\u00f6schen", "i.resourceNonCompatibleNotification":"Diese Ressource ist besch\u00e4digt oder nicht mit der aktuellen ViSH Editor Version kompatibel und kann nicht ge\u00f6ffnet werden.", "i.save":"Speichern", "i.Save":"Speichern", "i.Saving":"Speichern", "i.School":"Schule", "i.SearchContent":"Inhalt suchen", "i.Searchplaces":"Orte suchen", "i.Seconds":"Sekunden", "i.SelectAll":"Alle ausw\u00e4hlen", "i.selectObjectUpload":"Eine Datei zum Hochladen aussuchen", 
"i.selectObjectUpload2":"Unterst\u00fctze Formate: SWF (Flash), PDF", "i.selectPicture":"Ein Bild zum Hochladen aussuchen", "i.SelectSlide":"Folie ausw\u00e4hlen", "i.SelectTheme":"Thema ausw\u00e4hlen", "i.Settings":"Einstellungen", "i.Slides":"Folien", "i.SocialSciences":"Sozialwissenschaften", "i.SoftwareEngineering":"Software Engineering", "i.Style":"Stil", "i.Subject":"Fach", "i.Tags":"Schlagw\u00f6rter", "i.Technology":"Technologie", "i.Templates":"Vorlagen", "i.text":"Text", "i.Text":"Text", 
"i.Telecommunications":"Telekommunikation", "i.Themes":"Themes", "i.Title":"Titel *", "i.toJSON":"an JSON", "i.Training":"Training", "i.Typicallearningtime":"\u00fcbliche Dauer f\u00fcr die Lerneinheit", "i.unpublish":"unver\u00f6ffentlicht", "i.Unpublish":"Unver\u00f6ffentlicht", "i.University":"Universit\u00e4t", "i.UnselectAll":"Gesamte Auswahl r\u00fcckg\u00e4ngig machen", "i.UnselectSlide":"Auswahl der Folie r\u00fcckg\u00e4ngig machen", "i.unspecified":"Nicht spezifiziert", "i.Unspecified":"Nicht spezifiziert", 
"i.unpublishing":"aufheben", "i.Unpublishing":"Aufheben", "i.upload":"Hochladen", "i.Upload":"Hochladen", "i.Version":"Version", "i.verydifficult":"Sehr schwierig", "i.veryeasy":"Sehr einfach", "i.Vertical":"Vertikal", "i.VESurvey1":"Hilf uns, den ViSH Editor zu verbessern", "i.VESurvey2":"Bitte ausf\u00fcllen", "i.VESurvey3":"diese Umfrage", "i.VESurvey4":"Danke f\u00fcr deinen Beitrag", "i.Video":"Video", "i.Videos":"Videos", "i.VirtualTour":"Virtuelle Tour", "i.yes":"Ja", "i.Yes":"Ja", "i.ZoneTooltip":"Hier klicken um Inhalte hinzuzuf\u00fcgen", 
"i.tooltip.QSInput":"Einen Namen f\u00fcr das live Quizz eingeben"}};
var VISH = VISH || {};
VISH.VERSION = "0.9.4";
VISH.AUTHORS = "GING";
VISH.URL = "http://github.com/ging/vish_editor";
VISH.Constant = VISH.Constant || {};
VISH.Constant.Edit = "Editor";
VISH.Constant.Viewer = "Viewer";
VISH.Constant.AnyMode = "Both";
VISH.Constant.NOSERVER = "noserver";
VISH.Constant.VISH = "vish";
VISH.Constant.UA_IE = "Microsoft Internet Explorer";
VISH.Constant.UA_NETSCAPE = "Netscape";
VISH.Constant.IE = "Internet Explorer";
VISH.Constant.FIREFOX = "Mozilla Firefox";
VISH.Constant.CHROME = "Google Chrome";
VISH.Constant.SAFARI = "Safari";
VISH.Constant.ANDROID_BROWSER = "Android Browser";
VISH.Constant.EXTRA_SMALL = "extra_small";
VISH.Constant.SMALL = "small";
VISH.Constant.MEDIUM = "medium";
VISH.Constant.LARGE = "large";
VISH.Constant.THUMBNAIL = "thumbnail";
VISH.Constant.NONE = "none";
VISH.Constant.UNKNOWN = "Unknown";
VISH.Constant.AGE_RANGE_MIN = 0;
VISH.Constant.AGE_RANGE_MAX = 0;
VISH.Constant.AGE_RANGE = VISH.Constant.AGE_RANGE_MIN + " - " + VISH.Constant.AGE_RANGE_MAX;
VISH.Constant.DIFFICULTY = 0;
VISH.Constant.PRESENTATION = "presentation";
VISH.Constant.QUIZ_SIMPLE = "quiz_simple";
VISH.Constant.STANDARD = "standard";
VISH.Constant.SLIDESET = "slideset";
VISH.Constant.FLASHCARD = "flashcard";
VISH.Constant.VTOUR = "VirtualTour";
VISH.Constant.EVIDEO = "enrichedvideo";
VISH.Constant.GAME = "game";
VISH.Constant.TEXT = "text";
VISH.Constant.IMAGE = "image";
VISH.Constant.AUDIO = "audio";
VISH.Constant.VIDEO = "video";
VISH.Constant.OBJECT = "object";
VISH.Constant.SNAPSHOT = "snapshot";
VISH.Constant.APPLET = "applet";
VISH.Constant.QUIZ = "quiz";
VISH.Constant.MEDIA = {};
VISH.Constant.MEDIA.IMAGE = "image";
VISH.Constant.MEDIA.FLASH = "swf";
VISH.Constant.MEDIA.PDF = "pdf";
VISH.Constant.MEDIA.YOUTUBE_VIDEO = "Youtube";
VISH.Constant.MEDIA.HTML5_VIDEO = "HTML5_VIDEO";
VISH.Constant.MEDIA.HTML5_AUDIO = "HTML5_AUDIO";
VISH.Constant.MEDIA.SOUNDCLOUD_AUDIO = "Soundcloud";
VISH.Constant.MEDIA.WEB = "web";
VISH.Constant.MEDIA.JSON = "json";
VISH.Constant.MEDIA.DOC = "doc";
VISH.Constant.MEDIA.PPT = "ppt";
VISH.Constant.MEDIA.SCORM_PACKAGE = "scormpackage";
VISH.Constant.MEDIA.WEB_APP = "webapp";
VISH.Constant.MEDIA.IMS_QTI_QUIZ = "IMS_QTI_QUIZ";
VISH.Constant.WRAPPER = {};
VISH.Constant.WRAPPER.EMBED = "EMBED";
VISH.Constant.WRAPPER.OBJECT = "OBJECT";
VISH.Constant.WRAPPER.IFRAME = "IFRAME";
VISH.Constant.WRAPPER.VIDEO = "VIDEO";
VISH.Constant.WRAPPER.AUDIO = "AUDIO";
VISH.Constant.QZ_TYPE = {};
VISH.Constant.QZ_TYPE.OPEN = "openAnswer";
VISH.Constant.QZ_TYPE.MCHOICE = "multiplechoice";
VISH.Constant.QZ_TYPE.TF = "truefalse";
VISH.Constant.QZ_TYPE.SORTING = "sorting";
VISH.Constant.QZ_MODE = {};
VISH.Constant.QZ_MODE.SELFA = "selfA";
VISH.Constant.QZ_MODE.RT = "realTime";
VISH.Constant.TextDefault = 12;
VISH.Constant.TextBase = 12;
VISH.Constant.Clipboard = {};
VISH.Constant.Clipboard.Slide = "slide";
VISH.Constant.Clipboard.LocalStorageStack = "VishEditorClipboardStack";
VISH.Constant.Themes = {};
VISH.Constant.Themes.Default = "theme1";
VISH.Constant.Animations = {};
VISH.Constant.Animations.Default = "animation1";
VISH.Constant.Event = {};
VISH.Constant.Event.onSendIframeMessage = "onSendIframeMessage";
VISH.Constant.Event.onGoToSlide = "onGoToSlide";
VISH.Constant.Event.onEnterSlide = "onEnterSlide";
VISH.Constant.Event.onPlayVideo = "onPlayVideo";
VISH.Constant.Event.onPauseVideo = "onPauseVideo";
VISH.Constant.Event.onSeekVideo = "onSeekVideo";
VISH.Constant.Event.onPlayAudio = "onPlayAudio";
VISH.Constant.Event.onPauseAudio = "onPauseAudio";
VISH.Constant.Event.onSeekAudio = "onSeekAudio";
VISH.Constant.Event.onSubslideOpen = "onSubslideOpen";
VISH.Constant.Event.onSubslideClosed = "onSubslideClosed";
VISH.Constant.Event.onAnswerQuiz = "onAnswerQuiz";
VISH.Constant.Event.onSetSlave = "onSetSlave";
VISH.Constant.Event.allowExitWithoutConfirmation = "allowExitWithoutConfirmation";
VISH.Constant.Event.exit = "exit";
VISH.Constant.Event.onSelectedSlides = "onSelectedSlides";
VISH.Constant.Event.onVEFocusChange = "onVEFocusChange";
VISH.Constant.Event.onShowRecommendations = "onShowRecommendations";
VISH.Constant.Event.onHideRecommendations = "onHideRecommendations";
VISH.Constant.Event.onAcceptRecommendation = "onAcceptRecommendation";
VISH.Constant.Event.onEvaluate = "onEvaluate";
VISH.Constant.Event.onEvaluateCompletion = "onEvaluateCompletion";
VISH.Constant.Event.onViewportResize = "onViewportResize";
VISH.Constant.Event.onProgressObjectiveUpdated = "onProgressObjectiveUpdated";
VISH.Constant.Event.onNewObjectiveScore = "onNewObjectiveScore";
VISH.Constant.Event.onTrackedAction = "onTrackedAction";
VISH.Constant.Event.Touchable = {};
VISH.Constant.Event.Touchable.onSimpleClick = "onSimpleClick";
VISH.Constant.Event.Touchable.onLongClick = "onLongClick";
VISH.Constant.Event.Touchable.onUnknownTouchMovement = "onUnknownTouchMovement";
VISH.Constant.Event.Touchable.onShiftRight = "onShiftRight";
VISH.Constant.Event.Touchable.onShiftLeft = "onShiftLeft";
VISH.Constant.Storage = {};
VISH.Constant.Storage.Device = "Device";
VISH.Constant.VTour = {};
VISH.Constant.VTour.DEFAULT_MAP = "roadmap";
VISH.Constant.VTour.ROADMAP = "roadmap";
VISH.Constant.VTour.SERVICES = {};
VISH.Constant.VTour.SERVICES.GMaps = "Google Maps";
VISH.Constant.EVideo = {};
VISH.Constant.EVideo.Status = {};
VISH.Constant.EVideo.Status.Ended = 0;
VISH.Constant.EVideo.Status.Playing = 1;
VISH.Constant.EVideo.Status.Paused = 2;
VISH.Constant.INTRO = 13;
(function(a, b) {
  function cy(a) {
    return f.isWindow(a) ? a : a.nodeType === 9 ? a.defaultView || a.parentWindow : !1
  }
  function cu(a) {
    if(!cj[a]) {
      var b = c.body, d = f("<" + a + ">").appendTo(b), e = d.css("display");
      d.remove();
      if(e === "none" || e === "") {
        ck || (ck = c.createElement("iframe"), ck.frameBorder = ck.width = ck.height = 0), b.appendChild(ck);
        if(!cl || !ck.createElement) {
          cl = (ck.contentWindow || ck.contentDocument).document, cl.write((f.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), cl.close()
        }
        d = cl.createElement(a), cl.body.appendChild(d), e = f.css(d, "display"), b.removeChild(ck)
      }
      cj[a] = e
    }
    return cj[a]
  }
  function ct(a, b) {
    var c = {};
    f.each(cp.concat.apply([], cp.slice(0, b)), function() {
      c[this] = a
    });
    return c
  }
  function cs() {
    cq = b
  }
  function cr() {
    setTimeout(cs, 0);
    return cq = f.now()
  }
  function ci() {
    try {
      return new a.ActiveXObject("Microsoft.XMLHTTP")
    }catch(b) {
    }
  }
  function ch() {
    try {
      return new a.XMLHttpRequest
    }catch(b) {
    }
  }
  function cb(a, c) {
    a.dataFilter && (c = a.dataFilter(c, a.dataType));
    var d = a.dataTypes, e = {}, g, h, i = d.length, j, k = d[0], l, m, n, o, p;
    for(g = 1;g < i;g++) {
      if(g === 1) {
        for(h in a.converters) {
          typeof h == "string" && (e[h.toLowerCase()] = a.converters[h])
        }
      }
      l = k, k = d[g];
      if(k === "*") {
        k = l
      }else {
        if(l !== "*" && l !== k) {
          m = l + " " + k, n = e[m] || e["* " + k];
          if(!n) {
            p = b;
            for(o in e) {
              j = o.split(" ");
              if(j[0] === l || j[0] === "*") {
                p = e[j[1] + " " + k];
                if(p) {
                  o = e[o], o === !0 ? n = p : p === !0 && (n = o);
                  break
                }
              }
            }
          }
          !n && (!p && f.error("No conversion from " + m.replace(" ", " to "))), n !== !0 && (c = n ? n(c) : p(o(c)))
        }
      }
    }
    return c
  }
  function ca(a, c, d) {
    var e = a.contents, f = a.dataTypes, g = a.responseFields, h, i, j, k;
    for(i in g) {
      i in d && (c[g[i]] = d[i])
    }
    while(f[0] === "*") {
      f.shift(), h === b && (h = a.mimeType || c.getResponseHeader("content-type"))
    }
    if(h) {
      for(i in e) {
        if(e[i] && e[i].test(h)) {
          f.unshift(i);
          break
        }
      }
    }
    if(f[0] in d) {
      j = f[0]
    }else {
      for(i in d) {
        if(!f[0] || a.converters[i + " " + f[0]]) {
          j = i;
          break
        }
        k || (k = i)
      }
      j = j || k
    }
    if(j) {
      j !== f[0] && f.unshift(j);
      return d[j]
    }
  }
  function b_(a, b, c, d) {
    if(f.isArray(b)) {
      f.each(b, function(b, e) {
        c || bD.test(a) ? d(a, e) : b_(a + "[" + (typeof e == "object" ? b : "") + "]", e, c, d)
      })
    }else {
      if(!c && f.type(b) === "object") {
        for(var e in b) {
          b_(a + "[" + e + "]", b[e], c, d)
        }
      }else {
        d(a, b)
      }
    }
  }
  function b$(a, c) {
    var d, e, g = f.ajaxSettings.flatOptions || {};
    for(d in c) {
      c[d] !== b && ((g[d] ? a : e || (e = {}))[d] = c[d])
    }
    e && f.extend(!0, a, e)
  }
  function bZ(a, c, d, e, f, g) {
    f = f || c.dataTypes[0], g = g || {}, g[f] = !0;
    var h = a[f], i = 0, j = h ? h.length : 0, k = a === bS, l;
    for(;i < j && (k || !l);i++) {
      l = h[i](c, d, e), typeof l == "string" && (!k || g[l] ? l = b : (c.dataTypes.unshift(l), l = bZ(a, c, d, e, l, g)))
    }
    (k || !l) && (!g["*"] && (l = bZ(a, c, d, e, "*", g)));
    return l
  }
  function bY(a) {
    return function(b, c) {
      typeof b != "string" && (c = b, b = "*");
      if(f.isFunction(c)) {
        var d = b.toLowerCase().split(bO), e = 0, g = d.length, h, i, j;
        for(;e < g;e++) {
          h = d[e], j = /^\+/.test(h), j && (h = h.substr(1) || "*"), i = a[h] = a[h] || [], i[j ? "unshift" : "push"](c)
        }
      }
    }
  }
  function bB(a, b, c) {
    var d = b === "width" ? a.offsetWidth : a.offsetHeight, e = b === "width" ? 1 : 0, g = 4;
    if(d > 0) {
      if(c !== "border") {
        for(;e < g;e += 2) {
          c || (d -= parseFloat(f.css(a, "padding" + bx[e])) || 0), c === "margin" ? d += parseFloat(f.css(a, c + bx[e])) || 0 : d -= parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0
        }
      }
      return d + "px"
    }
    d = by(a, b);
    if(d < 0 || d == null) {
      d = a.style[b]
    }
    if(bt.test(d)) {
      return d
    }
    d = parseFloat(d) || 0;
    if(c) {
      for(;e < g;e += 2) {
        d += parseFloat(f.css(a, "padding" + bx[e])) || 0, c !== "padding" && (d += parseFloat(f.css(a, "border" + bx[e] + "Width")) || 0), c === "margin" && (d += parseFloat(f.css(a, c + bx[e])) || 0)
      }
    }
    return d + "px"
  }
  function bo(a) {
    var b = c.createElement("div");
    bh.appendChild(b), b.innerHTML = a.outerHTML;
    return b.firstChild
  }
  function bn(a) {
    var b = (a.nodeName || "").toLowerCase();
    b === "input" ? bm(a) : b !== "script" && (typeof a.getElementsByTagName != "undefined" && f.grep(a.getElementsByTagName("input"), bm))
  }
  function bm(a) {
    if(a.type === "checkbox" || a.type === "radio") {
      a.defaultChecked = a.checked
    }
  }
  function bl(a) {
    return typeof a.getElementsByTagName != "undefined" ? a.getElementsByTagName("*") : typeof a.querySelectorAll != "undefined" ? a.querySelectorAll("*") : []
  }
  function bk(a, b) {
    var c;
    b.nodeType === 1 && (b.clearAttributes && b.clearAttributes(), b.mergeAttributes && b.mergeAttributes(a), c = b.nodeName.toLowerCase(), c === "object" ? b.outerHTML = a.outerHTML : c !== "input" || a.type !== "checkbox" && a.type !== "radio" ? c === "option" ? b.selected = a.defaultSelected : c === "input" || c === "textarea" ? b.defaultValue = a.defaultValue : c === "script" && (b.text !== a.text && (b.text = a.text)) : (a.checked && (b.defaultChecked = b.checked = a.checked), b.value !== a.value && 
    (b.value = a.value)), b.removeAttribute(f.expando), b.removeAttribute("_submit_attached"), b.removeAttribute("_change_attached"))
  }
  function bj(a, b) {
    if(b.nodeType === 1 && !!f.hasData(a)) {
      var c, d, e, g = f._data(a), h = f._data(b, g), i = g.events;
      if(i) {
        delete h.handle, h.events = {};
        for(c in i) {
          for(d = 0, e = i[c].length;d < e;d++) {
            f.event.add(b, c, i[c][d])
          }
        }
      }
      h.data && (h.data = f.extend({}, h.data))
    }
  }
  function bi(a, b) {
    return f.nodeName(a, "table") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a
  }
  function U(a) {
    var b = V.split("|"), c = a.createDocumentFragment();
    if(c.createElement) {
      while(b.length) {
        c.createElement(b.pop())
      }
    }
    return c
  }
  function T(a, b, c) {
    b = b || 0;
    if(f.isFunction(b)) {
      return f.grep(a, function(a, d) {
        var e = !!b.call(a, d, a);
        return e === c
      })
    }
    if(b.nodeType) {
      return f.grep(a, function(a, d) {
        return a === b === c
      })
    }
    if(typeof b == "string") {
      var d = f.grep(a, function(a) {
        return a.nodeType === 1
      });
      if(O.test(b)) {
        return f.filter(b, d, !c)
      }
      b = f.filter(b, d)
    }
    return f.grep(a, function(a, d) {
      return f.inArray(a, b) >= 0 === c
    })
  }
  function S(a) {
    return!a || (!a.parentNode || a.parentNode.nodeType === 11)
  }
  function K() {
    return!0
  }
  function J() {
    return!1
  }
  function n(a, b, c) {
    var d = b + "defer", e = b + "queue", g = b + "mark", h = f._data(a, d);
    h && ((c === "queue" || !f._data(a, e)) && ((c === "mark" || !f._data(a, g)) && setTimeout(function() {
      !f._data(a, e) && (!f._data(a, g) && (f.removeData(a, d, !0), h.fire()))
    }, 0)))
  }
  function m(a) {
    for(var b in a) {
      if(b === "data" && f.isEmptyObject(a[b])) {
        continue
      }
      if(b !== "toJSON") {
        return!1
      }
    }
    return!0
  }
  function l(a, c, d) {
    if(d === b && a.nodeType === 1) {
      var e = "data-" + c.replace(k, "-$1").toLowerCase();
      d = a.getAttribute(e);
      if(typeof d == "string") {
        try {
          d = d === "true" ? !0 : d === "false" ? !1 : d === "null" ? null : f.isNumeric(d) ? +d : j.test(d) ? f.parseJSON(d) : d
        }catch(g) {
        }
        f.data(a, c, d)
      }else {
        d = b
      }
    }
    return d
  }
  function h(a) {
    var b = g[a] = {}, c, d;
    a = a.split(/\s+/);
    for(c = 0, d = a.length;c < d;c++) {
      b[a[c]] = !0
    }
    return b
  }
  var c = a.document, d = a.navigator, e = a.location, f = function() {
    function J() {
      if(!e.isReady) {
        try {
          c.documentElement.doScroll("left")
        }catch(a) {
          setTimeout(J, 1);
          return
        }
        e.ready()
      }
    }
    var e = function(a, b) {
      return new e.fn.init(a, b, h)
    }, f = a.jQuery, g = a.$, h, i = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, j = /\S/, k = /^\s+/, l = /\s+$/, m = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, n = /^[\],:{}\s]*$/, o = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, p = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, q = /(?:^|:|,)(?:\s*\[)+/g, r = /(webkit)[ \/]([\w.]+)/, s = /(opera)(?:.*version)?[ \/]([\w.]+)/, t = /(msie) ([\w.]+)/, u = /(mozilla)(?:.*? rv:([\w.]+))?/, v = /-([a-z]|[0-9])/ig, w = /^-ms-/, x = function(a, b) {
      return(b + "").toUpperCase()
    }, y = d.userAgent, z, A, B, C = Object.prototype.toString, D = Object.prototype.hasOwnProperty, E = Array.prototype.push, F = Array.prototype.slice, G = String.prototype.trim, H = Array.prototype.indexOf, I = {};
    e.fn = e.prototype = {constructor:e, init:function(a, d, f) {
      var g, h, j, k;
      if(!a) {
        return this
      }
      if(a.nodeType) {
        this.context = this[0] = a, this.length = 1;
        return this
      }
      if(a === "body" && (!d && c.body)) {
        this.context = c, this[0] = c.body, this.selector = a, this.length = 1;
        return this
      }
      if(typeof a == "string") {
        a.charAt(0) !== "<" || (a.charAt(a.length - 1) !== ">" || a.length < 3) ? g = i.exec(a) : g = [null, a, null];
        if(g && (g[1] || !d)) {
          if(g[1]) {
            d = d instanceof e ? d[0] : d, k = d ? d.ownerDocument || d : c, j = m.exec(a), j ? e.isPlainObject(d) ? (a = [c.createElement(j[1])], e.fn.attr.call(a, d, !0)) : a = [k.createElement(j[1])] : (j = e.buildFragment([g[1]], [k]), a = (j.cacheable ? e.clone(j.fragment) : j.fragment).childNodes);
            return e.merge(this, a)
          }
          h = c.getElementById(g[2]);
          if(h && h.parentNode) {
            if(h.id !== g[2]) {
              return f.find(a)
            }
            this.length = 1, this[0] = h
          }
          this.context = c, this.selector = a;
          return this
        }
        return!d || d.jquery ? (d || f).find(a) : this.constructor(d).find(a)
      }
      if(e.isFunction(a)) {
        return f.ready(a)
      }
      a.selector !== b && (this.selector = a.selector, this.context = a.context);
      return e.makeArray(a, this)
    }, selector:"", jquery:"1.7.2", length:0, size:function() {
      return this.length
    }, toArray:function() {
      return F.call(this, 0)
    }, get:function(a) {
      return a == null ? this.toArray() : a < 0 ? this[this.length + a] : this[a]
    }, pushStack:function(a, b, c) {
      var d = this.constructor();
      e.isArray(a) ? E.apply(d, a) : e.merge(d, a), d.prevObject = this, d.context = this.context, b === "find" ? d.selector = this.selector + (this.selector ? " " : "") + c : b && (d.selector = this.selector + "." + b + "(" + c + ")");
      return d
    }, each:function(a, b) {
      return e.each(this, a, b)
    }, ready:function(a) {
      e.bindReady(), A.add(a);
      return this
    }, eq:function(a) {
      a = +a;
      return a === -1 ? this.slice(a) : this.slice(a, a + 1)
    }, first:function() {
      return this.eq(0)
    }, last:function() {
      return this.eq(-1)
    }, slice:function() {
      return this.pushStack(F.apply(this, arguments), "slice", F.call(arguments).join(","))
    }, map:function(a) {
      return this.pushStack(e.map(this, function(b, c) {
        return a.call(b, c, b)
      }))
    }, end:function() {
      return this.prevObject || this.constructor(null)
    }, push:E, sort:[].sort, splice:[].splice}, e.fn.init.prototype = e.fn, e.extend = e.fn.extend = function() {
      var a, c, d, f, g, h, i = arguments[0] || {}, j = 1, k = arguments.length, l = !1;
      typeof i == "boolean" && (l = i, i = arguments[1] || {}, j = 2), typeof i != "object" && (!e.isFunction(i) && (i = {})), k === j && (i = this, --j);
      for(;j < k;j++) {
        if((a = arguments[j]) != null) {
          for(c in a) {
            d = i[c], f = a[c];
            if(i === f) {
              continue
            }
            l && (f && (e.isPlainObject(f) || (g = e.isArray(f)))) ? (g ? (g = !1, h = d && e.isArray(d) ? d : []) : h = d && e.isPlainObject(d) ? d : {}, i[c] = e.extend(l, h, f)) : f !== b && (i[c] = f)
          }
        }
      }
      return i
    }, e.extend({noConflict:function(b) {
      a.$ === e && (a.$ = g), b && (a.jQuery === e && (a.jQuery = f));
      return e
    }, isReady:!1, readyWait:1, holdReady:function(a) {
      a ? e.readyWait++ : e.ready(!0)
    }, ready:function(a) {
      if(a === !0 && !--e.readyWait || a !== !0 && !e.isReady) {
        if(!c.body) {
          return setTimeout(e.ready, 1)
        }
        e.isReady = !0;
        if(a !== !0 && --e.readyWait > 0) {
          return
        }
        A.fireWith(c, [e]), e.fn.trigger && e(c).trigger("ready").off("ready")
      }
    }, bindReady:function() {
      if(!A) {
        A = e.Callbacks("once memory");
        if(c.readyState === "complete") {
          return setTimeout(e.ready, 1)
        }
        if(c.addEventListener) {
          c.addEventListener("DOMContentLoaded", B, !1), a.addEventListener("load", e.ready, !1)
        }else {
          if(c.attachEvent) {
            c.attachEvent("onreadystatechange", B), a.attachEvent("onload", e.ready);
            var b = !1;
            try {
              b = a.frameElement == null
            }catch(d) {
            }
            c.documentElement.doScroll && (b && J())
          }
        }
      }
    }, isFunction:function(a) {
      return e.type(a) === "function"
    }, isArray:Array.isArray || function(a) {
      return e.type(a) === "array"
    }, isWindow:function(a) {
      return a != null && a == a.window
    }, isNumeric:function(a) {
      return!isNaN(parseFloat(a)) && isFinite(a)
    }, type:function(a) {
      return a == null ? String(a) : I[C.call(a)] || "object"
    }, isPlainObject:function(a) {
      if(!a || (e.type(a) !== "object" || (a.nodeType || e.isWindow(a)))) {
        return!1
      }
      try {
        if(a.constructor && (!D.call(a, "constructor") && !D.call(a.constructor.prototype, "isPrototypeOf"))) {
          return!1
        }
      }catch(c) {
        return!1
      }
      var d;
      for(d in a) {
      }
      return d === b || D.call(a, d)
    }, isEmptyObject:function(a) {
      for(var b in a) {
        return!1
      }
      return!0
    }, error:function(a) {
      throw new Error(a);
    }, parseJSON:function(b) {
      if(typeof b != "string" || !b) {
        return null
      }
      b = e.trim(b);
      if(a.JSON && a.JSON.parse) {
        return a.JSON.parse(b)
      }
      if(n.test(b.replace(o, "@").replace(p, "]").replace(q, ""))) {
        return(new Function("return " + b))()
      }
      e.error("Invalid JSON: " + b)
    }, parseXML:function(c) {
      if(typeof c != "string" || !c) {
        return null
      }
      var d, f;
      try {
        a.DOMParser ? (f = new DOMParser, d = f.parseFromString(c, "text/xml")) : (d = new ActiveXObject("Microsoft.XMLDOM"), d.async = "false", d.loadXML(c))
      }catch(g) {
        d = b
      }
      (!d || (!d.documentElement || d.getElementsByTagName("parsererror").length)) && e.error("Invalid XML: " + c);
      return d
    }, noop:function() {
    }, globalEval:function(b) {
      b && (j.test(b) && (a.execScript || function(b) {
        a.eval.call(a, b)
      })(b))
    }, camelCase:function(a) {
      return a.replace(w, "ms-").replace(v, x)
    }, nodeName:function(a, b) {
      return a.nodeName && a.nodeName.toUpperCase() === b.toUpperCase()
    }, each:function(a, c, d) {
      var f, g = 0, h = a.length, i = h === b || e.isFunction(a);
      if(d) {
        if(i) {
          for(f in a) {
            if(c.apply(a[f], d) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.apply(a[g++], d) === !1) {
              break
            }
          }
        }
      }else {
        if(i) {
          for(f in a) {
            if(c.call(a[f], f, a[f]) === !1) {
              break
            }
          }
        }else {
          for(;g < h;) {
            if(c.call(a[g], g, a[g++]) === !1) {
              break
            }
          }
        }
      }
      return a
    }, trim:G ? function(a) {
      return a == null ? "" : G.call(a)
    } : function(a) {
      return a == null ? "" : (a + "").replace(k, "").replace(l, "")
    }, makeArray:function(a, b) {
      var c = b || [];
      if(a != null) {
        var d = e.type(a);
        a.length == null || (d === "string" || (d === "function" || (d === "regexp" || e.isWindow(a)))) ? E.call(c, a) : e.merge(c, a)
      }
      return c
    }, inArray:function(a, b, c) {
      var d;
      if(b) {
        if(H) {
          return H.call(b, a, c)
        }
        d = b.length, c = c ? c < 0 ? Math.max(0, d + c) : c : 0;
        for(;c < d;c++) {
          if(c in b && b[c] === a) {
            return c
          }
        }
      }
      return-1
    }, merge:function(a, c) {
      var d = a.length, e = 0;
      if(typeof c.length == "number") {
        for(var f = c.length;e < f;e++) {
          a[d++] = c[e]
        }
      }else {
        while(c[e] !== b) {
          a[d++] = c[e++]
        }
      }
      a.length = d;
      return a
    }, grep:function(a, b, c) {
      var d = [], e;
      c = !!c;
      for(var f = 0, g = a.length;f < g;f++) {
        e = !!b(a[f], f), c !== e && d.push(a[f])
      }
      return d
    }, map:function(a, c, d) {
      var f, g, h = [], i = 0, j = a.length, k = a instanceof e || j !== b && (typeof j == "number" && (j > 0 && (a[0] && a[j - 1]) || (j === 0 || e.isArray(a))));
      if(k) {
        for(;i < j;i++) {
          f = c(a[i], i, d), f != null && (h[h.length] = f)
        }
      }else {
        for(g in a) {
          f = c(a[g], g, d), f != null && (h[h.length] = f)
        }
      }
      return h.concat.apply([], h)
    }, guid:1, proxy:function(a, c) {
      if(typeof c == "string") {
        var d = a[c];
        c = a, a = d
      }
      if(!e.isFunction(a)) {
        return b
      }
      var f = F.call(arguments, 2), g = function() {
        return a.apply(c, f.concat(F.call(arguments)))
      };
      g.guid = a.guid = a.guid || (g.guid || e.guid++);
      return g
    }, access:function(a, c, d, f, g, h, i) {
      var j, k = d == null, l = 0, m = a.length;
      if(d && typeof d == "object") {
        for(l in d) {
          e.access(a, c, l, d[l], 1, h, f)
        }
        g = 1
      }else {
        if(f !== b) {
          j = i === b && e.isFunction(f), k && (j ? (j = c, c = function(a, b, c) {
            return j.call(e(a), c)
          }) : (c.call(a, f), c = null));
          if(c) {
            for(;l < m;l++) {
              c(a[l], d, j ? f.call(a[l], l, c(a[l], d)) : f, i)
            }
          }
          g = 1
        }
      }
      return g ? a : k ? c.call(a) : m ? c(a[0], d) : h
    }, now:function() {
      return(new Date).getTime()
    }, uaMatch:function(a) {
      a = a.toLowerCase();
      var b = r.exec(a) || (s.exec(a) || (t.exec(a) || (a.indexOf("compatible") < 0 && u.exec(a) || [])));
      return{browser:b[1] || "", version:b[2] || "0"}
    }, sub:function() {
      function a(b, c) {
        return new a.fn.init(b, c)
      }
      e.extend(!0, a, this), a.superclass = this, a.fn = a.prototype = this(), a.fn.constructor = a, a.sub = this.sub, a.fn.init = function(d, f) {
        f && (f instanceof e && (!(f instanceof a) && (f = a(f))));
        return e.fn.init.call(this, d, f, b)
      }, a.fn.init.prototype = a.fn;
      var b = a(c);
      return a
    }, browser:{}}), e.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(a, b) {
      I["[object " + b + "]"] = b.toLowerCase()
    }), z = e.uaMatch(y), z.browser && (e.browser[z.browser] = !0, e.browser.version = z.version), e.browser.webkit && (e.browser.safari = !0), j.test("\u00a0") && (k = /^[\s\xA0]+/, l = /[\s\xA0]+$/), h = e(c), c.addEventListener ? B = function() {
      c.removeEventListener("DOMContentLoaded", B, !1), e.ready()
    } : c.attachEvent && (B = function() {
      c.readyState === "complete" && (c.detachEvent("onreadystatechange", B), e.ready())
    });
    return e
  }(), g = {};
  f.Callbacks = function(a) {
    a = a ? g[a] || h(a) : {};
    var c = [], d = [], e, i, j, k, l, m, n = function(b) {
      var d, e, g, h, i;
      for(d = 0, e = b.length;d < e;d++) {
        g = b[d], h = f.type(g), h === "array" ? n(g) : h === "function" && ((!a.unique || !p.has(g)) && c.push(g))
      }
    }, o = function(b, f) {
      f = f || [], e = !a.memory || [b, f], i = !0, j = !0, m = k || 0, k = 0, l = c.length;
      for(;c && m < l;m++) {
        if(c[m].apply(b, f) === !1 && a.stopOnFalse) {
          e = !0;
          break
        }
      }
      j = !1, c && (a.once ? e === !0 ? p.disable() : c = [] : d && (d.length && (e = d.shift(), p.fireWith(e[0], e[1]))))
    }, p = {add:function() {
      if(c) {
        var a = c.length;
        n(arguments), j ? l = c.length : e && (e !== !0 && (k = a, o(e[0], e[1])))
      }
      return this
    }, remove:function() {
      if(c) {
        var b = arguments, d = 0, e = b.length;
        for(;d < e;d++) {
          for(var f = 0;f < c.length;f++) {
            if(b[d] === c[f]) {
              j && (f <= l && (l--, f <= m && m--)), c.splice(f--, 1);
              if(a.unique) {
                break
              }
            }
          }
        }
      }
      return this
    }, has:function(a) {
      if(c) {
        var b = 0, d = c.length;
        for(;b < d;b++) {
          if(a === c[b]) {
            return!0
          }
        }
      }
      return!1
    }, empty:function() {
      c = [];
      return this
    }, disable:function() {
      c = d = e = b;
      return this
    }, disabled:function() {
      return!c
    }, lock:function() {
      d = b, (!e || e === !0) && p.disable();
      return this
    }, locked:function() {
      return!d
    }, fireWith:function(b, c) {
      d && (j ? a.once || d.push([b, c]) : (!a.once || !e) && o(b, c));
      return this
    }, fire:function() {
      p.fireWith(this, arguments);
      return this
    }, fired:function() {
      return!!i
    }};
    return p
  };
  var i = [].slice;
  f.extend({Deferred:function(a) {
    var b = f.Callbacks("once memory"), c = f.Callbacks("once memory"), d = f.Callbacks("memory"), e = "pending", g = {resolve:b, reject:c, notify:d}, h = {done:b.add, fail:c.add, progress:d.add, state:function() {
      return e
    }, isResolved:b.fired, isRejected:c.fired, then:function(a, b, c) {
      i.done(a).fail(b).progress(c);
      return this
    }, always:function() {
      i.done.apply(i, arguments).fail.apply(i, arguments);
      return this
    }, pipe:function(a, b, c) {
      return f.Deferred(function(d) {
        f.each({done:[a, "resolve"], fail:[b, "reject"], progress:[c, "notify"]}, function(a, b) {
          var c = b[0], e = b[1], g;
          f.isFunction(c) ? i[a](function() {
            g = c.apply(this, arguments), g && f.isFunction(g.promise) ? g.promise().then(d.resolve, d.reject, d.notify) : d[e + "With"](this === i ? d : this, [g])
          }) : i[a](d[e])
        })
      }).promise()
    }, promise:function(a) {
      if(a == null) {
        a = h
      }else {
        for(var b in h) {
          a[b] = h[b]
        }
      }
      return a
    }}, i = h.promise({}), j;
    for(j in g) {
      i[j] = g[j].fire, i[j + "With"] = g[j].fireWith
    }
    i.done(function() {
      e = "resolved"
    }, c.disable, d.lock).fail(function() {
      e = "rejected"
    }, b.disable, d.lock), a && a.call(i, i);
    return i
  }, when:function(a) {
    function m(a) {
      return function(b) {
        e[a] = arguments.length > 1 ? i.call(arguments, 0) : b, j.notifyWith(k, e)
      }
    }
    function l(a) {
      return function(c) {
        b[a] = arguments.length > 1 ? i.call(arguments, 0) : c, --g || j.resolveWith(j, b)
      }
    }
    var b = i.call(arguments, 0), c = 0, d = b.length, e = Array(d), g = d, h = d, j = d <= 1 && (a && f.isFunction(a.promise)) ? a : f.Deferred(), k = j.promise();
    if(d > 1) {
      for(;c < d;c++) {
        b[c] && (b[c].promise && f.isFunction(b[c].promise)) ? b[c].promise().then(l(c), j.reject, m(c)) : --g
      }
      g || j.resolveWith(j, b)
    }else {
      j !== a && j.resolveWith(j, d ? [a] : [])
    }
    return k
  }}), f.support = function() {
    var b, d, e, g, h, i, j, k, l, m, n, o, p = c.createElement("div"), q = c.documentElement;
    p.setAttribute("className", "t"), p.innerHTML = "   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>", d = p.getElementsByTagName("*"), e = p.getElementsByTagName("a")[0];
    if(!d || (!d.length || !e)) {
      return{}
    }
    g = c.createElement("select"), h = g.appendChild(c.createElement("option")), i = p.getElementsByTagName("input")[0], b = {leadingWhitespace:p.firstChild.nodeType === 3, tbody:!p.getElementsByTagName("tbody").length, htmlSerialize:!!p.getElementsByTagName("link").length, style:/top/.test(e.getAttribute("style")), hrefNormalized:e.getAttribute("href") === "/a", opacity:/^0.55/.test(e.style.opacity), cssFloat:!!e.style.cssFloat, checkOn:i.value === "on", optSelected:h.selected, getSetAttribute:p.className !== 
    "t", enctype:!!c.createElement("form").enctype, html5Clone:c.createElement("nav").cloneNode(!0).outerHTML !== "<:nav></:nav>", submitBubbles:!0, changeBubbles:!0, focusinBubbles:!1, deleteExpando:!0, noCloneEvent:!0, inlineBlockNeedsLayout:!1, shrinkWrapBlocks:!1, reliableMarginRight:!0, pixelMargin:!0}, f.boxModel = b.boxModel = c.compatMode === "CSS1Compat", i.checked = !0, b.noCloneChecked = i.cloneNode(!0).checked, g.disabled = !0, b.optDisabled = !h.disabled;
    try {
      delete p.test
    }catch(r) {
      b.deleteExpando = !1
    }
    !p.addEventListener && (p.attachEvent && (p.fireEvent && (p.attachEvent("onclick", function() {
      b.noCloneEvent = !1
    }), p.cloneNode(!0).fireEvent("onclick")))), i = c.createElement("input"), i.value = "t", i.setAttribute("type", "radio"), b.radioValue = i.value === "t", i.setAttribute("checked", "checked"), i.setAttribute("name", "t"), p.appendChild(i), j = c.createDocumentFragment(), j.appendChild(p.lastChild), b.checkClone = j.cloneNode(!0).cloneNode(!0).lastChild.checked, b.appendChecked = i.checked, j.removeChild(i), j.appendChild(p);
    if(p.attachEvent) {
      for(n in{submit:1, change:1, focusin:1}) {
        m = "on" + n, o = m in p, o || (p.setAttribute(m, "return;"), o = typeof p[m] == "function"), b[n + "Bubbles"] = o
      }
    }
    j.removeChild(p), j = g = h = p = i = null, f(function() {
      var d, e, g, h, i, j, l, m, n, q, r, s, t, u = c.getElementsByTagName("body")[0];
      !u || (m = 1, t = "padding:0;margin:0;border:", r = "position:absolute;top:0;left:0;width:1px;height:1px;", s = t + "0;visibility:hidden;", n = "style='" + r + t + "5px solid #000;", q = "<div " + n + "display:block;'><div style='" + t + "0;display:block;overflow:hidden;'></div></div>" + "<table " + n + "' cellpadding='0' cellspacing='0'>" + "<tr><td></td></tr></table>", d = c.createElement("div"), d.style.cssText = s + "width:0;height:0;position:static;top:0;margin-top:" + m + "px", u.insertBefore(d, 
      u.firstChild), p = c.createElement("div"), d.appendChild(p), p.innerHTML = "<table><tr><td style='" + t + "0;display:none'></td><td>t</td></tr></table>", k = p.getElementsByTagName("td"), o = k[0].offsetHeight === 0, k[0].style.display = "", k[1].style.display = "none", b.reliableHiddenOffsets = o && k[0].offsetHeight === 0, a.getComputedStyle && (p.innerHTML = "", l = c.createElement("div"), l.style.width = "0", l.style.marginRight = "0", p.style.width = "2px", p.appendChild(l), b.reliableMarginRight = 
      (parseInt((a.getComputedStyle(l, null) || {marginRight:0}).marginRight, 10) || 0) === 0), typeof p.style.zoom != "undefined" && (p.innerHTML = "", p.style.width = p.style.padding = "1px", p.style.border = 0, p.style.overflow = "hidden", p.style.display = "inline", p.style.zoom = 1, b.inlineBlockNeedsLayout = p.offsetWidth === 3, p.style.display = "block", p.style.overflow = "visible", p.innerHTML = "<div style='width:5px;'></div>", b.shrinkWrapBlocks = p.offsetWidth !== 3), p.style.cssText = 
      r + s, p.innerHTML = q, e = p.firstChild, g = e.firstChild, i = e.nextSibling.firstChild.firstChild, j = {doesNotAddBorder:g.offsetTop !== 5, doesAddBorderForTableAndCells:i.offsetTop === 5}, g.style.position = "fixed", g.style.top = "20px", j.fixedPosition = g.offsetTop === 20 || g.offsetTop === 15, g.style.position = g.style.top = "", e.style.overflow = "hidden", e.style.position = "relative", j.subtractsBorderForOverflowNotVisible = g.offsetTop === -5, j.doesNotIncludeMarginInBodyOffset = 
      u.offsetTop !== m, a.getComputedStyle && (p.style.marginTop = "1%", b.pixelMargin = (a.getComputedStyle(p, null) || {marginTop:0}).marginTop !== "1%"), typeof d.style.zoom != "undefined" && (d.style.zoom = 1), u.removeChild(d), l = p = d = null, f.extend(b, j))
    });
    return b
  }();
  var j = /^(?:\{.*\}|\[.*\])$/, k = /([A-Z])/g;
  f.extend({cache:{}, uuid:0, expando:"jQuery" + (f.fn.jquery + Math.random()).replace(/\D/g, ""), noData:{embed:!0, object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", applet:!0}, hasData:function(a) {
    a = a.nodeType ? f.cache[a[f.expando]] : a[f.expando];
    return!!a && !m(a)
  }, data:function(a, c, d, e) {
    if(!!f.acceptData(a)) {
      var g, h, i, j = f.expando, k = typeof c == "string", l = a.nodeType, m = l ? f.cache : a, n = l ? a[j] : a[j] && j, o = c === "events";
      if((!n || (!m[n] || !o && (!e && !m[n].data))) && (k && d === b)) {
        return
      }
      n || (l ? a[j] = n = ++f.uuid : n = j), m[n] || (m[n] = {}, l || (m[n].toJSON = f.noop));
      if(typeof c == "object" || typeof c == "function") {
        e ? m[n] = f.extend(m[n], c) : m[n].data = f.extend(m[n].data, c)
      }
      g = h = m[n], e || (h.data || (h.data = {}), h = h.data), d !== b && (h[f.camelCase(c)] = d);
      if(o && !h[c]) {
        return g.events
      }
      k ? (i = h[c], i == null && (i = h[f.camelCase(c)])) : i = h;
      return i
    }
  }, removeData:function(a, b, c) {
    if(!!f.acceptData(a)) {
      var d, e, g, h = f.expando, i = a.nodeType, j = i ? f.cache : a, k = i ? a[h] : h;
      if(!j[k]) {
        return
      }
      if(b) {
        d = c ? j[k] : j[k].data;
        if(d) {
          f.isArray(b) || (b in d ? b = [b] : (b = f.camelCase(b), b in d ? b = [b] : b = b.split(" ")));
          for(e = 0, g = b.length;e < g;e++) {
            delete d[b[e]]
          }
          if(!(c ? m : f.isEmptyObject)(d)) {
            return
          }
        }
      }
      if(!c) {
        delete j[k].data;
        if(!m(j[k])) {
          return
        }
      }
      f.support.deleteExpando || !j.setInterval ? delete j[k] : j[k] = null, i && (f.support.deleteExpando ? delete a[h] : a.removeAttribute ? a.removeAttribute(h) : a[h] = null)
    }
  }, _data:function(a, b, c) {
    return f.data(a, b, c, !0)
  }, acceptData:function(a) {
    if(a.nodeName) {
      var b = f.noData[a.nodeName.toLowerCase()];
      if(b) {
        return b !== !0 && a.getAttribute("classid") === b
      }
    }
    return!0
  }}), f.fn.extend({data:function(a, c) {
    var d, e, g, h, i, j = this[0], k = 0, m = null;
    if(a === b) {
      if(this.length) {
        m = f.data(j);
        if(j.nodeType === 1 && !f._data(j, "parsedAttrs")) {
          g = j.attributes;
          for(i = g.length;k < i;k++) {
            h = g[k].name, h.indexOf("data-") === 0 && (h = f.camelCase(h.substring(5)), l(j, h, m[h]))
          }
          f._data(j, "parsedAttrs", !0)
        }
      }
      return m
    }
    if(typeof a == "object") {
      return this.each(function() {
        f.data(this, a)
      })
    }
    d = a.split(".", 2), d[1] = d[1] ? "." + d[1] : "", e = d[1] + "!";
    return f.access(this, function(c) {
      if(c === b) {
        m = this.triggerHandler("getData" + e, [d[0]]), m === b && (j && (m = f.data(j, a), m = l(j, a, m)));
        return m === b && d[1] ? this.data(d[0]) : m
      }
      d[1] = c, this.each(function() {
        var b = f(this);
        b.triggerHandler("setData" + e, d), f.data(this, a, c), b.triggerHandler("changeData" + e, d)
      })
    }, null, c, arguments.length > 1, null, !1)
  }, removeData:function(a) {
    return this.each(function() {
      f.removeData(this, a)
    })
  }}), f.extend({_mark:function(a, b) {
    a && (b = (b || "fx") + "mark", f._data(a, b, (f._data(a, b) || 0) + 1))
  }, _unmark:function(a, b, c) {
    a !== !0 && (c = b, b = a, a = !1);
    if(b) {
      c = c || "fx";
      var d = c + "mark", e = a ? 0 : (f._data(b, d) || 1) - 1;
      e ? f._data(b, d, e) : (f.removeData(b, d, !0), n(b, c, "mark"))
    }
  }, queue:function(a, b, c) {
    var d;
    if(a) {
      b = (b || "fx") + "queue", d = f._data(a, b), c && (!d || f.isArray(c) ? d = f._data(a, b, f.makeArray(c)) : d.push(c));
      return d || []
    }
  }, dequeue:function(a, b) {
    b = b || "fx";
    var c = f.queue(a, b), d = c.shift(), e = {};
    d === "inprogress" && (d = c.shift()), d && (b === "fx" && c.unshift("inprogress"), f._data(a, b + ".run", e), d.call(a, function() {
      f.dequeue(a, b)
    }, e)), c.length || (f.removeData(a, b + "queue " + b + ".run", !0), n(a, b, "queue"))
  }}), f.fn.extend({queue:function(a, c) {
    var d = 2;
    typeof a != "string" && (c = a, a = "fx", d--);
    if(arguments.length < d) {
      return f.queue(this[0], a)
    }
    return c === b ? this : this.each(function() {
      var b = f.queue(this, a, c);
      a === "fx" && (b[0] !== "inprogress" && f.dequeue(this, a))
    })
  }, dequeue:function(a) {
    return this.each(function() {
      f.dequeue(this, a)
    })
  }, delay:function(a, b) {
    a = f.fx ? f.fx.speeds[a] || a : a, b = b || "fx";
    return this.queue(b, function(b, c) {
      var d = setTimeout(b, a);
      c.stop = function() {
        clearTimeout(d)
      }
    })
  }, clearQueue:function(a) {
    return this.queue(a || "fx", [])
  }, promise:function(a, c) {
    function m() {
      --h || d.resolveWith(e, [e])
    }
    typeof a != "string" && (c = a, a = b), a = a || "fx";
    var d = f.Deferred(), e = this, g = e.length, h = 1, i = a + "defer", j = a + "queue", k = a + "mark", l;
    while(g--) {
      if(l = f.data(e[g], i, b, !0) || (f.data(e[g], j, b, !0) || f.data(e[g], k, b, !0)) && f.data(e[g], i, f.Callbacks("once memory"), !0)) {
        h++, l.add(m)
      }
    }
    m();
    return d.promise(c)
  }});
  var o = /[\n\t\r]/g, p = /\s+/, q = /\r/g, r = /^(?:button|input)$/i, s = /^(?:button|input|object|select|textarea)$/i, t = /^a(?:rea)?$/i, u = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, v = f.support.getSetAttribute, w, x, y;
  f.fn.extend({attr:function(a, b) {
    return f.access(this, f.attr, a, b, arguments.length > 1)
  }, removeAttr:function(a) {
    return this.each(function() {
      f.removeAttr(this, a)
    })
  }, prop:function(a, b) {
    return f.access(this, f.prop, a, b, arguments.length > 1)
  }, removeProp:function(a) {
    a = f.propFix[a] || a;
    return this.each(function() {
      try {
        this[a] = b, delete this[a]
      }catch(c) {
      }
    })
  }, addClass:function(a) {
    var b, c, d, e, g, h, i;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).addClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string") {
      b = a.split(p);
      for(c = 0, d = this.length;c < d;c++) {
        e = this[c];
        if(e.nodeType === 1) {
          if(!e.className && b.length === 1) {
            e.className = a
          }else {
            g = " " + e.className + " ";
            for(h = 0, i = b.length;h < i;h++) {
              ~g.indexOf(" " + b[h] + " ") || (g += b[h] + " ")
            }
            e.className = f.trim(g)
          }
        }
      }
    }
    return this
  }, removeClass:function(a) {
    var c, d, e, g, h, i, j;
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).removeClass(a.call(this, b, this.className))
      })
    }
    if(a && typeof a == "string" || a === b) {
      c = (a || "").split(p);
      for(d = 0, e = this.length;d < e;d++) {
        g = this[d];
        if(g.nodeType === 1 && g.className) {
          if(a) {
            h = (" " + g.className + " ").replace(o, " ");
            for(i = 0, j = c.length;i < j;i++) {
              h = h.replace(" " + c[i] + " ", " ")
            }
            g.className = f.trim(h)
          }else {
            g.className = ""
          }
        }
      }
    }
    return this
  }, toggleClass:function(a, b) {
    var c = typeof a, d = typeof b == "boolean";
    if(f.isFunction(a)) {
      return this.each(function(c) {
        f(this).toggleClass(a.call(this, c, this.className, b), b)
      })
    }
    return this.each(function() {
      if(c === "string") {
        var e, g = 0, h = f(this), i = b, j = a.split(p);
        while(e = j[g++]) {
          i = d ? i : !h.hasClass(e), h[i ? "addClass" : "removeClass"](e)
        }
      }else {
        if(c === "undefined" || c === "boolean") {
          this.className && f._data(this, "__className__", this.className), this.className = this.className || a === !1 ? "" : f._data(this, "__className__") || ""
        }
      }
    })
  }, hasClass:function(a) {
    var b = " " + a + " ", c = 0, d = this.length;
    for(;c < d;c++) {
      if(this[c].nodeType === 1 && (" " + this[c].className + " ").replace(o, " ").indexOf(b) > -1) {
        return!0
      }
    }
    return!1
  }, val:function(a) {
    var c, d, e, g = this[0];
    if(!!arguments.length) {
      e = f.isFunction(a);
      return this.each(function(d) {
        var g = f(this), h;
        if(this.nodeType === 1) {
          e ? h = a.call(this, d, g.val()) : h = a, h == null ? h = "" : typeof h == "number" ? h += "" : f.isArray(h) && (h = f.map(h, function(a) {
            return a == null ? "" : a + ""
          })), c = f.valHooks[this.type] || f.valHooks[this.nodeName.toLowerCase()];
          if(!c || (!("set" in c) || c.set(this, h, "value") === b)) {
            this.value = h
          }
        }
      })
    }
    if(g) {
      c = f.valHooks[g.type] || f.valHooks[g.nodeName.toLowerCase()];
      if(c && ("get" in c && (d = c.get(g, "value")) !== b)) {
        return d
      }
      d = g.value;
      return typeof d == "string" ? d.replace(q, "") : d == null ? "" : d
    }
  }}), f.extend({valHooks:{option:{get:function(a) {
    var b = a.attributes.value;
    return!b || b.specified ? a.value : a.text
  }}, select:{get:function(a) {
    var b, c, d, e, g = a.selectedIndex, h = [], i = a.options, j = a.type === "select-one";
    if(g < 0) {
      return null
    }
    c = j ? g : 0, d = j ? g + 1 : i.length;
    for(;c < d;c++) {
      e = i[c];
      if(e.selected && ((f.support.optDisabled ? !e.disabled : e.getAttribute("disabled") === null) && (!e.parentNode.disabled || !f.nodeName(e.parentNode, "optgroup")))) {
        b = f(e).val();
        if(j) {
          return b
        }
        h.push(b)
      }
    }
    if(j && (!h.length && i.length)) {
      return f(i[g]).val()
    }
    return h
  }, set:function(a, b) {
    var c = f.makeArray(b);
    f(a).find("option").each(function() {
      this.selected = f.inArray(f(this).val(), c) >= 0
    }), c.length || (a.selectedIndex = -1);
    return c
  }}}, attrFn:{val:!0, css:!0, html:!0, text:!0, data:!0, width:!0, height:!0, offset:!0}, attr:function(a, c, d, e) {
    var g, h, i, j = a.nodeType;
    if(!!a && (j !== 3 && (j !== 8 && j !== 2))) {
      if(e && c in f.attrFn) {
        return f(a)[c](d)
      }
      if(typeof a.getAttribute == "undefined") {
        return f.prop(a, c, d)
      }
      i = j !== 1 || !f.isXMLDoc(a), i && (c = c.toLowerCase(), h = f.attrHooks[c] || (u.test(c) ? x : w));
      if(d !== b) {
        if(d === null) {
          f.removeAttr(a, c);
          return
        }
        if(h && ("set" in h && (i && (g = h.set(a, d, c)) !== b))) {
          return g
        }
        a.setAttribute(c, "" + d);
        return d
      }
      if(h && ("get" in h && (i && (g = h.get(a, c)) !== null))) {
        return g
      }
      g = a.getAttribute(c);
      return g === null ? b : g
    }
  }, removeAttr:function(a, b) {
    var c, d, e, g, h, i = 0;
    if(b && a.nodeType === 1) {
      d = b.toLowerCase().split(p), g = d.length;
      for(;i < g;i++) {
        e = d[i], e && (c = f.propFix[e] || e, h = u.test(e), h || f.attr(a, e, ""), a.removeAttribute(v ? e : c), h && (c in a && (a[c] = !1)))
      }
    }
  }, attrHooks:{type:{set:function(a, b) {
    if(r.test(a.nodeName) && a.parentNode) {
      f.error("type property can't be changed")
    }else {
      if(!f.support.radioValue && (b === "radio" && f.nodeName(a, "input"))) {
        var c = a.value;
        a.setAttribute("type", b), c && (a.value = c);
        return b
      }
    }
  }}, value:{get:function(a, b) {
    if(w && f.nodeName(a, "button")) {
      return w.get(a, b)
    }
    return b in a ? a.value : null
  }, set:function(a, b, c) {
    if(w && f.nodeName(a, "button")) {
      return w.set(a, b, c)
    }
    a.value = b
  }}}, propFix:{tabindex:"tabIndex", readonly:"readOnly", "for":"htmlFor", "class":"className", maxlength:"maxLength", cellspacing:"cellSpacing", cellpadding:"cellPadding", rowspan:"rowSpan", colspan:"colSpan", usemap:"useMap", frameborder:"frameBorder", contenteditable:"contentEditable"}, prop:function(a, c, d) {
    var e, g, h, i = a.nodeType;
    if(!!a && (i !== 3 && (i !== 8 && i !== 2))) {
      h = i !== 1 || !f.isXMLDoc(a), h && (c = f.propFix[c] || c, g = f.propHooks[c]);
      return d !== b ? g && ("set" in g && (e = g.set(a, d, c)) !== b) ? e : a[c] = d : g && ("get" in g && (e = g.get(a, c)) !== null) ? e : a[c]
    }
  }, propHooks:{tabIndex:{get:function(a) {
    var c = a.getAttributeNode("tabindex");
    return c && c.specified ? parseInt(c.value, 10) : s.test(a.nodeName) || t.test(a.nodeName) && a.href ? 0 : b
  }}}}), f.attrHooks.tabindex = f.propHooks.tabIndex, x = {get:function(a, c) {
    var d, e = f.prop(a, c);
    return e === !0 || typeof e != "boolean" && ((d = a.getAttributeNode(c)) && d.nodeValue !== !1) ? c.toLowerCase() : b
  }, set:function(a, b, c) {
    var d;
    b === !1 ? f.removeAttr(a, c) : (d = f.propFix[c] || c, d in a && (a[d] = !0), a.setAttribute(c, c.toLowerCase()));
    return c
  }}, v || (y = {name:!0, id:!0, coords:!0}, w = f.valHooks.button = {get:function(a, c) {
    var d;
    d = a.getAttributeNode(c);
    return d && (y[c] ? d.nodeValue !== "" : d.specified) ? d.nodeValue : b
  }, set:function(a, b, d) {
    var e = a.getAttributeNode(d);
    e || (e = c.createAttribute(d), a.setAttributeNode(e));
    return e.nodeValue = b + ""
  }}, f.attrHooks.tabindex.set = w.set, f.each(["width", "height"], function(a, b) {
    f.attrHooks[b] = f.extend(f.attrHooks[b], {set:function(a, c) {
      if(c === "") {
        a.setAttribute(b, "auto");
        return c
      }
    }})
  }), f.attrHooks.contenteditable = {get:w.get, set:function(a, b, c) {
    b === "" && (b = "false"), w.set(a, b, c)
  }}), f.support.hrefNormalized || f.each(["href", "src", "width", "height"], function(a, c) {
    f.attrHooks[c] = f.extend(f.attrHooks[c], {get:function(a) {
      var d = a.getAttribute(c, 2);
      return d === null ? b : d
    }})
  }), f.support.style || (f.attrHooks.style = {get:function(a) {
    return a.style.cssText.toLowerCase() || b
  }, set:function(a, b) {
    return a.style.cssText = "" + b
  }}), f.support.optSelected || (f.propHooks.selected = f.extend(f.propHooks.selected, {get:function(a) {
    var b = a.parentNode;
    b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex);
    return null
  }})), f.support.enctype || (f.propFix.enctype = "encoding"), f.support.checkOn || f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = {get:function(a) {
      return a.getAttribute("value") === null ? "on" : a.value
    }}
  }), f.each(["radio", "checkbox"], function() {
    f.valHooks[this] = f.extend(f.valHooks[this], {set:function(a, b) {
      if(f.isArray(b)) {
        return a.checked = f.inArray(f(a).val(), b) >= 0
      }
    }})
  });
  var z = /^(?:textarea|input|select)$/i, A = /^([^\.]*)?(?:\.(.+))?$/, B = /(?:^|\s)hover(\.\S+)?\b/, C = /^key/, D = /^(?:mouse|contextmenu)|click/, E = /^(?:focusinfocus|focusoutblur)$/, F = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, G = function(a) {
    var b = F.exec(a);
    b && (b[1] = (b[1] || "").toLowerCase(), b[3] = b[3] && new RegExp("(?:^|\\s)" + b[3] + "(?:\\s|$)"));
    return b
  }, H = function(a, b) {
    var c = a.attributes || {};
    return(!b[1] || a.nodeName.toLowerCase() === b[1]) && ((!b[2] || (c.id || {}).value === b[2]) && (!b[3] || b[3].test((c["class"] || {}).value)))
  }, I = function(a) {
    return f.event.special.hover ? a : a.replace(B, "mouseenter$1 mouseleave$1")
  };
  f.event = {add:function(a, c, d, e, g) {
    var h, i, j, k, l, m, n, o, p, q, r, s;
    if(!(a.nodeType === 3 || (a.nodeType === 8 || (!c || (!d || !(h = f._data(a))))))) {
      d.handler && (p = d, d = p.handler, g = p.selector), d.guid || (d.guid = f.guid++), j = h.events, j || (h.events = j = {}), i = h.handle, i || (h.handle = i = function(a) {
        return typeof f != "undefined" && (!a || f.event.triggered !== a.type) ? f.event.dispatch.apply(i.elem, arguments) : b
      }, i.elem = a), c = f.trim(I(c)).split(" ");
      for(k = 0;k < c.length;k++) {
        l = A.exec(c[k]) || [], m = l[1], n = (l[2] || "").split(".").sort(), s = f.event.special[m] || {}, m = (g ? s.delegateType : s.bindType) || m, s = f.event.special[m] || {}, o = f.extend({type:m, origType:l[1], data:e, handler:d, guid:d.guid, selector:g, quick:g && G(g), namespace:n.join(".")}, p), r = j[m];
        if(!r) {
          r = j[m] = [], r.delegateCount = 0;
          if(!s.setup || s.setup.call(a, e, n, i) === !1) {
            a.addEventListener ? a.addEventListener(m, i, !1) : a.attachEvent && a.attachEvent("on" + m, i)
          }
        }
        s.add && (s.add.call(a, o), o.handler.guid || (o.handler.guid = d.guid)), g ? r.splice(r.delegateCount++, 0, o) : r.push(o), f.event.global[m] = !0
      }
      a = null
    }
  }, global:{}, remove:function(a, b, c, d, e) {
    var g = f.hasData(a) && f._data(a), h, i, j, k, l, m, n, o, p, q, r, s;
    if(!!g && !!(o = g.events)) {
      b = f.trim(I(b || "")).split(" ");
      for(h = 0;h < b.length;h++) {
        i = A.exec(b[h]) || [], j = k = i[1], l = i[2];
        if(!j) {
          for(j in o) {
            f.event.remove(a, j + b[h], c, d, !0)
          }
          continue
        }
        p = f.event.special[j] || {}, j = (d ? p.delegateType : p.bindType) || j, r = o[j] || [], m = r.length, l = l ? new RegExp("(^|\\.)" + l.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null;
        for(n = 0;n < r.length;n++) {
          s = r[n], (e || k === s.origType) && ((!c || c.guid === s.guid) && ((!l || l.test(s.namespace)) && ((!d || (d === s.selector || d === "**" && s.selector)) && (r.splice(n--, 1), s.selector && r.delegateCount--, p.remove && p.remove.call(a, s)))))
        }
        r.length === 0 && (m !== r.length && ((!p.teardown || p.teardown.call(a, l) === !1) && f.removeEvent(a, j, g.handle), delete o[j]))
      }
      f.isEmptyObject(o) && (q = g.handle, q && (q.elem = null), f.removeData(a, ["events", "handle"], !0))
    }
  }, customEvent:{getData:!0, setData:!0, changeData:!0}, trigger:function(c, d, e, g) {
    if(!e || e.nodeType !== 3 && e.nodeType !== 8) {
      var h = c.type || c, i = [], j, k, l, m, n, o, p, q, r, s;
      if(E.test(h + f.event.triggered)) {
        return
      }
      h.indexOf("!") >= 0 && (h = h.slice(0, -1), k = !0), h.indexOf(".") >= 0 && (i = h.split("."), h = i.shift(), i.sort());
      if((!e || f.event.customEvent[h]) && !f.event.global[h]) {
        return
      }
      c = typeof c == "object" ? c[f.expando] ? c : new f.Event(h, c) : new f.Event(h), c.type = h, c.isTrigger = !0, c.exclusive = k, c.namespace = i.join("."), c.namespace_re = c.namespace ? new RegExp("(^|\\.)" + i.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, o = h.indexOf(":") < 0 ? "on" + h : "";
      if(!e) {
        j = f.cache;
        for(l in j) {
          j[l].events && (j[l].events[h] && f.event.trigger(c, d, j[l].handle.elem, !0))
        }
        return
      }
      c.result = b, c.target || (c.target = e), d = d != null ? f.makeArray(d) : [], d.unshift(c), p = f.event.special[h] || {};
      if(p.trigger && p.trigger.apply(e, d) === !1) {
        return
      }
      r = [[e, p.bindType || h]];
      if(!g && (!p.noBubble && !f.isWindow(e))) {
        s = p.delegateType || h, m = E.test(s + h) ? e : e.parentNode, n = null;
        for(;m;m = m.parentNode) {
          r.push([m, s]), n = m
        }
        n && (n === e.ownerDocument && r.push([n.defaultView || (n.parentWindow || a), s]))
      }
      for(l = 0;l < r.length && !c.isPropagationStopped();l++) {
        m = r[l][0], c.type = r[l][1], q = (f._data(m, "events") || {})[c.type] && f._data(m, "handle"), q && q.apply(m, d), q = o && m[o], q && (f.acceptData(m) && (q.apply(m, d) === !1 && c.preventDefault()))
      }
      c.type = h, !g && (!c.isDefaultPrevented() && ((!p._default || p._default.apply(e.ownerDocument, d) === !1) && ((h !== "click" || !f.nodeName(e, "a")) && (f.acceptData(e) && (o && (e[h] && ((h !== "focus" && h !== "blur" || c.target.offsetWidth !== 0) && (!f.isWindow(e) && (n = e[o], n && (e[o] = null), f.event.triggered = h, e[h](), f.event.triggered = b, n && (e[o] = n))))))))));
      return c.result
    }
  }, dispatch:function(c) {
    c = f.event.fix(c || a.event);
    var d = (f._data(this, "events") || {})[c.type] || [], e = d.delegateCount, g = [].slice.call(arguments, 0), h = !c.exclusive && !c.namespace, i = f.event.special[c.type] || {}, j = [], k, l, m, n, o, p, q, r, s, t, u;
    g[0] = c, c.delegateTarget = this;
    if(!i.preDispatch || i.preDispatch.call(this, c) !== !1) {
      if(e && (!c.button || c.type !== "click")) {
        n = f(this), n.context = this.ownerDocument || this;
        for(m = c.target;m != this;m = m.parentNode || this) {
          if(m.disabled !== !0) {
            p = {}, r = [], n[0] = m;
            for(k = 0;k < e;k++) {
              s = d[k], t = s.selector, p[t] === b && (p[t] = s.quick ? H(m, s.quick) : n.is(t)), p[t] && r.push(s)
            }
            r.length && j.push({elem:m, matches:r})
          }
        }
      }
      d.length > e && j.push({elem:this, matches:d.slice(e)});
      for(k = 0;k < j.length && !c.isPropagationStopped();k++) {
        q = j[k], c.currentTarget = q.elem;
        for(l = 0;l < q.matches.length && !c.isImmediatePropagationStopped();l++) {
          s = q.matches[l];
          if(h || (!c.namespace && !s.namespace || c.namespace_re && c.namespace_re.test(s.namespace))) {
            c.data = s.data, c.handleObj = s, o = ((f.event.special[s.origType] || {}).handle || s.handler).apply(q.elem, g), o !== b && (c.result = o, o === !1 && (c.preventDefault(), c.stopPropagation()))
          }
        }
      }
      i.postDispatch && i.postDispatch.call(this, c);
      return c.result
    }
  }, props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks:{}, keyHooks:{props:"char charCode key keyCode".split(" "), filter:function(a, b) {
    a.which == null && (a.which = b.charCode != null ? b.charCode : b.keyCode);
    return a
  }}, mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter:function(a, d) {
    var e, f, g, h = d.button, i = d.fromElement;
    a.pageX == null && (d.clientX != null && (e = a.target.ownerDocument || c, f = e.documentElement, g = e.body, a.pageX = d.clientX + (f && f.scrollLeft || (g && g.scrollLeft || 0)) - (f && f.clientLeft || (g && g.clientLeft || 0)), a.pageY = d.clientY + (f && f.scrollTop || (g && g.scrollTop || 0)) - (f && f.clientTop || (g && g.clientTop || 0)))), !a.relatedTarget && (i && (a.relatedTarget = i === a.target ? d.toElement : i)), !a.which && (h !== b && (a.which = h & 1 ? 1 : h & 2 ? 3 : h & 4 ? 
    2 : 0));
    return a
  }}, fix:function(a) {
    if(a[f.expando]) {
      return a
    }
    var d, e, g = a, h = f.event.fixHooks[a.type] || {}, i = h.props ? this.props.concat(h.props) : this.props;
    a = f.Event(g);
    for(d = i.length;d;) {
      e = i[--d], a[e] = g[e]
    }
    a.target || (a.target = g.srcElement || c), a.target.nodeType === 3 && (a.target = a.target.parentNode), a.metaKey === b && (a.metaKey = a.ctrlKey);
    return h.filter ? h.filter(a, g) : a
  }, special:{ready:{setup:f.bindReady}, load:{noBubble:!0}, focus:{delegateType:"focusin"}, blur:{delegateType:"focusout"}, beforeunload:{setup:function(a, b, c) {
    f.isWindow(this) && (this.onbeforeunload = c)
  }, teardown:function(a, b) {
    this.onbeforeunload === b && (this.onbeforeunload = null)
  }}}, simulate:function(a, b, c, d) {
    var e = f.extend(new f.Event, c, {type:a, isSimulated:!0, originalEvent:{}});
    d ? f.event.trigger(e, null, b) : f.event.dispatch.call(b, e), e.isDefaultPrevented() && c.preventDefault()
  }}, f.event.handle = f.event.dispatch, f.removeEvent = c.removeEventListener ? function(a, b, c) {
    a.removeEventListener && a.removeEventListener(b, c, !1)
  } : function(a, b, c) {
    a.detachEvent && a.detachEvent("on" + b, c)
  }, f.Event = function(a, b) {
    if(!(this instanceof f.Event)) {
      return new f.Event(a, b)
    }
    a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || (a.returnValue === !1 || a.getPreventDefault && a.getPreventDefault()) ? K : J) : this.type = a, b && f.extend(this, b), this.timeStamp = a && a.timeStamp || f.now(), this[f.expando] = !0
  }, f.Event.prototype = {preventDefault:function() {
    this.isDefaultPrevented = K;
    var a = this.originalEvent;
    !a || (a.preventDefault ? a.preventDefault() : a.returnValue = !1)
  }, stopPropagation:function() {
    this.isPropagationStopped = K;
    var a = this.originalEvent;
    !a || (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0)
  }, stopImmediatePropagation:function() {
    this.isImmediatePropagationStopped = K, this.stopPropagation()
  }, isDefaultPrevented:J, isPropagationStopped:J, isImmediatePropagationStopped:J}, f.each({mouseenter:"mouseover", mouseleave:"mouseout"}, function(a, b) {
    f.event.special[a] = {delegateType:b, bindType:b, handle:function(a) {
      var c = this, d = a.relatedTarget, e = a.handleObj, g = e.selector, h;
      if(!d || d !== c && !f.contains(c, d)) {
        a.type = e.origType, h = e.handler.apply(this, arguments), a.type = b
      }
      return h
    }}
  }), f.support.submitBubbles || (f.event.special.submit = {setup:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.add(this, "click._submit keypress._submit", function(a) {
      var c = a.target, d = f.nodeName(c, "input") || f.nodeName(c, "button") ? c.form : b;
      d && (!d._submit_attached && (f.event.add(d, "submit._submit", function(a) {
        a._submit_bubble = !0
      }), d._submit_attached = !0))
    })
  }, postDispatch:function(a) {
    a._submit_bubble && (delete a._submit_bubble, this.parentNode && (!a.isTrigger && f.event.simulate("submit", this.parentNode, a, !0)))
  }, teardown:function() {
    if(f.nodeName(this, "form")) {
      return!1
    }
    f.event.remove(this, "._submit")
  }}), f.support.changeBubbles || (f.event.special.change = {setup:function() {
    if(z.test(this.nodeName)) {
      if(this.type === "checkbox" || this.type === "radio") {
        f.event.add(this, "propertychange._change", function(a) {
          a.originalEvent.propertyName === "checked" && (this._just_changed = !0)
        }), f.event.add(this, "click._change", function(a) {
          this._just_changed && (!a.isTrigger && (this._just_changed = !1, f.event.simulate("change", this, a, !0)))
        })
      }
      return!1
    }
    f.event.add(this, "beforeactivate._change", function(a) {
      var b = a.target;
      z.test(b.nodeName) && (!b._change_attached && (f.event.add(b, "change._change", function(a) {
        this.parentNode && (!a.isSimulated && (!a.isTrigger && f.event.simulate("change", this.parentNode, a, !0)))
      }), b._change_attached = !0))
    })
  }, handle:function(a) {
    var b = a.target;
    if(this !== b || (a.isSimulated || (a.isTrigger || b.type !== "radio" && b.type !== "checkbox"))) {
      return a.handleObj.handler.apply(this, arguments)
    }
  }, teardown:function() {
    f.event.remove(this, "._change");
    return z.test(this.nodeName)
  }}), f.support.focusinBubbles || f.each({focus:"focusin", blur:"focusout"}, function(a, b) {
    var d = 0, e = function(a) {
      f.event.simulate(b, a.target, f.event.fix(a), !0)
    };
    f.event.special[b] = {setup:function() {
      d++ === 0 && c.addEventListener(a, e, !0)
    }, teardown:function() {
      --d === 0 && c.removeEventListener(a, e, !0)
    }}
  }), f.fn.extend({on:function(a, c, d, e, g) {
    var h, i;
    if(typeof a == "object") {
      typeof c != "string" && (d = d || c, c = b);
      for(i in a) {
        this.on(i, c, d, a[i], g)
      }
      return this
    }
    d == null && e == null ? (e = c, d = c = b) : e == null && (typeof c == "string" ? (e = d, d = b) : (e = d, d = c, c = b));
    if(e === !1) {
      e = J
    }else {
      if(!e) {
        return this
      }
    }
    g === 1 && (h = e, e = function(a) {
      f().off(a);
      return h.apply(this, arguments)
    }, e.guid = h.guid || (h.guid = f.guid++));
    return this.each(function() {
      f.event.add(this, a, e, d, c)
    })
  }, one:function(a, b, c, d) {
    return this.on(a, b, c, d, 1)
  }, off:function(a, c, d) {
    if(a && (a.preventDefault && a.handleObj)) {
      var e = a.handleObj;
      f(a.delegateTarget).off(e.namespace ? e.origType + "." + e.namespace : e.origType, e.selector, e.handler);
      return this
    }
    if(typeof a == "object") {
      for(var g in a) {
        this.off(g, c, a[g])
      }
      return this
    }
    if(c === !1 || typeof c == "function") {
      d = c, c = b
    }
    d === !1 && (d = J);
    return this.each(function() {
      f.event.remove(this, a, d, c)
    })
  }, bind:function(a, b, c) {
    return this.on(a, null, b, c)
  }, unbind:function(a, b) {
    return this.off(a, null, b)
  }, live:function(a, b, c) {
    f(this.context).on(a, this.selector, b, c);
    return this
  }, die:function(a, b) {
    f(this.context).off(a, this.selector || "**", b);
    return this
  }, delegate:function(a, b, c, d) {
    return this.on(b, a, c, d)
  }, undelegate:function(a, b, c) {
    return arguments.length == 1 ? this.off(a, "**") : this.off(b, a, c)
  }, trigger:function(a, b) {
    return this.each(function() {
      f.event.trigger(a, b, this)
    })
  }, triggerHandler:function(a, b) {
    if(this[0]) {
      return f.event.trigger(a, b, this[0], !0)
    }
  }, toggle:function(a) {
    var b = arguments, c = a.guid || f.guid++, d = 0, e = function(c) {
      var e = (f._data(this, "lastToggle" + a.guid) || 0) % d;
      f._data(this, "lastToggle" + a.guid, e + 1), c.preventDefault();
      return b[e].apply(this, arguments) || !1
    };
    e.guid = c;
    while(d < b.length) {
      b[d++].guid = c
    }
    return this.click(e)
  }, hover:function(a, b) {
    return this.mouseenter(a).mouseleave(b || a)
  }}), f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(a, b) {
    f.fn[b] = function(a, c) {
      c == null && (c = a, a = null);
      return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b)
    }, f.attrFn && (f.attrFn[b] = !0), C.test(b) && (f.event.fixHooks[b] = f.event.keyHooks), D.test(b) && (f.event.fixHooks[b] = f.event.mouseHooks)
  }), function() {
    function x(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            if(j.nodeType === 1) {
              g || (j[d] = c, j.sizset = h);
              if(typeof b != "string") {
                if(j === b) {
                  k = !0;
                  break
                }
              }else {
                if(m.filter(b, [j]).length > 0) {
                  k = j;
                  break
                }
              }
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    function w(a, b, c, e, f, g) {
      for(var h = 0, i = e.length;h < i;h++) {
        var j = e[h];
        if(j) {
          var k = !1;
          j = j[a];
          while(j) {
            if(j[d] === c) {
              k = e[j.sizset];
              break
            }
            j.nodeType === 1 && (!g && (j[d] = c, j.sizset = h));
            if(j.nodeName.toLowerCase() === b) {
              k = j;
              break
            }
            j = j[a]
          }
          e[h] = k
        }
      }
    }
    var a = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, d = "sizcache" + (Math.random() + "").replace(".", ""), e = 0, g = Object.prototype.toString, h = !1, i = !0, j = /\\/g, k = /\r\n/g, l = /\W/;
    [0, 0].sort(function() {
      i = !1;
      return 0
    });
    var m = function(b, d, e, f) {
      e = e || [], d = d || c;
      var h = d;
      if(d.nodeType !== 1 && d.nodeType !== 9) {
        return[]
      }
      if(!b || typeof b != "string") {
        return e
      }
      var i, j, k, l, n, q, r, t, u = !0, v = m.isXML(d), w = [], x = b;
      do {
        a.exec(""), i = a.exec(x);
        if(i) {
          x = i[3], w.push(i[1]);
          if(i[2]) {
            l = i[3];
            break
          }
        }
      }while(i);
      if(w.length > 1 && p.exec(b)) {
        if(w.length === 2 && o.relative[w[0]]) {
          j = y(w[0] + w[1], d, f)
        }else {
          j = o.relative[w[0]] ? [d] : m(w.shift(), d);
          while(w.length) {
            b = w.shift(), o.relative[b] && (b += w.shift()), j = y(b, j, f)
          }
        }
      }else {
        !f && (w.length > 1 && (d.nodeType === 9 && (!v && (o.match.ID.test(w[0]) && (!o.match.ID.test(w[w.length - 1]) && (n = m.find(w.shift(), d, v), d = n.expr ? m.filter(n.expr, n.set)[0] : n.set[0]))))));
        if(d) {
          n = f ? {expr:w.pop(), set:s(f)} : m.find(w.pop(), w.length === 1 && ((w[0] === "~" || w[0] === "+") && d.parentNode) ? d.parentNode : d, v), j = n.expr ? m.filter(n.expr, n.set) : n.set, w.length > 0 ? k = s(j) : u = !1;
          while(w.length) {
            q = w.pop(), r = q, o.relative[q] ? r = w.pop() : q = "", r == null && (r = d), o.relative[q](k, r, v)
          }
        }else {
          k = w = []
        }
      }
      k || (k = j), k || m.error(q || b);
      if(g.call(k) === "[object Array]") {
        if(!u) {
          e.push.apply(e, k)
        }else {
          if(d && d.nodeType === 1) {
            for(t = 0;k[t] != null;t++) {
              k[t] && ((k[t] === !0 || k[t].nodeType === 1 && m.contains(d, k[t])) && e.push(j[t]))
            }
          }else {
            for(t = 0;k[t] != null;t++) {
              k[t] && (k[t].nodeType === 1 && e.push(j[t]))
            }
          }
        }
      }else {
        s(k, e)
      }
      l && (m(l, h, e, f), m.uniqueSort(e));
      return e
    };
    m.uniqueSort = function(a) {
      if(u) {
        h = i, a.sort(u);
        if(h) {
          for(var b = 1;b < a.length;b++) {
            a[b] === a[b - 1] && a.splice(b--, 1)
          }
        }
      }
      return a
    }, m.matches = function(a, b) {
      return m(a, null, null, b)
    }, m.matchesSelector = function(a, b) {
      return m(b, null, null, [a]).length > 0
    }, m.find = function(a, b, c) {
      var d, e, f, g, h, i;
      if(!a) {
        return[]
      }
      for(e = 0, f = o.order.length;e < f;e++) {
        h = o.order[e];
        if(g = o.leftMatch[h].exec(a)) {
          i = g[1], g.splice(1, 1);
          if(i.substr(i.length - 1) !== "\\") {
            g[1] = (g[1] || "").replace(j, ""), d = o.find[h](g, b, c);
            if(d != null) {
              a = a.replace(o.match[h], "");
              break
            }
          }
        }
      }
      d || (d = typeof b.getElementsByTagName != "undefined" ? b.getElementsByTagName("*") : []);
      return{set:d, expr:a}
    }, m.filter = function(a, c, d, e) {
      var f, g, h, i, j, k, l, n, p, q = a, r = [], s = c, t = c && (c[0] && m.isXML(c[0]));
      while(a && c.length) {
        for(h in o.filter) {
          if((f = o.leftMatch[h].exec(a)) != null && f[2]) {
            k = o.filter[h], l = f[1], g = !1, f.splice(1, 1);
            if(l.substr(l.length - 1) === "\\") {
              continue
            }
            s === r && (r = []);
            if(o.preFilter[h]) {
              f = o.preFilter[h](f, s, d, r, e, t);
              if(!f) {
                g = i = !0
              }else {
                if(f === !0) {
                  continue
                }
              }
            }
            if(f) {
              for(n = 0;(j = s[n]) != null;n++) {
                j && (i = k(j, f, n, s), p = e ^ i, d && i != null ? p ? g = !0 : s[n] = !1 : p && (r.push(j), g = !0))
              }
            }
            if(i !== b) {
              d || (s = r), a = a.replace(o.match[h], "");
              if(!g) {
                return[]
              }
              break
            }
          }
        }
        if(a === q) {
          if(g == null) {
            m.error(a)
          }else {
            break
          }
        }
        q = a
      }
      return s
    }, m.error = function(a) {
      throw new Error("Syntax error, unrecognized expression: " + a);
    };
    var n = m.getText = function(a) {
      var b, c, d = a.nodeType, e = "";
      if(d) {
        if(d === 1 || (d === 9 || d === 11)) {
          if(typeof a.textContent == "string") {
            return a.textContent
          }
          if(typeof a.innerText == "string") {
            return a.innerText.replace(k, "")
          }
          for(a = a.firstChild;a;a = a.nextSibling) {
            e += n(a)
          }
        }else {
          if(d === 3 || d === 4) {
            return a.nodeValue
          }
        }
      }else {
        for(b = 0;c = a[b];b++) {
          c.nodeType !== 8 && (e += n(c))
        }
      }
      return e
    }, o = m.selectors = {order:["ID", "NAME", "TAG"], match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/, ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/, TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/, CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/, POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/, 
    PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/}, leftMatch:{}, attrMap:{"class":"className", "for":"htmlFor"}, attrHandle:{href:function(a) {
      return a.getAttribute("href")
    }, type:function(a) {
      return a.getAttribute("type")
    }}, relative:{"+":function(a, b) {
      var c = typeof b == "string", d = c && !l.test(b), e = c && !d;
      d && (b = b.toLowerCase());
      for(var f = 0, g = a.length, h;f < g;f++) {
        if(h = a[f]) {
          while((h = h.previousSibling) && h.nodeType !== 1) {
          }
          a[f] = e || h && h.nodeName.toLowerCase() === b ? h || !1 : h === b
        }
      }
      e && m.filter(b, a, !0)
    }, ">":function(a, b) {
      var c, d = typeof b == "string", e = 0, f = a.length;
      if(d && !l.test(b)) {
        b = b.toLowerCase();
        for(;e < f;e++) {
          c = a[e];
          if(c) {
            var g = c.parentNode;
            a[e] = g.nodeName.toLowerCase() === b ? g : !1
          }
        }
      }else {
        for(;e < f;e++) {
          c = a[e], c && (a[e] = d ? c.parentNode : c.parentNode === b)
        }
        d && m.filter(b, a, !0)
      }
    }, "":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && (!l.test(b) && (b = b.toLowerCase(), d = b, g = w)), g("parentNode", b, f, a, d, c)
    }, "~":function(a, b, c) {
      var d, f = e++, g = x;
      typeof b == "string" && (!l.test(b) && (b = b.toLowerCase(), d = b, g = w)), g("previousSibling", b, f, a, d, c)
    }}, find:{ID:function(a, b, c) {
      if(typeof b.getElementById != "undefined" && !c) {
        var d = b.getElementById(a[1]);
        return d && d.parentNode ? [d] : []
      }
    }, NAME:function(a, b) {
      if(typeof b.getElementsByName != "undefined") {
        var c = [], d = b.getElementsByName(a[1]);
        for(var e = 0, f = d.length;e < f;e++) {
          d[e].getAttribute("name") === a[1] && c.push(d[e])
        }
        return c.length === 0 ? null : c
      }
    }, TAG:function(a, b) {
      if(typeof b.getElementsByTagName != "undefined") {
        return b.getElementsByTagName(a[1])
      }
    }}, preFilter:{CLASS:function(a, b, c, d, e, f) {
      a = " " + a[1].replace(j, "") + " ";
      if(f) {
        return a
      }
      for(var g = 0, h;(h = b[g]) != null;g++) {
        h && (e ^ (h.className && (" " + h.className + " ").replace(/[\t\n\r]/g, " ").indexOf(a) >= 0) ? c || d.push(h) : c && (b[g] = !1))
      }
      return!1
    }, ID:function(a) {
      return a[1].replace(j, "")
    }, TAG:function(a, b) {
      return a[1].replace(j, "").toLowerCase()
    }, CHILD:function(a) {
      if(a[1] === "nth") {
        a[2] || m.error(a[0]), a[2] = a[2].replace(/^\+|\s*/g, "");
        var b = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2] === "even" && "2n" || (a[2] === "odd" && "2n+1" || (!/\D/.test(a[2]) && "0n+" + a[2] || a[2])));
        a[2] = b[1] + (b[2] || 1) - 0, a[3] = b[3] - 0
      }else {
        a[2] && m.error(a[0])
      }
      a[0] = e++;
      return a
    }, ATTR:function(a, b, c, d, e, f) {
      var g = a[1] = a[1].replace(j, "");
      !f && (o.attrMap[g] && (a[1] = o.attrMap[g])), a[4] = (a[4] || (a[5] || "")).replace(j, ""), a[2] === "~=" && (a[4] = " " + a[4] + " ");
      return a
    }, PSEUDO:function(b, c, d, e, f) {
      if(b[1] === "not") {
        if((a.exec(b[3]) || "").length > 1 || /^\w/.test(b[3])) {
          b[3] = m(b[3], null, null, c)
        }else {
          var g = m.filter(b[3], c, d, !0 ^ f);
          d || e.push.apply(e, g);
          return!1
        }
      }else {
        if(o.match.POS.test(b[0]) || o.match.CHILD.test(b[0])) {
          return!0
        }
      }
      return b
    }, POS:function(a) {
      a.unshift(!0);
      return a
    }}, filters:{enabled:function(a) {
      return a.disabled === !1 && a.type !== "hidden"
    }, disabled:function(a) {
      return a.disabled === !0
    }, checked:function(a) {
      return a.checked === !0
    }, selected:function(a) {
      a.parentNode && a.parentNode.selectedIndex;
      return a.selected === !0
    }, parent:function(a) {
      return!!a.firstChild
    }, empty:function(a) {
      return!a.firstChild
    }, has:function(a, b, c) {
      return!!m(c[3], a).length
    }, header:function(a) {
      return/h\d/i.test(a.nodeName)
    }, text:function(a) {
      var b = a.getAttribute("type"), c = a.type;
      return a.nodeName.toLowerCase() === "input" && ("text" === c && (b === c || b === null))
    }, radio:function(a) {
      return a.nodeName.toLowerCase() === "input" && "radio" === a.type
    }, checkbox:function(a) {
      return a.nodeName.toLowerCase() === "input" && "checkbox" === a.type
    }, file:function(a) {
      return a.nodeName.toLowerCase() === "input" && "file" === a.type
    }, password:function(a) {
      return a.nodeName.toLowerCase() === "input" && "password" === a.type
    }, submit:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "submit" === a.type
    }, image:function(a) {
      return a.nodeName.toLowerCase() === "input" && "image" === a.type
    }, reset:function(a) {
      var b = a.nodeName.toLowerCase();
      return(b === "input" || b === "button") && "reset" === a.type
    }, button:function(a) {
      var b = a.nodeName.toLowerCase();
      return b === "input" && "button" === a.type || b === "button"
    }, input:function(a) {
      return/input|select|textarea|button/i.test(a.nodeName)
    }, focus:function(a) {
      return a === a.ownerDocument.activeElement
    }}, setFilters:{first:function(a, b) {
      return b === 0
    }, last:function(a, b, c, d) {
      return b === d.length - 1
    }, even:function(a, b) {
      return b % 2 === 0
    }, odd:function(a, b) {
      return b % 2 === 1
    }, lt:function(a, b, c) {
      return b < c[3] - 0
    }, gt:function(a, b, c) {
      return b > c[3] - 0
    }, nth:function(a, b, c) {
      return c[3] - 0 === b
    }, eq:function(a, b, c) {
      return c[3] - 0 === b
    }}, filter:{PSEUDO:function(a, b, c, d) {
      var e = b[1], f = o.filters[e];
      if(f) {
        return f(a, c, b, d)
      }
      if(e === "contains") {
        return(a.textContent || (a.innerText || (n([a]) || ""))).indexOf(b[3]) >= 0
      }
      if(e === "not") {
        var g = b[3];
        for(var h = 0, i = g.length;h < i;h++) {
          if(g[h] === a) {
            return!1
          }
        }
        return!0
      }
      m.error(e)
    }, CHILD:function(a, b) {
      var c, e, f, g, h, i, j, k = b[1], l = a;
      switch(k) {
        case "only":
        ;
        case "first":
          while(l = l.previousSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          if(k === "first") {
            return!0
          }
          l = a;
        case "last":
          while(l = l.nextSibling) {
            if(l.nodeType === 1) {
              return!1
            }
          }
          return!0;
        case "nth":
          c = b[2], e = b[3];
          if(c === 1 && e === 0) {
            return!0
          }
          f = b[0], g = a.parentNode;
          if(g && (g[d] !== f || !a.nodeIndex)) {
            i = 0;
            for(l = g.firstChild;l;l = l.nextSibling) {
              l.nodeType === 1 && (l.nodeIndex = ++i)
            }
            g[d] = f
          }
          j = a.nodeIndex - e;
          return c === 0 ? j === 0 : j % c === 0 && j / c >= 0
      }
    }, ID:function(a, b) {
      return a.nodeType === 1 && a.getAttribute("id") === b
    }, TAG:function(a, b) {
      return b === "*" && a.nodeType === 1 || !!a.nodeName && a.nodeName.toLowerCase() === b
    }, CLASS:function(a, b) {
      return(" " + (a.className || a.getAttribute("class")) + " ").indexOf(b) > -1
    }, ATTR:function(a, b) {
      var c = b[1], d = m.attr ? m.attr(a, c) : o.attrHandle[c] ? o.attrHandle[c](a) : a[c] != null ? a[c] : a.getAttribute(c), e = d + "", f = b[2], g = b[4];
      return d == null ? f === "!=" : !f && m.attr ? d != null : f === "=" ? e === g : f === "*=" ? e.indexOf(g) >= 0 : f === "~=" ? (" " + e + " ").indexOf(g) >= 0 : g ? f === "!=" ? e !== g : f === "^=" ? e.indexOf(g) === 0 : f === "$=" ? e.substr(e.length - g.length) === g : f === "|=" ? e === g || e.substr(0, g.length + 1) === g + "-" : !1 : e && d !== !1
    }, POS:function(a, b, c, d) {
      var e = b[2], f = o.setFilters[e];
      if(f) {
        return f(a, c, b, d)
      }
    }}}, p = o.match.POS, q = function(a, b) {
      return"\\" + (b - 0 + 1)
    };
    for(var r in o.match) {
      o.match[r] = new RegExp(o.match[r].source + /(?![^\[]*\])(?![^\(]*\))/.source), o.leftMatch[r] = new RegExp(/(^(?:.|\r|\n)*?)/.source + o.match[r].source.replace(/\\(\d+)/g, q))
    }
    o.match.globalPOS = p;
    var s = function(a, b) {
      a = Array.prototype.slice.call(a, 0);
      if(b) {
        b.push.apply(b, a);
        return b
      }
      return a
    };
    try {
      Array.prototype.slice.call(c.documentElement.childNodes, 0)[0].nodeType
    }catch(t) {
      s = function(a, b) {
        var c = 0, d = b || [];
        if(g.call(a) === "[object Array]") {
          Array.prototype.push.apply(d, a)
        }else {
          if(typeof a.length == "number") {
            for(var e = a.length;c < e;c++) {
              d.push(a[c])
            }
          }else {
            for(;a[c];c++) {
              d.push(a[c])
            }
          }
        }
        return d
      }
    }
    var u, v;
    c.documentElement.compareDocumentPosition ? u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(!a.compareDocumentPosition || !b.compareDocumentPosition) {
        return a.compareDocumentPosition ? -1 : 1
      }
      return a.compareDocumentPosition(b) & 4 ? -1 : 1
    } : (u = function(a, b) {
      if(a === b) {
        h = !0;
        return 0
      }
      if(a.sourceIndex && b.sourceIndex) {
        return a.sourceIndex - b.sourceIndex
      }
      var c, d, e = [], f = [], g = a.parentNode, i = b.parentNode, j = g;
      if(g === i) {
        return v(a, b)
      }
      if(!g) {
        return-1
      }
      if(!i) {
        return 1
      }
      while(j) {
        e.unshift(j), j = j.parentNode
      }
      j = i;
      while(j) {
        f.unshift(j), j = j.parentNode
      }
      c = e.length, d = f.length;
      for(var k = 0;k < c && k < d;k++) {
        if(e[k] !== f[k]) {
          return v(e[k], f[k])
        }
      }
      return k === c ? v(a, f[k], -1) : v(e[k], b, 1)
    }, v = function(a, b, c) {
      if(a === b) {
        return c
      }
      var d = a.nextSibling;
      while(d) {
        if(d === b) {
          return-1
        }
        d = d.nextSibling
      }
      return 1
    }), function() {
      var a = c.createElement("div"), d = "script" + (new Date).getTime(), e = c.documentElement;
      a.innerHTML = "<a name='" + d + "'/>", e.insertBefore(a, e.firstChild), c.getElementById(d) && (o.find.ID = function(a, c, d) {
        if(typeof c.getElementById != "undefined" && !d) {
          var e = c.getElementById(a[1]);
          return e ? e.id === a[1] || typeof e.getAttributeNode != "undefined" && e.getAttributeNode("id").nodeValue === a[1] ? [e] : b : []
        }
      }, o.filter.ID = function(a, b) {
        var c = typeof a.getAttributeNode != "undefined" && a.getAttributeNode("id");
        return a.nodeType === 1 && (c && c.nodeValue === b)
      }), e.removeChild(a), e = a = null
    }(), function() {
      var a = c.createElement("div");
      a.appendChild(c.createComment("")), a.getElementsByTagName("*").length > 0 && (o.find.TAG = function(a, b) {
        var c = b.getElementsByTagName(a[1]);
        if(a[1] === "*") {
          var d = [];
          for(var e = 0;c[e];e++) {
            c[e].nodeType === 1 && d.push(c[e])
          }
          c = d
        }
        return c
      }), a.innerHTML = "<a href='#'></a>", a.firstChild && (typeof a.firstChild.getAttribute != "undefined" && (a.firstChild.getAttribute("href") !== "#" && (o.attrHandle.href = function(a) {
        return a.getAttribute("href", 2)
      }))), a = null
    }(), c.querySelectorAll && function() {
      var a = m, b = c.createElement("div"), d = "__sizzle__";
      b.innerHTML = "<p class='TEST'></p>";
      if(!b.querySelectorAll || b.querySelectorAll(".TEST").length !== 0) {
        m = function(b, e, f, g) {
          e = e || c;
          if(!g && !m.isXML(e)) {
            var h = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);
            if(h && (e.nodeType === 1 || e.nodeType === 9)) {
              if(h[1]) {
                return s(e.getElementsByTagName(b), f)
              }
              if(h[2] && (o.find.CLASS && e.getElementsByClassName)) {
                return s(e.getElementsByClassName(h[2]), f)
              }
            }
            if(e.nodeType === 9) {
              if(b === "body" && e.body) {
                return s([e.body], f)
              }
              if(h && h[3]) {
                var i = e.getElementById(h[3]);
                if(!i || !i.parentNode) {
                  return s([], f)
                }
                if(i.id === h[3]) {
                  return s([i], f)
                }
              }
              try {
                return s(e.querySelectorAll(b), f)
              }catch(j) {
              }
            }else {
              if(e.nodeType === 1 && e.nodeName.toLowerCase() !== "object") {
                var k = e, l = e.getAttribute("id"), n = l || d, p = e.parentNode, q = /^\s*[+~]/.test(b);
                l ? n = n.replace(/'/g, "\\$&") : e.setAttribute("id", n), q && (p && (e = e.parentNode));
                try {
                  if(!q || p) {
                    return s(e.querySelectorAll("[id='" + n + "'] " + b), f)
                  }
                }catch(r) {
                }finally {
                  l || k.removeAttribute("id")
                }
              }
            }
          }
          return a(b, e, f, g)
        };
        for(var e in a) {
          m[e] = a[e]
        }
        b = null
      }
    }(), function() {
      var a = c.documentElement, b = a.matchesSelector || (a.mozMatchesSelector || (a.webkitMatchesSelector || a.msMatchesSelector));
      if(b) {
        var d = !b.call(c.createElement("div"), "div"), e = !1;
        try {
          b.call(c.documentElement, "[test!='']:sizzle")
        }catch(f) {
          e = !0
        }
        m.matchesSelector = function(a, c) {
          c = c.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']");
          if(!m.isXML(a)) {
            try {
              if(e || !o.match.PSEUDO.test(c) && !/!=/.test(c)) {
                var f = b.call(a, c);
                if(f || (!d || a.document && a.document.nodeType !== 11)) {
                  return f
                }
              }
            }catch(g) {
            }
          }
          return m(c, null, null, [a]).length > 0
        }
      }
    }(), function() {
      var a = c.createElement("div");
      a.innerHTML = "<div class='test e'></div><div class='test'></div>";
      if(!!a.getElementsByClassName && a.getElementsByClassName("e").length !== 0) {
        a.lastChild.className = "e";
        if(a.getElementsByClassName("e").length === 1) {
          return
        }
        o.order.splice(1, 0, "CLASS"), o.find.CLASS = function(a, b, c) {
          if(typeof b.getElementsByClassName != "undefined" && !c) {
            return b.getElementsByClassName(a[1])
          }
        }, a = null
      }
    }(), c.documentElement.contains ? m.contains = function(a, b) {
      return a !== b && (a.contains ? a.contains(b) : !0)
    } : c.documentElement.compareDocumentPosition ? m.contains = function(a, b) {
      return!!(a.compareDocumentPosition(b) & 16)
    } : m.contains = function() {
      return!1
    }, m.isXML = function(a) {
      var b = (a ? a.ownerDocument || a : 0).documentElement;
      return b ? b.nodeName !== "HTML" : !1
    };
    var y = function(a, b, c) {
      var d, e = [], f = "", g = b.nodeType ? [b] : b;
      while(d = o.match.PSEUDO.exec(a)) {
        f += d[0], a = a.replace(o.match.PSEUDO, "")
      }
      a = o.relative[a] ? a + "*" : a;
      for(var h = 0, i = g.length;h < i;h++) {
        m(a, g[h], e, c)
      }
      return m.filter(f, e)
    };
    m.attr = f.attr, m.selectors.attrMap = {}, f.find = m, f.expr = m.selectors, f.expr[":"] = f.expr.filters, f.unique = m.uniqueSort, f.text = m.getText, f.isXMLDoc = m.isXML, f.contains = m.contains
  }();
  var L = /Until$/, M = /^(?:parents|prevUntil|prevAll)/, N = /,/, O = /^.[^:#\[\.,]*$/, P = Array.prototype.slice, Q = f.expr.match.globalPOS, R = {children:!0, contents:!0, next:!0, prev:!0};
  f.fn.extend({find:function(a) {
    var b = this, c, d;
    if(typeof a != "string") {
      return f(a).filter(function() {
        for(c = 0, d = b.length;c < d;c++) {
          if(f.contains(b[c], this)) {
            return!0
          }
        }
      })
    }
    var e = this.pushStack("", "find", a), g, h, i;
    for(c = 0, d = this.length;c < d;c++) {
      g = e.length, f.find(a, this[c], e);
      if(c > 0) {
        for(h = g;h < e.length;h++) {
          for(i = 0;i < g;i++) {
            if(e[i] === e[h]) {
              e.splice(h--, 1);
              break
            }
          }
        }
      }
    }
    return e
  }, has:function(a) {
    var b = f(a);
    return this.filter(function() {
      for(var a = 0, c = b.length;a < c;a++) {
        if(f.contains(this, b[a])) {
          return!0
        }
      }
    })
  }, not:function(a) {
    return this.pushStack(T(this, a, !1), "not", a)
  }, filter:function(a) {
    return this.pushStack(T(this, a, !0), "filter", a)
  }, is:function(a) {
    return!!a && (typeof a == "string" ? Q.test(a) ? f(a, this.context).index(this[0]) >= 0 : f.filter(a, this).length > 0 : this.filter(a).length > 0)
  }, closest:function(a, b) {
    var c = [], d, e, g = this[0];
    if(f.isArray(a)) {
      var h = 1;
      while(g && (g.ownerDocument && g !== b)) {
        for(d = 0;d < a.length;d++) {
          f(g).is(a[d]) && c.push({selector:a[d], elem:g, level:h})
        }
        g = g.parentNode, h++
      }
      return c
    }
    var i = Q.test(a) || typeof a != "string" ? f(a, b || this.context) : 0;
    for(d = 0, e = this.length;d < e;d++) {
      g = this[d];
      while(g) {
        if(i ? i.index(g) > -1 : f.find.matchesSelector(g, a)) {
          c.push(g);
          break
        }
        g = g.parentNode;
        if(!g || (!g.ownerDocument || (g === b || g.nodeType === 11))) {
          break
        }
      }
    }
    c = c.length > 1 ? f.unique(c) : c;
    return this.pushStack(c, "closest", a)
  }, index:function(a) {
    if(!a) {
      return this[0] && this[0].parentNode ? this.prevAll().length : -1
    }
    if(typeof a == "string") {
      return f.inArray(this[0], f(a))
    }
    return f.inArray(a.jquery ? a[0] : a, this)
  }, add:function(a, b) {
    var c = typeof a == "string" ? f(a, b) : f.makeArray(a && a.nodeType ? [a] : a), d = f.merge(this.get(), c);
    return this.pushStack(S(c[0]) || S(d[0]) ? d : f.unique(d))
  }, andSelf:function() {
    return this.add(this.prevObject)
  }}), f.each({parent:function(a) {
    var b = a.parentNode;
    return b && b.nodeType !== 11 ? b : null
  }, parents:function(a) {
    return f.dir(a, "parentNode")
  }, parentsUntil:function(a, b, c) {
    return f.dir(a, "parentNode", c)
  }, next:function(a) {
    return f.nth(a, 2, "nextSibling")
  }, prev:function(a) {
    return f.nth(a, 2, "previousSibling")
  }, nextAll:function(a) {
    return f.dir(a, "nextSibling")
  }, prevAll:function(a) {
    return f.dir(a, "previousSibling")
  }, nextUntil:function(a, b, c) {
    return f.dir(a, "nextSibling", c)
  }, prevUntil:function(a, b, c) {
    return f.dir(a, "previousSibling", c)
  }, siblings:function(a) {
    return f.sibling((a.parentNode || {}).firstChild, a)
  }, children:function(a) {
    return f.sibling(a.firstChild)
  }, contents:function(a) {
    return f.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : f.makeArray(a.childNodes)
  }}, function(a, b) {
    f.fn[a] = function(c, d) {
      var e = f.map(this, b, c);
      L.test(a) || (d = c), d && (typeof d == "string" && (e = f.filter(d, e))), e = this.length > 1 && !R[a] ? f.unique(e) : e, (this.length > 1 || N.test(d)) && (M.test(a) && (e = e.reverse()));
      return this.pushStack(e, a, P.call(arguments).join(","))
    }
  }), f.extend({filter:function(a, b, c) {
    c && (a = ":not(" + a + ")");
    return b.length === 1 ? f.find.matchesSelector(b[0], a) ? [b[0]] : [] : f.find.matches(a, b)
  }, dir:function(a, c, d) {
    var e = [], g = a[c];
    while(g && (g.nodeType !== 9 && (d === b || (g.nodeType !== 1 || !f(g).is(d))))) {
      g.nodeType === 1 && e.push(g), g = g[c]
    }
    return e
  }, nth:function(a, b, c, d) {
    b = b || 1;
    var e = 0;
    for(;a;a = a[c]) {
      if(a.nodeType === 1 && ++e === b) {
        break
      }
    }
    return a
  }, sibling:function(a, b) {
    var c = [];
    for(;a;a = a.nextSibling) {
      a.nodeType === 1 && (a !== b && c.push(a))
    }
    return c
  }});
  var V = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", W = / jQuery\d+="(?:\d+|null)"/g, X = /^\s+/, Y = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig, Z = /<([\w:]+)/, $ = /<tbody/i, _ = /<|&#?\w+;/, ba = /<(?:script|style)/i, bb = /<(?:script|object|embed|option|style)/i, bc = new RegExp("<(?:" + V + ")[\\s/>]", "i"), bd = /checked\s*(?:[^=]|=\s*.checked.)/i, 
  be = /\/(java|ecma)script/i, bf = /^\s*<!(?:\[CDATA\[|\-\-)/, bg = {option:[1, "<select multiple='multiple'>", "</select>"], legend:[1, "<fieldset>", "</fieldset>"], thead:[1, "<table>", "</table>"], tr:[2, "<table><tbody>", "</tbody></table>"], td:[3, "<table><tbody><tr>", "</tr></tbody></table>"], col:[2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], area:[1, "<map>", "</map>"], _default:[0, "", ""]}, bh = U(c);
  bg.optgroup = bg.option, bg.tbody = bg.tfoot = bg.colgroup = bg.caption = bg.thead, bg.th = bg.td, f.support.htmlSerialize || (bg._default = [1, "div<div>", "</div>"]), f.fn.extend({text:function(a) {
    return f.access(this, function(a) {
      return a === b ? f.text(this) : this.empty().append((this[0] && this[0].ownerDocument || c).createTextNode(a))
    }, null, a, arguments.length)
  }, wrapAll:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapAll(a.call(this, b))
      })
    }
    if(this[0]) {
      var b = f(a, this[0].ownerDocument).eq(0).clone(!0);
      this[0].parentNode && b.insertBefore(this[0]), b.map(function() {
        var a = this;
        while(a.firstChild && a.firstChild.nodeType === 1) {
          a = a.firstChild
        }
        return a
      }).append(this)
    }
    return this
  }, wrapInner:function(a) {
    if(f.isFunction(a)) {
      return this.each(function(b) {
        f(this).wrapInner(a.call(this, b))
      })
    }
    return this.each(function() {
      var b = f(this), c = b.contents();
      c.length ? c.wrapAll(a) : b.append(a)
    })
  }, wrap:function(a) {
    var b = f.isFunction(a);
    return this.each(function(c) {
      f(this).wrapAll(b ? a.call(this, c) : a)
    })
  }, unwrap:function() {
    return this.parent().each(function() {
      f.nodeName(this, "body") || f(this).replaceWith(this.childNodes)
    }).end()
  }, append:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.appendChild(a)
    })
  }, prepend:function() {
    return this.domManip(arguments, !0, function(a) {
      this.nodeType === 1 && this.insertBefore(a, this.firstChild)
    })
  }, before:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this)
      })
    }
    if(arguments.length) {
      var a = f.clean(arguments);
      a.push.apply(a, this.toArray());
      return this.pushStack(a, "before", arguments)
    }
  }, after:function() {
    if(this[0] && this[0].parentNode) {
      return this.domManip(arguments, !1, function(a) {
        this.parentNode.insertBefore(a, this.nextSibling)
      })
    }
    if(arguments.length) {
      var a = this.pushStack(this, "after", arguments);
      a.push.apply(a, f.clean(arguments));
      return a
    }
  }, remove:function(a, b) {
    for(var c = 0, d;(d = this[c]) != null;c++) {
      if(!a || f.filter(a, [d]).length) {
        !b && (d.nodeType === 1 && (f.cleanData(d.getElementsByTagName("*")), f.cleanData([d]))), d.parentNode && d.parentNode.removeChild(d)
      }
    }
    return this
  }, empty:function() {
    for(var a = 0, b;(b = this[a]) != null;a++) {
      b.nodeType === 1 && f.cleanData(b.getElementsByTagName("*"));
      while(b.firstChild) {
        b.removeChild(b.firstChild)
      }
    }
    return this
  }, clone:function(a, b) {
    a = a == null ? !1 : a, b = b == null ? a : b;
    return this.map(function() {
      return f.clone(this, a, b)
    })
  }, html:function(a) {
    return f.access(this, function(a) {
      var c = this[0] || {}, d = 0, e = this.length;
      if(a === b) {
        return c.nodeType === 1 ? c.innerHTML.replace(W, "") : null
      }
      if(typeof a == "string" && (!ba.test(a) && ((f.support.leadingWhitespace || !X.test(a)) && !bg[(Z.exec(a) || ["", ""])[1].toLowerCase()]))) {
        a = a.replace(Y, "<$1></$2>");
        try {
          for(;d < e;d++) {
            c = this[d] || {}, c.nodeType === 1 && (f.cleanData(c.getElementsByTagName("*")), c.innerHTML = a)
          }
          c = 0
        }catch(g) {
        }
      }
      c && this.empty().append(a)
    }, null, a, arguments.length)
  }, replaceWith:function(a) {
    if(this[0] && this[0].parentNode) {
      if(f.isFunction(a)) {
        return this.each(function(b) {
          var c = f(this), d = c.html();
          c.replaceWith(a.call(this, b, d))
        })
      }
      typeof a != "string" && (a = f(a).detach());
      return this.each(function() {
        var b = this.nextSibling, c = this.parentNode;
        f(this).remove(), b ? f(b).before(a) : f(c).append(a)
      })
    }
    return this.length ? this.pushStack(f(f.isFunction(a) ? a() : a), "replaceWith", a) : this
  }, detach:function(a) {
    return this.remove(a, !0)
  }, domManip:function(a, c, d) {
    var e, g, h, i, j = a[0], k = [];
    if(!f.support.checkClone && (arguments.length === 3 && (typeof j == "string" && bd.test(j)))) {
      return this.each(function() {
        f(this).domManip(a, c, d, !0)
      })
    }
    if(f.isFunction(j)) {
      return this.each(function(e) {
        var g = f(this);
        a[0] = j.call(this, e, c ? g.html() : b), g.domManip(a, c, d)
      })
    }
    if(this[0]) {
      i = j && j.parentNode, f.support.parentNode && (i && (i.nodeType === 11 && i.childNodes.length === this.length)) ? e = {fragment:i} : e = f.buildFragment(a, this, k), h = e.fragment, h.childNodes.length === 1 ? g = h = h.firstChild : g = h.firstChild;
      if(g) {
        c = c && f.nodeName(g, "tr");
        for(var l = 0, m = this.length, n = m - 1;l < m;l++) {
          d.call(c ? bi(this[l], g) : this[l], e.cacheable || m > 1 && l < n ? f.clone(h, !0, !0) : h)
        }
      }
      k.length && f.each(k, function(a, b) {
        b.src ? f.ajax({type:"GET", global:!1, url:b.src, async:!1, dataType:"script"}) : f.globalEval((b.text || (b.textContent || (b.innerHTML || ""))).replace(bf, "/*$0*/")), b.parentNode && b.parentNode.removeChild(b)
      })
    }
    return this
  }}), f.buildFragment = function(a, b, d) {
    var e, g, h, i, j = a[0];
    b && (b[0] && (i = b[0].ownerDocument || b[0])), i.createDocumentFragment || (i = c), a.length === 1 && (typeof j == "string" && (j.length < 512 && (i === c && (j.charAt(0) === "<" && (!bb.test(j) && ((f.support.checkClone || !bd.test(j)) && ((f.support.html5Clone || !bc.test(j)) && (g = !0, h = f.fragments[j], h && (h !== 1 && (e = h)))))))))), e || (e = i.createDocumentFragment(), f.clean(a, i, e, d)), g && (f.fragments[j] = h ? e : 1);
    return{fragment:e, cacheable:g}
  }, f.fragments = {}, f.each({appendTo:"append", prependTo:"prepend", insertBefore:"before", insertAfter:"after", replaceAll:"replaceWith"}, function(a, b) {
    f.fn[a] = function(c) {
      var d = [], e = f(c), g = this.length === 1 && this[0].parentNode;
      if(g && (g.nodeType === 11 && (g.childNodes.length === 1 && e.length === 1))) {
        e[b](this[0]);
        return this
      }
      for(var h = 0, i = e.length;h < i;h++) {
        var j = (h > 0 ? this.clone(!0) : this).get();
        f(e[h])[b](j), d = d.concat(j)
      }
      return this.pushStack(d, a, e.selector)
    }
  }), f.extend({clone:function(a, b, c) {
    var d, e, g, h = f.support.html5Clone || (f.isXMLDoc(a) || !bc.test("<" + a.nodeName + ">")) ? a.cloneNode(!0) : bo(a);
    if((!f.support.noCloneEvent || !f.support.noCloneChecked) && ((a.nodeType === 1 || a.nodeType === 11) && !f.isXMLDoc(a))) {
      bk(a, h), d = bl(a), e = bl(h);
      for(g = 0;d[g];++g) {
        e[g] && bk(d[g], e[g])
      }
    }
    if(b) {
      bj(a, h);
      if(c) {
        d = bl(a), e = bl(h);
        for(g = 0;d[g];++g) {
          bj(d[g], e[g])
        }
      }
    }
    d = e = null;
    return h
  }, clean:function(a, b, d, e) {
    var g, h, i, j = [];
    b = b || c, typeof b.createElement == "undefined" && (b = b.ownerDocument || (b[0] && b[0].ownerDocument || c));
    for(var k = 0, l;(l = a[k]) != null;k++) {
      typeof l == "number" && (l += "");
      if(!l) {
        continue
      }
      if(typeof l == "string") {
        if(!_.test(l)) {
          l = b.createTextNode(l)
        }else {
          l = l.replace(Y, "<$1></$2>");
          var m = (Z.exec(l) || ["", ""])[1].toLowerCase(), n = bg[m] || bg._default, o = n[0], p = b.createElement("div"), q = bh.childNodes, r;
          b === c ? bh.appendChild(p) : U(b).appendChild(p), p.innerHTML = n[1] + l + n[2];
          while(o--) {
            p = p.lastChild
          }
          if(!f.support.tbody) {
            var s = $.test(l), t = m === "table" && !s ? p.firstChild && p.firstChild.childNodes : n[1] === "<table>" && !s ? p.childNodes : [];
            for(i = t.length - 1;i >= 0;--i) {
              f.nodeName(t[i], "tbody") && (!t[i].childNodes.length && t[i].parentNode.removeChild(t[i]))
            }
          }
          !f.support.leadingWhitespace && (X.test(l) && p.insertBefore(b.createTextNode(X.exec(l)[0]), p.firstChild)), l = p.childNodes, p && (p.parentNode.removeChild(p), q.length > 0 && (r = q[q.length - 1], r && (r.parentNode && r.parentNode.removeChild(r))))
        }
      }
      var u;
      if(!f.support.appendChecked) {
        if(l[0] && typeof(u = l.length) == "number") {
          for(i = 0;i < u;i++) {
            bn(l[i])
          }
        }else {
          bn(l)
        }
      }
      l.nodeType ? j.push(l) : j = f.merge(j, l)
    }
    if(d) {
      g = function(a) {
        return!a.type || be.test(a.type)
      };
      for(k = 0;j[k];k++) {
        h = j[k];
        if(e && (f.nodeName(h, "script") && (!h.type || be.test(h.type)))) {
          e.push(h.parentNode ? h.parentNode.removeChild(h) : h)
        }else {
          if(h.nodeType === 1) {
            var v = f.grep(h.getElementsByTagName("script"), g);
            j.splice.apply(j, [k + 1, 0].concat(v))
          }
          d.appendChild(h)
        }
      }
    }
    return j
  }, cleanData:function(a) {
    var b, c, d = f.cache, e = f.event.special, g = f.support.deleteExpando;
    for(var h = 0, i;(i = a[h]) != null;h++) {
      if(i.nodeName && f.noData[i.nodeName.toLowerCase()]) {
        continue
      }
      c = i[f.expando];
      if(c) {
        b = d[c];
        if(b && b.events) {
          for(var j in b.events) {
            e[j] ? f.event.remove(i, j) : f.removeEvent(i, j, b.handle)
          }
          b.handle && (b.handle.elem = null)
        }
        g ? delete i[f.expando] : i.removeAttribute && i.removeAttribute(f.expando), delete d[c]
      }
    }
  }});
  var bp = /alpha\([^)]*\)/i, bq = /opacity=([^)]*)/, br = /([A-Z]|^ms)/g, bs = /^[\-+]?(?:\d*\.)?\d+$/i, bt = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, bu = /^([\-+])=([\-+.\de]+)/, bv = /^margin/, bw = {position:"absolute", visibility:"hidden", display:"block"}, bx = ["Top", "Right", "Bottom", "Left"], by, bz, bA;
  f.fn.css = function(a, c) {
    return f.access(this, function(a, c, d) {
      return d !== b ? f.style(a, c, d) : f.css(a, c)
    }, a, c, arguments.length > 1)
  }, f.extend({cssHooks:{opacity:{get:function(a, b) {
    if(b) {
      var c = by(a, "opacity");
      return c === "" ? "1" : c
    }
    return a.style.opacity
  }}}, cssNumber:{fillOpacity:!0, fontWeight:!0, lineHeight:!0, opacity:!0, orphans:!0, widows:!0, zIndex:!0, zoom:!0}, cssProps:{"float":f.support.cssFloat ? "cssFloat" : "styleFloat"}, style:function(a, c, d, e) {
    if(!!a && (a.nodeType !== 3 && (a.nodeType !== 8 && !!a.style))) {
      var g, h, i = f.camelCase(c), j = a.style, k = f.cssHooks[i];
      c = f.cssProps[i] || i;
      if(d === b) {
        if(k && ("get" in k && (g = k.get(a, !1, e)) !== b)) {
          return g
        }
        return j[c]
      }
      h = typeof d, h === "string" && ((g = bu.exec(d)) && (d = +(g[1] + 1) * +g[2] + parseFloat(f.css(a, c)), h = "number"));
      if(d == null || h === "number" && isNaN(d)) {
        return
      }
      h === "number" && (!f.cssNumber[i] && (d += "px"));
      if(!k || (!("set" in k) || (d = k.set(a, d)) !== b)) {
        try {
          j[c] = d
        }catch(l) {
        }
      }
    }
  }, css:function(a, c, d) {
    var e, g;
    c = f.camelCase(c), g = f.cssHooks[c], c = f.cssProps[c] || c, c === "cssFloat" && (c = "float");
    if(g && ("get" in g && (e = g.get(a, !0, d)) !== b)) {
      return e
    }
    if(by) {
      return by(a, c)
    }
  }, swap:function(a, b, c) {
    var d = {}, e, f;
    for(f in b) {
      d[f] = a.style[f], a.style[f] = b[f]
    }
    e = c.call(a);
    for(f in b) {
      a.style[f] = d[f]
    }
    return e
  }}), f.curCSS = f.css, c.defaultView && (c.defaultView.getComputedStyle && (bz = function(a, b) {
    var c, d, e, g, h = a.style;
    b = b.replace(br, "-$1").toLowerCase(), (d = a.ownerDocument.defaultView) && ((e = d.getComputedStyle(a, null)) && (c = e.getPropertyValue(b), c === "" && (!f.contains(a.ownerDocument.documentElement, a) && (c = f.style(a, b))))), !f.support.pixelMargin && (e && (bv.test(b) && (bt.test(c) && (g = h.width, h.width = c, c = e.width, h.width = g))));
    return c
  })), c.documentElement.currentStyle && (bA = function(a, b) {
    var c, d, e, f = a.currentStyle && a.currentStyle[b], g = a.style;
    f == null && (g && ((e = g[b]) && (f = e))), bt.test(f) && (c = g.left, d = a.runtimeStyle && a.runtimeStyle.left, d && (a.runtimeStyle.left = a.currentStyle.left), g.left = b === "fontSize" ? "1em" : f, f = g.pixelLeft + "px", g.left = c, d && (a.runtimeStyle.left = d));
    return f === "" ? "auto" : f
  }), by = bz || bA, f.each(["height", "width"], function(a, b) {
    f.cssHooks[b] = {get:function(a, c, d) {
      if(c) {
        return a.offsetWidth !== 0 ? bB(a, b, d) : f.swap(a, bw, function() {
          return bB(a, b, d)
        })
      }
    }, set:function(a, b) {
      return bs.test(b) ? b + "px" : b
    }}
  }), f.support.opacity || (f.cssHooks.opacity = {get:function(a, b) {
    return bq.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : b ? "1" : ""
  }, set:function(a, b) {
    var c = a.style, d = a.currentStyle, e = f.isNumeric(b) ? "alpha(opacity=" + b * 100 + ")" : "", g = d && d.filter || (c.filter || "");
    c.zoom = 1;
    if(b >= 1 && f.trim(g.replace(bp, "")) === "") {
      c.removeAttribute("filter");
      if(d && !d.filter) {
        return
      }
    }
    c.filter = bp.test(g) ? g.replace(bp, e) : g + " " + e
  }}), f(function() {
    f.support.reliableMarginRight || (f.cssHooks.marginRight = {get:function(a, b) {
      return f.swap(a, {display:"inline-block"}, function() {
        return b ? by(a, "margin-right") : a.style.marginRight
      })
    }})
  }), f.expr && (f.expr.filters && (f.expr.filters.hidden = function(a) {
    var b = a.offsetWidth, c = a.offsetHeight;
    return b === 0 && c === 0 || !f.support.reliableHiddenOffsets && (a.style && a.style.display || f.css(a, "display")) === "none"
  }, f.expr.filters.visible = function(a) {
    return!f.expr.filters.hidden(a)
  })), f.each({margin:"", padding:"", border:"Width"}, function(a, b) {
    f.cssHooks[a + b] = {expand:function(c) {
      var d, e = typeof c == "string" ? c.split(" ") : [c], f = {};
      for(d = 0;d < 4;d++) {
        f[a + bx[d] + b] = e[d] || (e[d - 2] || e[0])
      }
      return f
    }}
  });
  var bC = /%20/g, bD = /\[\]$/, bE = /\r?\n/g, bF = /#.*$/, bG = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, bH = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, bI = /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/, bJ = /^(?:GET|HEAD)$/, bK = /^\/\//, bL = /\?/, bM = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, bN = /^(?:select|textarea)/i, bO = /\s+/, bP = /([?&])_=[^&]*/, bQ = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, 
  bR = f.fn.load, bS = {}, bT = {}, bU, bV, bW = ["*/"] + ["*"];
  try {
    bU = e.href
  }catch(bX) {
    bU = c.createElement("a"), bU.href = "", bU = bU.href
  }
  bV = bQ.exec(bU.toLowerCase()) || [], f.fn.extend({load:function(a, c, d) {
    if(typeof a != "string" && bR) {
      return bR.apply(this, arguments)
    }
    if(!this.length) {
      return this
    }
    var e = a.indexOf(" ");
    if(e >= 0) {
      var g = a.slice(e, a.length);
      a = a.slice(0, e)
    }
    var h = "GET";
    c && (f.isFunction(c) ? (d = c, c = b) : typeof c == "object" && (c = f.param(c, f.ajaxSettings.traditional), h = "POST"));
    var i = this;
    f.ajax({url:a, type:h, dataType:"html", data:c, complete:function(a, b, c) {
      c = a.responseText, a.isResolved() && (a.done(function(a) {
        c = a
      }), i.html(g ? f("<div>").append(c.replace(bM, "")).find(g) : c)), d && i.each(d, [c, b, a])
    }});
    return this
  }, serialize:function() {
    return f.param(this.serializeArray())
  }, serializeArray:function() {
    return this.map(function() {
      return this.elements ? f.makeArray(this.elements) : this
    }).filter(function() {
      return this.name && (!this.disabled && (this.checked || (bN.test(this.nodeName) || bH.test(this.type))))
    }).map(function(a, b) {
      var c = f(this).val();
      return c == null ? null : f.isArray(c) ? f.map(c, function(a, c) {
        return{name:b.name, value:a.replace(bE, "\r\n")}
      }) : {name:b.name, value:c.replace(bE, "\r\n")}
    }).get()
  }}), f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function(a, b) {
    f.fn[b] = function(a) {
      return this.on(b, a)
    }
  }), f.each(["get", "post"], function(a, c) {
    f[c] = function(a, d, e, g) {
      f.isFunction(d) && (g = g || e, e = d, d = b);
      return f.ajax({type:c, url:a, data:d, success:e, dataType:g})
    }
  }), f.extend({getScript:function(a, c) {
    return f.get(a, b, c, "script")
  }, getJSON:function(a, b, c) {
    return f.get(a, b, c, "json")
  }, ajaxSetup:function(a, b) {
    b ? b$(a, f.ajaxSettings) : (b = a, a = f.ajaxSettings), b$(a, b);
    return a
  }, ajaxSettings:{url:bU, isLocal:bI.test(bV[1]), global:!0, type:"GET", contentType:"application/x-www-form-urlencoded; charset=UTF-8", processData:!0, async:!0, accepts:{xml:"application/xml, text/xml", html:"text/html", text:"text/plain", json:"application/json, text/javascript", "*":bW}, contents:{xml:/xml/, html:/html/, json:/json/}, responseFields:{xml:"responseXML", text:"responseText"}, converters:{"* text":a.String, "text html":!0, "text json":f.parseJSON, "text xml":f.parseXML}, flatOptions:{context:!0, 
  url:!0}}, ajaxPrefilter:bY(bS), ajaxTransport:bY(bT), ajax:function(a, c) {
    function w(a, c, l, m) {
      if(s !== 2) {
        s = 2, q && clearTimeout(q), p = b, n = m || "", v.readyState = a > 0 ? 4 : 0;
        var o, r, u, w = c, x = l ? ca(d, v, l) : b, y, z;
        if(a >= 200 && a < 300 || a === 304) {
          if(d.ifModified) {
            if(y = v.getResponseHeader("Last-Modified")) {
              f.lastModified[k] = y
            }
            if(z = v.getResponseHeader("Etag")) {
              f.etag[k] = z
            }
          }
          if(a === 304) {
            w = "notmodified", o = !0
          }else {
            try {
              r = cb(d, x), w = "success", o = !0
            }catch(A) {
              w = "parsererror", u = A
            }
          }
        }else {
          u = w;
          if(!w || a) {
            w = "error", a < 0 && (a = 0)
          }
        }
        v.status = a, v.statusText = "" + (c || w), o ? h.resolveWith(e, [r, w, v]) : h.rejectWith(e, [v, w, u]), v.statusCode(j), j = b, t && g.trigger("ajax" + (o ? "Success" : "Error"), [v, d, o ? r : u]), i.fireWith(e, [v, w]), t && (g.trigger("ajaxComplete", [v, d]), --f.active || f.event.trigger("ajaxStop"))
      }
    }
    typeof a == "object" && (c = a, a = b), c = c || {};
    var d = f.ajaxSetup({}, c), e = d.context || d, g = e !== d && (e.nodeType || e instanceof f) ? f(e) : f.event, h = f.Deferred(), i = f.Callbacks("once memory"), j = d.statusCode || {}, k, l = {}, m = {}, n, o, p, q, r, s = 0, t, u, v = {readyState:0, setRequestHeader:function(a, b) {
      if(!s) {
        var c = a.toLowerCase();
        a = m[c] = m[c] || a, l[a] = b
      }
      return this
    }, getAllResponseHeaders:function() {
      return s === 2 ? n : null
    }, getResponseHeader:function(a) {
      var c;
      if(s === 2) {
        if(!o) {
          o = {};
          while(c = bG.exec(n)) {
            o[c[1].toLowerCase()] = c[2]
          }
        }
        c = o[a.toLowerCase()]
      }
      return c === b ? null : c
    }, overrideMimeType:function(a) {
      s || (d.mimeType = a);
      return this
    }, abort:function(a) {
      a = a || "abort", p && p.abort(a), w(0, a);
      return this
    }};
    h.promise(v), v.success = v.done, v.error = v.fail, v.complete = i.add, v.statusCode = function(a) {
      if(a) {
        var b;
        if(s < 2) {
          for(b in a) {
            j[b] = [j[b], a[b]]
          }
        }else {
          b = a[v.status], v.then(b, b)
        }
      }
      return this
    }, d.url = ((a || d.url) + "").replace(bF, "").replace(bK, bV[1] + "//"), d.dataTypes = f.trim(d.dataType || "*").toLowerCase().split(bO), d.crossDomain == null && (r = bQ.exec(d.url.toLowerCase()), d.crossDomain = !(!r || r[1] == bV[1] && (r[2] == bV[2] && (r[3] || (r[1] === "http:" ? 80 : 443)) == (bV[3] || (bV[1] === "http:" ? 80 : 443))))), d.data && (d.processData && (typeof d.data != "string" && (d.data = f.param(d.data, d.traditional)))), bZ(bS, d, c, v);
    if(s === 2) {
      return!1
    }
    t = d.global, d.type = d.type.toUpperCase(), d.hasContent = !bJ.test(d.type), t && (f.active++ === 0 && f.event.trigger("ajaxStart"));
    if(!d.hasContent) {
      d.data && (d.url += (bL.test(d.url) ? "&" : "?") + d.data, delete d.data), k = d.url;
      if(d.cache === !1) {
        var x = f.now(), y = d.url.replace(bP, "$1_=" + x);
        d.url = y + (y === d.url ? (bL.test(d.url) ? "&" : "?") + "_=" + x : "")
      }
    }
    (d.data && (d.hasContent && d.contentType !== !1) || c.contentType) && v.setRequestHeader("Content-Type", d.contentType), d.ifModified && (k = k || d.url, f.lastModified[k] && v.setRequestHeader("If-Modified-Since", f.lastModified[k]), f.etag[k] && v.setRequestHeader("If-None-Match", f.etag[k])), v.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + (d.dataTypes[0] !== "*" ? ", " + bW + "; q=0.01" : "") : d.accepts["*"]);
    for(u in d.headers) {
      v.setRequestHeader(u, d.headers[u])
    }
    if(d.beforeSend && (d.beforeSend.call(e, v, d) === !1 || s === 2)) {
      v.abort();
      return!1
    }
    for(u in{success:1, error:1, complete:1}) {
      v[u](d[u])
    }
    p = bZ(bT, d, c, v);
    if(!p) {
      w(-1, "No Transport")
    }else {
      v.readyState = 1, t && g.trigger("ajaxSend", [v, d]), d.async && (d.timeout > 0 && (q = setTimeout(function() {
        v.abort("timeout")
      }, d.timeout)));
      try {
        s = 1, p.send(l, w)
      }catch(z) {
        if(s < 2) {
          w(-1, z)
        }else {
          throw z;
        }
      }
    }
    return v
  }, param:function(a, c) {
    var d = [], e = function(a, b) {
      b = f.isFunction(b) ? b() : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b)
    };
    c === b && (c = f.ajaxSettings.traditional);
    if(f.isArray(a) || a.jquery && !f.isPlainObject(a)) {
      f.each(a, function() {
        e(this.name, this.value)
      })
    }else {
      for(var g in a) {
        b_(g, a[g], c, e)
      }
    }
    return d.join("&").replace(bC, "+")
  }}), f.extend({active:0, lastModified:{}, etag:{}});
  var cc = f.now(), cd = /(\=)\?(&|$)|\?\?/i;
  f.ajaxSetup({jsonp:"callback", jsonpCallback:function() {
    return f.expando + "_" + cc++
  }}), f.ajaxPrefilter("json jsonp", function(b, c, d) {
    var e = typeof b.data == "string" && /^application\/x\-www\-form\-urlencoded/.test(b.contentType);
    if(b.dataTypes[0] === "jsonp" || b.jsonp !== !1 && (cd.test(b.url) || e && cd.test(b.data))) {
      var g, h = b.jsonpCallback = f.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, i = a[h], j = b.url, k = b.data, l = "$1" + h + "$2";
      b.jsonp !== !1 && (j = j.replace(cd, l), b.url === j && (e && (k = k.replace(cd, l)), b.data === k && (j += (/\?/.test(j) ? "&" : "?") + b.jsonp + "=" + h))), b.url = j, b.data = k, a[h] = function(a) {
        g = [a]
      }, d.always(function() {
        a[h] = i, g && (f.isFunction(i) && a[h](g[0]))
      }), b.converters["script json"] = function() {
        g || f.error(h + " was not called");
        return g[0]
      }, b.dataTypes[0] = "json";
      return"script"
    }
  }), f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents:{script:/javascript|ecmascript/}, converters:{"text script":function(a) {
    f.globalEval(a);
    return a
  }}}), f.ajaxPrefilter("script", function(a) {
    a.cache === b && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1)
  }), f.ajaxTransport("script", function(a) {
    if(a.crossDomain) {
      var d, e = c.head || (c.getElementsByTagName("head")[0] || c.documentElement);
      return{send:function(f, g) {
        d = c.createElement("script"), d.async = "async", a.scriptCharset && (d.charset = a.scriptCharset), d.src = a.url, d.onload = d.onreadystatechange = function(a, c) {
          if(c || (!d.readyState || /loaded|complete/.test(d.readyState))) {
            d.onload = d.onreadystatechange = null, e && (d.parentNode && e.removeChild(d)), d = b, c || g(200, "success")
          }
        }, e.insertBefore(d, e.firstChild)
      }, abort:function() {
        d && d.onload(0, 1)
      }}
    }
  });
  var ce = a.ActiveXObject ? function() {
    for(var a in cg) {
      cg[a](0, 1)
    }
  } : !1, cf = 0, cg;
  f.ajaxSettings.xhr = a.ActiveXObject ? function() {
    return!this.isLocal && ch() || ci()
  } : ch, function(a) {
    f.extend(f.support, {ajax:!!a, cors:!!a && "withCredentials" in a})
  }(f.ajaxSettings.xhr()), f.support.ajax && f.ajaxTransport(function(c) {
    if(!c.crossDomain || f.support.cors) {
      var d;
      return{send:function(e, g) {
        var h = c.xhr(), i, j;
        c.username ? h.open(c.type, c.url, c.async, c.username, c.password) : h.open(c.type, c.url, c.async);
        if(c.xhrFields) {
          for(j in c.xhrFields) {
            h[j] = c.xhrFields[j]
          }
        }
        c.mimeType && (h.overrideMimeType && h.overrideMimeType(c.mimeType)), !c.crossDomain && (!e["X-Requested-With"] && (e["X-Requested-With"] = "XMLHttpRequest"));
        try {
          for(j in e) {
            h.setRequestHeader(j, e[j])
          }
        }catch(k) {
        }
        h.send(c.hasContent && c.data || null), d = function(a, e) {
          var j, k, l, m, n;
          try {
            if(d && (e || h.readyState === 4)) {
              d = b, i && (h.onreadystatechange = f.noop, ce && delete cg[i]);
              if(e) {
                h.readyState !== 4 && h.abort()
              }else {
                j = h.status, l = h.getAllResponseHeaders(), m = {}, n = h.responseXML, n && (n.documentElement && (m.xml = n));
                try {
                  m.text = h.responseText
                }catch(a) {
                }
                try {
                  k = h.statusText
                }catch(o) {
                  k = ""
                }
                !j && (c.isLocal && !c.crossDomain) ? j = m.text ? 200 : 404 : j === 1223 && (j = 204)
              }
            }
          }catch(p) {
            e || g(-1, p)
          }
          m && g(j, k, m, l)
        }, !c.async || h.readyState === 4 ? d() : (i = ++cf, ce && (cg || (cg = {}, f(a).unload(ce)), cg[i] = d), h.onreadystatechange = d)
      }, abort:function() {
        d && d(0, 1)
      }}
    }
  });
  var cj = {}, ck, cl, cm = /^(?:toggle|show|hide)$/, cn = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, co, cp = [["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"], ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"], ["opacity"]], cq;
  f.fn.extend({show:function(a, b, c) {
    var d, e;
    if(a || a === 0) {
      return this.animate(ct("show", 3), a, b, c)
    }
    for(var g = 0, h = this.length;g < h;g++) {
      d = this[g], d.style && (e = d.style.display, !f._data(d, "olddisplay") && (e === "none" && (e = d.style.display = "")), (e === "" && f.css(d, "display") === "none" || !f.contains(d.ownerDocument.documentElement, d)) && f._data(d, "olddisplay", cu(d.nodeName)))
    }
    for(g = 0;g < h;g++) {
      d = this[g];
      if(d.style) {
        e = d.style.display;
        if(e === "" || e === "none") {
          d.style.display = f._data(d, "olddisplay") || ""
        }
      }
    }
    return this
  }, hide:function(a, b, c) {
    if(a || a === 0) {
      return this.animate(ct("hide", 3), a, b, c)
    }
    var d, e, g = 0, h = this.length;
    for(;g < h;g++) {
      d = this[g], d.style && (e = f.css(d, "display"), e !== "none" && (!f._data(d, "olddisplay") && f._data(d, "olddisplay", e)))
    }
    for(g = 0;g < h;g++) {
      this[g].style && (this[g].style.display = "none")
    }
    return this
  }, _toggle:f.fn.toggle, toggle:function(a, b, c) {
    var d = typeof a == "boolean";
    f.isFunction(a) && f.isFunction(b) ? this._toggle.apply(this, arguments) : a == null || d ? this.each(function() {
      var b = d ? a : f(this).is(":hidden");
      f(this)[b ? "show" : "hide"]()
    }) : this.animate(ct("toggle", 3), a, b, c);
    return this
  }, fadeTo:function(a, b, c, d) {
    return this.filter(":hidden").css("opacity", 0).show().end().animate({opacity:b}, a, c, d)
  }, animate:function(a, b, c, d) {
    function g() {
      e.queue === !1 && f._mark(this);
      var b = f.extend({}, e), c = this.nodeType === 1, d = c && f(this).is(":hidden"), g, h, i, j, k, l, m, n, o, p, q;
      b.animatedProperties = {};
      for(i in a) {
        g = f.camelCase(i), i !== g && (a[g] = a[i], delete a[i]);
        if((k = f.cssHooks[g]) && "expand" in k) {
          l = k.expand(a[g]), delete a[g];
          for(i in l) {
            i in a || (a[i] = l[i])
          }
        }
      }
      for(g in a) {
        h = a[g], f.isArray(h) ? (b.animatedProperties[g] = h[1], h = a[g] = h[0]) : b.animatedProperties[g] = b.specialEasing && b.specialEasing[g] || (b.easing || "swing");
        if(h === "hide" && d || h === "show" && !d) {
          return b.complete.call(this)
        }
        c && ((g === "height" || g === "width") && (b.overflow = [this.style.overflow, this.style.overflowX, this.style.overflowY], f.css(this, "display") === "inline" && (f.css(this, "float") === "none" && (!f.support.inlineBlockNeedsLayout || cu(this.nodeName) === "inline" ? this.style.display = "inline-block" : this.style.zoom = 1))))
      }
      b.overflow != null && (this.style.overflow = "hidden");
      for(i in a) {
        j = new f.fx(this, b, i), h = a[i], cm.test(h) ? (q = f._data(this, "toggle" + i) || (h === "toggle" ? d ? "show" : "hide" : 0), q ? (f._data(this, "toggle" + i, q === "show" ? "hide" : "show"), j[q]()) : j[h]()) : (m = cn.exec(h), n = j.cur(), m ? (o = parseFloat(m[2]), p = m[3] || (f.cssNumber[i] ? "" : "px"), p !== "px" && (f.style(this, i, (o || 1) + p), n = (o || 1) / j.cur() * n, f.style(this, i, n + p)), m[1] && (o = (m[1] === "-=" ? -1 : 1) * o + n), j.custom(n, o, p)) : j.custom(n, 
        h, ""))
      }
      return!0
    }
    var e = f.speed(b, c, d);
    if(f.isEmptyObject(a)) {
      return this.each(e.complete, [!1])
    }
    a = f.extend({}, a);
    return e.queue === !1 ? this.each(g) : this.queue(e.queue, g)
  }, stop:function(a, c, d) {
    typeof a != "string" && (d = c, c = a, a = b), c && (a !== !1 && this.queue(a || "fx", []));
    return this.each(function() {
      function h(a, b, c) {
        var e = b[c];
        f.removeData(a, c, !0), e.stop(d)
      }
      var b, c = !1, e = f.timers, g = f._data(this);
      d || f._unmark(!0, this);
      if(a == null) {
        for(b in g) {
          g[b] && (g[b].stop && (b.indexOf(".run") === b.length - 4 && h(this, g, b)))
        }
      }else {
        g[b = a + ".run"] && (g[b].stop && h(this, g, b))
      }
      for(b = e.length;b--;) {
        e[b].elem === this && ((a == null || e[b].queue === a) && (d ? e[b](!0) : e[b].saveState(), c = !0, e.splice(b, 1)))
      }
      (!d || !c) && f.dequeue(this, a)
    })
  }}), f.each({slideDown:ct("show", 1), slideUp:ct("hide", 1), slideToggle:ct("toggle", 1), fadeIn:{opacity:"show"}, fadeOut:{opacity:"hide"}, fadeToggle:{opacity:"toggle"}}, function(a, b) {
    f.fn[a] = function(a, c, d) {
      return this.animate(b, a, c, d)
    }
  }), f.extend({speed:function(a, b, c) {
    var d = a && typeof a == "object" ? f.extend({}, a) : {complete:c || (!c && b || f.isFunction(a) && a), duration:a, easing:c && b || b && (!f.isFunction(b) && b)};
    d.duration = f.fx.off ? 0 : typeof d.duration == "number" ? d.duration : d.duration in f.fx.speeds ? f.fx.speeds[d.duration] : f.fx.speeds._default;
    if(d.queue == null || d.queue === !0) {
      d.queue = "fx"
    }
    d.old = d.complete, d.complete = function(a) {
      f.isFunction(d.old) && d.old.call(this), d.queue ? f.dequeue(this, d.queue) : a !== !1 && f._unmark(this)
    };
    return d
  }, easing:{linear:function(a) {
    return a
  }, swing:function(a) {
    return-Math.cos(a * Math.PI) / 2 + 0.5
  }}, timers:[], fx:function(a, b, c) {
    this.options = b, this.elem = a, this.prop = c, b.orig = b.orig || {}
  }}), f.fx.prototype = {update:function() {
    this.options.step && this.options.step.call(this.elem, this.now, this), (f.fx.step[this.prop] || f.fx.step._default)(this)
  }, cur:function() {
    if(this.elem[this.prop] != null && (!this.elem.style || this.elem.style[this.prop] == null)) {
      return this.elem[this.prop]
    }
    var a, b = f.css(this.elem, this.prop);
    return isNaN(a = parseFloat(b)) ? !b || b === "auto" ? 0 : b : a
  }, custom:function(a, c, d) {
    function h(a) {
      return e.step(a)
    }
    var e = this, g = f.fx;
    this.startTime = cq || cr(), this.end = c, this.now = this.start = a, this.pos = this.state = 0, this.unit = d || (this.unit || (f.cssNumber[this.prop] ? "" : "px")), h.queue = this.options.queue, h.elem = this.elem, h.saveState = function() {
      f._data(e.elem, "fxshow" + e.prop) === b && (e.options.hide ? f._data(e.elem, "fxshow" + e.prop, e.start) : e.options.show && f._data(e.elem, "fxshow" + e.prop, e.end))
    }, h() && (f.timers.push(h) && (!co && (co = setInterval(g.tick, g.interval))))
  }, show:function() {
    var a = f._data(this.elem, "fxshow" + this.prop);
    this.options.orig[this.prop] = a || f.style(this.elem, this.prop), this.options.show = !0, a !== b ? this.custom(this.cur(), a) : this.custom(this.prop === "width" || this.prop === "height" ? 1 : 0, this.cur()), f(this.elem).show()
  }, hide:function() {
    this.options.orig[this.prop] = f._data(this.elem, "fxshow" + this.prop) || f.style(this.elem, this.prop), this.options.hide = !0, this.custom(this.cur(), 0)
  }, step:function(a) {
    var b, c, d, e = cq || cr(), g = !0, h = this.elem, i = this.options;
    if(a || e >= i.duration + this.startTime) {
      this.now = this.end, this.pos = this.state = 1, this.update(), i.animatedProperties[this.prop] = !0;
      for(b in i.animatedProperties) {
        i.animatedProperties[b] !== !0 && (g = !1)
      }
      if(g) {
        i.overflow != null && (!f.support.shrinkWrapBlocks && f.each(["", "X", "Y"], function(a, b) {
          h.style["overflow" + b] = i.overflow[a]
        })), i.hide && f(h).hide();
        if(i.hide || i.show) {
          for(b in i.animatedProperties) {
            f.style(h, b, i.orig[b]), f.removeData(h, "fxshow" + b, !0), f.removeData(h, "toggle" + b, !0)
          }
        }
        d = i.complete, d && (i.complete = !1, d.call(h))
      }
      return!1
    }
    i.duration == Infinity ? this.now = e : (c = e - this.startTime, this.state = c / i.duration, this.pos = f.easing[i.animatedProperties[this.prop]](this.state, c, 0, 1, i.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update();
    return!0
  }}, f.extend(f.fx, {tick:function() {
    var a, b = f.timers, c = 0;
    for(;c < b.length;c++) {
      a = b[c], !a() && (b[c] === a && b.splice(c--, 1))
    }
    b.length || f.fx.stop()
  }, interval:13, stop:function() {
    clearInterval(co), co = null
  }, speeds:{slow:600, fast:200, _default:400}, step:{opacity:function(a) {
    f.style(a.elem, "opacity", a.now)
  }, _default:function(a) {
    a.elem.style && a.elem.style[a.prop] != null ? a.elem.style[a.prop] = a.now + a.unit : a.elem[a.prop] = a.now
  }}}), f.each(cp.concat.apply([], cp), function(a, b) {
    b.indexOf("margin") && (f.fx.step[b] = function(a) {
      f.style(a.elem, b, Math.max(0, a.now) + a.unit)
    })
  }), f.expr && (f.expr.filters && (f.expr.filters.animated = function(a) {
    return f.grep(f.timers, function(b) {
      return a === b.elem
    }).length
  }));
  var cv, cw = /^t(?:able|d|h)$/i, cx = /^(?:body|html)$/i;
  "getBoundingClientRect" in c.documentElement ? cv = function(a, b, c, d) {
    try {
      d = a.getBoundingClientRect()
    }catch(e) {
    }
    if(!d || !f.contains(c, a)) {
      return d ? {top:d.top, left:d.left} : {top:0, left:0}
    }
    var g = b.body, h = cy(b), i = c.clientTop || (g.clientTop || 0), j = c.clientLeft || (g.clientLeft || 0), k = h.pageYOffset || (f.support.boxModel && c.scrollTop || g.scrollTop), l = h.pageXOffset || (f.support.boxModel && c.scrollLeft || g.scrollLeft), m = d.top + k - i, n = d.left + l - j;
    return{top:m, left:n}
  } : cv = function(a, b, c) {
    var d, e = a.offsetParent, g = a, h = b.body, i = b.defaultView, j = i ? i.getComputedStyle(a, null) : a.currentStyle, k = a.offsetTop, l = a.offsetLeft;
    while((a = a.parentNode) && (a !== h && a !== c)) {
      if(f.support.fixedPosition && j.position === "fixed") {
        break
      }
      d = i ? i.getComputedStyle(a, null) : a.currentStyle, k -= a.scrollTop, l -= a.scrollLeft, a === e && (k += a.offsetTop, l += a.offsetLeft, f.support.doesNotAddBorder && ((!f.support.doesAddBorderForTableAndCells || !cw.test(a.nodeName)) && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 0)), g = e, e = a.offsetParent), f.support.subtractsBorderForOverflowNotVisible && (d.overflow !== "visible" && (k += parseFloat(d.borderTopWidth) || 0, l += parseFloat(d.borderLeftWidth) || 
      0)), j = d
    }
    if(j.position === "relative" || j.position === "static") {
      k += h.offsetTop, l += h.offsetLeft
    }
    f.support.fixedPosition && (j.position === "fixed" && (k += Math.max(c.scrollTop, h.scrollTop), l += Math.max(c.scrollLeft, h.scrollLeft)));
    return{top:k, left:l}
  }, f.fn.offset = function(a) {
    if(arguments.length) {
      return a === b ? this : this.each(function(b) {
        f.offset.setOffset(this, a, b)
      })
    }
    var c = this[0], d = c && c.ownerDocument;
    if(!d) {
      return null
    }
    if(c === d.body) {
      return f.offset.bodyOffset(c)
    }
    return cv(c, d, d.documentElement)
  }, f.offset = {bodyOffset:function(a) {
    var b = a.offsetTop, c = a.offsetLeft;
    f.support.doesNotIncludeMarginInBodyOffset && (b += parseFloat(f.css(a, "marginTop")) || 0, c += parseFloat(f.css(a, "marginLeft")) || 0);
    return{top:b, left:c}
  }, setOffset:function(a, b, c) {
    var d = f.css(a, "position");
    d === "static" && (a.style.position = "relative");
    var e = f(a), g = e.offset(), h = f.css(a, "top"), i = f.css(a, "left"), j = (d === "absolute" || d === "fixed") && f.inArray("auto", [h, i]) > -1, k = {}, l = {}, m, n;
    j ? (l = e.position(), m = l.top, n = l.left) : (m = parseFloat(h) || 0, n = parseFloat(i) || 0), f.isFunction(b) && (b = b.call(a, c, g)), b.top != null && (k.top = b.top - g.top + m), b.left != null && (k.left = b.left - g.left + n), "using" in b ? b.using.call(a, k) : e.css(k)
  }}, f.fn.extend({position:function() {
    if(!this[0]) {
      return null
    }
    var a = this[0], b = this.offsetParent(), c = this.offset(), d = cx.test(b[0].nodeName) ? {top:0, left:0} : b.offset();
    c.top -= parseFloat(f.css(a, "marginTop")) || 0, c.left -= parseFloat(f.css(a, "marginLeft")) || 0, d.top += parseFloat(f.css(b[0], "borderTopWidth")) || 0, d.left += parseFloat(f.css(b[0], "borderLeftWidth")) || 0;
    return{top:c.top - d.top, left:c.left - d.left}
  }, offsetParent:function() {
    return this.map(function() {
      var a = this.offsetParent || c.body;
      while(a && (!cx.test(a.nodeName) && f.css(a, "position") === "static")) {
        a = a.offsetParent
      }
      return a
    })
  }}), f.each({scrollLeft:"pageXOffset", scrollTop:"pageYOffset"}, function(a, c) {
    var d = /Y/.test(c);
    f.fn[a] = function(e) {
      return f.access(this, function(a, e, g) {
        var h = cy(a);
        if(g === b) {
          return h ? c in h ? h[c] : f.support.boxModel && h.document.documentElement[e] || h.document.body[e] : a[e]
        }
        h ? h.scrollTo(d ? f(h).scrollLeft() : g, d ? g : f(h).scrollTop()) : a[e] = g
      }, a, e, arguments.length, null)
    }
  }), f.each({Height:"height", Width:"width"}, function(a, c) {
    var d = "client" + a, e = "scroll" + a, g = "offset" + a;
    f.fn["inner" + a] = function() {
      var a = this[0];
      return a ? a.style ? parseFloat(f.css(a, c, "padding")) : this[c]() : null
    }, f.fn["outer" + a] = function(a) {
      var b = this[0];
      return b ? b.style ? parseFloat(f.css(b, c, a ? "margin" : "border")) : this[c]() : null
    }, f.fn[c] = function(a) {
      return f.access(this, function(a, c, h) {
        var i, j, k, l;
        if(f.isWindow(a)) {
          i = a.document, j = i.documentElement[d];
          return f.support.boxModel && j || (i.body && i.body[d] || j)
        }
        if(a.nodeType === 9) {
          i = a.documentElement;
          if(i[d] >= i[e]) {
            return i[d]
          }
          return Math.max(a.body[e], i[e], a.body[g], i[g])
        }
        if(h === b) {
          k = f.css(a, c), l = parseFloat(k);
          return f.isNumeric(l) ? l : k
        }
        f(a).css(c, h)
      }, c, a, arguments.length, null)
    }
  }), a.jQuery = a.$ = f, typeof define == "function" && (define.amd && (define.amd.jQuery && define("jquery", [], function() {
    return f
  })))
})(window);
(function(e, t) {
  function i(t, n) {
    var r, i, o, u = t.nodeName.toLowerCase();
    return"area" === u ? (r = t.parentNode, i = r.name, !t.href || (!i || r.nodeName.toLowerCase() !== "map") ? !1 : (o = e("img[usemap=#" + i + "]")[0], !!o && s(o))) : (/input|select|textarea|button|object/.test(u) ? !t.disabled : "a" === u ? t.href || n : n) && s(t)
  }
  function s(t) {
    return e.expr.filters.visible(t) && !e(t).parents().andSelf().filter(function() {
      return e.css(this, "visibility") === "hidden"
    }).length
  }
  var n = 0, r = /^ui-id-\d+$/;
  e.ui = e.ui || {};
  if(e.ui.version) {
    return
  }
  e.extend(e.ui, {version:"1.9.2", keyCode:{BACKSPACE:8, COMMA:188, DELETE:46, DOWN:40, END:35, ENTER:13, ESCAPE:27, HOME:36, LEFT:37, NUMPAD_ADD:107, NUMPAD_DECIMAL:110, NUMPAD_DIVIDE:111, NUMPAD_ENTER:108, NUMPAD_MULTIPLY:106, NUMPAD_SUBTRACT:109, PAGE_DOWN:34, PAGE_UP:33, PERIOD:190, RIGHT:39, SPACE:32, TAB:9, UP:38}}), e.fn.extend({_focus:e.fn.focus, focus:function(t, n) {
    return typeof t == "number" ? this.each(function() {
      var r = this;
      setTimeout(function() {
        e(r).focus(), n && n.call(r)
      }, t)
    }) : this._focus.apply(this, arguments)
  }, scrollParent:function() {
    var t;
    return e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? t = this.parents().filter(function() {
      return/(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
    }).eq(0) : t = this.parents().filter(function() {
      return/(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x"))
    }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
  }, zIndex:function(n) {
    if(n !== t) {
      return this.css("zIndex", n)
    }
    if(this.length) {
      var r = e(this[0]), i, s;
      while(r.length && r[0] !== document) {
        i = r.css("position");
        if(i === "absolute" || (i === "relative" || i === "fixed")) {
          s = parseInt(r.css("zIndex"), 10);
          if(!isNaN(s) && s !== 0) {
            return s
          }
        }
        r = r.parent()
      }
    }
    return 0
  }, uniqueId:function() {
    return this.each(function() {
      this.id || (this.id = "ui-id-" + ++n)
    })
  }, removeUniqueId:function() {
    return this.each(function() {
      r.test(this.id) && e(this).removeAttr("id")
    })
  }}), e.extend(e.expr[":"], {data:e.expr.createPseudo ? e.expr.createPseudo(function(t) {
    return function(n) {
      return!!e.data(n, t)
    }
  }) : function(t, n, r) {
    return!!e.data(t, r[3])
  }, focusable:function(t) {
    return i(t, !isNaN(e.attr(t, "tabindex")))
  }, tabbable:function(t) {
    var n = e.attr(t, "tabindex"), r = isNaN(n);
    return(r || n >= 0) && i(t, !r)
  }}), e(function() {
    var t = document.body, n = t.appendChild(n = document.createElement("div"));
    n.offsetHeight, e.extend(n.style, {minHeight:"100px", height:"auto", padding:0, borderWidth:0}), e.support.minHeight = n.offsetHeight === 100, e.support.selectstart = "onselectstart" in n, t.removeChild(n).style.display = "none"
  }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function(n, r) {
    function u(t, n, r, s) {
      return e.each(i, function() {
        n -= parseFloat(e.css(t, "padding" + this)) || 0, r && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0)
      }), n
    }
    var i = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], s = r.toLowerCase(), o = {innerWidth:e.fn.innerWidth, innerHeight:e.fn.innerHeight, outerWidth:e.fn.outerWidth, outerHeight:e.fn.outerHeight};
    e.fn["inner" + r] = function(n) {
      return n === t ? o["inner" + r].call(this) : this.each(function() {
        e(this).css(s, u(this, n) + "px")
      })
    }, e.fn["outer" + r] = function(t, n) {
      return typeof t != "number" ? o["outer" + r].call(this, t) : this.each(function() {
        e(this).css(s, u(this, t, !0, n) + "px")
      })
    }
  }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
    return function(n) {
      return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this)
    }
  }(e.fn.removeData)), function() {
    var t = /msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase()) || [];
    e.ui.ie = t.length ? !0 : !1, e.ui.ie6 = parseFloat(t[1], 10) === 6
  }(), e.fn.extend({disableSelection:function() {
    return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
      e.preventDefault()
    })
  }, enableSelection:function() {
    return this.unbind(".ui-disableSelection")
  }}), e.extend(e.ui, {plugin:{add:function(t, n, r) {
    var i, s = e.ui[t].prototype;
    for(i in r) {
      s.plugins[i] = s.plugins[i] || [], s.plugins[i].push([n, r[i]])
    }
  }, call:function(e, t, n) {
    var r, i = e.plugins[t];
    if(!i || (!e.element[0].parentNode || e.element[0].parentNode.nodeType === 11)) {
      return
    }
    for(r = 0;r < i.length;r++) {
      e.options[i[r][0]] && i[r][1].apply(e.element, n)
    }
  }}, contains:e.contains, hasScroll:function(t, n) {
    if(e(t).css("overflow") === "hidden") {
      return!1
    }
    var r = n && n === "left" ? "scrollLeft" : "scrollTop", i = !1;
    return t[r] > 0 ? !0 : (t[r] = 1, i = t[r] > 0, t[r] = 0, i)
  }, isOverAxis:function(e, t, n) {
    return e > t && e < t + n
  }, isOver:function(t, n, r, i, s, o) {
    return e.ui.isOverAxis(t, r, s) && e.ui.isOverAxis(n, i, o)
  }})
})(jQuery);
(function(e, t) {
  var n = 0, r = Array.prototype.slice, i = e.cleanData;
  e.cleanData = function(t) {
    for(var n = 0, r;(r = t[n]) != null;n++) {
      try {
        e(r).triggerHandler("remove")
      }catch(s) {
      }
    }
    i(t)
  }, e.widget = function(t, n, r) {
    var i, s, o, u, a = t.split(".")[0];
    t = t.split(".")[1], i = a + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][i.toLowerCase()] = function(t) {
      return!!e.data(t, i)
    }, e[a] = e[a] || {}, s = e[a][t], o = e[a][t] = function(e, t) {
      if(!this._createWidget) {
        return new o(e, t)
      }
      arguments.length && this._createWidget(e, t)
    }, e.extend(o, s, {version:r.version, _proto:e.extend({}, r), _childConstructors:[]}), u = new n, u.options = e.widget.extend({}, u.options), e.each(r, function(t, i) {
      e.isFunction(i) && (r[t] = function() {
        var e = function() {
          return n.prototype[t].apply(this, arguments)
        }, r = function(e) {
          return n.prototype[t].apply(this, e)
        };
        return function() {
          var t = this._super, n = this._superApply, s;
          return this._super = e, this._superApply = r, s = i.apply(this, arguments), this._super = t, this._superApply = n, s
        }
      }())
    }), o.prototype = e.widget.extend(u, {widgetEventPrefix:s ? u.widgetEventPrefix : t}, r, {constructor:o, namespace:a, widgetName:t, widgetBaseClass:i, widgetFullName:i}), s ? (e.each(s._childConstructors, function(t, n) {
      var r = n.prototype;
      e.widget(r.namespace + "." + r.widgetName, o, n._proto)
    }), delete s._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o)
  }, e.widget.extend = function(n) {
    var i = r.call(arguments, 1), s = 0, o = i.length, u, a;
    for(;s < o;s++) {
      for(u in i[s]) {
        a = i[s][u], i[s].hasOwnProperty(u) && (a !== t && (e.isPlainObject(a) ? n[u] = e.isPlainObject(n[u]) ? e.widget.extend({}, n[u], a) : e.widget.extend({}, a) : n[u] = a))
      }
    }
    return n
  }, e.widget.bridge = function(n, i) {
    var s = i.prototype.widgetFullName || n;
    e.fn[n] = function(o) {
      var u = typeof o == "string", a = r.call(arguments, 1), f = this;
      return o = !u && a.length ? e.widget.extend.apply(null, [o].concat(a)) : o, u ? this.each(function() {
        var r, i = e.data(this, s);
        if(!i) {
          return e.error("cannot call methods on " + n + " prior to initialization; " + "attempted to call method '" + o + "'")
        }
        if(!e.isFunction(i[o]) || o.charAt(0) === "_") {
          return e.error("no such method '" + o + "' for " + n + " widget instance")
        }
        r = i[o].apply(i, a);
        if(r !== i && r !== t) {
          return f = r && r.jquery ? f.pushStack(r.get()) : r, !1
        }
      }) : this.each(function() {
        var t = e.data(this, s);
        t ? t.option(o || {})._init() : e.data(this, s, new i(o, this))
      }), f
    }
  }, e.Widget = function() {
  }, e.Widget._childConstructors = [], e.Widget.prototype = {widgetName:"widget", widgetEventPrefix:"", defaultElement:"<div>", options:{disabled:!1, create:null}, _createWidget:function(t, r) {
    r = e(r || (this.defaultElement || this))[0], this.element = e(r), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), r !== this && (e.data(r, this.widgetName, this), e.data(r, this.widgetFullName, this), this._on(!0, this.element, {remove:function(e) {
      e.target === r && this.destroy()
    }}), this.document = e(r.style ? r.ownerDocument : r.document || r), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init()
  }, _getCreateOptions:e.noop, _getCreateEventData:e.noop, _create:e.noop, _init:e.noop, destroy:function() {
    this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")
  }, _destroy:e.noop, widget:function() {
    return this.element
  }, option:function(n, r) {
    var i = n, s, o, u;
    if(arguments.length === 0) {
      return e.widget.extend({}, this.options)
    }
    if(typeof n == "string") {
      i = {}, s = n.split("."), n = s.shift();
      if(s.length) {
        o = i[n] = e.widget.extend({}, this.options[n]);
        for(u = 0;u < s.length - 1;u++) {
          o[s[u]] = o[s[u]] || {}, o = o[s[u]]
        }
        n = s.pop();
        if(r === t) {
          return o[n] === t ? null : o[n]
        }
        o[n] = r
      }else {
        if(r === t) {
          return this.options[n] === t ? null : this.options[n]
        }
        i[n] = r
      }
    }
    return this._setOptions(i), this
  }, _setOptions:function(e) {
    var t;
    for(t in e) {
      this._setOption(t, e[t])
    }
    return this
  }, _setOption:function(e, t) {
    return this.options[e] = t, e === "disabled" && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this
  }, enable:function() {
    return this._setOption("disabled", !1)
  }, disable:function() {
    return this._setOption("disabled", !0)
  }, _on:function(t, n, r) {
    var i, s = this;
    typeof t != "boolean" && (r = n, n = t, t = !1), r ? (n = i = e(n), this.bindings = this.bindings.add(n)) : (r = n, n = this.element, i = this.widget()), e.each(r, function(r, o) {
      function u() {
        if(!t && (s.options.disabled === !0 || e(this).hasClass("ui-state-disabled"))) {
          return
        }
        return(typeof o == "string" ? s[o] : o).apply(s, arguments)
      }
      typeof o != "string" && (u.guid = o.guid = o.guid || (u.guid || e.guid++));
      var a = r.match(/^(\w+)\s*(.*)$/), f = a[1] + s.eventNamespace, l = a[2];
      l ? i.delegate(l, f, u) : n.bind(f, u)
    })
  }, _off:function(e, t) {
    t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t)
  }, _delay:function(e, t) {
    function n() {
      return(typeof e == "string" ? r[e] : e).apply(r, arguments)
    }
    var r = this;
    return setTimeout(n, t || 0)
  }, _hoverable:function(t) {
    this.hoverable = this.hoverable.add(t), this._on(t, {mouseenter:function(t) {
      e(t.currentTarget).addClass("ui-state-hover")
    }, mouseleave:function(t) {
      e(t.currentTarget).removeClass("ui-state-hover")
    }})
  }, _focusable:function(t) {
    this.focusable = this.focusable.add(t), this._on(t, {focusin:function(t) {
      e(t.currentTarget).addClass("ui-state-focus")
    }, focusout:function(t) {
      e(t.currentTarget).removeClass("ui-state-focus")
    }})
  }, _trigger:function(t, n, r) {
    var i, s, o = this.options[t];
    r = r || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], s = n.originalEvent;
    if(s) {
      for(i in s) {
        i in n || (n[i] = s[i])
      }
    }
    return this.element.trigger(n, r), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(r)) === !1 || n.isDefaultPrevented())
  }}, e.each({show:"fadeIn", hide:"fadeOut"}, function(t, n) {
    e.Widget.prototype["_" + t] = function(r, i, s) {
      typeof i == "string" && (i = {effect:i});
      var o, u = i ? i === !0 || typeof i == "number" ? n : i.effect || n : t;
      i = i || {}, typeof i == "number" && (i = {duration:i}), o = !e.isEmptyObject(i), i.complete = s, i.delay && r.delay(i.delay), o && (e.effects && (e.effects.effect[u] || e.uiBackCompat !== !1 && e.effects[u])) ? r[t](i) : u !== t && r[u] ? r[u](i.duration, i.easing, s) : r.queue(function(n) {
        e(this)[t](), s && s.call(r[0]), n()
      })
    }
  }), e.uiBackCompat !== !1 && (e.Widget.prototype._getCreateOptions = function() {
    return e.metadata && e.metadata.get(this.element[0])[this.widgetName]
  })
})(jQuery);
(function(e, t) {
  var n = !1;
  e(document).mouseup(function(e) {
    n = !1
  }), e.widget("ui.mouse", {version:"1.9.2", options:{cancel:"input,textarea,button,select,option", distance:1, delay:0}, _mouseInit:function() {
    var t = this;
    this.element.bind("mousedown." + this.widgetName, function(e) {
      return t._mouseDown(e)
    }).bind("click." + this.widgetName, function(n) {
      if(!0 === e.data(n.target, t.widgetName + ".preventClickEvent")) {
        return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1
      }
    }), this.started = !1
  }, _mouseDestroy:function() {
    this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
  }, _mouseDown:function(t) {
    if(n) {
      return
    }
    this._mouseStarted && this._mouseUp(t), this._mouseDownEvent = t;
    var r = this, i = t.which === 1, s = typeof this.options.cancel == "string" && t.target.nodeName ? e(t.target).closest(this.options.cancel).length : !1;
    if(!i || (s || !this._mouseCapture(t))) {
      return!0
    }
    this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
      r.mouseDelayMet = !0
    }, this.options.delay));
    if(this._mouseDistanceMet(t) && this._mouseDelayMet(t)) {
      this._mouseStarted = this._mouseStart(t) !== !1;
      if(!this._mouseStarted) {
        return t.preventDefault(), !0
      }
    }
    return!0 === e.data(t.target, this.widgetName + ".preventClickEvent") && e.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
      return r._mouseMove(e)
    }, this._mouseUpDelegate = function(e) {
      return r._mouseUp(e)
    }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), n = !0, !0
  }, _mouseMove:function(t) {
    return!e.ui.ie || (document.documentMode >= 9 || !!t.button) ? this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && (this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t))), !this._mouseStarted) : this._mouseUp(t)
  }, _mouseUp:function(t) {
    return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
  }, _mouseDistanceMet:function(e) {
    return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
  }, _mouseDelayMet:function(e) {
    return this.mouseDelayMet
  }, _mouseStart:function(e) {
  }, _mouseDrag:function(e) {
  }, _mouseStop:function(e) {
  }, _mouseCapture:function(e) {
    return!0
  }})
})(jQuery);
(function(e, t) {
  function h(e, t, n) {
    return[parseInt(e[0], 10) * (l.test(e[0]) ? t / 100 : 1), parseInt(e[1], 10) * (l.test(e[1]) ? n / 100 : 1)]
  }
  function p(t, n) {
    return parseInt(e.css(t, n), 10) || 0
  }
  e.ui = e.ui || {};
  var n, r = Math.max, i = Math.abs, s = Math.round, o = /left|center|right/, u = /top|center|bottom/, a = /[\+\-]\d+%?/, f = /^\w+/, l = /%$/, c = e.fn.position;
  e.position = {scrollbarWidth:function() {
    if(n !== t) {
      return n
    }
    var r, i, s = e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), o = s.children()[0];
    return e("body").append(s), r = o.offsetWidth, s.css("overflow", "scroll"), i = o.offsetWidth, r === i && (i = s[0].clientWidth), s.remove(), n = r - i
  }, getScrollInfo:function(t) {
    var n = t.isWindow ? "" : t.element.css("overflow-x"), r = t.isWindow ? "" : t.element.css("overflow-y"), i = n === "scroll" || n === "auto" && t.width < t.element[0].scrollWidth, s = r === "scroll" || r === "auto" && t.height < t.element[0].scrollHeight;
    return{width:i ? e.position.scrollbarWidth() : 0, height:s ? e.position.scrollbarWidth() : 0}
  }, getWithinInfo:function(t) {
    var n = e(t || window), r = e.isWindow(n[0]);
    return{element:n, isWindow:r, offset:n.offset() || {left:0, top:0}, scrollLeft:n.scrollLeft(), scrollTop:n.scrollTop(), width:r ? n.width() : n.outerWidth(), height:r ? n.height() : n.outerHeight()}
  }}, e.fn.position = function(t) {
    if(!t || !t.of) {
      return c.apply(this, arguments)
    }
    t = e.extend({}, t);
    var n, l, d, v, m, g = e(t.of), y = e.position.getWithinInfo(t.within), b = e.position.getScrollInfo(y), w = g[0], E = (t.collision || "flip").split(" "), S = {};
    return w.nodeType === 9 ? (l = g.width(), d = g.height(), v = {top:0, left:0}) : e.isWindow(w) ? (l = g.width(), d = g.height(), v = {top:g.scrollTop(), left:g.scrollLeft()}) : w.preventDefault ? (t.at = "left top", l = d = 0, v = {top:w.pageY, left:w.pageX}) : (l = g.outerWidth(), d = g.outerHeight(), v = g.offset()), m = e.extend({}, v), e.each(["my", "at"], function() {
      var e = (t[this] || "").split(" "), n, r;
      e.length === 1 && (e = o.test(e[0]) ? e.concat(["center"]) : u.test(e[0]) ? ["center"].concat(e) : ["center", "center"]), e[0] = o.test(e[0]) ? e[0] : "center", e[1] = u.test(e[1]) ? e[1] : "center", n = a.exec(e[0]), r = a.exec(e[1]), S[this] = [n ? n[0] : 0, r ? r[0] : 0], t[this] = [f.exec(e[0])[0], f.exec(e[1])[0]]
    }), E.length === 1 && (E[1] = E[0]), t.at[0] === "right" ? m.left += l : t.at[0] === "center" && (m.left += l / 2), t.at[1] === "bottom" ? m.top += d : t.at[1] === "center" && (m.top += d / 2), n = h(S.at, l, d), m.left += n[0], m.top += n[1], this.each(function() {
      var o, u, a = e(this), f = a.outerWidth(), c = a.outerHeight(), w = p(this, "marginLeft"), x = p(this, "marginTop"), T = f + w + p(this, "marginRight") + b.width, N = c + x + p(this, "marginBottom") + b.height, C = e.extend({}, m), k = h(S.my, a.outerWidth(), a.outerHeight());
      t.my[0] === "right" ? C.left -= f : t.my[0] === "center" && (C.left -= f / 2), t.my[1] === "bottom" ? C.top -= c : t.my[1] === "center" && (C.top -= c / 2), C.left += k[0], C.top += k[1], e.support.offsetFractions || (C.left = s(C.left), C.top = s(C.top)), o = {marginLeft:w, marginTop:x}, e.each(["left", "top"], function(r, i) {
        e.ui.position[E[r]] && e.ui.position[E[r]][i](C, {targetWidth:l, targetHeight:d, elemWidth:f, elemHeight:c, collisionPosition:o, collisionWidth:T, collisionHeight:N, offset:[n[0] + k[0], n[1] + k[1]], my:t.my, at:t.at, within:y, elem:a})
      }), e.fn.bgiframe && a.bgiframe(), t.using && (u = function(e) {
        var n = v.left - C.left, s = n + l - f, o = v.top - C.top, u = o + d - c, h = {target:{element:g, left:v.left, top:v.top, width:l, height:d}, element:{element:a, left:C.left, top:C.top, width:f, height:c}, horizontal:s < 0 ? "left" : n > 0 ? "right" : "center", vertical:u < 0 ? "top" : o > 0 ? "bottom" : "middle"};
        l < f && (i(n + s) < l && (h.horizontal = "center")), d < c && (i(o + u) < d && (h.vertical = "middle")), r(i(n), i(s)) > r(i(o), i(u)) ? h.important = "horizontal" : h.important = "vertical", t.using.call(this, e, h)
      }), a.offset(e.extend(C, {using:u}))
    })
  }, e.ui.position = {fit:{left:function(e, t) {
    var n = t.within, i = n.isWindow ? n.scrollLeft : n.offset.left, s = n.width, o = e.left - t.collisionPosition.marginLeft, u = i - o, a = o + t.collisionWidth - s - i, f;
    t.collisionWidth > s ? u > 0 && a <= 0 ? (f = e.left + u + t.collisionWidth - s - i, e.left += u - f) : a > 0 && u <= 0 ? e.left = i : u > a ? e.left = i + s - t.collisionWidth : e.left = i : u > 0 ? e.left += u : a > 0 ? e.left -= a : e.left = r(e.left - o, e.left)
  }, top:function(e, t) {
    var n = t.within, i = n.isWindow ? n.scrollTop : n.offset.top, s = t.within.height, o = e.top - t.collisionPosition.marginTop, u = i - o, a = o + t.collisionHeight - s - i, f;
    t.collisionHeight > s ? u > 0 && a <= 0 ? (f = e.top + u + t.collisionHeight - s - i, e.top += u - f) : a > 0 && u <= 0 ? e.top = i : u > a ? e.top = i + s - t.collisionHeight : e.top = i : u > 0 ? e.top += u : a > 0 ? e.top -= a : e.top = r(e.top - o, e.top)
  }}, flip:{left:function(e, t) {
    var n = t.within, r = n.offset.left + n.scrollLeft, s = n.width, o = n.isWindow ? n.scrollLeft : n.offset.left, u = e.left - t.collisionPosition.marginLeft, a = u - o, f = u + t.collisionWidth - s - o, l = t.my[0] === "left" ? -t.elemWidth : t.my[0] === "right" ? t.elemWidth : 0, c = t.at[0] === "left" ? t.targetWidth : t.at[0] === "right" ? -t.targetWidth : 0, h = -2 * t.offset[0], p, d;
    if(a < 0) {
      p = e.left + l + c + h + t.collisionWidth - s - r;
      if(p < 0 || p < i(a)) {
        e.left += l + c + h
      }
    }else {
      if(f > 0) {
        d = e.left - t.collisionPosition.marginLeft + l + c + h - o;
        if(d > 0 || i(d) < f) {
          e.left += l + c + h
        }
      }
    }
  }, top:function(e, t) {
    var n = t.within, r = n.offset.top + n.scrollTop, s = n.height, o = n.isWindow ? n.scrollTop : n.offset.top, u = e.top - t.collisionPosition.marginTop, a = u - o, f = u + t.collisionHeight - s - o, l = t.my[1] === "top", c = l ? -t.elemHeight : t.my[1] === "bottom" ? t.elemHeight : 0, h = t.at[1] === "top" ? t.targetHeight : t.at[1] === "bottom" ? -t.targetHeight : 0, p = -2 * t.offset[1], d, v;
    a < 0 ? (v = e.top + c + h + p + t.collisionHeight - s - r, e.top + c + h + p > a && ((v < 0 || v < i(a)) && (e.top += c + h + p))) : f > 0 && (d = e.top - t.collisionPosition.marginTop + c + h + p - o, e.top + c + h + p > f && ((d > 0 || i(d) < f) && (e.top += c + h + p)))
  }}, flipfit:{left:function() {
    e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments)
  }, top:function() {
    e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments)
  }}}, function() {
    var t, n, r, i, s, o = document.getElementsByTagName("body")[0], u = document.createElement("div");
    t = document.createElement(o ? "div" : "body"), r = {visibility:"hidden", width:0, height:0, border:0, margin:0, background:"none"}, o && e.extend(r, {position:"absolute", left:"-1000px", top:"-1000px"});
    for(s in r) {
      t.style[s] = r[s]
    }
    t.appendChild(u), n = o || document.documentElement, n.insertBefore(t, n.firstChild), u.style.cssText = "position: absolute; left: 10.7432222px;", i = e(u).offset().left, e.support.offsetFractions = i > 10 && i < 11, t.innerHTML = "", n.removeChild(t)
  }(), e.uiBackCompat !== !1 && function(e) {
    var n = e.fn.position;
    e.fn.position = function(r) {
      if(!r || !r.offset) {
        return n.call(this, r)
      }
      var i = r.offset.split(" "), s = r.at.split(" ");
      return i.length === 1 && (i[1] = i[0]), /^\d/.test(i[0]) && (i[0] = "+" + i[0]), /^\d/.test(i[1]) && (i[1] = "+" + i[1]), s.length === 1 && (/left|center|right/.test(s[0]) ? s[1] = "center" : (s[1] = s[0], s[0] = "center")), n.call(this, e.extend(r, {at:s[0] + i[0] + " " + s[1] + i[1], offset:t}))
    }
  }(jQuery)
})(jQuery);
(function(e, t) {
  e.widget("ui.draggable", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"drag", options:{addClasses:!0, appendTo:"parent", axis:!1, connectToSortable:!1, containment:!1, cursor:"auto", cursorAt:!1, grid:!1, handle:!1, helper:"original", iframeFix:!1, opacity:!1, refreshPositions:!1, revert:!1, revertDuration:500, scope:"default", scroll:!0, scrollSensitivity:20, scrollSpeed:20, snap:!1, snapMode:"both", snapTolerance:20, stack:!1, zIndex:!1}, _create:function() {
    this.options.helper == "original" && (!/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative")), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
  }, _destroy:function() {
    this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy()
  }, _mouseCapture:function(t) {
    var n = this.options;
    return this.helper || (n.disabled || e(t.target).is(".ui-resizable-handle")) ? !1 : (this.handle = this._getHandle(t), this.handle ? (e(n.iframeFix === !0 ? "iframe" : n.iframeFix).each(function() {
      e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth + "px", height:this.offsetHeight + "px", position:"absolute", opacity:"0.001", zIndex:1E3}).css(e(this).offset()).appendTo("body")
    }), !0) : !1)
  }, _mouseStart:function(t) {
    var n = this.options;
    return this.helper = this._createHelper(t), this.helper.addClass("ui-draggable-dragging"), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, e.extend(this.offset, {click:{left:t.pageX - this.offset.left, 
    top:t.pageY - this.offset.top}, parent:this._getParentOffset(), relative:this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), n.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && (!n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this._mouseDrag(t, 
    !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
  }, _mouseDrag:function(t, n) {
    this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute");
    if(!n) {
      var r = this._uiHash();
      if(this._trigger("drag", t, r) === !1) {
        return this._mouseUp({}), !1
      }
      this.position = r.position
    }
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    return e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
  }, _mouseStop:function(t) {
    var n = !1;
    e.ui.ddmanager && (!this.options.dropBehaviour && (n = e.ui.ddmanager.drop(this, t))), this.dropped && (n = this.dropped, this.dropped = !1);
    var r = this.element[0], i = !1;
    while(r && (r = r.parentNode)) {
      r == document && (i = !0)
    }
    if(!i && this.options.helper === "original") {
      return!1
    }
    if(this.options.revert == "invalid" && !n || (this.options.revert == "valid" && n || (this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, n)))) {
      var s = this;
      e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
        s._trigger("stop", t) !== !1 && s._clear()
      })
    }else {
      this._trigger("stop", t) !== !1 && this._clear()
    }
    return!1
  }, _mouseUp:function(t) {
    return e("div.ui-draggable-iframeFix").each(function() {
      this.parentNode.removeChild(this)
    }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
  }, cancel:function() {
    return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
  }, _getHandle:function(t) {
    var n = !this.options.handle || !e(this.options.handle, this.element).length ? !0 : !1;
    return e(this.options.handle, this.element).find("*").andSelf().each(function() {
      this == t.target && (n = !0)
    }), n
  }, _createHelper:function(t) {
    var n = this.options, r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t])) : n.helper == "clone" ? this.element.clone().removeAttr("id") : this.element;
    return r.parents("body").length || r.appendTo(n.appendTo == "parent" ? this.element[0].parentNode : n.appendTo), r[0] != this.element[0] && (!/(fixed|absolute)/.test(r.css("position")) && r.css("position", "absolute")), r
  }, _adjustOffsetFromHelper:function(t) {
    typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left:+t[0], top:+t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var t = this.offsetParent.offset();
    this.cssPosition == "absolute" && (this.scrollParent[0] != document && (e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop())));
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && (this.offsetParent[0].tagName.toLowerCase() == "html" && e.ui.ie)) {
      t = {top:0, left:0}
    }
    return{top:t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var e = this.element.position();
      return{top:e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.element.css("marginLeft"), 10) || 0, top:parseInt(this.element.css("marginTop"), 10) || 0, right:parseInt(this.element.css("marginRight"), 10) || 0, bottom:parseInt(this.element.css("marginBottom"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var t = this.options;
    t.containment == "parent" && (t.containment = this.helper[0].parentNode);
    if(t.containment == "document" || t.containment == "window") {
      this.containment = [t.containment == "document" ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, t.containment == "document" ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (t.containment == "document" ? 0 : e(window).scrollLeft()) + e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (t.containment == "document" ? 0 : e(window).scrollTop()) + (e(t.containment == "document" ? 
      document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(t.containment) && t.containment.constructor != Array) {
      var n = e(t.containment), r = n[0];
      if(!r) {
        return
      }
      var i = n.offset(), s = e(r).css("overflow") != "hidden";
      this.containment = [(parseInt(e(r).css("borderLeftWidth"), 10) || 0) + (parseInt(e(r).css("paddingLeft"), 10) || 0), (parseInt(e(r).css("borderTopWidth"), 10) || 0) + (parseInt(e(r).css("paddingTop"), 10) || 0), (s ? Math.max(r.scrollWidth, r.offsetWidth) : r.offsetWidth) - (parseInt(e(r).css("borderLeftWidth"), 10) || 0) - (parseInt(e(r).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (s ? Math.max(r.scrollHeight, r.offsetHeight) : r.offsetHeight) - 
      (parseInt(e(r).css("borderTopWidth"), 10) || 0) - (parseInt(e(r).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = n
    }else {
      t.containment.constructor == Array && (this.containment = t.containment)
    }
  }, _convertPositionTo:function(t, n) {
    n || (n = this.position);
    var r = t == "absolute" ? 1 : -1, i = this.options, s = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, o = /(html|body)/i.test(s[0].tagName);
    return{top:n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : o ? 0 : s.scrollTop()) * r, left:n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : o ? 0 : s.scrollLeft()) * r}
  }, _generatePosition:function(t) {
    var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName), s = t.pageX, o = t.pageY;
    if(this.originalPosition) {
      var u;
      if(this.containment) {
        if(this.relative_container) {
          var a = this.relative_container.offset();
          u = [this.containment[0] + a.left, this.containment[1] + a.top, this.containment[2] + a.left, this.containment[3] + a.top]
        }else {
          u = this.containment
        }
        t.pageX - this.offset.click.left < u[0] && (s = u[0] + this.offset.click.left), t.pageY - this.offset.click.top < u[1] && (o = u[1] + this.offset.click.top), t.pageX - this.offset.click.left > u[2] && (s = u[2] + this.offset.click.left), t.pageY - this.offset.click.top > u[3] && (o = u[3] + this.offset.click.top)
      }
      if(n.grid) {
        var f = n.grid[1] ? this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1] : this.originalPageY;
        o = u ? f - this.offset.click.top < u[1] || f - this.offset.click.top > u[3] ? f - this.offset.click.top < u[1] ? f + n.grid[1] : f - n.grid[1] : f : f;
        var l = n.grid[0] ? this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0] : this.originalPageX;
        s = u ? l - this.offset.click.left < u[0] || l - this.offset.click.left > u[2] ? l - this.offset.click.left < u[0] ? l + n.grid[0] : l - n.grid[0] : l : l
      }
    }
    return{top:o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()), left:s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
  }, _clear:function() {
    this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && (!this.cancelHelperRemoval && this.helper.remove()), this.helper = null, this.cancelHelperRemoval = !1
  }, _trigger:function(t, n, r) {
    return r = r || this._uiHash(), e.ui.plugin.call(this, t, [n, r]), t == "drag" && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, n, r)
  }, plugins:{}, _uiHash:function(e) {
    return{helper:this.helper, position:this.position, originalPosition:this.originalPosition, offset:this.positionAbs}
  }}), e.ui.plugin.add("draggable", "connectToSortable", {start:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = e.extend({}, n, {item:r.element});
    r.sortables = [], e(i.connectToSortable).each(function() {
      var n = e.data(this, "sortable");
      n && (!n.options.disabled && (r.sortables.push({instance:n, shouldRevert:n.options.revert}), n.refreshPositions(), n._trigger("activate", t, s)))
    })
  }, stop:function(t, n) {
    var r = e(this).data("draggable"), i = e.extend({}, n, {item:r.element});
    e.each(r.sortables, function() {
      this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, r.options.helper == "original" && this.instance.currentItem.css({top:"auto", left:"auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, i))
    })
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = this, s = function(t) {
      var n = this.offset.click.top, r = this.offset.click.left, i = this.positionAbs.top, s = this.positionAbs.left, o = t.height, u = t.width, a = t.top, f = t.left;
      return e.ui.isOver(i + n, s + r, a, f, o, u)
    };
    e.each(r.sortables, function(s) {
      var o = !1, u = this;
      this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this.instance._intersectsWith(this.instance.containerCache) && (o = !0, e.each(r.sortables, function() {
        return this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this != u && (this.instance._intersectsWith(this.instance.containerCache) && (e.ui.contains(u.instance.element[0], this.instance.element[0]) && (o = !1))), o
      })), o ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
        return n.helper[0]
      }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, 
      this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", 
      t), r.dropped = !1)
    })
  }}), e.ui.plugin.add("draggable", "cursor", {start:function(t, n) {
    var r = e("body"), i = e(this).data("draggable").options;
    r.css("cursor") && (i._cursor = r.css("cursor")), r.css("cursor", i.cursor)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._cursor && e("body").css("cursor", r._cursor)
  }}), e.ui.plugin.add("draggable", "opacity", {start:function(t, n) {
    var r = e(n.helper), i = e(this).data("draggable").options;
    r.css("opacity") && (i._opacity = r.css("opacity")), r.css("opacity", i.opacity)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._opacity && e(n.helper).css("opacity", r._opacity)
  }}), e.ui.plugin.add("draggable", "scroll", {start:function(t, n) {
    var r = e(this).data("draggable");
    r.scrollParent[0] != document && (r.scrollParent[0].tagName != "HTML" && (r.overflowOffset = r.scrollParent.offset()))
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = !1;
    if(r.scrollParent[0] != document && r.scrollParent[0].tagName != "HTML") {
      if(!i.axis || i.axis != "x") {
        r.overflowOffset.top + r.scrollParent[0].offsetHeight - t.pageY < i.scrollSensitivity ? r.scrollParent[0].scrollTop = s = r.scrollParent[0].scrollTop + i.scrollSpeed : t.pageY - r.overflowOffset.top < i.scrollSensitivity && (r.scrollParent[0].scrollTop = s = r.scrollParent[0].scrollTop - i.scrollSpeed)
      }
      if(!i.axis || i.axis != "y") {
        r.overflowOffset.left + r.scrollParent[0].offsetWidth - t.pageX < i.scrollSensitivity ? r.scrollParent[0].scrollLeft = s = r.scrollParent[0].scrollLeft + i.scrollSpeed : t.pageX - r.overflowOffset.left < i.scrollSensitivity && (r.scrollParent[0].scrollLeft = s = r.scrollParent[0].scrollLeft - i.scrollSpeed)
      }
    }else {
      if(!i.axis || i.axis != "x") {
        t.pageY - e(document).scrollTop() < i.scrollSensitivity ? s = e(document).scrollTop(e(document).scrollTop() - i.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < i.scrollSensitivity && (s = e(document).scrollTop(e(document).scrollTop() + i.scrollSpeed))
      }
      if(!i.axis || i.axis != "y") {
        t.pageX - e(document).scrollLeft() < i.scrollSensitivity ? s = e(document).scrollLeft(e(document).scrollLeft() - i.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < i.scrollSensitivity && (s = e(document).scrollLeft(e(document).scrollLeft() + i.scrollSpeed))
      }
    }
    s !== !1 && (e.ui.ddmanager && (!i.dropBehaviour && e.ui.ddmanager.prepareOffsets(r, t)))
  }}), e.ui.plugin.add("draggable", "snap", {start:function(t, n) {
    var r = e(this).data("draggable"), i = r.options;
    r.snapElements = [], e(i.snap.constructor != String ? i.snap.items || ":data(draggable)" : i.snap).each(function() {
      var t = e(this), n = t.offset();
      this != r.element[0] && r.snapElements.push({item:this, width:t.outerWidth(), height:t.outerHeight(), top:n.top, left:n.left})
    })
  }, drag:function(t, n) {
    var r = e(this).data("draggable"), i = r.options, s = i.snapTolerance, o = n.offset.left, u = o + r.helperProportions.width, a = n.offset.top, f = a + r.helperProportions.height;
    for(var l = r.snapElements.length - 1;l >= 0;l--) {
      var c = r.snapElements[l].left, h = c + r.snapElements[l].width, p = r.snapElements[l].top, d = p + r.snapElements[l].height;
      if(!(c - s < o && (o < h + s && (p - s < a && a < d + s)) || (c - s < o && (o < h + s && (p - s < f && f < d + s)) || (c - s < u && (u < h + s && (p - s < a && a < d + s)) || c - s < u && (u < h + s && (p - s < f && f < d + s)))))) {
        r.snapElements[l].snapping && (r.options.snap.release && r.options.snap.release.call(r.element, t, e.extend(r._uiHash(), {snapItem:r.snapElements[l].item}))), r.snapElements[l].snapping = !1;
        continue
      }
      if(i.snapMode != "inner") {
        var v = Math.abs(p - f) <= s, m = Math.abs(d - a) <= s, g = Math.abs(c - u) <= s, y = Math.abs(h - o) <= s;
        v && (n.position.top = r._convertPositionTo("relative", {top:p - r.helperProportions.height, left:0}).top - r.margins.top), m && (n.position.top = r._convertPositionTo("relative", {top:d, left:0}).top - r.margins.top), g && (n.position.left = r._convertPositionTo("relative", {top:0, left:c - r.helperProportions.width}).left - r.margins.left), y && (n.position.left = r._convertPositionTo("relative", {top:0, left:h}).left - r.margins.left)
      }
      var b = v || (m || (g || y));
      if(i.snapMode != "outer") {
        var v = Math.abs(p - a) <= s, m = Math.abs(d - f) <= s, g = Math.abs(c - o) <= s, y = Math.abs(h - u) <= s;
        v && (n.position.top = r._convertPositionTo("relative", {top:p, left:0}).top - r.margins.top), m && (n.position.top = r._convertPositionTo("relative", {top:d - r.helperProportions.height, left:0}).top - r.margins.top), g && (n.position.left = r._convertPositionTo("relative", {top:0, left:c}).left - r.margins.left), y && (n.position.left = r._convertPositionTo("relative", {top:0, left:h - r.helperProportions.width}).left - r.margins.left)
      }
      !r.snapElements[l].snapping && ((v || (m || (g || (y || b)))) && (r.options.snap.snap && r.options.snap.snap.call(r.element, t, e.extend(r._uiHash(), {snapItem:r.snapElements[l].item})))), r.snapElements[l].snapping = v || (m || (g || (y || b)))
    }
  }}), e.ui.plugin.add("draggable", "stack", {start:function(t, n) {
    var r = e(this).data("draggable").options, i = e.makeArray(e(r.stack)).sort(function(t, n) {
      return(parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(n).css("zIndex"), 10) || 0)
    });
    if(!i.length) {
      return
    }
    var s = parseInt(i[0].style.zIndex) || 0;
    e(i).each(function(e) {
      this.style.zIndex = s + e
    }), this[0].style.zIndex = s + i.length
  }}), e.ui.plugin.add("draggable", "zIndex", {start:function(t, n) {
    var r = e(n.helper), i = e(this).data("draggable").options;
    r.css("zIndex") && (i._zIndex = r.css("zIndex")), r.css("zIndex", i.zIndex)
  }, stop:function(t, n) {
    var r = e(this).data("draggable").options;
    r._zIndex && e(n.helper).css("zIndex", r._zIndex)
  }})
})(jQuery);
(function(e, t) {
  e.widget("ui.droppable", {version:"1.9.2", widgetEventPrefix:"drop", options:{accept:"*", activeClass:!1, addClasses:!0, greedy:!1, hoverClass:!1, scope:"default", tolerance:"intersect"}, _create:function() {
    var t = this.options, n = t.accept;
    this.isover = 0, this.isout = 1, this.accept = e.isFunction(n) ? n : function(e) {
      return e.is(n)
    }, this.proportions = {width:this.element[0].offsetWidth, height:this.element[0].offsetHeight}, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable")
  }, _destroy:function() {
    var t = e.ui.ddmanager.droppables[this.options.scope];
    for(var n = 0;n < t.length;n++) {
      t[n] == this && t.splice(n, 1)
    }
    this.element.removeClass("ui-droppable ui-droppable-disabled")
  }, _setOption:function(t, n) {
    t == "accept" && (this.accept = e.isFunction(n) ? n : function(e) {
      return e.is(n)
    }), e.Widget.prototype._setOption.apply(this, arguments)
  }, _activate:function(t) {
    var n = e.ui.ddmanager.current;
    this.options.activeClass && this.element.addClass(this.options.activeClass), n && this._trigger("activate", t, this.ui(n))
  }, _deactivate:function(t) {
    var n = e.ui.ddmanager.current;
    this.options.activeClass && this.element.removeClass(this.options.activeClass), n && this._trigger("deactivate", t, this.ui(n))
  }, _over:function(t) {
    var n = e.ui.ddmanager.current;
    if(!n || (n.currentItem || n.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(n)))
  }, _out:function(t) {
    var n = e.ui.ddmanager.current;
    if(!n || (n.currentItem || n.element)[0] == this.element[0]) {
      return
    }
    this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(n)))
  }, _drop:function(t, n) {
    var r = n || e.ui.ddmanager.current;
    if(!r || (r.currentItem || r.element)[0] == this.element[0]) {
      return!1
    }
    var i = !1;
    return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function() {
      var t = e.data(this, "droppable");
      if(t.options.greedy && (!t.options.disabled && (t.options.scope == r.options.scope && (t.accept.call(t.element[0], r.currentItem || r.element) && e.ui.intersect(r, e.extend(t, {offset:t.element.offset()}), t.options.tolerance))))) {
        return i = !0, !1
      }
    }), i ? !1 : this.accept.call(this.element[0], r.currentItem || r.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(r)), this.element) : !1
  }, ui:function(e) {
    return{draggable:e.currentItem || e.element, helper:e.helper, position:e.position, offset:e.positionAbs}
  }}), e.ui.intersect = function(t, n, r) {
    if(!n.offset) {
      return!1
    }
    var i = (t.positionAbs || t.position.absolute).left, s = i + t.helperProportions.width, o = (t.positionAbs || t.position.absolute).top, u = o + t.helperProportions.height, a = n.offset.left, f = a + n.proportions.width, l = n.offset.top, c = l + n.proportions.height;
    switch(r) {
      case "fit":
        return a <= i && (s <= f && (l <= o && u <= c));
      case "intersect":
        return a < i + t.helperProportions.width / 2 && (s - t.helperProportions.width / 2 < f && (l < o + t.helperProportions.height / 2 && u - t.helperProportions.height / 2 < c));
      case "pointer":
        var h = (t.positionAbs || t.position.absolute).left + (t.clickOffset || t.offset.click).left, p = (t.positionAbs || t.position.absolute).top + (t.clickOffset || t.offset.click).top, d = e.ui.isOver(p, h, l, a, n.proportions.height, n.proportions.width);
        return d;
      case "touch":
        return(o >= l && o <= c || (u >= l && u <= c || o < l && u > c)) && (i >= a && i <= f || (s >= a && s <= f || i < a && s > f));
      default:
        return!1
    }
  }, e.ui.ddmanager = {current:null, droppables:{"default":[]}, prepareOffsets:function(t, n) {
    var r = e.ui.ddmanager.droppables[t.options.scope] || [], i = n ? n.type : null, s = (t.currentItem || t.element).find(":data(droppable)").andSelf();
    e:for(var o = 0;o < r.length;o++) {
      if(r[o].options.disabled || t && !r[o].accept.call(r[o].element[0], t.currentItem || t.element)) {
        continue
      }
      for(var u = 0;u < s.length;u++) {
        if(s[u] == r[o].element[0]) {
          r[o].proportions.height = 0;
          continue e
        }
      }
      r[o].visible = r[o].element.css("display") != "none";
      if(!r[o].visible) {
        continue
      }
      i == "mousedown" && r[o]._activate.call(r[o], n), r[o].offset = r[o].element.offset(), r[o].proportions = {width:r[o].element[0].offsetWidth, height:r[o].element[0].offsetHeight}
    }
  }, drop:function(t, n) {
    var r = !1;
    return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
      if(!this.options) {
        return
      }
      !this.options.disabled && (this.visible && (e.ui.intersect(t, this, this.options.tolerance) && (r = this._drop.call(this, n) || r))), !this.options.disabled && (this.visible && (this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, n))))
    }), r
  }, dragStart:function(t, n) {
    t.element.parentsUntil("body").bind("scroll.droppable", function() {
      t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
    })
  }, drag:function(t, n) {
    t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, n), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
      if(this.options.disabled || (this.greedyChild || !this.visible)) {
        return
      }
      var r = e.ui.intersect(t, this, this.options.tolerance), i = !r && this.isover == 1 ? "isout" : r && this.isover == 0 ? "isover" : null;
      if(!i) {
        return
      }
      var s;
      if(this.options.greedy) {
        var o = this.options.scope, u = this.element.parents(":data(droppable)").filter(function() {
          return e.data(this, "droppable").options.scope === o
        });
        u.length && (s = e.data(u[0], "droppable"), s.greedyChild = i == "isover" ? 1 : 0)
      }
      s && (i == "isover" && (s.isover = 0, s.isout = 1, s._out.call(s, n))), this[i] = 1, this[i == "isout" ? "isover" : "isout"] = 0, this[i == "isover" ? "_over" : "_out"].call(this, n), s && (i == "isout" && (s.isout = 0, s.isover = 1, s._over.call(s, n)))
    })
  }, dragStop:function(t, n) {
    t.element.parentsUntil("body").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
  }}
})(jQuery);
(function(e, t) {
  e.widget("ui.sortable", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"sort", ready:!1, options:{appendTo:"parent", axis:!1, connectWith:!1, containment:!1, cursor:"auto", cursorAt:!1, dropOnEmpty:!0, forcePlaceholderSize:!1, forceHelperSize:!1, grid:!1, handle:!1, helper:"original", items:"> *", opacity:!1, placeholder:!1, revert:!1, scroll:!0, scrollSensitivity:20, scrollSpeed:20, scope:"default", tolerance:"intersect", zIndex:1E3}, _create:function() {
    var e = this.options;
    this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || (/left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display"))) : !1, this.offset = this.element.offset(), this._mouseInit(), this.ready = !0
  }, _destroy:function() {
    this.element.removeClass("ui-sortable ui-sortable-disabled"), this._mouseDestroy();
    for(var e = this.items.length - 1;e >= 0;e--) {
      this.items[e].item.removeData(this.widgetName + "-item")
    }
    return this
  }, _setOption:function(t, n) {
    t === "disabled" ? (this.options[t] = n, this.widget().toggleClass("ui-sortable-disabled", !!n)) : e.Widget.prototype._setOption.apply(this, arguments)
  }, _mouseCapture:function(t, n) {
    var r = this;
    if(this.reverting) {
      return!1
    }
    if(this.options.disabled || this.options.type == "static") {
      return!1
    }
    this._refreshItems(t);
    var i = null, s = e(t.target).parents().each(function() {
      if(e.data(this, r.widgetName + "-item") == r) {
        return i = e(this), !1
      }
    });
    e.data(t.target, r.widgetName + "-item") == r && (i = e(t.target));
    if(!i) {
      return!1
    }
    if(this.options.handle && !n) {
      var o = !1;
      e(this.options.handle, i).find("*").andSelf().each(function() {
        this == t.target && (o = !0)
      });
      if(!o) {
        return!1
      }
    }
    return this.currentItem = i, this._removeCurrentsFromItems(), !0
  }, _mouseStart:function(t, n, r) {
    var i = this.options;
    this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top:this.offset.top - this.margins.top, left:this.offset.left - this.margins.left}, e.extend(this.offset, {click:{left:t.pageX - this.offset.left, top:t.pageY - this.offset.top}, parent:this._getParentOffset(), relative:this._getRelativeOffset()}), 
    this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this.domPosition = {prev:this.currentItem.prev()[0], parent:this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), i.containment && this._setContainment(), i.cursor && (e("body").css("cursor") && 
    (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", i.cursor)), i.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", i.opacity)), i.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", i.zIndex)), this.scrollParent[0] != document && (this.scrollParent[0].tagName != "HTML" && (this.overflowOffset = this.scrollParent.offset())), this._trigger("start", 
    t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
    if(!r) {
      for(var s = this.containers.length - 1;s >= 0;s--) {
        this.containers[s]._trigger("activate", t, this._uiHash(this))
      }
    }
    return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && (!i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
  }, _mouseDrag:function(t) {
    this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
    if(this.options.scroll) {
      var n = this.options, r = !1;
      this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < n.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + n.scrollSpeed : t.pageY - this.overflowOffset.top < n.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - n.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < n.scrollSensitivity ? 
      this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + n.scrollSpeed : t.pageX - this.overflowOffset.left < n.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - n.scrollSpeed)) : (t.pageY - e(document).scrollTop() < n.scrollSensitivity ? r = e(document).scrollTop(e(document).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < n.scrollSensitivity && (r = e(document).scrollTop(e(document).scrollTop() + 
      n.scrollSpeed)), t.pageX - e(document).scrollLeft() < n.scrollSensitivity ? r = e(document).scrollLeft(e(document).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < n.scrollSensitivity && (r = e(document).scrollLeft(e(document).scrollLeft() + n.scrollSpeed))), r !== !1 && (e.ui.ddmanager && (!n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)))
    }
    this.positionAbs = this._convertPositionTo("absolute");
    if(!this.options.axis || this.options.axis != "y") {
      this.helper[0].style.left = this.position.left + "px"
    }
    if(!this.options.axis || this.options.axis != "x") {
      this.helper[0].style.top = this.position.top + "px"
    }
    for(var i = this.items.length - 1;i >= 0;i--) {
      var s = this.items[i], o = s.item[0], u = this._intersectsWithPointer(s);
      if(!u) {
        continue
      }
      if(s.instance !== this.currentContainer) {
        continue
      }
      if(o != this.currentItem[0] && (this.placeholder[u == 1 ? "next" : "prev"]()[0] != o && (!e.contains(this.placeholder[0], o) && (this.options.type == "semi-dynamic" ? !e.contains(this.element[0], o) : !0)))) {
        this.direction = u == 1 ? "down" : "up";
        if(this.options.tolerance != "pointer" && !this._intersectsWithSides(s)) {
          break
        }
        this._rearrange(t, s), this._trigger("change", t, this._uiHash());
        break
      }
    }
    return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
  }, _mouseStop:function(t, n) {
    if(!t) {
      return
    }
    e.ui.ddmanager && (!this.options.dropBehaviour && e.ui.ddmanager.drop(this, t));
    if(this.options.revert) {
      var r = this, i = this.placeholder.offset();
      this.reverting = !0, e(this.helper).animate({left:i.left - this.offset.parent.left - this.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft), top:i.top - this.offset.parent.top - this.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function() {
        r._clear(t)
      })
    }else {
      this._clear(t, n)
    }
    return!1
  }, cancel:function() {
    if(this.dragging) {
      this._mouseUp({target:null}), this.options.helper == "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
      for(var t = this.containers.length - 1;t >= 0;t--) {
        this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
      }
    }
    return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper != "original" && (this.helper && (this.helper[0].parentNode && this.helper.remove())), e.extend(this, {helper:null, dragging:!1, reverting:!1, _noFinalSort:null}), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
  }, serialize:function(t) {
    var n = this._getItemsAsjQuery(t && t.connected), r = [];
    return t = t || {}, e(n).each(function() {
      var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[-=_](.+)/);
      n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
    }), !r.length && (t.key && r.push(t.key + "=")), r.join("&")
  }, toArray:function(t) {
    var n = this._getItemsAsjQuery(t && t.connected), r = [];
    return t = t || {}, n.each(function() {
      r.push(e(t.item || this).attr(t.attribute || "id") || "")
    }), r
  }, _intersectsWith:function(e) {
    var t = this.positionAbs.left, n = t + this.helperProportions.width, r = this.positionAbs.top, i = r + this.helperProportions.height, s = e.left, o = s + e.width, u = e.top, a = u + e.height, f = this.offset.click.top, l = this.offset.click.left, c = r + f > u && (r + f < a && (t + l > s && t + l < o));
    return this.options.tolerance == "pointer" || (this.options.forcePointerForContainers || this.options.tolerance != "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"]) ? c : s < t + this.helperProportions.width / 2 && (n - this.helperProportions.width / 2 < o && (u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a))
  }, _intersectsWithPointer:function(t) {
    var n = this.options.axis === "x" || e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top, t.height), r = this.options.axis === "y" || e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left, t.width), i = n && r, s = this._getDragVerticalDirection(), o = this._getDragHorizontalDirection();
    return i ? this.floating ? o && o == "right" || s == "down" ? 2 : 1 : s && (s == "down" ? 2 : 1) : !1
  }, _intersectsWithSides:function(t) {
    var n = e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height), r = e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width), i = this._getDragVerticalDirection(), s = this._getDragHorizontalDirection();
    return this.floating && s ? s == "right" && r || s == "left" && !r : i && (i == "down" && n || i == "up" && !n)
  }, _getDragVerticalDirection:function() {
    var e = this.positionAbs.top - this.lastPositionAbs.top;
    return e != 0 && (e > 0 ? "down" : "up")
  }, _getDragHorizontalDirection:function() {
    var e = this.positionAbs.left - this.lastPositionAbs.left;
    return e != 0 && (e > 0 ? "right" : "left")
  }, refresh:function(e) {
    return this._refreshItems(e), this.refreshPositions(), this
  }, _connectWith:function() {
    var e = this.options;
    return e.connectWith.constructor == String ? [e.connectWith] : e.connectWith
  }, _getItemsAsjQuery:function(t) {
    var n = [], r = [], i = this._connectWith();
    if(i && t) {
      for(var s = i.length - 1;s >= 0;s--) {
        var o = e(i[s]);
        for(var u = o.length - 1;u >= 0;u--) {
          var a = e.data(o[u], this.widgetName);
          a && (a != this && (!a.options.disabled && r.push([e.isFunction(a.options.items) ? a.options.items.call(a.element) : e(a.options.items, a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), a])))
        }
      }
    }
    r.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options:this.options, item:this.currentItem}) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
    for(var s = r.length - 1;s >= 0;s--) {
      r[s][0].each(function() {
        n.push(this)
      })
    }
    return e(n)
  }, _removeCurrentsFromItems:function() {
    var t = this.currentItem.find(":data(" + this.widgetName + "-item)");
    this.items = e.grep(this.items, function(e) {
      for(var n = 0;n < t.length;n++) {
        if(t[n] == e.item[0]) {
          return!1
        }
      }
      return!0
    })
  }, _refreshItems:function(t) {
    this.items = [], this.containers = [this];
    var n = this.items, r = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {item:this.currentItem}) : e(this.options.items, this.element), this]], i = this._connectWith();
    if(i && this.ready) {
      for(var s = i.length - 1;s >= 0;s--) {
        var o = e(i[s]);
        for(var u = o.length - 1;u >= 0;u--) {
          var a = e.data(o[u], this.widgetName);
          a && (a != this && (!a.options.disabled && (r.push([e.isFunction(a.options.items) ? a.options.items.call(a.element[0], t, {item:this.currentItem}) : e(a.options.items, a.element), a]), this.containers.push(a))))
        }
      }
    }
    for(var s = r.length - 1;s >= 0;s--) {
      var f = r[s][1], l = r[s][0];
      for(var u = 0, c = l.length;u < c;u++) {
        var h = e(l[u]);
        h.data(this.widgetName + "-item", f), n.push({item:h, instance:f, width:0, height:0, left:0, top:0})
      }
    }
  }, refreshPositions:function(t) {
    this.offsetParent && (this.helper && (this.offset.parent = this._getParentOffset()));
    for(var n = this.items.length - 1;n >= 0;n--) {
      var r = this.items[n];
      if(r.instance != this.currentContainer && (this.currentContainer && r.item[0] != this.currentItem[0])) {
        continue
      }
      var i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item;
      t || (r.width = i.outerWidth(), r.height = i.outerHeight());
      var s = i.offset();
      r.left = s.left, r.top = s.top
    }
    if(this.options.custom && this.options.custom.refreshContainers) {
      this.options.custom.refreshContainers.call(this)
    }else {
      for(var n = this.containers.length - 1;n >= 0;n--) {
        var s = this.containers[n].element.offset();
        this.containers[n].containerCache.left = s.left, this.containers[n].containerCache.top = s.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight()
      }
    }
    return this
  }, _createPlaceholder:function(t) {
    t = t || this;
    var n = t.options;
    if(!n.placeholder || n.placeholder.constructor == String) {
      var r = n.placeholder;
      n.placeholder = {element:function() {
        var n = e(document.createElement(t.currentItem[0].nodeName)).addClass(r || t.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
        return r || (n.style.visibility = "hidden"), n
      }, update:function(e, i) {
        if(r && !n.forcePlaceholderSize) {
          return
        }
        i.height() || i.height(t.currentItem.innerHeight() - parseInt(t.currentItem.css("paddingTop") || 0, 10) - parseInt(t.currentItem.css("paddingBottom") || 0, 10)), i.width() || i.width(t.currentItem.innerWidth() - parseInt(t.currentItem.css("paddingLeft") || 0, 10) - parseInt(t.currentItem.css("paddingRight") || 0, 10))
      }}
    }
    t.placeholder = e(n.placeholder.element.call(t.element, t.currentItem)), t.currentItem.after(t.placeholder), n.placeholder.update(t, t.placeholder)
  }, _contactContainers:function(t) {
    var n = null, r = null;
    for(var i = this.containers.length - 1;i >= 0;i--) {
      if(e.contains(this.currentItem[0], this.containers[i].element[0])) {
        continue
      }
      if(this._intersectsWith(this.containers[i].containerCache)) {
        if(n && e.contains(this.containers[i].element[0], n.element[0])) {
          continue
        }
        n = this.containers[i], r = i
      }else {
        this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0)
      }
    }
    if(!n) {
      return
    }
    if(this.containers.length === 1) {
      this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1
    }else {
      var s = 1E4, o = null, u = this.containers[r].floating ? "left" : "top", a = this.containers[r].floating ? "width" : "height", f = this.positionAbs[u] + this.offset.click[u];
      for(var l = this.items.length - 1;l >= 0;l--) {
        if(!e.contains(this.containers[r].element[0], this.items[l].item[0])) {
          continue
        }
        if(this.items[l].item[0] == this.currentItem[0]) {
          continue
        }
        var c = this.items[l].item.offset()[u], h = !1;
        Math.abs(c - f) > Math.abs(c + this.items[l][a] - f) && (h = !0, c += this.items[l][a]), Math.abs(c - f) < s && (s = Math.abs(c - f), o = this.items[l], this.direction = h ? "up" : "down")
      }
      if(!o && !this.options.dropOnEmpty) {
        return
      }
      this.currentContainer = this.containers[r], o ? this._rearrange(t, o, null, !0) : this._rearrange(t, null, this.containers[r].element, !0), this._trigger("change", t, this._uiHash()), this.containers[r]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1
    }
  }, _createHelper:function(t) {
    var n = this.options, r = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper == "clone" ? this.currentItem.clone() : this.currentItem;
    return r.parents("body").length || e(n.appendTo != "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(r[0]), r[0] == this.currentItem[0] && (this._storedCSS = {width:this.currentItem[0].style.width, height:this.currentItem[0].style.height, position:this.currentItem.css("position"), top:this.currentItem.css("top"), left:this.currentItem.css("left")}), (r[0].style.width == "" || n.forceHelperSize) && r.width(this.currentItem.width()), (r[0].style.height == "" || n.forceHelperSize) && 
    r.height(this.currentItem.height()), r
  }, _adjustOffsetFromHelper:function(t) {
    typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left:+t[0], top:+t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
  }, _getParentOffset:function() {
    this.offsetParent = this.helper.offsetParent();
    var t = this.offsetParent.offset();
    this.cssPosition == "absolute" && (this.scrollParent[0] != document && (e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop())));
    if(this.offsetParent[0] == document.body || this.offsetParent[0].tagName && (this.offsetParent[0].tagName.toLowerCase() == "html" && e.ui.ie)) {
      t = {top:0, left:0}
    }
    return{top:t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left:t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
  }, _getRelativeOffset:function() {
    if(this.cssPosition == "relative") {
      var e = this.currentItem.position();
      return{top:e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left:e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
    }
    return{top:0, left:0}
  }, _cacheMargins:function() {
    this.margins = {left:parseInt(this.currentItem.css("marginLeft"), 10) || 0, top:parseInt(this.currentItem.css("marginTop"), 10) || 0}
  }, _cacheHelperProportions:function() {
    this.helperProportions = {width:this.helper.outerWidth(), height:this.helper.outerHeight()}
  }, _setContainment:function() {
    var t = this.options;
    t.containment == "parent" && (t.containment = this.helper[0].parentNode);
    if(t.containment == "document" || t.containment == "window") {
      this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(t.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]
    }
    if(!/^(document|window|parent)$/.test(t.containment)) {
      var n = e(t.containment)[0], r = e(t.containment).offset(), i = e(n).css("overflow") != "hidden";
      this.containment = [r.left + (parseInt(e(n).css("borderLeftWidth"), 10) || 0) + (parseInt(e(n).css("paddingLeft"), 10) || 0) - this.margins.left, r.top + (parseInt(e(n).css("borderTopWidth"), 10) || 0) + (parseInt(e(n).css("paddingTop"), 10) || 0) - this.margins.top, r.left + (i ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(e(n).css("borderLeftWidth"), 10) || 0) - (parseInt(e(n).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, r.top + 
      (i ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(e(n).css("borderTopWidth"), 10) || 0) - (parseInt(e(n).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
    }
  }, _convertPositionTo:function(t, n) {
    n || (n = this.position);
    var r = t == "absolute" ? 1 : -1, i = this.options, s = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, o = /(html|body)/i.test(s[0].tagName);
    return{top:n.top + this.offset.relative.top * r + this.offset.parent.top * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : o ? 0 : s.scrollTop()) * r, left:n.left + this.offset.relative.left * r + this.offset.parent.left * r - (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : o ? 0 : s.scrollLeft()) * r}
  }, _generatePosition:function(t) {
    var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName);
    this.cssPosition == "relative" && ((this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset()));
    var s = t.pageX, o = t.pageY;
    if(this.originalPosition) {
      this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top));
      if(n.grid) {
        var u = this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1];
        o = this.containment ? u - this.offset.click.top < this.containment[1] || u - this.offset.click.top > this.containment[3] ? u - this.offset.click.top < this.containment[1] ? u + n.grid[1] : u - n.grid[1] : u : u;
        var a = this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0];
        s = this.containment ? a - this.offset.click.left < this.containment[0] || a - this.offset.click.left > this.containment[2] ? a - this.offset.click.left < this.containment[0] ? a + n.grid[0] : a - n.grid[0] : a : a
      }
    }
    return{top:o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()), left:s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
  }, _rearrange:function(e, t, n, r) {
    n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction == "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
    var i = this.counter;
    this._delay(function() {
      i == this.counter && this.refreshPositions(!r)
    })
  }, _clear:function(t, n) {
    this.reverting = !1;
    var r = [];
    !this._noFinalSort && (this.currentItem.parent().length && this.placeholder.before(this.currentItem)), this._noFinalSort = null;
    if(this.helper[0] == this.currentItem[0]) {
      for(var i in this._storedCSS) {
        if(this._storedCSS[i] == "auto" || this._storedCSS[i] == "static") {
          this._storedCSS[i] = ""
        }
      }
      this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
    }else {
      this.currentItem.show()
    }
    this.fromOutside && (!n && r.push(function(e) {
      this._trigger("receive", e, this._uiHash(this.fromOutside))
    })), (this.fromOutside || (this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0])) && (!n && r.push(function(e) {
      this._trigger("update", e, this._uiHash())
    })), this !== this.currentContainer && (n || (r.push(function(e) {
      this._trigger("remove", e, this._uiHash())
    }), r.push(function(e) {
      return function(t) {
        e._trigger("receive", t, this._uiHash(this))
      }
    }.call(this, this.currentContainer)), r.push(function(e) {
      return function(t) {
        e._trigger("update", t, this._uiHash(this))
      }
    }.call(this, this.currentContainer))));
    for(var i = this.containers.length - 1;i >= 0;i--) {
      n || r.push(function(e) {
        return function(t) {
          e._trigger("deactivate", t, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over && (r.push(function(e) {
        return function(t) {
          e._trigger("out", t, this._uiHash(this))
        }
      }.call(this, this.containers[i])), this.containers[i].containerCache.over = 0)
    }
    this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex == "auto" ? "" : this._storedZIndex), this.dragging = !1;
    if(this.cancelHelperRemoval) {
      if(!n) {
        this._trigger("beforeStop", t, this._uiHash());
        for(var i = 0;i < r.length;i++) {
          r[i].call(this, t)
        }
        this._trigger("stop", t, this._uiHash())
      }
      return this.fromOutside = !1, !1
    }
    n || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null;
    if(!n) {
      for(var i = 0;i < r.length;i++) {
        r[i].call(this, t)
      }
      this._trigger("stop", t, this._uiHash())
    }
    return this.fromOutside = !1, !0
  }, _trigger:function() {
    e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
  }, _uiHash:function(t) {
    var n = t || this;
    return{helper:n.helper, placeholder:n.placeholder || e([]), position:n.position, originalPosition:n.originalPosition, offset:n.positionAbs, item:n.currentItem, sender:t ? t.element : null}
  }})
})(jQuery);
(function(e, t) {
  var n = 0;
  e.widget("ui.autocomplete", {version:"1.9.2", defaultElement:"<input>", options:{appendTo:"body", autoFocus:!1, delay:300, minLength:1, position:{my:"left top", at:"left bottom", collision:"none"}, source:null, change:null, close:null, focus:null, open:null, response:null, search:null, select:null}, pending:0, _create:function() {
    var t, n, r;
    this.isMultiLine = this._isMultiLine(), this.valueMethod = this.element[this.element.is("input,textarea") ? "val" : "text"], this.isNewMenu = !0, this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"), this._on(this.element, {keydown:function(i) {
      if(this.element.prop("readOnly")) {
        t = !0, r = !0, n = !0;
        return
      }
      t = !1, r = !1, n = !1;
      var s = e.ui.keyCode;
      switch(i.keyCode) {
        case s.PAGE_UP:
          t = !0, this._move("previousPage", i);
          break;
        case s.PAGE_DOWN:
          t = !0, this._move("nextPage", i);
          break;
        case s.UP:
          t = !0, this._keyEvent("previous", i);
          break;
        case s.DOWN:
          t = !0, this._keyEvent("next", i);
          break;
        case s.ENTER:
        ;
        case s.NUMPAD_ENTER:
          this.menu.active && (t = !0, i.preventDefault(), this.menu.select(i));
          break;
        case s.TAB:
          this.menu.active && this.menu.select(i);
          break;
        case s.ESCAPE:
          this.menu.element.is(":visible") && (this._value(this.term), this.close(i), i.preventDefault());
          break;
        default:
          n = !0, this._searchTimeout(i)
      }
    }, keypress:function(r) {
      if(t) {
        t = !1, r.preventDefault();
        return
      }
      if(n) {
        return
      }
      var i = e.ui.keyCode;
      switch(r.keyCode) {
        case i.PAGE_UP:
          this._move("previousPage", r);
          break;
        case i.PAGE_DOWN:
          this._move("nextPage", r);
          break;
        case i.UP:
          this._keyEvent("previous", r);
          break;
        case i.DOWN:
          this._keyEvent("next", r)
      }
    }, input:function(e) {
      if(r) {
        r = !1, e.preventDefault();
        return
      }
      this._searchTimeout(e)
    }, focus:function() {
      this.selectedItem = null, this.previous = this._value()
    }, blur:function(e) {
      if(this.cancelBlur) {
        delete this.cancelBlur;
        return
      }
      clearTimeout(this.searching), this.close(e), this._change(e)
    }}), this._initSource(), this.menu = e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo || "body")[0]).menu({input:e(), role:null}).zIndex(this.element.zIndex() + 1).hide().data("menu"), this._on(this.menu.element, {mousedown:function(t) {
      t.preventDefault(), this.cancelBlur = !0, this._delay(function() {
        delete this.cancelBlur
      });
      var n = this.menu.element[0];
      e(t.target).closest(".ui-menu-item").length || this._delay(function() {
        var t = this;
        this.document.one("mousedown", function(r) {
          r.target !== t.element[0] && (r.target !== n && (!e.contains(n, r.target) && t.close()))
        })
      })
    }, menufocus:function(t, n) {
      if(this.isNewMenu) {
        this.isNewMenu = !1;
        if(t.originalEvent && /^mouse/.test(t.originalEvent.type)) {
          this.menu.blur(), this.document.one("mousemove", function() {
            e(t.target).trigger(t.originalEvent)
          });
          return
        }
      }
      var r = n.item.data("ui-autocomplete-item") || n.item.data("item.autocomplete");
      !1 !== this._trigger("focus", t, {item:r}) ? t.originalEvent && (/^key/.test(t.originalEvent.type) && this._value(r.value)) : this.liveRegion.text(r.value)
    }, menuselect:function(e, t) {
      var n = t.item.data("ui-autocomplete-item") || t.item.data("item.autocomplete"), r = this.previous;
      this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function() {
        this.previous = r, this.selectedItem = n
      })), !1 !== this._trigger("select", e, {item:n}) && this._value(n.value), this.term = this._value(), this.close(e), this.selectedItem = n
    }}), this.liveRegion = e("<span>", {role:"status", "aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element), e.fn.bgiframe && this.menu.element.bgiframe(), this._on(this.window, {beforeunload:function() {
      this.element.removeAttr("autocomplete")
    }})
  }, _destroy:function() {
    clearTimeout(this.searching), this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"), this.menu.element.remove(), this.liveRegion.remove()
  }, _setOption:function(e, t) {
    this._super(e, t), e === "source" && this._initSource(), e === "appendTo" && this.menu.element.appendTo(this.document.find(t || "body")[0]), e === "disabled" && (t && (this.xhr && this.xhr.abort()))
  }, _isMultiLine:function() {
    return this.element.is("textarea") ? !0 : this.element.is("input") ? !1 : this.element.prop("isContentEditable")
  }, _initSource:function() {
    var t, n, r = this;
    e.isArray(this.options.source) ? (t = this.options.source, this.source = function(n, r) {
      r(e.ui.autocomplete.filter(t, n.term))
    }) : typeof this.options.source == "string" ? (n = this.options.source, this.source = function(t, i) {
      r.xhr && r.xhr.abort(), r.xhr = e.ajax({url:n, data:t, dataType:"json", success:function(e) {
        i(e)
      }, error:function() {
        i([])
      }})
    }) : this.source = this.options.source
  }, _searchTimeout:function(e) {
    clearTimeout(this.searching), this.searching = this._delay(function() {
      this.term !== this._value() && (this.selectedItem = null, this.search(null, e))
    }, this.options.delay)
  }, search:function(e, t) {
    e = e != null ? e : this._value(), this.term = this._value();
    if(e.length < this.options.minLength) {
      return this.close(t)
    }
    if(this._trigger("search", t) === !1) {
      return
    }
    return this._search(e)
  }, _search:function(e) {
    this.pending++, this.element.addClass("ui-autocomplete-loading"), this.cancelSearch = !1, this.source({term:e}, this._response())
  }, _response:function() {
    var e = this, t = ++n;
    return function(r) {
      t === n && e.__response(r), e.pending--, e.pending || e.element.removeClass("ui-autocomplete-loading")
    }
  }, __response:function(e) {
    e && (e = this._normalize(e)), this._trigger("response", null, {content:e}), !this.options.disabled && (e && (e.length && !this.cancelSearch)) ? (this._suggest(e), this._trigger("open")) : this._close()
  }, close:function(e) {
    this.cancelSearch = !0, this._close(e)
  }, _close:function(e) {
    this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", e))
  }, _change:function(e) {
    this.previous !== this._value() && this._trigger("change", e, {item:this.selectedItem})
  }, _normalize:function(t) {
    return t.length && (t[0].label && t[0].value) ? t : e.map(t, function(t) {
      return typeof t == "string" ? {label:t, value:t} : e.extend({label:t.label || t.value, value:t.value || t.label}, t)
    })
  }, _suggest:function(t) {
    var n = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
    this._renderMenu(n, t), this.menu.refresh(), n.show(), this._resizeMenu(), n.position(e.extend({of:this.element}, this.options.position)), this.options.autoFocus && this.menu.next()
  }, _resizeMenu:function() {
    var e = this.menu.element;
    e.outerWidth(Math.max(e.width("").outerWidth() + 1, this.element.outerWidth()))
  }, _renderMenu:function(t, n) {
    var r = this;
    e.each(n, function(e, n) {
      r._renderItemData(t, n)
    })
  }, _renderItemData:function(e, t) {
    return this._renderItem(e, t).data("ui-autocomplete-item", t)
  }, _renderItem:function(t, n) {
    return e("<li>").append(e("<a>").text(n.label)).appendTo(t)
  }, _move:function(e, t) {
    if(!this.menu.element.is(":visible")) {
      this.search(null, t);
      return
    }
    if(this.menu.isFirstItem() && /^previous/.test(e) || this.menu.isLastItem() && /^next/.test(e)) {
      this._value(this.term), this.menu.blur();
      return
    }
    this.menu[e](t)
  }, widget:function() {
    return this.menu.element
  }, _value:function() {
    return this.valueMethod.apply(this.element, arguments)
  }, _keyEvent:function(e, t) {
    if(!this.isMultiLine || this.menu.element.is(":visible")) {
      this._move(e, t), t.preventDefault()
    }
  }}), e.extend(e.ui.autocomplete, {escapeRegex:function(e) {
    return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
  }, filter:function(t, n) {
    var r = new RegExp(e.ui.autocomplete.escapeRegex(n), "i");
    return e.grep(t, function(e) {
      return r.test(e.label || (e.value || e))
    })
  }}), e.widget("ui.autocomplete", e.ui.autocomplete, {options:{messages:{noResults:"No search results.", results:function(e) {
    return e + (e > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate."
  }}}, __response:function(e) {
    var t;
    this._superApply(arguments);
    if(this.options.disabled || this.cancelSearch) {
      return
    }
    e && e.length ? t = this.options.messages.results(e.length) : t = this.options.messages.noResults, this.liveRegion.text(t)
  }})
})(jQuery);
(function(e, t) {
  var n = !1;
  e.widget("ui.menu", {version:"1.9.2", defaultElement:"<ul>", delay:300, options:{icons:{submenu:"ui-icon-carat-1-e"}, menus:"ul", position:{my:"left top", at:"right top"}, role:"menu", blur:null, focus:null, select:null}, _create:function() {
    this.activeMenu = this.element, this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({role:this.options.role, tabIndex:0}).bind("click" + this.eventNamespace, e.proxy(function(e) {
      this.options.disabled && e.preventDefault()
    }, this)), this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"), this._on({"mousedown .ui-menu-item > a":function(e) {
      e.preventDefault()
    }, "click .ui-state-disabled > a":function(e) {
      e.preventDefault()
    }, "click .ui-menu-item:has(a)":function(t) {
      var r = e(t.target).closest(".ui-menu-item");
      !n && (r.not(".ui-state-disabled").length && (n = !0, this.select(t), r.has(".ui-menu").length ? this.expand(t) : this.element.is(":focus") || (this.element.trigger("focus", [!0]), this.active && (this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer)))))
    }, "mouseenter .ui-menu-item":function(t) {
      var n = e(t.currentTarget);
      n.siblings().children(".ui-state-active").removeClass("ui-state-active"), this.focus(t, n)
    }, mouseleave:"collapseAll", "mouseleave .ui-menu":"collapseAll", focus:function(e, t) {
      var n = this.active || this.element.children(".ui-menu-item").eq(0);
      t || this.focus(e, n)
    }, blur:function(t) {
      this._delay(function() {
        e.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t)
      })
    }, keydown:"_keydown"}), this.refresh(), this._on(this.document, {click:function(t) {
      e(t.target).closest(".ui-menu").length || this.collapseAll(t), n = !1
    }})
  }, _destroy:function() {
    this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(), this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function() {
      var t = e(this);
      t.data("ui-menu-submenu-carat") && t.remove()
    }), this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")
  }, _keydown:function(t) {
    function a(e) {
      return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&")
    }
    var n, r, i, s, o, u = !0;
    switch(t.keyCode) {
      case e.ui.keyCode.PAGE_UP:
        this.previousPage(t);
        break;
      case e.ui.keyCode.PAGE_DOWN:
        this.nextPage(t);
        break;
      case e.ui.keyCode.HOME:
        this._move("first", "first", t);
        break;
      case e.ui.keyCode.END:
        this._move("last", "last", t);
        break;
      case e.ui.keyCode.UP:
        this.previous(t);
        break;
      case e.ui.keyCode.DOWN:
        this.next(t);
        break;
      case e.ui.keyCode.LEFT:
        this.collapse(t);
        break;
      case e.ui.keyCode.RIGHT:
        this.active && (!this.active.is(".ui-state-disabled") && this.expand(t));
        break;
      case e.ui.keyCode.ENTER:
      ;
      case e.ui.keyCode.SPACE:
        this._activate(t);
        break;
      case e.ui.keyCode.ESCAPE:
        this.collapse(t);
        break;
      default:
        u = !1, r = this.previousFilter || "", i = String.fromCharCode(t.keyCode), s = !1, clearTimeout(this.filterTimer), i === r ? s = !0 : i = r + i, o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
          return o.test(e(this).children("a").text())
        }), n = s && n.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : n, n.length || (i = String.fromCharCode(t.keyCode), o = new RegExp("^" + a(i), "i"), n = this.activeMenu.children(".ui-menu-item").filter(function() {
          return o.test(e(this).children("a").text())
        })), n.length ? (this.focus(t, n), n.length > 1 ? (this.previousFilter = i, this.filterTimer = this._delay(function() {
          delete this.previousFilter
        }, 1E3)) : delete this.previousFilter) : delete this.previousFilter
    }
    u && t.preventDefault()
  }, _activate:function(e) {
    this.active.is(".ui-state-disabled") || (this.active.children("a[aria-haspopup='true']").length ? this.expand(e) : this.select(e))
  }, refresh:function() {
    var t, n = this.options.icons.submenu, r = this.element.find(this.options.menus);
    r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role, "aria-hidden":"true", "aria-expanded":"false"}).each(function() {
      var t = e(this), r = t.prev("a"), i = e("<span>").addClass("ui-menu-icon ui-icon " + n).data("ui-menu-submenu-carat", !0);
      r.attr("aria-haspopup", "true").prepend(i), t.attr("aria-labelledby", r.attr("id"))
    }), t = r.add(this.element), t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1, role:this._itemRole()}), t.children(":not(.ui-menu-item)").each(function() {
      var t = e(this);
      /[^\-\u2014\u2013\s]/.test(t.text()) || t.addClass("ui-widget-content ui-menu-divider")
    }), t.children(".ui-state-disabled").attr("aria-disabled", "true"), this.active && (!e.contains(this.element[0], this.active[0]) && this.blur())
  }, _itemRole:function() {
    return{menu:"menuitem", listbox:"option"}[this.options.role]
  }, focus:function(e, t) {
    var n, r;
    this.blur(e, e && e.type === "focus"), this._scrollIntoView(t), this.active = t.first(), r = this.active.children("a").addClass("ui-state-focus"), this.options.role && this.element.attr("aria-activedescendant", r.attr("id")), this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"), e && e.type === "keydown" ? this._close() : this.timer = this._delay(function() {
      this._close()
    }, this.delay), n = t.children(".ui-menu"), n.length && (/^mouse/.test(e.type) && this._startOpening(n)), this.activeMenu = t.parent(), this._trigger("focus", e, {item:t})
  }, _scrollIntoView:function(t) {
    var n, r, i, s, o, u;
    this._hasScroll() && (n = parseFloat(e.css(this.activeMenu[0], "borderTopWidth")) || 0, r = parseFloat(e.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - n - r, s = this.activeMenu.scrollTop(), o = this.activeMenu.height(), u = t.height(), i < 0 ? this.activeMenu.scrollTop(s + i) : i + u > o && this.activeMenu.scrollTop(s + i - o + u))
  }, blur:function(e, t) {
    t || clearTimeout(this.timer);
    if(!this.active) {
      return
    }
    this.active.children("a").removeClass("ui-state-focus"), this.active = null, this._trigger("blur", e, {item:this.active})
  }, _startOpening:function(e) {
    clearTimeout(this.timer);
    if(e.attr("aria-hidden") !== "true") {
      return
    }
    this.timer = this._delay(function() {
      this._close(), this._open(e)
    }, this.delay)
  }, _open:function(t) {
    var n = e.extend({of:this.active}, this.options.position);
    clearTimeout(this.timer), this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"), t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(n)
  }, collapseAll:function(t, n) {
    clearTimeout(this.timer), this.timer = this._delay(function() {
      var r = n ? this.element : e(t && t.target).closest(this.element.find(".ui-menu"));
      r.length || (r = this.element), this._close(r), this.blur(t), this.activeMenu = r
    }, this.delay)
  }, _close:function(e) {
    e || (e = this.active ? this.active.parent() : this.element), e.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find("a.ui-state-active").removeClass("ui-state-active")
  }, collapse:function(e) {
    var t = this.active && this.active.parent().closest(".ui-menu-item", this.element);
    t && (t.length && (this._close(), this.focus(e, t)))
  }, expand:function(e) {
    var t = this.active && this.active.children(".ui-menu ").children(".ui-menu-item").first();
    t && (t.length && (this._open(t.parent()), this._delay(function() {
      this.focus(e, t)
    })))
  }, next:function(e) {
    this._move("next", "first", e)
  }, previous:function(e) {
    this._move("prev", "last", e)
  }, isFirstItem:function() {
    return this.active && !this.active.prevAll(".ui-menu-item").length
  }, isLastItem:function() {
    return this.active && !this.active.nextAll(".ui-menu-item").length
  }, _move:function(e, t, n) {
    var r;
    this.active && (e === "first" || e === "last" ? r = this.active[e === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : r = this.active[e + "All"](".ui-menu-item").eq(0));
    if(!r || (!r.length || !this.active)) {
      r = this.activeMenu.children(".ui-menu-item")[t]()
    }
    this.focus(n, r)
  }, nextPage:function(t) {
    var n, r, i;
    if(!this.active) {
      this.next(t);
      return
    }
    if(this.isLastItem()) {
      return
    }
    this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.nextAll(".ui-menu-item").each(function() {
      return n = e(this), n.offset().top - r - i < 0
    }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item")[this.active ? "last" : "first"]())
  }, previousPage:function(t) {
    var n, r, i;
    if(!this.active) {
      this.next(t);
      return
    }
    if(this.isFirstItem()) {
      return
    }
    this._hasScroll() ? (r = this.active.offset().top, i = this.element.height(), this.active.prevAll(".ui-menu-item").each(function() {
      return n = e(this), n.offset().top - r + i > 0
    }), this.focus(t, n)) : this.focus(t, this.activeMenu.children(".ui-menu-item").first())
  }, _hasScroll:function() {
    return this.element.outerHeight() < this.element.prop("scrollHeight")
  }, select:function(t) {
    this.active = this.active || e(t.target).closest(".ui-menu-item");
    var n = {item:this.active};
    this.active.has(".ui-menu").length || this.collapseAll(t, !0), this._trigger("select", t, n)
  }})
})(jQuery);
(function(e, t) {
  var n = 5;
  e.widget("ui.slider", e.ui.mouse, {version:"1.9.2", widgetEventPrefix:"slide", options:{animate:!1, distance:0, max:100, min:0, orientation:"horizontal", range:!1, step:1, value:0, values:null}, _create:function() {
    var t, r, i = this.options, s = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"), o = "<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>", u = [];
    this._keySliding = !1, this._mouseSliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget" + " ui-widget-content" + " ui-corner-all" + (i.disabled ? " ui-slider-disabled ui-disabled" : "")), this.range = e([]), i.range && (i.range === !0 && (i.values || (i.values = [this._valueMin(), this._valueMin()]), i.values.length && (i.values.length !== 2 && (i.values = [i.values[0], 
    i.values[0]]))), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + (i.range === "min" || i.range === "max" ? " ui-slider-range-" + i.range : ""))), r = i.values && i.values.length || 1;
    for(t = s.length;t < r;t++) {
      u.push(o)
    }
    this.handles = s.add(e(u.join("")).appendTo(this.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function(e) {
      e.preventDefault()
    }).mouseenter(function() {
      i.disabled || e(this).addClass("ui-state-hover")
    }).mouseleave(function() {
      e(this).removeClass("ui-state-hover")
    }).focus(function() {
      i.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"))
    }).blur(function() {
      e(this).removeClass("ui-state-focus")
    }), this.handles.each(function(t) {
      e(this).data("ui-slider-handle-index", t)
    }), this._on(this.handles, {keydown:function(t) {
      var r, i, s, o, u = e(t.target).data("ui-slider-handle-index");
      switch(t.keyCode) {
        case e.ui.keyCode.HOME:
        ;
        case e.ui.keyCode.END:
        ;
        case e.ui.keyCode.PAGE_UP:
        ;
        case e.ui.keyCode.PAGE_DOWN:
        ;
        case e.ui.keyCode.UP:
        ;
        case e.ui.keyCode.RIGHT:
        ;
        case e.ui.keyCode.DOWN:
        ;
        case e.ui.keyCode.LEFT:
          t.preventDefault();
          if(!this._keySliding) {
            this._keySliding = !0, e(t.target).addClass("ui-state-active"), r = this._start(t, u);
            if(r === !1) {
              return
            }
          }
      }
      o = this.options.step, this.options.values && this.options.values.length ? i = s = this.values(u) : i = s = this.value();
      switch(t.keyCode) {
        case e.ui.keyCode.HOME:
          s = this._valueMin();
          break;
        case e.ui.keyCode.END:
          s = this._valueMax();
          break;
        case e.ui.keyCode.PAGE_UP:
          s = this._trimAlignValue(i + (this._valueMax() - this._valueMin()) / n);
          break;
        case e.ui.keyCode.PAGE_DOWN:
          s = this._trimAlignValue(i - (this._valueMax() - this._valueMin()) / n);
          break;
        case e.ui.keyCode.UP:
        ;
        case e.ui.keyCode.RIGHT:
          if(i === this._valueMax()) {
            return
          }
          s = this._trimAlignValue(i + o);
          break;
        case e.ui.keyCode.DOWN:
        ;
        case e.ui.keyCode.LEFT:
          if(i === this._valueMin()) {
            return
          }
          s = this._trimAlignValue(i - o)
      }
      this._slide(t, u, s)
    }, keyup:function(t) {
      var n = e(t.target).data("ui-slider-handle-index");
      this._keySliding && (this._keySliding = !1, this._stop(t, n), this._change(t, n), e(t.target).removeClass("ui-state-active"))
    }}), this._refreshValue(), this._animateOff = !1
  }, _destroy:function() {
    this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"), this._mouseDestroy()
  }, _mouseCapture:function(t) {
    var n, r, i, s, o, u, a, f, l = this, c = this.options;
    return c.disabled ? !1 : (this.elementSize = {width:this.element.outerWidth(), height:this.element.outerHeight()}, this.elementOffset = this.element.offset(), n = {x:t.pageX, y:t.pageY}, r = this._normValueFromMouse(n), i = this._valueMax() - this._valueMin() + 1, this.handles.each(function(t) {
      var n = Math.abs(r - l.values(t));
      i > n && (i = n, s = e(this), o = t)
    }), c.range === !0 && (this.values(1) === c.min && (o += 1, s = e(this.handles[o]))), u = this._start(t, o), u === !1 ? !1 : (this._mouseSliding = !0, this._handleIndex = o, s.addClass("ui-state-active").focus(), a = s.offset(), f = !e(t.target).parents().andSelf().is(".ui-slider-handle"), this._clickOffset = f ? {left:0, top:0} : {left:t.pageX - a.left - s.width() / 2, top:t.pageY - a.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 
    10) || 0) + (parseInt(s.css("marginTop"), 10) || 0)}, this.handles.hasClass("ui-state-hover") || this._slide(t, o, r), this._animateOff = !0, !0))
  }, _mouseStart:function() {
    return!0
  }, _mouseDrag:function(e) {
    var t = {x:e.pageX, y:e.pageY}, n = this._normValueFromMouse(t);
    return this._slide(e, this._handleIndex, n), !1
  }, _mouseStop:function(e) {
    return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._handleIndex = null, this._clickOffset = null, this._animateOff = !1, !1
  }, _detectOrientation:function() {
    this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal"
  }, _normValueFromMouse:function(e) {
    var t, n, r, i, s;
    return this.orientation === "horizontal" ? (t = this.elementSize.width, n = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, n = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), r = n / t, r > 1 && (r = 1), r < 0 && (r = 0), this.orientation === "vertical" && (r = 1 - r), i = this._valueMax() - this._valueMin(), s = this._valueMin() + r * i, this._trimAlignValue(s)
  }, _start:function(e, t) {
    var n = {handle:this.handles[t], value:this.value()};
    return this.options.values && (this.options.values.length && (n.value = this.values(t), n.values = this.values())), this._trigger("start", e, n)
  }, _slide:function(e, t, n) {
    var r, i, s;
    this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), this.options.values.length === 2 && (this.options.range === !0 && ((t === 0 && n > r || t === 1 && n < r) && (n = r))), n !== this.values(t) && (i = this.values(), i[t] = n, s = this._trigger("slide", e, {handle:this.handles[t], value:n, values:i}), r = this.values(t ? 0 : 1), s !== !1 && this.values(t, n, !0))) : n !== this.value() && (s = this._trigger("slide", e, {handle:this.handles[t], value:n}), s !== !1 && 
    this.value(n))
  }, _stop:function(e, t) {
    var n = {handle:this.handles[t], value:this.value()};
    this.options.values && (this.options.values.length && (n.value = this.values(t), n.values = this.values())), this._trigger("stop", e, n)
  }, _change:function(e, t) {
    if(!this._keySliding && !this._mouseSliding) {
      var n = {handle:this.handles[t], value:this.value()};
      this.options.values && (this.options.values.length && (n.value = this.values(t), n.values = this.values())), this._trigger("change", e, n)
    }
  }, value:function(e) {
    if(arguments.length) {
      this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0);
      return
    }
    return this._value()
  }, values:function(t, n) {
    var r, i, s;
    if(arguments.length > 1) {
      this.options.values[t] = this._trimAlignValue(n), this._refreshValue(), this._change(null, t);
      return
    }
    if(!arguments.length) {
      return this._values()
    }
    if(!e.isArray(arguments[0])) {
      return this.options.values && this.options.values.length ? this._values(t) : this.value()
    }
    r = this.options.values, i = arguments[0];
    for(s = 0;s < r.length;s += 1) {
      r[s] = this._trimAlignValue(i[s]), this._change(null, s)
    }
    this._refreshValue()
  }, _setOption:function(t, n) {
    var r, i = 0;
    e.isArray(this.options.values) && (i = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments);
    switch(t) {
      case "disabled":
        n ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.prop("disabled", !0), this.element.addClass("ui-disabled")) : (this.handles.prop("disabled", !1), this.element.removeClass("ui-disabled"));
        break;
      case "orientation":
        this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
        break;
      case "value":
        this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
        break;
      case "values":
        this._animateOff = !0, this._refreshValue();
        for(r = 0;r < i;r += 1) {
          this._change(null, r)
        }
        this._animateOff = !1;
        break;
      case "min":
      ;
      case "max":
        this._animateOff = !0, this._refreshValue(), this._animateOff = !1
    }
  }, _value:function() {
    var e = this.options.value;
    return e = this._trimAlignValue(e), e
  }, _values:function(e) {
    var t, n, r;
    if(arguments.length) {
      return t = this.options.values[e], t = this._trimAlignValue(t), t
    }
    n = this.options.values.slice();
    for(r = 0;r < n.length;r += 1) {
      n[r] = this._trimAlignValue(n[r])
    }
    return n
  }, _trimAlignValue:function(e) {
    if(e <= this._valueMin()) {
      return this._valueMin()
    }
    if(e >= this._valueMax()) {
      return this._valueMax()
    }
    var t = this.options.step > 0 ? this.options.step : 1, n = (e - this._valueMin()) % t, r = e - n;
    return Math.abs(n) * 2 >= t && (r += n > 0 ? t : -t), parseFloat(r.toFixed(5))
  }, _valueMin:function() {
    return this.options.min
  }, _valueMax:function() {
    return this.options.max
  }, _refreshValue:function() {
    var t, n, r, i, s, o = this.options.range, u = this.options, a = this, f = this._animateOff ? !1 : u.animate, l = {};
    this.options.values && this.options.values.length ? this.handles.each(function(r) {
      n = (a.values(r) - a._valueMin()) / (a._valueMax() - a._valueMin()) * 100, l[a.orientation === "horizontal" ? "left" : "bottom"] = n + "%", e(this).stop(1, 1)[f ? "animate" : "css"](l, u.animate), a.options.range === !0 && (a.orientation === "horizontal" ? (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({left:n + "%"}, u.animate), r === 1 && a.range[f ? "animate" : "css"]({width:n - t + "%"}, {queue:!1, duration:u.animate})) : (r === 0 && a.range.stop(1, 1)[f ? "animate" : "css"]({bottom:n + 
      "%"}, u.animate), r === 1 && a.range[f ? "animate" : "css"]({height:n - t + "%"}, {queue:!1, duration:u.animate}))), t = n
    }) : (r = this.value(), i = this._valueMin(), s = this._valueMax(), n = s !== i ? (r - i) / (s - i) * 100 : 0, l[this.orientation === "horizontal" ? "left" : "bottom"] = n + "%", this.handle.stop(1, 1)[f ? "animate" : "css"](l, u.animate), o === "min" && (this.orientation === "horizontal" && this.range.stop(1, 1)[f ? "animate" : "css"]({width:n + "%"}, u.animate)), o === "max" && (this.orientation === "horizontal" && this.range[f ? "animate" : "css"]({width:100 - n + "%"}, {queue:!1, duration:u.animate})), 
    o === "min" && (this.orientation === "vertical" && this.range.stop(1, 1)[f ? "animate" : "css"]({height:n + "%"}, u.animate)), o === "max" && (this.orientation === "vertical" && this.range[f ? "animate" : "css"]({height:100 - n + "%"}, {queue:!1, duration:u.animate})))
  }})
})(jQuery);
(function(d) {
  function g(a) {
    var b = a || window.event, i = [].slice.call(arguments, 1), c = 0, h = 0, e = 0;
    a = d.event.fix(b);
    a.type = "mousewheel";
    if(a.wheelDelta) {
      c = a.wheelDelta / 120
    }
    if(a.detail) {
      c = -a.detail / 3
    }
    e = c;
    if(b.axis !== undefined && b.axis === b.HORIZONTAL_AXIS) {
      e = 0;
      h = -1 * c
    }
    if(b.wheelDeltaY !== undefined) {
      e = b.wheelDeltaY / 120
    }
    if(b.wheelDeltaX !== undefined) {
      h = -1 * b.wheelDeltaX / 120
    }
    i.unshift(a, c, h, e);
    return d.event.handle.apply(this, i)
  }
  var f = ["DOMMouseScroll", "mousewheel"];
  d.event.special.mousewheel = {setup:function() {
    if(this.addEventListener) {
      for(var a = f.length;a;) {
        this.addEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = g
    }
  }, teardown:function() {
    if(this.removeEventListener) {
      for(var a = f.length;a;) {
        this.removeEventListener(f[--a], g, false)
      }
    }else {
      this.onmousewheel = null
    }
  }};
  d.fn.extend({mousewheel:function(a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel:function(a) {
    return this.unbind("mousewheel", a)
  }})
})(jQuery);
window.Chart = function(context, options) {
  var chart = this;
  var animationOptions = {linear:function(t) {
    return t
  }, easeInQuad:function(t) {
    return t * t
  }, easeOutQuad:function(t) {
    return-1 * t * (t - 2)
  }, easeInOutQuad:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t
    }
    return-1 / 2 * (--t * (t - 2) - 1)
  }, easeInCubic:function(t) {
    return t * t * t
  }, easeOutCubic:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t + 1)
  }, easeInOutCubic:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t + 2)
  }, easeInQuart:function(t) {
    return t * t * t * t
  }, easeOutQuart:function(t) {
    return-1 * ((t = t / 1 - 1) * t * t * t - 1)
  }, easeInOutQuart:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t
    }
    return-1 / 2 * ((t -= 2) * t * t * t - 2)
  }, easeInQuint:function(t) {
    return 1 * (t /= 1) * t * t * t * t
  }, easeOutQuint:function(t) {
    return 1 * ((t = t / 1 - 1) * t * t * t * t + 1)
  }, easeInOutQuint:function(t) {
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * t * t * t * t * t
    }
    return 1 / 2 * ((t -= 2) * t * t * t * t + 2)
  }, easeInSine:function(t) {
    return-1 * Math.cos(t / 1 * (Math.PI / 2)) + 1
  }, easeOutSine:function(t) {
    return 1 * Math.sin(t / 1 * (Math.PI / 2))
  }, easeInOutSine:function(t) {
    return-1 / 2 * (Math.cos(Math.PI * t / 1) - 1)
  }, easeInExpo:function(t) {
    return t == 0 ? 1 : 1 * Math.pow(2, 10 * (t / 1 - 1))
  }, easeOutExpo:function(t) {
    return t == 1 ? 1 : 1 * (-Math.pow(2, -10 * t / 1) + 1)
  }, easeInOutExpo:function(t) {
    if(t == 0) {
      return 0
    }
    if(t == 1) {
      return 1
    }
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * Math.pow(2, 10 * (t - 1))
    }
    return 1 / 2 * (-Math.pow(2, -10 * --t) + 2)
  }, easeInCirc:function(t) {
    if(t >= 1) {
      return t
    }
    return-1 * (Math.sqrt(1 - (t /= 1) * t) - 1)
  }, easeOutCirc:function(t) {
    return 1 * Math.sqrt(1 - (t = t / 1 - 1) * t)
  }, easeInOutCirc:function(t) {
    if((t /= 1 / 2) < 1) {
      return-1 / 2 * (Math.sqrt(1 - t * t) - 1)
    }
    return 1 / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1)
  }, easeInElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return-(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p))
  }, easeOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1) == 1) {
      return 1
    }
    if(!p) {
      p = 1 * 0.3
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    return a * Math.pow(2, -10 * t) * Math.sin((t * 1 - s) * (2 * Math.PI) / p) + 1
  }, easeInOutElastic:function(t) {
    var s = 1.70158;
    var p = 0;
    var a = 1;
    if(t == 0) {
      return 0
    }
    if((t /= 1 / 2) == 2) {
      return 1
    }
    if(!p) {
      p = 1 * (0.3 * 1.5)
    }
    if(a < Math.abs(1)) {
      a = 1;
      var s = p / 4
    }else {
      var s = p / (2 * Math.PI) * Math.asin(1 / a)
    }
    if(t < 1) {
      return-0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p))
    }
    return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * 1 - s) * (2 * Math.PI) / p) * 0.5 + 1
  }, easeInBack:function(t) {
    var s = 1.70158;
    return 1 * (t /= 1) * t * ((s + 1) * t - s)
  }, easeOutBack:function(t) {
    var s = 1.70158;
    return 1 * ((t = t / 1 - 1) * t * ((s + 1) * t + s) + 1)
  }, easeInOutBack:function(t) {
    var s = 1.70158;
    if((t /= 1 / 2) < 1) {
      return 1 / 2 * (t * t * (((s *= 1.525) + 1) * t - s))
    }
    return 1 / 2 * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2)
  }, easeInBounce:function(t) {
    return 1 - animationOptions.easeOutBounce(1 - t)
  }, easeOutBounce:function(t) {
    if((t /= 1) < 1 / 2.75) {
      return 1 * (7.5625 * t * t)
    }else {
      if(t < 2 / 2.75) {
        return 1 * (7.5625 * (t -= 1.5 / 2.75) * t + 0.75)
      }else {
        if(t < 2.5 / 2.75) {
          return 1 * (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375)
        }else {
          return 1 * (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375)
        }
      }
    }
  }, easeInOutBounce:function(t) {
    if(t < 1 / 2) {
      return animationOptions.easeInBounce(t * 2) * 0.5
    }
    return animationOptions.easeOutBounce(t * 2 - 1) * 0.5 + 1 * 0.5
  }};
  this.tooltips = [], defaults = {tooltips:{background:"rgba(0,0,0,0.6)", fontFamily:"'Arial'", fontStyle:"normal", fontColor:"white", fontSize:"12px", labelTemplate:"<%=label%>: <%=value%>", padding:{top:10, right:10, bottom:10, left:10}, offset:{left:0, top:0}, border:{width:0, color:"#000"}, showHighlight:true, highlight:{stroke:{width:1, color:"rgba(230,230,230,0.25)"}, fill:"rgba(255,255,255,0.25)"}}}, options = options ? mergeChartConfig(defaults, options) : defaults;
  function registerTooltip(ctx, areaObj, data, type) {
    chart.tooltips.push(new Tooltip(ctx, areaObj, data, type))
  }
  var Tooltip = function(ctx, areaObj, data, type) {
    this.ctx = ctx;
    this.areaObj = areaObj;
    this.data = data;
    this.savedState = null;
    this.highlightState = null;
    this.x = null;
    this.y = null;
    this.inRange = function(x, y) {
      if(this.areaObj.type) {
        switch(this.areaObj.type) {
          case "rect":
            return x >= this.areaObj.x && x <= this.areaObj.x + this.areaObj.width && (y >= this.areaObj.y && y <= this.areaObj.y + this.areaObj.height);
            break;
          case "circle":
            return Math.pow(x - this.areaObj.x, 2) + Math.pow(y - this.areaObj.y, 2) < Math.pow(this.areaObj.r, 2);
            break;
          case "shape":
            var poly = this.areaObj.points;
            for(var c = false, i = -1, l = poly.length, j = l - 1;++i < l;j = i) {
              (poly[i].y <= y && y < poly[j].y || poly[j].y <= y && y < poly[i].y) && (x < (poly[j].x - poly[i].x) * (y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x && (c = !c))
            }
            return c;
            break
        }
      }
    };
    this.render = function(x, y) {
      if(this.savedState == null) {
        this.ctx.putImageData(chart.savedState, 0, 0);
        this.savedState = this.ctx.getImageData(0, 0, this.ctx.canvas.width, this.ctx.canvas.height)
      }
      this.ctx.putImageData(this.savedState, 0, 0);
      if(options.tooltips.showHighlight) {
        if(this.highlightState == null) {
          this.ctx.strokeStyle = options.tooltips.highlight.stroke.color;
          this.ctx.lineWidth = options.tooltips.highlight.stroke.width;
          this.ctx.fillStyle = options.tooltips.highlight.fill;
          switch(this.areaObj.type) {
            case "rect":
              this.ctx.strokeRect(this.areaObj.x, this.areaObj.y, this.areaObj.width, this.areaObj.height);
              this.ctx.fillStyle = options.tooltips.highlight.fill;
              this.ctx.fillRect(this.areaObj.x, this.areaObj.y, this.areaObj.width, this.areaObj.height);
              break;
            case "circle":
              this.ctx.beginPath();
              this.ctx.arc(this.areaObj.x, this.areaObj.y, this.areaObj.r, 0, 2 * Math.PI, false);
              this.ctx.stroke();
              this.ctx.fill();
              break;
            case "shape":
              this.ctx.beginPath();
              this.ctx.moveTo(this.areaObj.points[0].x, this.areaObj.points[0].y);
              var aOpL = this.areaObj.points.length;
              for(var p = 0;p < aOpL;p++) {
                this.ctx.lineTo(this.areaObj.points[p].x, this.areaObj.points[p].y)
              }
              this.ctx.stroke();
              this.ctx.fill();
              break
          }
          this.highlightState = this.ctx.getImageData(0, 0, this.ctx.canvas.width, this.ctx.canvas.height)
        }else {
          this.ctx.putImageData(this.highlightState, 0, 0)
        }
      }
      var posX = x + options.tooltips.offset.left, posY = y + options.tooltips.offset.top, tpl = tmpl(options.tooltips.labelTemplate, this.data), rectWidth = options.tooltips.padding.left + this.ctx.measureText(tpl).width + options.tooltips.padding.right;
      if(posX + rectWidth > ctx.canvas.width) {
        posX -= posX - rectWidth < 0 ? posX : rectWidth
      }
      if(posY + 24 > ctx.canvas.height) {
        posY -= 24
      }
      this.ctx.fillStyle = options.tooltips.background;
      this.ctx.fillRect(posX, posY, rectWidth, 24);
      if(options.tooltips.border.width > 0) {
        this.ctx.fillStyle = options.tooltips.order.color;
        this.ctx.lineWidth = options.tooltips.border.width;
        this.ctx.strokeRect(posX, posY, rectWidth, 24)
      }
      this.ctx.font = options.tooltips.fontStyle + " " + options.tooltips.fontSize + " " + options.tooltips.fontFamily;
      this.ctx.fillStyle = options.tooltips.fontColor;
      this.ctx.textAlign = "center";
      this.ctx.textBaseline = "middle";
      this.ctx.fillText(tpl, posX + rectWidth / 2, posY + 12);
      this.x = x;
      this.y = y
    }
  };
  var width = context.canvas.width, height = context.canvas.height;
  this.savedState = null;
  function getPosition(e) {
    var xPosition = 0;
    var yPosition = 0;
    while(e) {
      xPosition += e.offsetLeft - e.scrollLeft + e.clientLeft;
      yPosition += e.offsetTop - e.scrollTop + e.clientTop;
      e = e.offsetParent
    }
    return{x:xPosition, y:yPosition}
  }
  function tooltipEventHandler(e) {
    if(chart.tooltips.length > 0) {
      chart.savedState = chart.savedState == null ? context.getImageData(0, 0, context.canvas.width, context.canvas.height) : chart.savedState;
      var rendered = 0;
      var cTL = chart.tooltips.length;
      for(var i = 0;i < cTL;i++) {
        var position = getPosition(context.canvas), mx = e.clientX - position.x, my = e.clientY - position.y;
        if(chart.tooltips[i].inRange(mx, my)) {
          chart.tooltips[i].render(mx, my);
          rendered++
        }
      }
      if(rendered == 0) {
        context.putImageData(chart.savedState, 0, 0)
      }
    }
  }
  context.canvas.onmousemove = function(e) {
    tooltipEventHandler(e)
  };
  context.canvas.onmouseout = function(e) {
    if(chart.savedState != null) {
      context.putImageData(chart.savedState, 0, 0)
    }
  };
  if(window.devicePixelRatio) {
    context.canvas.style.width = width + "px";
    context.canvas.style.height = height + "px";
    context.canvas.height = height * window.devicePixelRatio;
    context.canvas.width = width * window.devicePixelRatio;
    context.scale(window.devicePixelRatio, window.devicePixelRatio)
  }
  this.PolarArea = function(data, options) {
    chart.PolarArea.defaults = {scaleOverlay:true, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, segmentShowStroke:true, segmentStrokeColor:"#fff", 
    segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.PolarArea.defaults, options) : chart.PolarArea.defaults;
    return new PolarArea(data, config, context)
  };
  this.Radar = function(data, options) {
    chart.Radar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleShowLine:true, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:false, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowLabelBackdrop:true, scaleBackdropColor:"rgba(255,255,255,0.75)", scaleBackdropPaddingY:2, scaleBackdropPaddingX:2, angleShowLineOut:true, angleLineColor:"rgba(0,0,0,.1)", 
    angleLineWidth:1, pointLabelFontFamily:"'Arial'", pointLabelFontStyle:"normal", pointLabelFontSize:12, pointLabelFontColor:"#666", pointDot:true, pointDotRadius:3, pointDotStrokeWidth:1, datasetStroke:true, datasetStrokeWidth:2, datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Radar.defaults, options) : chart.Radar.defaults;
    return new Radar(data, config, context)
  };
  this.Pie = function(data, options) {
    chart.Pie.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, labelFontFamily:"'Arial'", labelFontStyle:"normal", labelFontSize:12, labelFontColor:"#666", labelAlign:"right", showTooltips:true};
    var config = options ? mergeChartConfig(chart.Pie.defaults, options) : chart.Pie.defaults;
    return new Pie(data, config, context)
  };
  this.Doughnut = function(data, options) {
    chart.Doughnut.defaults = {segmentShowStroke:true, segmentStrokeColor:"#fff", segmentStrokeWidth:2, percentageInnerCutout:50, animation:true, animationSteps:100, animationEasing:"easeOutBounce", animateRotate:true, animateScale:false, onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Doughnut.defaults, options) : chart.Doughnut.defaults;
    return new Doughnut(data, config, context)
  };
  this.Line = function(data, options) {
    chart.Line.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, bezierCurve:true, pointDot:true, pointDotRadius:4, pointDotStrokeWidth:2, datasetStroke:true, datasetStrokeWidth:2, 
    datasetFill:true, animation:true, animationSteps:60, animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Line.defaults, options) : chart.Line.defaults;
    return new Line(data, config, context)
  };
  this.Bar = function(data, options) {
    chart.Bar.defaults = {scaleOverlay:false, scaleOverride:false, scaleSteps:null, scaleStepWidth:null, scaleStartValue:null, scaleLineColor:"rgba(0,0,0,.1)", scaleLineWidth:1, scaleShowLabels:true, scaleLabel:"<%=value%>", scaleFontFamily:"'Arial'", scaleFontSize:12, scaleFontStyle:"normal", scaleFontColor:"#666", scaleShowGridLines:true, scaleGridLineColor:"rgba(0,0,0,.05)", scaleGridLineWidth:1, barShowStroke:true, barStrokeWidth:2, barValueSpacing:5, barDatasetSpacing:1, animation:true, animationSteps:60, 
    animationEasing:"easeOutQuart", onAnimationComplete:null, showTooltips:true};
    var config = options ? mergeChartConfig(chart.Bar.defaults, options) : chart.Bar.defaults;
    return new Bar(data, config, context)
  };
  var clear = function(c) {
    c.clearRect(0, 0, width, height)
  };
  var PolarArea = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllSegments, ctx);
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      maxSize -= Max([config.scaleFontSize * 0.5, config.scaleLineWidth * 0.5]);
      labelHeight = config.scaleFontSize * 2;
      if(config.scaleShowLabelBackdrop) {
        labelHeight += 2 * config.scaleBackdropPaddingY;
        maxSize -= config.scaleBackdropPaddingY * 1.5
      }
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function drawScale() {
      for(var i = 0;i < calculatedScale.steps;i++) {
        if(config.scaleShowLine) {
          ctx.beginPath();
          ctx.arc(width / 2, height / 2, scaleHop * (i + 1), 0, Math.PI * 2, true);
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          var label = calculatedScale.labels[i];
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(label).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(width / 2 - textWidth / 2 - config.scaleBackdropPaddingX), Math.round(height / 2 - scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.textBaseline = "middle";
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(label, width / 2, height / 2 - scaleHop * (i + 1))
        }
      }
    }
    function drawAllSegments(animationDecimal) {
      var startAngle = -Math.PI / 2, angleStep = Math.PI * 2 / data.length, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * calculateOffset(data[i].value, calculatedScale, scaleHop), startAngle, startAngle + rotateAnimation * angleStep, false);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [{x:width / 2, y:height / 2}], pAmount = 50, radius = calculateOffset(data[i].value, calculatedScale, scaleHop);
          points.push({x:width / 2 + radius * Math.cos(startAngle), y:height / 2 + radius * Math.sin(startAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + radius * Math.cos(startAngle + p / pAmount * rotateAnimation * angleStep), y:height / 2 + radius * Math.sin(startAngle + p / pAmount * rotateAnimation * angleStep)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].tooltipLabel}, "PolarArea")
        }
        if(config.segmentShowStroke) {
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.stroke()
        }
        startAngle += rotateAnimation * angleStep
      }
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.length;i++) {
        if(data[i].value > upperValue) {
          upperValue = data[i].value
        }
        if(data[i].value < lowerValue) {
          lowerValue = data[i].value
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Radar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString;
    if(!data.labels) {
      data.labels = []
    }
    calculateDrawingSizes();
    var valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : null;
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = maxSize / calculatedScale.steps;
    animationLoop(config, drawScale, drawAllDataPoints, ctx);
    function drawAllDataPoints(animationDecimal) {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      for(var i = 0;i < data.datasets.length;i++) {
        var offset = calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop);
        ctx.beginPath();
        ctx.moveTo(0, animationDecimal * (-1 * offset));
        if(animationDecimal >= 1 && config.showTooltips) {
          var curX = width / 2 + offset * Math.cos(0 - Math.PI / 2), curY = height / 2 + offset * Math.sin(0 - Math.PI / 2), pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10, ttData = data.labels[0].trim() != "" ? data.labels[0] + ": " + data.datasets[i].data[0] : data.datasets[i].data[0];
          registerTooltip(ctx, {type:"circle", x:curX, y:curY, r:pointRadius}, {label:data.labels[0], value:data.datasets[i].data[0]}, "Radar")
        }
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          offset = calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop);
          ctx.rotate(rotationDegree);
          ctx.lineTo(0, animationDecimal * (-1 * offset));
          if(animationDecimal >= 1 && config.showTooltips) {
            var curX = width / 2 + offset * Math.cos(j * rotationDegree - Math.PI / 2), curY = height / 2 + offset * Math.sin(j * rotationDegree - Math.PI / 2), pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10, ttData = data.labels[j].trim() != "" ? data.labels[j] + ": " + data.datasets[i].data[j] : data.datasets[i].data[j];
            registerTooltip(ctx, {type:"circle", x:curX, y:curY, r:pointRadius}, {label:data.labels[j], value:data.datasets[i].data[j]}, "Radar")
          }
        }
        ctx.closePath();
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.fill();
        ctx.stroke();
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.rotate(rotationDegree);
            ctx.beginPath();
            ctx.arc(0, animationDecimal * (-1 * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop)), config.pointDotRadius, 2 * Math.PI, false);
            ctx.fill();
            ctx.stroke()
          }
        }
        ctx.rotate(rotationDegree)
      }
      ctx.restore()
    }
    function drawScale() {
      var rotationDegree = 2 * Math.PI / data.datasets[0].data.length;
      ctx.save();
      ctx.translate(width / 2, height / 2);
      if(config.angleShowLineOut) {
        ctx.strokeStyle = config.angleLineColor;
        ctx.lineWidth = config.angleLineWidth;
        for(var h = 0;h < data.datasets[0].data.length;h++) {
          ctx.rotate(rotationDegree);
          ctx.beginPath();
          ctx.moveTo(0, 0);
          ctx.lineTo(0, -maxSize);
          ctx.stroke()
        }
      }
      for(var i = 0;i < calculatedScale.steps;i++) {
        ctx.beginPath();
        if(config.scaleShowLine) {
          ctx.strokeStyle = config.scaleLineColor;
          ctx.lineWidth = config.scaleLineWidth;
          ctx.moveTo(0, -scaleHop * (i + 1));
          for(var j = 0;j < data.datasets[0].data.length;j++) {
            ctx.rotate(rotationDegree);
            ctx.lineTo(0, -scaleHop * (i + 1))
          }
          ctx.closePath();
          ctx.stroke()
        }
        if(config.scaleShowLabels) {
          ctx.textAlign = "center";
          ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
          ctx.textBaseline = "middle";
          if(config.scaleShowLabelBackdrop) {
            var textWidth = ctx.measureText(calculatedScale.labels[i]).width;
            ctx.fillStyle = config.scaleBackdropColor;
            ctx.beginPath();
            ctx.rect(Math.round(-textWidth / 2 - config.scaleBackdropPaddingX), Math.round(-scaleHop * (i + 1) - config.scaleFontSize * 0.5 - config.scaleBackdropPaddingY), Math.round(textWidth + config.scaleBackdropPaddingX * 2), Math.round(config.scaleFontSize + config.scaleBackdropPaddingY * 2));
            ctx.fill()
          }
          ctx.fillStyle = config.scaleFontColor;
          ctx.fillText(calculatedScale.labels[i], 0, -scaleHop * (i + 1))
        }
      }
      for(var k = 0;k < data.labels.length;k++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        ctx.fillStyle = config.pointLabelFontColor;
        var opposite = Math.sin(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        var adjacent = Math.cos(rotationDegree * k) * (maxSize + config.pointLabelFontSize);
        if(rotationDegree * k == Math.PI || rotationDegree * k == 0) {
          ctx.textAlign = "center"
        }else {
          if(rotationDegree * k > Math.PI) {
            ctx.textAlign = "right"
          }else {
            ctx.textAlign = "left"
          }
        }
        ctx.textBaseline = "middle";
        ctx.fillText(data.labels[k], opposite, -adjacent)
      }
      ctx.restore()
    }
    function calculateDrawingSizes() {
      maxSize = Min([width, height]) / 2;
      labelHeight = config.scaleFontSize * 2;
      var labelLength = 0;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.font = config.pointLabelFontStyle + " " + config.pointLabelFontSize + "px " + config.pointLabelFontFamily;
        var textMeasurement = ctx.measureText(data.labels[i]).width;
        if(textMeasurement > labelLength) {
          labelLength = textMeasurement
        }
      }
      maxSize -= Max([labelLength, config.pointLabelFontSize / 2 * 1.5]);
      maxSize -= config.pointLabelFontSize;
      maxSize = CapValue(maxSize, null, 0);
      scaleHeight = maxSize;
      labelHeight = Default(labelHeight, 5)
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Pie = function(data, config, ctx) {
    var segmentTotal = 0;
    var pieRadius = Min([height / 2, width / 2]) - 5;
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    ctx.fillStyle = "black";
    ctx.textBaseline = "base";
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * (data[i].value / segmentTotal * (Math.PI * 2));
        segmentAngle = Math.min(Math.PI * 1.99999, segmentAngle);
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * pieRadius, cumulativeAngle, cumulativeAngle + segmentAngle);
        ctx.lineTo(width / 2, height / 2);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(data[i].label && scaleAnimation * pieRadius * 2 * segmentAngle / (2 * Math.PI) > config.labelFontSize) {
          function getPieLabelX(align, r) {
            switch(align) {
              case "left":
                return-r + 20;
                break;
              case "center":
                return-r / 2;
                break
            }
            return-10
          }
          function reversePieLabelAlign(align) {
            switch(align) {
              case "left":
                return"right";
                break;
              case "right":
                return"left";
                break;
              case "center":
                return align;
                break
            }
          }
          var fontSize = data[i].labelFontSize || config.labelFontSize + "px";
          if(fontSize.match(/^[0-9]+$/g) != null) {
            fontSize = fontSize + "px"
          }
          ctx.font = config.labelFontStyle + " " + fontSize + " " + config.labelFontFamily;
          ctx.fillStyle = getFadeColor(animationDecimal, data[i].labelColor || "black", data[i].color);
          ctx.textBaseline = "middle";
          var textRotation = -(cumulativeAngle + segmentAngle) + segmentAngle / 2, tX = width / 2 + scaleAnimation * pieRadius * Math.cos(textRotation), tY = height / 2 - scaleAnimation * pieRadius * Math.sin(textRotation);
          ctx.textAlign = data[i].labelAlign || config.labelAlign;
          textX = getPieLabelX(ctx.textAlign, scaleAnimation * pieRadius);
          if(textRotation < -Math.PI / 2) {
            textRotation -= Math.PI;
            ctx.textAlign = reversePieLabelAlign(ctx.textAlign);
            textX = -textX
          }
          ctx.translate(tX, tY);
          ctx.rotate(-textRotation);
          ctx.fillText(data[i].label, textX, 0);
          ctx.rotate(textRotation);
          ctx.translate(-tX, -tY)
        }
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [{x:width / 2, y:height / 2}], pAmount = 50;
          points.push({x:width / 2 + pieRadius * Math.cos(cumulativeAngle), y:height / 2 + pieRadius * Math.sin(cumulativeAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + pieRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + pieRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].value}, "Pie")
        }
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Doughnut = function(data, config, ctx) {
    var segmentTotal = 0;
    var doughnutRadius = Min([height / 2, width / 2]) - 5;
    var cutoutRadius = doughnutRadius * (config.percentageInnerCutout / 100);
    for(var i = 0;i < data.length;i++) {
      segmentTotal += data[i].value
    }
    animationLoop(config, null, drawPieSegments, ctx);
    function drawPieSegments(animationDecimal) {
      var cumulativeAngle = -Math.PI / 2, scaleAnimation = 1, rotateAnimation = 1;
      if(config.animation) {
        if(config.animateScale) {
          scaleAnimation = animationDecimal
        }
        if(config.animateRotate) {
          rotateAnimation = animationDecimal
        }
      }
      for(var i = 0;i < data.length;i++) {
        var segmentAngle = rotateAnimation * (data[i].value / segmentTotal * (Math.PI * 2));
        ctx.beginPath();
        ctx.arc(width / 2, height / 2, scaleAnimation * doughnutRadius, cumulativeAngle, cumulativeAngle + segmentAngle, false);
        ctx.arc(width / 2, height / 2, scaleAnimation * cutoutRadius, cumulativeAngle + segmentAngle, cumulativeAngle, true);
        ctx.closePath();
        ctx.fillStyle = data[i].color;
        ctx.fill();
        if(animationDecimal >= 1 && config.showTooltips) {
          var points = [], pAmount = 50;
          points.push({x:width / 2 + doughnutRadius * Math.cos(cumulativeAngle), y:height / 2 + doughnutRadius * Math.sin(cumulativeAngle)});
          for(var p = 0;p <= pAmount;p++) {
            points.push({x:width / 2 + doughnutRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + doughnutRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          points.push({x:width / 2 + cutoutRadius * Math.cos(cumulativeAngle + segmentAngle), y:height / 2 + cutoutRadius * Math.sin(cumulativeAngle + segmentAngle)});
          for(var p = pAmount;p >= 0;p--) {
            points.push({x:width / 2 + cutoutRadius * Math.cos(cumulativeAngle + p / pAmount * segmentAngle), y:height / 2 + cutoutRadius * Math.sin(cumulativeAngle + p / pAmount * segmentAngle)})
          }
          registerTooltip(ctx, {type:"shape", points:points}, {label:data[i].tooltipLabel, value:data[i].value}, "Doughnut")
        }
        if(config.segmentShowStroke) {
          ctx.lineWidth = config.segmentStrokeWidth;
          ctx.strokeStyle = config.segmentStrokeColor;
          ctx.stroke()
        }
        cumulativeAngle += segmentAngle
      }
    }
  };
  var Line = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawLines, ctx);
    function drawLines(animPc) {
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.strokeStyle = data.datasets[i].strokeColor;
        ctx.lineWidth = config.datasetStrokeWidth;
        ctx.beginPath();
        ctx.moveTo(yAxisPosX, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[0], calculatedScale, scaleHop));
        for(var j = 1;j < data.datasets[i].data.length;j++) {
          if(config.bezierCurve) {
            ctx.bezierCurveTo(xPos(j - 0.5), yPos(i, j - 1), xPos(j - 0.5), yPos(i, j), xPos(j), yPos(i, j))
          }else {
            ctx.lineTo(xPos(j), yPos(i, j))
          }
        }
        var pointRadius = config.pointDot ? config.pointDotRadius + config.pointDotStrokeWidth : 10;
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(animPc >= 1 && config.showTooltips) {
            registerTooltip(ctx, {type:"circle", x:xPos(j), y:yPos(i, j), r:pointRadius}, {label:data.tooltipLabels[j], value:data.datasets[i].data[j]}, "Line")
          }
        }
        ctx.stroke();
        if(config.datasetFill) {
          ctx.lineTo(yAxisPosX + valueHop * (data.datasets[i].data.length - 1), xAxisPosY);
          ctx.lineTo(yAxisPosX, xAxisPosY);
          ctx.closePath();
          ctx.fillStyle = data.datasets[i].fillColor;
          ctx.fill()
        }else {
          ctx.closePath()
        }
        if(config.pointDot) {
          ctx.fillStyle = data.datasets[i].pointColor;
          ctx.strokeStyle = data.datasets[i].pointStrokeColor;
          ctx.lineWidth = config.pointDotStrokeWidth;
          for(var k = 0;k < data.datasets[i].data.length;k++) {
            ctx.beginPath();
            ctx.arc(yAxisPosX + valueHop * k, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[k], calculatedScale, scaleHop), config.pointDotRadius, 0, Math.PI * 2, true);
            ctx.fill();
            ctx.stroke()
          }
        }
      }
      function yPos(dataSet, iteration) {
        return xAxisPosY - animPc * calculateOffset(data.datasets[dataSet].data[iteration], calculatedScale, scaleHop)
      }
      function xPos(iteration) {
        return yAxisPosX + valueHop * iteration
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + i * valueHop, xAxisPosY + 3);
        if(config.scaleShowGridLines && i > 0) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + i * valueHop, 5)
        }else {
          ctx.lineTo(yAxisPosX + i * valueHop, xAxisPosY + 3)
        }
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / (data.labels.length - 1));
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  var Bar = function(data, config, ctx) {
    var maxSize, scaleHop, calculatedScale, labelHeight, scaleHeight, valueBounds, labelTemplateString, valueHop, widestXLabel, xAxisLength, yAxisPosX, xAxisPosY, barWidth, rotateLabels = 0;
    calculateDrawingSizes();
    valueBounds = getValueBounds();
    labelTemplateString = config.scaleShowLabels ? config.scaleLabel : "";
    if(!config.scaleOverride) {
      calculatedScale = calculateScale(scaleHeight, valueBounds.maxSteps, valueBounds.minSteps, valueBounds.maxValue, valueBounds.minValue, labelTemplateString)
    }else {
      calculatedScale = {steps:config.scaleSteps, stepValue:config.scaleStepWidth, graphMin:config.scaleStartValue, labels:[]};
      populateLabels(labelTemplateString, calculatedScale.labels, calculatedScale.steps, config.scaleStartValue, config.scaleStepWidth)
    }
    scaleHop = Math.floor(scaleHeight / calculatedScale.steps);
    calculateXAxisSize();
    animationLoop(config, drawScale, drawBars, ctx);
    function drawBars(animPc) {
      ctx.lineWidth = config.barStrokeWidth;
      for(var i = 0;i < data.datasets.length;i++) {
        ctx.fillStyle = data.datasets[i].fillColor;
        ctx.strokeStyle = data.datasets[i].strokeColor;
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          var barOffset = yAxisPosX + config.barValueSpacing + valueHop * j + barWidth * i + config.barDatasetSpacing * i + config.barStrokeWidth * i;
          ctx.beginPath();
          ctx.moveTo(barOffset, xAxisPosY);
          ctx.lineTo(barOffset, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY - animPc * calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop) + config.barStrokeWidth / 2);
          ctx.lineTo(barOffset + barWidth, xAxisPosY);
          if(config.barShowStroke) {
            ctx.stroke()
          }
          ctx.closePath();
          ctx.fill();
          if(animPc >= 1 && config.showTooltips) {
            var x = barOffset, height = calculateOffset(data.datasets[i].data[j], calculatedScale, scaleHop), y = xAxisPosY - height, width = barWidth;
            registerTooltip(ctx, {type:"rect", x:x, y:y, width:width, height:height}, {label:data.tooltipLabels[j], value:data.datasets[i].data[j]}, "Bar")
          }
        }
      }
    }
    function drawScale() {
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(width - widestXLabel / 2 + 5, xAxisPosY);
      ctx.lineTo(width - widestXLabel / 2 - xAxisLength - 5, xAxisPosY);
      ctx.stroke();
      if(rotateLabels > 0) {
        ctx.save();
        ctx.textAlign = "right"
      }else {
        ctx.textAlign = "center"
      }
      ctx.fillStyle = config.scaleFontColor;
      for(var i = 0;i < data.labels.length;i++) {
        ctx.save();
        if(rotateLabels > 0) {
          ctx.translate(yAxisPosX + i * valueHop, xAxisPosY + config.scaleFontSize);
          ctx.rotate(-(rotateLabels * (Math.PI / 180)));
          ctx.fillText(data.labels[i], 0, 0);
          ctx.restore()
        }else {
          ctx.fillText(data.labels[i], yAxisPosX + i * valueHop + valueHop / 2, xAxisPosY + config.scaleFontSize + 3)
        }
        ctx.beginPath();
        ctx.moveTo(yAxisPosX + (i + 1) * valueHop, xAxisPosY + 3);
        ctx.lineWidth = config.scaleGridLineWidth;
        ctx.strokeStyle = config.scaleGridLineColor;
        ctx.lineTo(yAxisPosX + (i + 1) * valueHop, 5);
        ctx.stroke()
      }
      ctx.lineWidth = config.scaleLineWidth;
      ctx.strokeStyle = config.scaleLineColor;
      ctx.beginPath();
      ctx.moveTo(yAxisPosX, xAxisPosY + 5);
      ctx.lineTo(yAxisPosX, 5);
      ctx.stroke();
      ctx.textAlign = "right";
      ctx.textBaseline = "middle";
      for(var j = 0;j < calculatedScale.steps;j++) {
        ctx.beginPath();
        ctx.moveTo(yAxisPosX - 3, xAxisPosY - (j + 1) * scaleHop);
        if(config.scaleShowGridLines) {
          ctx.lineWidth = config.scaleGridLineWidth;
          ctx.strokeStyle = config.scaleGridLineColor;
          ctx.lineTo(yAxisPosX + xAxisLength + 5, xAxisPosY - (j + 1) * scaleHop)
        }else {
          ctx.lineTo(yAxisPosX - 0.5, xAxisPosY - (j + 1) * scaleHop)
        }
        ctx.stroke();
        if(config.scaleShowLabels) {
          ctx.fillText(calculatedScale.labels[j], yAxisPosX - 8, xAxisPosY - (j + 1) * scaleHop)
        }
      }
    }
    function calculateXAxisSize() {
      var longestText = 1;
      if(config.scaleShowLabels) {
        ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
        for(var i = 0;i < calculatedScale.labels.length;i++) {
          var measuredText = ctx.measureText(calculatedScale.labels[i]).width;
          longestText = measuredText > longestText ? measuredText : longestText
        }
        longestText += 10
      }
      xAxisLength = width - longestText - widestXLabel;
      valueHop = Math.floor(xAxisLength / data.labels.length);
      barWidth = (valueHop - config.scaleGridLineWidth * 2 - config.barValueSpacing * 2 - (config.barDatasetSpacing * data.datasets.length - 1) - (config.barStrokeWidth / 2 * data.datasets.length - 1)) / data.datasets.length;
      yAxisPosX = width - widestXLabel / 2 - xAxisLength;
      xAxisPosY = scaleHeight + config.scaleFontSize / 2
    }
    function calculateDrawingSizes() {
      maxSize = height;
      ctx.font = config.scaleFontStyle + " " + config.scaleFontSize + "px " + config.scaleFontFamily;
      widestXLabel = 1;
      for(var i = 0;i < data.labels.length;i++) {
        var textLength = ctx.measureText(data.labels[i]).width;
        widestXLabel = textLength > widestXLabel ? textLength : widestXLabel
      }
      if(width / data.labels.length < widestXLabel) {
        rotateLabels = 45;
        if(width / data.labels.length < Math.cos(rotateLabels) * widestXLabel) {
          rotateLabels = 90;
          maxSize -= widestXLabel
        }else {
          maxSize -= Math.sin(rotateLabels) * widestXLabel
        }
      }else {
        maxSize -= config.scaleFontSize
      }
      maxSize -= 5;
      labelHeight = config.scaleFontSize;
      maxSize -= labelHeight;
      scaleHeight = maxSize
    }
    function getValueBounds() {
      var upperValue = Number.MIN_VALUE;
      var lowerValue = Number.MAX_VALUE;
      for(var i = 0;i < data.datasets.length;i++) {
        for(var j = 0;j < data.datasets[i].data.length;j++) {
          if(data.datasets[i].data[j] > upperValue) {
            upperValue = data.datasets[i].data[j]
          }
          if(data.datasets[i].data[j] < lowerValue) {
            lowerValue = data.datasets[i].data[j]
          }
        }
      }
      var maxSteps = Math.floor(scaleHeight / (labelHeight * 0.66));
      var minSteps = Math.floor(scaleHeight / labelHeight * 0.5);
      return{maxValue:upperValue, minValue:lowerValue, maxSteps:maxSteps, minSteps:minSteps}
    }
  };
  function calculateOffset(val, calculatedScale, scaleHop) {
    var outerValue = calculatedScale.steps * calculatedScale.stepValue;
    var adjustedValue = val - calculatedScale.graphMin;
    var scalingFactor = CapValue(adjustedValue / outerValue, 1, 0);
    return scaleHop * calculatedScale.steps * scalingFactor
  }
  function animationLoop(config, drawScale, drawData, ctx) {
    var animFrameAmount = config.animation ? 1 / CapValue(config.animationSteps, Number.MAX_VALUE, 1) : 1, easingFunction = animationOptions[config.animationEasing], percentAnimComplete = config.animation ? 0 : 1;
    if(typeof drawScale !== "function") {
      drawScale = function() {
      }
    }
    requestAnimFrame(animLoop);
    function animateFrame() {
      var easeAdjustedAnimationPercent = config.animation ? CapValue(easingFunction(percentAnimComplete), null, 0) : 1;
      clear(ctx);
      if(config.scaleOverlay) {
        drawData(easeAdjustedAnimationPercent);
        drawScale()
      }else {
        drawScale();
        drawData(easeAdjustedAnimationPercent)
      }
    }
    function animLoop() {
      percentAnimComplete += animFrameAmount;
      animateFrame();
      if(percentAnimComplete <= 1) {
        requestAnimFrame(animLoop)
      }else {
        if(typeof config.onAnimationComplete == "function") {
          config.onAnimationComplete()
        }
      }
    }
  }
  var requestAnimFrame = function() {
    return window.requestAnimationFrame || (window.webkitRequestAnimationFrame || (window.mozRequestAnimationFrame || (window.oRequestAnimationFrame || (window.msRequestAnimationFrame || function(callback) {
      window.setTimeout(callback, 1E3 / 60)
    }))))
  }();
  function calculateScale(drawingHeight, maxSteps, minSteps, maxValue, minValue, labelTemplateString) {
    var graphMin, graphMax, graphRange, stepValue, numberOfSteps, valueRange, rangeOrderOfMagnitude, decimalNum;
    valueRange = maxValue - minValue;
    rangeOrderOfMagnitude = calculateOrderOfMagnitude(valueRange);
    graphMin = Math.floor(minValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphMax = Math.ceil(maxValue / (1 * Math.pow(10, rangeOrderOfMagnitude))) * Math.pow(10, rangeOrderOfMagnitude);
    graphRange = graphMax - graphMin;
    stepValue = Math.pow(10, rangeOrderOfMagnitude);
    numberOfSteps = Math.round(graphRange / stepValue);
    while(numberOfSteps < minSteps || numberOfSteps > maxSteps) {
      if(numberOfSteps < minSteps) {
        stepValue /= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }else {
        stepValue *= 2;
        numberOfSteps = Math.round(graphRange / stepValue)
      }
    }
    var labels = [];
    populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue);
    return{steps:numberOfSteps, stepValue:stepValue, graphMin:graphMin, labels:labels};
    function calculateOrderOfMagnitude(val) {
      return Math.floor(Math.log(val) / Math.LN10)
    }
  }
  function populateLabels(labelTemplateString, labels, numberOfSteps, graphMin, stepValue) {
    if(labelTemplateString) {
      for(var i = 1;i < numberOfSteps + 1;i++) {
        labels.push(tmpl(labelTemplateString, {value:(graphMin + stepValue * i).toFixed(getDecimalPlaces(stepValue))}))
      }
    }
  }
  function Max(array) {
    return Math.max.apply(Math, array)
  }
  function Min(array) {
    return Math.min.apply(Math, array)
  }
  function Default(userDeclared, valueIfFalse) {
    if(!userDeclared) {
      return valueIfFalse
    }else {
      return userDeclared
    }
  }
  function isNumber(n) {
    return!isNaN(parseFloat(n)) && isFinite(n)
  }
  function CapValue(valueToCap, maxValue, minValue) {
    if(isNumber(maxValue)) {
      if(valueToCap > maxValue) {
        return maxValue
      }
    }
    if(isNumber(minValue)) {
      if(valueToCap < minValue) {
        return minValue
      }
    }
    return valueToCap
  }
  function getDecimalPlaces(num) {
    var numberOfDecimalPlaces;
    if(num % 1 != 0) {
      return num.toString().split(".")[1].length
    }else {
      return 0
    }
  }
  function mergeChartConfig(defaults, userDefined) {
    var returnObj = {};
    for(var attrname in defaults) {
      returnObj[attrname] = defaults[attrname]
    }
    for(var attrname in userDefined) {
      if(typeof userDefined[attrname] === "object" && defaults[attrname]) {
        returnObj[attrname] = mergeChartConfig(defaults[attrname], userDefined[attrname])
      }else {
        returnObj[attrname] = userDefined[attrname]
      }
    }
    return returnObj
  }
  var cache = {};
  function tmpl(str, data) {
    var fn = !/\W/.test(str) ? cache[str] = cache[str] || tmpl(document.getElementById(str).innerHTML) : new Function("obj", "var p=[],print=function(){p.push.apply(p,arguments);};" + "with(obj){p.push('" + str.replace(/[\r\t\n]/g, " ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g, "$1\r").replace(/\t=(.*?)%>/g, "',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'") + "');}return p.join('');");
    return data ? fn(data) : fn
  }
  function getFadeColor(percent, primColor, secColor) {
    var pseudoEl = document.createElement("div"), rgbPrim, rgbSec;
    pseudoEl.style.color = primColor;
    document.body.appendChild(pseudoEl);
    rgbPrim = window.getComputedStyle(pseudoEl).color;
    pseudoEl.style.color = secColor;
    rgbSec = window.getComputedStyle(pseudoEl).color;
    var regex = /rgb *\( *([0-9]{1,3}) *, *([0-9]{1,3}) *, *([0-9]{1,3}) *\)/, valuesP = regex.exec(rgbPrim), valuesS = regex.exec(rgbSec), rP = Math.round(parseFloat(valuesP[1])), gP = Math.round(parseFloat(valuesP[2])), bP = Math.round(parseFloat(valuesP[3])), rS = Math.round(parseFloat(valuesS[1])), gS = Math.round(parseFloat(valuesS[2])), bS = Math.round(parseFloat(valuesS[3])), rCur = parseInt((rP - rS) * percent + rS), gCur = parseInt((gP - gS) * percent + gS), bCur = parseInt((bP - bS) * percent + 
    bS);
    pseudoEl.parentNode.removeChild(pseudoEl);
    return"rgb(" + rCur + "," + gCur + "," + bCur + ")"
  }
};
eval(function(p, a, c, k, e, r) {
  e = function(c) {
    return(c < a ? "" : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36))
  };
  if(!"".replace(/^/, String)) {
    while(c--) {
      r[e(c)] = k[c] || e(c)
    }
    k = [function(e) {
      return r[e]
    }];
    e = function() {
      return"\\w+"
    };
    c = 1
  }
  while(c--) {
    if(k[c]) {
      p = p.replace(new RegExp("\\b" + e(c) + "\\b", "g"), k[c])
    }
  }
  return p
}("(D($){8($.1s.1v){H}$.1s.6i=$.1s.1v=D(u,w){8(1l.S==0){18(J,'6j 55 6k 1j \"'+1l.4o+'\".');H 1l}8(1l.S>1){H 1l.1W(D(){$(1l).1v(u,w)})}F y=1l,$12=1l[0],56=L;8(y.1q('57')){56=y.1P('3o','4p');y.T('3o',['4q',J])}F z={};z.59=D(o,a,b){o=3S($12,o);o.E=6l($12,o.E);o.1K=6m($12,o.1K);o.N=6n($12,o.N);o.14=5a($12,o.14);o.16=5a($12,o.16);o.1b=6o($12,o.1b);o.1r=6p($12,o.1r);o.1Q=6q($12,o.1Q);8(a){31=$.1L(J,{},$.1s.1v.5b,o)}7=$.1L(J,{},$.1s.1v.5b,o);7.d=6r(7);A.2l=(7.2l=='5c'||7.2l=='1m')?'16':'14';F c=y.13(),2m=5d($1n,7,'P');8(3p(7.25)){7.25='7Q'+G.3T}7.3U=5e(7,2m);7.E=6s(7.E,7,c,b);7[7.d['P']]=6t(7[7.d['P']],7,c);7[7.d['1e']]=6u(7[7.d['1e']],7,c);8(7.2H){8(!3V(7[7.d['P']])){7[7.d['P']]='2I%'}}8(3V(7[7.d['P']])){A.6v=J;A.4r=7[7.d['P']];7[7.d['P']]=4s(2m,A.4r);8(!7.E.M){7.E.U.1d=J}}8(7.2H){7.1R=L;7.1i=[0,0,0,0];7.1B=L;7.E.U.1d=L}O{8(!7.E.M){7=6w(7,2m)}8(!7[7.d['P']]){8(!7.E.U.1d&&Y(7.E[7.d['P']])&&7.E.1t=='*'){7[7.d['P']]=7.E.M*7.E[7.d['P']];7.1B=L}O{7[7.d['P']]='1d'}}8(1z(7.1B)){7.1B=(Y(7[7.d['P']]))?'5f':L}8(7.E.U.1d){7.E.M=32(c,7,0)}}8(7.E.1t!='*'&&!7.E.U.1d){7.E.U.4t=7.E.M;7.E.M=3W(c,7,0)}7.E.M=2x(7.E.M,7,7.E.U.2c,$12);7.E.U.20=7.E.M;8(7.2H){8(!7.E.U.34){7.E.U.34=7.E.M}8(!7.E.U.1X){7.E.U.1X=7.E.M}7=5g(7,c,2m)}O{7.1i=6x(7.1i);8(7.1B=='3q'){7.1B='1m'}O 8(7.1B=='5h'){7.1B='35'}1F(7.1B){R'5f':R'1m':R'35':8(7[7.d['P']]!='1d'){7=5i(7,c);7.1R=J}17;2J:7.1B=L;7.1R=(7.1i[0]==0&&7.1i[1]==0&&7.1i[2]==0&&7.1i[3]==0)?L:J;17}}8(!Y(7.1K.1M)){7.1K.1M=6y}8(1z(7.1K.E)){7.1K.E=(7.2H||7.E.U.1d||7.E.1t!='*')?'M':7.E.M}7.N=$.1L(J,{},7.1K,7.N);7.14=$.1L(J,{},7.1K,7.14);7.16=$.1L(J,{},7.1K,7.16);7.1b=$.1L(J,{},7.1K,7.1b);7.N=6z($12,7.N);7.14=5j($12,7.14);7.16=5j($12,7.16);7.1b=6A($12,7.1b);7.1r=6B($12,7.1r);7.1Q=6C($12,7.1Q);8(7.2n){7.2n=5k(7.2n)}8(7.N.5l){7.N.4u=7.N.5l;3X('N.5l','N.4u')}8(7.N.5m){7.N.4v=7.N.5m;3X('N.5m','N.4v')}8(7.N.5n){7.N.4w=7.N.5n;3X('N.5n','N.4w')}8(7.N.5o){7.N.2K=7.N.5o;3X('N.5o','N.2K')}};z.6D=D(){y.1q('57',J);F a=y.13(),3Y=6E(y,['6F','6G','3r','3q','35','5h','1m','3Z','P','1e','6H','1S','5p','6I']),5q='7R';1F(3Y.3r){R'6J':R'7S':5q=3Y.3r;17}8(G.3s=='36'){41($1n)}O{$1n.Z(3Y)}$1n.Z({'7T':'3t','3r':5q});41(y);y.1q('6K',3Y.3Z);y.Z({'6F':'1m','6G':'42','3r':'6J','3q':0,'35':'N','5h':'N','1m':0,'6H':0,'1S':0,'5p':0,'6I':0});4x(a,7);41(a);8(7.2H){5r(7,a)}};z.6L=D(){z.5s();y.11(I('6M',G),D(e,a){e.1g();8(!A.2d){8(7.N.W){7.N.W.3a(2y('4y',G))}}A.2d=J;8(7.N.1G){7.N.1G=L;y.T(I('3b',G),a)}H J});y.11(I('5t',G),D(e){e.1g();8(A.26){43(V)}H J});y.11(I('3b',G),D(e,a,b){e.1g();1u=3u(1u);8(a&&A.26){V.2d=J;F c=2o()-V.2L;V.1M-=c;8(V.4z){V.4z.1M-=c}8(V.4A){V.4A.1M-=c}43(V,L)}8(!A.27&&!A.26){8(b){1u.3v+=2o()-1u.2L}}8(!A.27){8(7.N.W){7.N.W.3a(2y('6N',G))}}A.27=J;8(7.N.4v){F d=7.N.2K-1u.3v,3c=2I-1H.2z(d*2I/7.N.2K);7.N.4v.1h($12,3c,d)}H J});y.11(I('1G',G),D(e,b,c,d){e.1g();1u=3u(1u);F v=[b,c,d],t=['2M','28','3d'],a=3e(v,t);b=a[0];c=a[1];d=a[2];8(b!='14'&&b!='16'){b=A.2l}8(!Y(c)){c=0}8(!1k(d)){d=L}8(d){A.2d=L;7.N.1G=J}8(!7.N.1G){e.2e();H 18(G,'3w 4y: 2p 3f.')}8(A.27){8(7.N.W){7.N.W.2N(2y('4y',G));7.N.W.2N(2y('6N',G))}}A.27=L;1u.2L=2o();F f=7.N.2K+c;44=f-1u.3v;3c=2I-1H.2z(44*2I/f);8(7.N.1f){1u.1f=7U(D(){F a=2o()-1u.2L+1u.3v,3c=1H.2z(a*2I/f);7.N.1f.4B.1h(7.N.1f.2q[0],3c)},7.N.1f.5u)}1u.N=7V(D(){8(7.N.1f){7.N.1f.4B.1h(7.N.1f.2q[0],2I)}8(7.N.4w){7.N.4w.1h($12,3c,44)}8(A.26){y.T(I('1G',G),b)}O{y.T(I(b,G),7.N)}},44);8(7.N.4u){7.N.4u.1h($12,3c,44)}H J});y.11(I('3g',G),D(e){e.1g();8(V.2d){V.2d=L;A.27=L;A.26=J;V.2L=2o();3x(V,G)}O{y.T(I('1G',G))}H J});y.11(I('14',G)+' '+I('16',G),D(e,b,f,g,h){e.1g();8(A.2d||y.2f(':3t')){e.2e();H 18(G,'3w 4y 7W 3t: 2p 3f.')}F i=(Y(7.E.4C))?7.E.4C:7.E.M+1;8(i>K.Q){e.2e();H 18(G,'2p 6O E ('+K.Q+' Q, '+i+' 6P): 2p 3f.')}F v=[b,f,g,h],t=['2A','28/2M','D','3d'],a=3e(v,t);b=a[0];f=a[1];g=a[2];h=a[3];F k=e.5v.19(G.3y.45.S);8(!1T(b)){b={}}8(1o(g)){b.3h=g}8(1k(h)){b.2O=h}b=$.1L(J,{},7[k],b);8(b.5w&&!b.5w.1h($12,k)){e.2e();H 18(G,'7X \"5w\" 7Y L.')}8(!Y(f)){8(7.E.1t!='*'){f='M'}O{F m=[f,b.E,7[k].E];1j(F a=0,l=m.S;a<l;a++){8(Y(m[a])||m[a]=='6Q'||m[a]=='M'){f=m[a];17}}}1F(f){R'6Q':e.2e();H y.1P(I(k+'7Z',G),[b,g]);17;R'M':8(!7.E.U.1d&&7.E.1t=='*'){f=7.E.M}17}}8(V.2d){y.T(I('3g',G));y.T(I('2O',G),[k,[b,f,g]]);e.2e();H 18(G,'3w 80 3f.')}8(b.1M>0){8(A.26){8(b.2O){8(b.2O=='2P'){2g=[]}8(b.2O!='X'||2g.S==0){y.T(I('2O',G),[k,[b,f,g]])}}e.2e();H 18(G,'3w 81 3f.')}}1u.3v=0;y.T(I('6R'+k,G),[b,f]);8(7.2n){F s=7.2n,c=[b,f];1j(F j=0,l=s.S;j<l;j++){F d=k;8(!s[j][2]){d=(d=='14')?'16':'14'}8(!s[j][1]){c[0]=s[j][0].1P('3o',['6S',d])}c[1]=f+s[j][3];s[j][0].T('3o',['6R'+d,c])}}H J});y.11(I('82',G),D(e,b,c){e.1g();F d=y.13();8(!7.1U){8(K.X==0){8(7.3z){y.T(I('16',G),K.Q-1)}H e.2e()}}1Y(d,7);8(!Y(c)){8(7.E.U.1d){c=4D(d,7,K.Q-1)}O 8(7.E.1t!='*'){F f=(Y(b.E))?b.E:5x(y,7);c=6T(d,7,K.Q-1,f)}O{c=7.E.M}c=4E(c,7,b.E,$12)}8(!7.1U){8(K.Q-c<K.X){c=K.Q-K.X}}7.E.U.20=7.E.M;8(7.E.U.1d){F g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12);8(7.E.M+c<=g&&c<K.Q){c++;g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12)}7.E.M=g}O 8(7.E.1t!='*'){F g=3W(d,7,K.Q-c);7.E.M=2x(g,7,7.E.U.2c,$12)}1Y(d,7,J);8(c==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+c+' E 5y.');K.X+=c;2h(K.X>=K.Q){K.X-=K.Q}8(!7.1U){8(K.X==0&&b.4F){b.4F.1h($12,'14')}8(!7.3z){3A(7,K.X,G)}}y.13().19(K.Q-c,K.Q).83(y);8(K.Q<7.E.M+c){y.13().19(0,(7.E.M+c)-K.Q).4G(J).47(y)}F d=y.13(),3i=6V(d,7,c),2i=6W(d,7),1Z=d.1N(c-1),21=3i.2P(),2r=2i.2P();1Y(d,7);F h=0,2B=0;8(7.1B){F p=4H(2i,7);h=p[0];2B=p[1]}F i=(h<0)?7.1i[7.d[3]]:0;F j=L,2Q=$();8(7.E.M<c){2Q=d.19(7.E.U.20,c);8(b.1V=='6X'){F k=7.E[7.d['P']];j=2Q;1Z=2r;5z(j);7.E[7.d['P']]='1d'}}F l=L,3B=2R(d.19(0,c),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4K={},2s={},2S={},4L={},2T={},5A={},2U=5B(b,7,c,3B);1F(b.1V){R'1I':R'1I-1w':3C=2R(d.19(0,7.E.M),7,'P');17}8(j){7.E[7.d['P']]=k}1Y(d,7,J);8(2B>=0){1Y(21,7,7.1i[7.d[1]])}8(h>=0){1Y(1Z,7,7.1i[7.d[3]])}8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=h}2T[7.d['1m']]=-(3B-i);5A[7.d['1m']]=-(3C-i);4K[7.d['1m']]=2j[7.d['P']];F m=D(){},1O=D(){},1C=D(){},3D=D(){},2C=D(){},5C=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(b.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':l=y.4G(J).47($1n);17}1F(b.1V){R'3j':R'22':R'22-1w':l.13().19(0,c).2t();l.13().19(7.E.U.20).2t();17;R'1I':R'1I-1w':l.13().19(7.E.M).2t();l.Z(5A);17}y.Z(2T);V=48(2U,b.2u,G);29[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){m=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){8(2r.4M(1Z).S){2s[7.d['1S']]=1Z.1q('2a');8(h<0){1Z.Z(2s)}O{1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}}1F(b.1V){R'1I':R'1I-1w':l.13().1N(c-1).Z(2s);17}8(2r.4M(21).S){2S[7.d['1S']]=21.1q('2a');1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])}}8(2B>=0){4L[7.d['1S']]=2r.1q('2a')+7.1i[7.d[1]];2C=D(){2r.Z(4L)};5C=D(){V.1a.1c([2r,4L])}}}1J=D(){y.Z(29)};F n=7.E.M+c-K.Q;1y=D(){8(n>0){y.13().19(K.Q).2t();3i=$(y.13().19(K.Q-(7.E.M-n)).3F().6Y(y.13().19(0,n).3F()))}5D(j);8(7.1R){F a=y.13().1N(7.E.M+c-1);a.Z(7.d['1S'],a.1q('2a'))}};F o=5E(3i,2Q,2i,c,'14',2U,2j);1x=D(){5F(y,l,b);A.26=L;2b.3h=4a($12,b,'3h',o,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,b,'3G',o,2b);1F(b.1V){R'42':y.Z(29);m();1C();2C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){m();1C();2C();1D();1J();1y();V=48(2U,b.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([l,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();2C();1D();1J();1y();17;R'1I':V.1a.1c([l,29,D(){1C();2C();1D();1J();1y();1x()}]);1O();17;R'1I-1w':V.1a.1c([y,{'1E':0}]);V.1a.1c([l,29,D(){y.Z({'1E':1});1C();2C();1D();1J();1y();1x()}]);1O();17;R'22':V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1y();1x()}]);1O();3D();5C();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('84',G),D(e,c,d){e.1g();F f=y.13();8(!7.1U){8(K.X==7.E.M){8(7.3z){y.T(I('14',G),K.Q-1)}H e.2e()}}1Y(f,7);8(!Y(d)){8(7.E.1t!='*'){F g=(Y(c.E))?c.E:5x(y,7);d=6Z(f,7,0,g)}O{d=7.E.M}d=4E(d,7,c.E,$12)}F h=(K.X==0)?K.Q:K.X;8(!7.1U){8(7.E.U.1d){F i=32(f,7,d),g=4D(f,7,h-1)}O{F i=7.E.M,g=7.E.M}8(d+i>h){d=h-g}}7.E.U.20=7.E.M;8(7.E.U.1d){F i=2x(5I(f,7,d,h),7,7.E.U.2c,$12);2h(7.E.M-d>=i&&d<K.Q){d++;i=2x(5I(f,7,d,h),7,7.E.U.2c,$12)}7.E.M=i}O 8(7.E.1t!='*'){F i=3W(f,7,d);7.E.M=2x(i,7,7.E.U.2c,$12)}1Y(f,7,J);8(d==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+d+' E 70.');K.X-=d;2h(K.X<0){K.X+=K.Q}8(!7.1U){8(K.X==7.E.M&&c.4F){c.4F.1h($12,'16')}8(!7.3z){3A(7,K.X,G)}}8(K.Q<7.E.M+d){y.13().19(0,(7.E.M+d)-K.Q).4G(J).47(y)}F f=y.13(),3i=71(f,7),2i=72(f,7,d),1Z=f.1N(d-1),21=3i.2P(),2r=2i.2P();1Y(f,7);F j=0,2B=0;8(7.1B){F p=4H(2i,7);j=p[0];2B=p[1]}F k=L,2Q=$();8(7.E.U.20<d){2Q=f.19(7.E.U.20,d);8(c.1V=='6X'){F l=7.E[7.d['P']];k=2Q;1Z=21;5z(k);7.E[7.d['P']]='1d'}}F m=L,3B=2R(f.19(0,d),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4N={},2s={},2S={},2T={},2U=5B(c,7,d,3B);1F(c.1V){R'22':R'22-1w':3C=2R(f.19(0,7.E.U.20),7,'P');17}8(k){7.E[7.d['P']]=l}8(7.1B){8(7.1i[7.d[1]]<0){7.1i[7.d[1]]=0}}1Y(f,7,J);1Y(21,7,7.1i[7.d[1]]);8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=j}2T[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;F n=D(){},1O=D(){},1C=D(){},3D=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(c.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':m=y.4G(J).47($1n);m.13().19(7.E.U.20).2t();17}1F(c.1V){R'3j':R'1I':R'1I-1w':y.Z('3Z',1);m.Z('3Z',0);17}V=48(2U,c.2u,G);29[7.d['1m']]=-3B;4N[7.d['1m']]=-3C;8(j<0){29[7.d['1m']]+=j}8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){n=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){F o=2r.1q('2a');8(2B>=0){o+=7.1i[7.d[1]]}2r.Z(7.d['1S'],o);8(1Z.4M(21).S){2S[7.d['1S']]=21.1q('2a')}1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])};F q=1Z.1q('2a');8(j>0){q+=7.1i[7.d[3]]}2s[7.d['1S']]=q;1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}1J=D(){y.Z(2T)};F r=7.E.M+d-K.Q;1y=D(){8(r>0){y.13().19(K.Q).2t()}F a=y.13().19(0,d).47(y).2P();8(r>0){2i=3I(f,7)}5D(k);8(7.1R){8(K.Q<7.E.M+d){F b=y.13().1N(7.E.M-1);b.Z(7.d['1S'],b.1q('2a')+7.1i[7.d[1]])}a.Z(7.d['1S'],a.1q('2a'))}};F s=5E(3i,2Q,2i,d,'16',2U,2j);1x=D(){y.Z('3Z',y.1q('6K'));5F(y,m,c);A.26=L;2b.3h=4a($12,c,'3h',s,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,c,'3G',s,2b);1F(c.1V){R'42':y.Z(29);n();1C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){n();1C();1D();1J();1y();V=48(2U,c.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([m,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();1D();1J();1y();17;R'1I':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'1I-1w':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([m,{'1E':0}]);V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'22':V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1J();1y();1x()}]);1O();3D();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('3k',G),D(e,b,c,d,f,g,h){e.1g();F v=[b,c,d,f,g,h],t=['2M/28/2A','28','3d','2A','2M','D'],a=3e(v,t);f=a[3];g=a[4];h=a[5];b=3J(a[0],a[1],a[2],K,y);8(b==0){H L}8(!1T(f)){f=L}8(g!='14'&&g!='16'){8(7.1U){g=(b<=K.Q/2)?'16':'14'}O{g=(K.X==0||K.X>b)?'16':'14'}}8(g=='14'){b=K.Q-b}y.T(I(g,G),[f,b,h]);H J});y.11(I('85',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c-1,a,'14',b])});y.11(I('86',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c+1,a,'16',b])});y.11(I('5J',G),D(e,a,b,c,d){e.1g();8(!Y(a)){a=y.1P(I('4b',G))}F f=7.1b.E||7.E.M,1X=1H.2z(K.Q/f)-1;8(a<0){a=1X}8(a>1X){a=0}H y.1P(I('3k',G),[a*f,0,J,b,c,d])});y.11(I('73',G),D(e,s){e.1g();8(s){s=3J(s,0,J,K,y)}O{s=0}s+=K.X;8(s!=0){8(K.Q>0){2h(s>K.Q){s-=K.Q}}y.87(y.13().19(s,K.Q))}H J});y.11(I('2n',G),D(e,s){e.1g();8(s){s=5k(s)}O 8(7.2n){s=7.2n}O{H 18(G,'6j 88 46 2n.')}F n=y.1P(I('4p',G)),x=J;1j(F j=0,l=s.S;j<l;j++){8(!s[j][0].1P(I('3k',G),[n,s[j][3],J])){x=L}}H x});y.11(I('2O',G),D(e,a,b){e.1g();8(1o(a)){a.1h($12,2g)}O 8(2V(a)){2g=a}O 8(!1z(a)){2g.1c([a,b])}H 2g});y.11(I('89',G),D(e,b,c,d,f){e.1g();F v=[b,c,d,f],t=['2M/2A','2M/28/2A','3d','28'],a=3e(v,t);b=a[0];c=a[1];d=a[2];f=a[3];8(1T(b)&&!2v(b)){b=$(b)}O 8(1p(b)){b=$(b)}8(!2v(b)||b.S==0){H 18(G,'2p a 5K 2A.')}8(1z(c)){c='4c'}4x(b,7);41(b);F g=c,4d='4d';8(c=='4c'){8(d){8(K.X==0){c=K.Q-1;4d='74'}O{c=K.X;K.X+=b.S}8(c<0){c=0}}O{c=K.Q-1;4d='74'}}O{c=3J(c,f,d,K,y)}F h=y.13().1N(c);8(h.S){h[4d](b)}O{18(G,'8a 8b-3r 4M 6k! 8c 8d 46 75 4c.');y.76(b)}8(g!='4c'&&!d){8(c<K.X){K.X+=b.S}}K.Q=y.13().S;8(K.X>=K.Q){K.X-=K.Q}y.T(I('4O',G));y.T(I('5L',G));H J});y.11(I('77',G),D(e,c,d,f){e.1g();F v=[c,d,f],t=['2M/28/2A','3d','28'],a=3e(v,t);c=a[0];d=a[1];f=a[2];F g=L;8(c 2W $&&c.S>1){h=$();c.1W(D(i,a){F b=y.T(I('77',G),[$(1l),d,f]);8(b){h=h.8e(b)}});H h}8(1z(c)||c=='4c'){h=y.13().2P()}O{c=3J(c,f,d,K,y);F h=y.13().1N(c);8(h.S){8(c<K.X){K.X-=h.S}}}8(h&&h.S){h.8f();K.Q=y.13().S;y.T(I('4O',G))}H h});y.11(I('3G',G)+' '+I('3h',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S);8(2V(a)){2b[b]=a}8(1o(a)){2b[b].1c(a)}H 2b[b]});y.11(I('4p',G),D(e,a){e.1g();8(K.X==0){F b=0}O{F b=K.Q-K.X}8(1o(a)){a.1h($12,b)}H b});y.11(I('4b',G),D(e,a){e.1g();F b=7.1b.E||7.E.M,1X=1H.2z(K.Q/b-1),2k;8(K.X==0){2k=0}O 8(K.X<K.Q%b){2k=0}O 8(K.X==b&&!7.1U){2k=1X}O{2k=1H.78((K.Q-K.X)/b)}8(2k<0){2k=0}8(2k>1X){2k=1X}8(1o(a)){a.1h($12,2k)}H 2k});y.11(I('8g',G),D(e,a){e.1g();F b=3I(y.13(),7);8(1o(a)){a.1h($12,b)}H b});y.11(I('19',G),D(e,f,l,b){e.1g();8(K.Q==0){H L}F v=[f,l,b],t=['28','28','D'],a=3e(v,t);f=(Y(a[0]))?a[0]:0;l=(Y(a[1]))?a[1]:K.Q;b=a[2];f+=K.X;l+=K.X;8(E.Q>0){2h(f>K.Q){f-=K.Q}2h(l>K.Q){l-=K.Q}2h(f<0){f+=K.Q}2h(l<0){l+=K.Q}}F c=y.13(),$i;8(l>f){$i=c.19(f,l)}O{$i=$(c.19(f,K.Q).3F().6Y(c.19(0,l).3F()))}8(1o(b)){b.1h($12,$i)}H $i});y.11(I('27',G)+' '+I('2d',G)+' '+I('26',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S),5M=A[b];8(1o(a)){a.1h($12,5M)}H 5M});y.11(I('6S',G),D(e,a,b,c){e.1g();F d=L;8(1o(a)){a.1h($12,7)}O 8(1T(a)){31=$.1L(J,{},31,a);8(b!==L)d=J;O 7=$.1L(J,{},7,a)}O 8(!1z(a)){8(1o(b)){F f=4P('7.'+a);8(1z(f)){f=''}b.1h($12,f)}O 8(!1z(b)){8(2X c!=='3d')c=J;4P('31.'+a+' = b');8(c!==L)d=J;O 4P('7.'+a+' = b')}O{H 4P('7.'+a)}}8(d){1Y(y.13(),7);z.59(31);z.5N();F g=4Q(y,7);y.T(I('3H',G),[J,g])}H 7});y.11(I('5L',G),D(e,a,b){e.1g();8(1z(a)){a=$('8h')}O 8(1p(a)){a=$(a)}8(!2v(a)||a.S==0){H 18(G,'2p a 5K 2A.')}8(!1p(b)){b='a.6i'}a.8i(b).1W(D(){F h=1l.79||'';8(h.S>0&&y.13().7a($(h))!=-1){$(1l).23('5O').5O(D(e){e.2D();y.T(I('3k',G),h)})}});H J});y.11(I('3H',G),D(e,b,c){e.1g();8(!7.1b.1A){H}F d=7.1b.E||7.E.M,4R=1H.2z(K.Q/d);8(b){8(7.1b.3K){7.1b.1A.13().2t();7.1b.1A.1W(D(){1j(F a=0;a<4R;a++){F i=y.13().1N(3J(a*d,0,J,K,y));$(1l).76(7.1b.3K.1h(i[0],a+1))}})}7.1b.1A.1W(D(){$(1l).13().23(7.1b.3L).1W(D(a){$(1l).11(7.1b.3L,D(e){e.2D();y.T(I('3k',G),[a*d,-7.1b.4S,J,7.1b])})})})}F f=y.1P(I('4b',G))+7.1b.4S;8(f>=4R){f=0}8(f<0){f=4R-1}7.1b.1A.1W(D(){$(1l).13().2N(2y('7b',G)).1N(f).3a(2y('7b',G))});H J});y.11(I('4O',G),D(e){F a=7.E.M,2E=y.13(),2m=5d($1n,7,'P');K.Q=2E.S;8(A.4r){7.3U=2m;7[7.d['P']]=4s(2m,A.4r)}O{7.3U=5e(7,2m)}8(7.2H){7.E.P=7.E.3M.P;7.E.1e=7.E.3M.1e;7=5g(7,2E,2m);a=7.E.M;5r(7,2E)}O 8(7.E.U.1d){a=32(2E,7,0)}O 8(7.E.1t!='*'){a=3W(2E,7,0)}8(!7.1U&&K.X!=0&&a>K.X){8(7.E.U.1d){F b=4D(2E,7,K.X)-K.X}O 8(7.E.1t!='*'){F b=7c(2E,7,K.X)-K.X}O{F b=7.E.M-K.X}18(G,'8j 8k-1U: 8l '+b+' E 5y.');y.T(I('14',G),b)}7.E.M=2x(a,7,7.E.U.2c,$12);7.E.U.20=7.E.M;7=5i(7,2E);F c=4Q(y,7);y.T(I('3H',G),[J,c]);4T(7,K.Q,G);3A(7,K.X,G);H c});y.11(I('4q',G),D(e,a){e.1g();1u=3u(1u);y.1q('57',L);y.T(I('5t',G));8(a){y.T(I('73',G))}4U(y.13());4U(y);z.5s();z.5P();8(G.3s=='36'){4U($1n)}O{$1n.8m(y)}H J});y.11(I('18',G),D(e){18(G,'3w P: '+7.P);18(G,'3w 1e: '+7.1e);18(G,'7d 8n: '+7.E.P);18(G,'7d 8o: '+7.E.1e);18(G,'4e 4f E M: '+7.E.M);8(7.N.1G){18(G,'4e 4f E 5Q 8p: '+7.N.E)}8(7.14.W){18(G,'4e 4f E 5Q 5y: '+7.14.E)}8(7.16.W){18(G,'4e 4f E 5Q 70: '+7.16.E)}H G.18});y.11('3o',D(e,n,o){e.1g();H y.1P(I(n,G),o)})};z.5s=D(){y.23(I('',G));y.23(I('',G,L));y.23('3o')};z.5N=D(){z.5P();4T(7,K.Q,G);3A(7,K.X,G);8(7.N.2F){F b=3N(7.N.2F);$1n.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}8(7.N.W){7.N.W.11(I(7.N.3L,G,L),D(e){e.2D();F a=L,b=3O;8(A.27){a='1G'}O 8(7.N.4X){a='3b';b=3N(7.N.4X)}8(a){y.T(I(a,G),b)}})}8(7.14.W){7.14.W.11(I(7.14.3L,G,L),D(e){e.2D();y.T(I('14',G))});8(7.14.2F){F b=3N(7.14.2F);7.14.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.16.W){7.16.W.11(I(7.16.3L,G,L),D(e){e.2D();y.T(I('16',G))});8(7.16.2F){F b=3N(7.16.2F);7.16.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.1b.1A){8(7.1b.2F){F b=3N(7.1b.2F);7.1b.1A.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.14.2Y||7.16.2Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k==7.16.2Y){e.2D();y.T(I('16',G))}8(k==7.14.2Y){e.2D();y.T(I('14',G))}})}8(7.1b.4Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k>=49&&k<58){k=(k-49)*7.E.M;8(k<=K.Q){e.2D();y.T(I('3k',G),[k,0,J,7.1b])}}})}8($.1s.1r){F c='8q'8r 3l;8((c&&7.1r.4h)||(!c&&7.1r.5R)){F d=$.1L(J,{},7.14,7.1r),7g=$.1L(J,{},7.16,7.1r),5S=D(){y.T(I('14',G),[d])},5T=D(){y.T(I('16',G),[7g])};1F(7.2l){R'5c':R'7h':7.1r.2G.8s=5T;7.1r.2G.8t=5S;17;2J:7.1r.2G.8u=5T;7.1r.2G.8v=5S}8(A.1r){y.1r('4q')}$1n.1r(7.1r.2G);$1n.Z('7i','8w');A.1r=J}}8($.1s.1Q){8(7.1Q){F f=$.1L(J,{},7.14,7.1Q),7j=$.1L(J,{},7.16,7.1Q);8(A.1Q){$1n.23(I('1Q',G,L))}$1n.11(I('1Q',G,L),D(e,a){e.2D();8(a>0){y.T(I('14',G),[f])}O{y.T(I('16',G),[7j])}});A.1Q=J}}8(7.N.1G){y.T(I('1G',G),7.N.5U)}8(A.6v){F g=D(e){y.T(I('5t',G));8(7.N.5V&&!A.27){y.T(I('1G',G))}1Y(y.13(),7);y.T(I('4O',G))};F h=$(3l),4i=3O;8($.5W&&G.5X=='5W'){4i=$.5W(8x,g)}O 8($.4Z&&G.5X=='4Z'){4i=$.4Z(8y,g)}O{F i=0,5Y=0;4i=D(){F a=h.P(),5Z=h.1e();8(a!=i||5Z!=5Y){g();i=a;5Y=5Z}}}h.11(I('8z',G,L,J,J),4i)}};z.5P=D(){F a=I('',G),3P=I('',G,L);61=I('',G,L,J,J);$(4g).23(61);$(3l).23(61);$1n.23(3P);8(7.N.W){7.N.W.23(3P)}8(7.14.W){7.14.W.23(3P)}8(7.16.W){7.16.W.23(3P)}8(7.1b.1A){7.1b.1A.23(3P);8(7.1b.3K){7.1b.1A.13().2t()}}8(A.1r){y.1r('4q');$1n.Z('7i','2J');A.1r=L}8(A.1Q){A.1Q=L}4T(7,'4j',G);3A(7,'2N',G)};8(1k(w)){w={'18':w}}F A={'2l':'16','27':J,'26':L,'2d':L,'1Q':L,'1r':L},K={'Q':y.13().S,'X':0},1u={'N':3O,'1f':3O,'2L':2o(),'3v':0},V={'2d':L,'1M':0,'2L':0,'2u':'','1a':[]},2b={'3G':[],'3h':[]},2g=[],G=$.1L(J,{},$.1s.1v.7k,w),7={},31=$.1L(J,{},u),$1n=(G.3s=='36')?y.36():y.8A('<'+G.3s.55+' 8B=\"'+G.3s.7l+'\" />').36();G.4o=y.4o;G.3T=$.1s.1v.3T++;G.2Z=(G.2Z&&$.1s.2Z)?'2Z':'8C';z.59(31,J,56);z.6D();z.6L();z.5N();8(2V(7.E.3m)){F B=7.E.3m}O{F B=[];8(7.E.3m!=0){B.1c(7.E.3m)}}8(7.25){B.8D(4k(7m(7.25),10))}8(B.S>0){1j(F a=0,l=B.S;a<l;a++){F s=B[a];8(s==0){62}8(s===J){s=3l.8E.79;8(s.S<1){62}}O 8(s==='7n'){s=1H.4l(1H.7n()*K.Q)}8(y.1P(I('3k',G),[s,0,J,{1V:'42'}])){17}}}F C=4Q(y,7),7o=3I(y.13(),7);8(7.7p){7.7p.1h($12,{'P':C.P,'1e':C.1e,'E':7o})}y.T(I('3H',G),[J,C]);y.T(I('5L',G));8(G.18){y.T(I('18',G))}H y};$.1s.1v.3T=1;$.1s.1v.5b={'2n':L,'3z':J,'1U':J,'2H':L,'2l':'1m','E':{'3m':0},'1K':{'2u':'7q','1M':6y,'2F':L,'3L':'5O','2O':L}};$.1s.1v.7k={'18':L,'2Z':L,'5X':'4Z','3y':{'45':'','7r':'8F'},'3s':{'55':'8G','7l':'8H'},'63':{}};$.1s.1v.7s=D(a){H'<a 8I=\"#\"><7t>'+a+'</7t></a>'};$.1s.1v.7u=D(a){$(1l).Z('P',a+'%')};$.1s.1v.25={3F:D(n){n+='=';F b=4g.25.3Q(';');1j(F a=0,l=b.S;a<l;a++){F c=b[a];2h(c.8J(0)==' '){c=c.19(1)}8(c.3R(n)==0){H c.19(n.S)}}H 0},64:D(n,v,d){F e=\"\";8(d){F a=7v 7w();a.8K(a.2o()+(d*24*60*60*8L));e=\"; 8M=\"+a.8N()}4g.25=n+'='+v+e+'; 8O=/'},2t:D(n){$.1s.1v.25.64(n,\"\",-1)}};D 48(d,e,c){8(c.2Z=='2Z'){8(e=='7q'){e='8P'}}H{1a:[],1M:d,8Q:d,2u:e,2L:2o()}}D 3x(s,c){1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];8(!b){62}b[0][c.2Z](b[1],s.1M,s.2u,b[2])}}D 43(s,c){8(!1k(c)){c=J}8(1T(s.4z)){43(s.4z,c)}1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];b[0].6M(J);8(c){b[0].Z(b[1]);8(1o(b[2])){b[2]()}}}8(1T(s.4A)){43(s.4A,c)}}D 5F(a,b,o){8(b){b.2t()}1F(o.1V){R'1w':R'3j':R'1I-1w':R'22-1w':a.Z('1t','');a.Z('1E',1);17}}D 4a(d,o,b,a,c){8(o[b]){o[b].1h(d,a)}8(c[b].S){1j(F i=0,l=c[b].S;i<l;i++){c[b][i].1h(d,a)}}H[]}D 5G(a,q,c){8(q.S){a.T(I(q[0][0],c),q[0][1]);q.8R()}H q}D 5z(b){b.1W(D(){F a=$(1l);a.1q('7x',a.2f(':3t')).4j()})}D 5D(b){8(b){b.1W(D(){F a=$(1l);8(!a.1q('7x')){a.4m()}})}}D 3u(t){8(t.N){8S(t.N)}8(t.1f){8T(t.1f)}H t}D 5E(a,b,c,d,e,f,g){H{'P':g.P,'1e':g.1e,'E':{'20':a,'8U':b,'M':c},'1K':{'E':d,'2l':e,'1M':f}}}D 5B(a,o,b,c){F d=a.1M;8(a.1V=='42'){H 0}8(d=='N'){d=o.1K.1M/o.1K.E*b}O 8(d<10){d=c/d}8(d<1){H 0}8(a.1V=='1w'){d=d/2}H 1H.78(d)}D 4T(o,t,c){F a=(Y(o.E.4C))?o.E.4C:o.E.M+1;8(t=='4m'||t=='4j'){F f=t}O 8(a>t){18(c,'2p 6O E ('+t+' Q, '+a+' 6P): 8V 8W.');F f='4j'}O{F f='4m'}F s=(f=='4m')?'2N':'3a',h=2y('3t',c);8(o.N.W){o.N.W[f]()[s](h)}8(o.14.W){o.14.W[f]()[s](h)}8(o.16.W){o.16.W[f]()[s](h)}8(o.1b.1A){o.1b.1A[f]()[s](h)}}D 3A(o,f,c){8(o.1U||o.3z)H;F a=(f=='2N'||f=='3a')?f:L,51=2y('8X',c);8(o.N.W&&a){o.N.W[a](51)}8(o.14.W){F b=a||(f==0)?'3a':'2N';o.14.W[b](51)}8(o.16.W){F b=a||(f==o.E.M)?'3a':'2N';o.16.W[b](51)}}D 3S(a,b){8(1o(b)){b=b.1h(a)}O 8(1z(b)){b={}}H b}D 6l(a,b){b=3S(a,b);8(Y(b)){b={'M':b}}O 8(b=='1d'){b={'M':b,'P':b,'1e':b}}O 8(!1T(b)){b={}}H b}D 6m(a,b){b=3S(a,b);8(Y(b)){8(b<=50){b={'E':b}}O{b={'1M':b}}}O 8(1p(b)){b={'2u':b}}O 8(!1T(b)){b={}}H b}D 52(a,b){b=3S(a,b);8(1p(b)){F c=65(b);8(c==-1){b=$(b)}O{b=c}}H b}D 6n(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(1k(b)){b={'1G':b}}O 8(Y(b)){b={'2K':b}}8(b.1f){8(1p(b.1f)||2v(b.1f)){b.1f={'2q':b.1f}}}H b}D 6z(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(!1k(b.1G)){b.1G=J}8(!Y(b.5U)){b.5U=0}8(1z(b.4X)){b.4X=J}8(!1k(b.5V)){b.5V=J}8(!Y(b.2K)){b.2K=(b.1M<10)?8Y:b.1M*5}8(b.1f){8(1o(b.1f.2q)){b.1f.2q=b.1f.2q.1h(a)}8(1p(b.1f.2q)){b.1f.2q=$(b.1f.2q)}8(b.1f.2q){8(!1o(b.1f.4B)){b.1f.4B=$.1s.1v.7u}8(!Y(b.1f.5u)){b.1f.5u=50}}O{b.1f=L}}H b}D 5a(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(Y(b)){b={'2Y':b}}H b}D 5j(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(1p(b.2Y)){b.2Y=65(b.2Y)}H b}D 6o(a,b){b=52(a,b);8(2v(b)){b={'1A':b}}O 8(1k(b)){b={'4Y':b}}H b}D 6A(a,b){8(1o(b.1A)){b.1A=b.1A.1h(a)}8(1p(b.1A)){b.1A=$(b.1A)}8(!Y(b.E)){b.E=L}8(!1k(b.4Y)){b.4Y=L}8(!1o(b.3K)&&!53(b.3K)){b.3K=$.1s.1v.7s}8(!Y(b.4S)){b.4S=0}H b}D 6p(a,b){8(1o(b)){b=b.1h(a)}8(1z(b)){b={'4h':L}}8(3p(b)){b={'4h':b}}O 8(Y(b)){b={'E':b}}H b}D 6B(a,b){8(!1k(b.4h)){b.4h=J}8(!1k(b.5R)){b.5R=L}8(!1T(b.2G)){b.2G={}}8(!1k(b.2G.7y)){b.2G.7y=L}H b}D 6q(a,b){8(1o(b)){b=b.1h(a)}8(3p(b)){b={}}O 8(Y(b)){b={'E':b}}O 8(1z(b)){b=L}H b}D 6C(a,b){H b}D 3J(a,b,c,d,e){8(1p(a)){a=$(a,e)}8(1T(a)){a=$(a,e)}8(2v(a)){a=e.13().7a(a);8(!1k(c)){c=L}}O{8(!1k(c)){c=J}}8(!Y(a)){a=0}8(!Y(b)){b=0}8(c){a+=d.X}a+=b;8(d.Q>0){2h(a>=d.Q){a-=d.Q}2h(a<0){a+=d.Q}}H a}D 4D(i,o,s){F t=0,x=0;1j(F a=s;a>=0;a--){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}8(a==0){a=i.S}x++}}D 7c(i,o,s){H 66(i,o.E.1t,o.E.U.4t,s)}D 6T(i,o,s,m){H 66(i,o.E.1t,m,s)}D 66(i,f,m,s){F t=0,x=0;1j(F a=s,l=i.S;a>=0;a--){x++;8(x==l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==0){a=l}}}D 5x(a,o){H o.E.U.4t||a.13().19(0,o.E.M).1t(o.E.1t).S}D 32(i,o,s){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}x++;8(x==l+1){H x}8(a==l){a=-1}}}D 5I(i,o,s,l){F v=32(i,o,s);8(!o.1U){8(s+v>l){v=l-s}}H v}D 3W(i,o,s){H 68(i,o.E.1t,o.E.U.4t,s,o.1U)}D 6Z(i,o,s,m){H 68(i,o.E.1t,m+1,s,o.1U)-1}D 68(i,f,m,s,c){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){x++;8(x>=l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==l){a=-1}}}D 3I(i,o){H i.19(0,o.E.M)}D 6V(i,o,n){H i.19(n,o.E.U.20+n)}D 6W(i,o){H i.19(0,o.E.M)}D 71(i,o){H i.19(0,o.E.U.20)}D 72(i,o,n){H i.19(n,o.E.M+n)}D 4x(i,o,d){8(o.1R){8(!1p(d)){d='2a'}i.1W(D(){F j=$(1l),m=4k(j.Z(o.d['1S']),10);8(!Y(m)){m=0}j.1q(d,m)})}}D 1Y(i,o,m){8(o.1R){F x=(1k(m))?m:L;8(!Y(m)){m=0}4x(i,o,'7z');i.1W(D(){F j=$(1l);j.Z(o.d['1S'],((x)?j.1q('7z'):m+j.1q('2a')))})}}D 41(i){i.1W(D(){F j=$(1l);j.1q('7A',j.7B('7C')||'')})}D 4U(i){i.1W(D(){F j=$(1l);j.7B('7C',j.1q('7A')||'')})}D 5r(o,b){F c=o.E.M,7D=o.E[o.d['P']],69=o[o.d['1e']],7E=3V(69);b.1W(D(){F a=$(1l),6a=7D-7F(a,o,'8Z');a[o.d['P']](6a);8(7E){a[o.d['1e']](4s(6a,69))}})}D 4Q(a,o){F b=a.36(),$i=a.13(),$v=3I($i,o),54=4I(4J($v,o,J),o,L);b.Z(54);8(o.1R){F p=o.1i,r=p[o.d[1]];8(o.1B&&r<0){r=0}F c=$v.2P();c.Z(o.d['1S'],c.1q('2a')+r);a.Z(o.d['3q'],p[o.d[0]]);a.Z(o.d['1m'],p[o.d[3]])}a.Z(o.d['P'],54[o.d['P']]+(2R($i,o,'P')*2));a.Z(o.d['1e'],6b($i,o,'1e'));H 54}D 4J(i,o,a){H[2R(i,o,'P',a),6b(i,o,'1e',a)]}D 6b(i,o,a,b){8(!1k(b)){b=L}8(Y(o[o.d[a]])&&b){H o[o.d[a]]}8(Y(o.E[o.d[a]])){H o.E[o.d[a]]}a=(a.6c().3R('P')>-1)?'2w':'3n';H 4n(i,o,a)}D 4n(i,o,b){F s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F m=(j.2f(':M'))?j[o.d[b]](J):0;8(s<m){s=m}}H s}D 2R(i,o,b,c){8(!1k(c)){c=L}8(Y(o[o.d[b]])&&c){H o[o.d[b]]}8(Y(o.E[o.d[b]])){H o.E[o.d[b]]*i.S}F d=(b.6c().3R('P')>-1)?'2w':'3n',s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);s+=(j.2f(':M'))?j[o.d[d]](J):0}H s}D 5d(a,o,d){F b=a.2f(':M');8(b){a.4j()}F s=a.36()[o.d[d]]();8(b){a.4m()}H s}D 5e(o,a){H(Y(o[o.d['P']]))?o[o.d['P']]:a}D 6d(i,o,b){F s=L,v=L;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F c=(j.2f(':M'))?j[o.d[b]](J):0;8(s===L){s=c}O 8(s!=c){v=J}8(s==0){v=J}}H v}D 7F(i,o,d){H i[o.d['90'+d]](J)-i[o.d[d.6c()]]()}D 4s(s,o){8(3V(o)){o=4k(o.19(0,-1),10);8(!Y(o)){H s}s*=o/2I}H s}D I(n,c,a,b,d){8(!1k(a)){a=J}8(!1k(b)){b=J}8(!1k(d)){d=L}8(a){n=c.3y.45+n}8(b){n=n+'.'+c.3y.7r}8(b&&d){n+=c.3T}H n}D 2y(n,c){H(1p(c.63[n]))?c.63[n]:n}D 4I(a,o,p){8(!1k(p)){p=J}F b=(o.1R&&p)?o.1i:[0,0,0,0];F c={};c[o.d['P']]=a[0]+b[1]+b[3];c[o.d['1e']]=a[1]+b[0]+b[2];H c}D 3e(c,d){F e=[];1j(F a=0,7G=c.S;a<7G;a++){1j(F b=0,7H=d.S;b<7H;b++){8(d[b].3R(2X c[a])>-1&&1z(e[b])){e[b]=c[a];17}}}H e}D 6x(p){8(1z(p)){H[0,0,0,0]}8(Y(p)){H[p,p,p,p]}8(1p(p)){p=p.3Q('91').7I('').3Q('92').7I('').3Q(' ')}8(!2V(p)){H[0,0,0,0]}1j(F i=0;i<4;i++){p[i]=4k(p[i],10)}1F(p.S){R 0:H[0,0,0,0];R 1:H[p[0],p[0],p[0],p[0]];R 2:H[p[0],p[1],p[0],p[1]];R 3:H[p[0],p[1],p[2],p[1]];2J:H[p[0],p[1],p[2],p[3]]}}D 4H(a,o){F x=(Y(o[o.d['P']]))?1H.2z(o[o.d['P']]-2R(a,o,'P')):0;1F(o.1B){R'1m':H[0,x];R'35':H[x,0];R'5f':2J:H[1H.2z(x/2),1H.4l(x/2)]}}D 6r(o){F a=[['P','7J','2w','1e','7K','3n','1m','3q','1S',0,1,2,3],['1e','7K','3n','P','7J','2w','3q','1m','5p',3,2,1,0]];F b=a[0].S,7L=(o.2l=='35'||o.2l=='1m')?0:1;F c={};1j(F d=0;d<b;d++){c[a[0][d]]=a[7L][d]}H c}D 4E(x,o,a,b){F v=x;8(1o(a)){v=a.1h(b,v)}O 8(1p(a)){F p=a.3Q('+'),m=a.3Q('-');8(m.S>p.S){F c=J,6e=m[0],30=m[1]}O{F c=L,6e=p[0],30=p[1]}1F(6e){R'93':v=(x%2==1)?x-1:x;17;R'94':v=(x%2==0)?x-1:x;17;2J:v=x;17}30=4k(30,10);8(Y(30)){8(c){30=-30}v+=30}}8(!Y(v)||v<1){v=1}H v}D 2x(x,o,a,b){H 6f(4E(x,o,a,b),o.E.U)}D 6f(v,i){8(Y(i.34)&&v<i.34){v=i.34}8(Y(i.1X)&&v>i.1X){v=i.1X}8(v<1){v=1}H v}D 5k(s){8(!2V(s)){s=[[s]]}8(!2V(s[0])){s=[s]}1j(F j=0,l=s.S;j<l;j++){8(1p(s[j][0])){s[j][0]=$(s[j][0])}8(!1k(s[j][1])){s[j][1]=J}8(!1k(s[j][2])){s[j][2]=J}8(!Y(s[j][3])){s[j][3]=0}}H s}D 65(k){8(k=='35'){H 39}8(k=='1m'){H 37}8(k=='5c'){H 38}8(k=='7h'){H 40}H-1}D 5H(n,a,c){8(n){F v=a.1P(I('4p',c));$.1s.1v.25.64(n,v)}}D 7m(n){F c=$.1s.1v.25.3F(n);H(c=='')?0:c}D 6E(a,b){F c={};1j(F p=0,l=b.S;p<l;p++){c[b[p]]=a.Z(b[p])}H c}D 6s(a,b,c,d){8(!1T(a.U)){a.U={}}8(!1T(a.3M)){a.3M={}}8(a.3m==0&&Y(d)){a.3m=d}8(1T(a.M)){a.U.34=a.M.34;a.U.1X=a.M.1X;a.M=L}O 8(1p(a.M)){8(a.M=='1d'){a.U.1d=J}O{a.U.2c=a.M}a.M=L}O 8(1o(a.M)){a.U.2c=a.M;a.M=L}8(!1p(a.1t)){a.1t=(c.1t(':3t').S>0)?':M':'*'}8(!a[b.d['P']]){8(b.2H){18(J,'7M a '+b.d['P']+' 1j 75 E!');a[b.d['P']]=4n(c,b,'2w')}O{a[b.d['P']]=(6d(c,b,'2w'))?'1d':c[b.d['2w']](J)}}8(!a[b.d['1e']]){a[b.d['1e']]=(6d(c,b,'3n'))?'1d':c[b.d['3n']](J)}a.3M.P=a.P;a.3M.1e=a.1e;H a}D 6w(a,b){8(a.E[a.d['P']]=='1d'){a.E.U.1d=J}8(!a.E.U.1d){8(Y(a[a.d['P']])){a.E.M=1H.4l(a[a.d['P']]/a.E[a.d['P']])}O{a.E.M=1H.4l(b/a.E[a.d['P']]);a[a.d['P']]=a.E.M*a.E[a.d['P']];8(!a.E.U.2c){a.1B=L}}8(a.E.M=='95'||a.E.M<1){18(J,'2p a 5K 28 4f M E: 7M 46 \"1d\".');a.E.U.1d=J}}H a}D 6t(a,b,c){8(a=='N'){a=4n(c,b,'2w')}H a}D 6u(a,b,c){8(a=='N'){a=4n(c,b,'3n')}8(!a){a=b.E[b.d['1e']]}H a}D 5i(o,a){F p=4H(3I(a,o),o);o.1i[o.d[1]]=p[1];o.1i[o.d[3]]=p[0];H o}D 5g(o,a,b){F c=6f(1H.2z(o[o.d['P']]/o.E[o.d['P']]),o.E.U);8(c>a.S){c=a.S}F d=1H.4l(o[o.d['P']]/c);o.E.M=c;o.E[o.d['P']]=d;o[o.d['P']]=c*d;H o}D 3N(p){8(1p(p)){F i=(p.3R('96')>-1)?J:L,r=(p.3R('3g')>-1)?J:L}O{F i=r=L}H[i,r]}D 97(a){H(Y(a))?a:3O}D 6g(a){H(a===3O)}D 1z(a){H(6g(a)||2X a=='7N'||a===''||a==='7N')}D 2V(a){H(a 2W 98)}D 2v(a){H(a 2W 7O)}D 1T(a){H((a 2W 99||2X a=='2A')&&!6g(a)&&!2v(a)&&!2V(a))}D Y(a){H((a 2W 4e||2X a=='28')&&!9a(a))}D 1p(a){H((a 2W 9b||2X a=='2M')&&!1z(a)&&!3p(a)&&!53(a))}D 1o(a){H(a 2W 9c||2X a=='D')}D 1k(a){H(a 2W 9d||2X a=='3d'||3p(a)||53(a))}D 3p(a){H(a===J||a==='J')}D 53(a){H(a===L||a==='L')}D 3V(x){H(1p(x)&&x.19(-1)=='%')}D 2o(){H 7v 7w().2o()}D 3X(o,n){18(J,o+' 2f 9e, 9f 1j 9g 9h 9i 9j. 9k '+n+' 9l.')}D 18(d,m){8(!1z(3l.6h)&&!1z(3l.6h.7P)){8(1T(d)){F s=' ('+d.4o+')';d=d.18}O{F s=''}8(!d){H L}8(1p(m)){m='1v'+s+': '+m}O{m=['1v'+s+':',m]}3l.6h.7P(m)}H L}$.1L($.2u,{'9m':D(t){F a=t*t;H t*(-a*t+4*a-6*t+4)},'9n':D(t){H t*(4*t*t-9*t+6)},'9o':D(t){F a=t*t;H t*(33*a*a-9p*a*t+9q*a-67*t+15)}})})(7O);", 
62, 585, "|||||||opts|if|||||||||||||||||||||||||||||||function|items|var|conf|return|cf_e|true|itms|false|visible|auto|else|width|total|case|length|trigger|visibleConf|scrl|button|first|is_number|css||bind|tt0|children|prev||next|break|debug|slice|anims|pagination|push|variable|height|progress|stopPropagation|call|padding|for|is_boolean|this|left|wrp|is_function|is_string|data|swipe|fn|filter|tmrs|carouFredSel|fade|_onafter|_moveitems|is_undefined|container|align|_s_paddingold|_s_paddingcur|opacity|switch|play|Math|cover|_position|scroll|extend|duration|eq|_a_wrapper|triggerHandler|mousewheel|usePadding|marginRight|is_object|circular|fx|each|max|sz_resetMargin|i_cur_l|old|i_old_l|uncover|unbind||cookie|isScrolling|isPaused|number|a_cfs|_cfs_origCssMargin|clbk|adjust|isStopped|stopImmediatePropagation|is|queu|while|i_new|w_siz|nr|direction|avail_primary|synchronise|getTime|Not|bar|i_new_l|a_cur|remove|easing|is_jquery|outerWidth|cf_getItemsAdjust|cf_c|ceil|object|pR|_s_paddingnew|preventDefault|a_itm|pauseOnHover|options|responsive|100|default|timeoutDuration|startTime|string|removeClass|queue|last|i_skp|ms_getTotalSize|a_old|a_lef|a_dur|is_array|instanceof|typeof|key|transition|adj|opts_orig|gn_getVisibleItemsNext||min|right|parent||||addClass|pause|perc|boolean|cf_sortParams|scrolling|resume|onAfter|i_old|crossfade|slideTo|window|start|outerHeight|_cfs_triggerEvent|is_true|top|position|wrapper|hidden|sc_clearTimers|timePassed|Carousel|sc_startScroll|events|infinite|nv_enableNavi|i_siz|i_siz_vis|_a_paddingold|_a_paddingcur|get|onBefore|updatePageStatus|gi_getCurrentItems|gn_getItemIndex|anchorBuilder|event|sizesConf|bt_pauseOnHoverConfig|null|ns2|split|indexOf|go_getObject|serialNumber|maxDimension|is_percentage|gn_getVisibleItemsNextFilter|deprecated|orgCSS|zIndex||sz_storeOrigCss|none|sc_stopScroll|dur2|prefix|to|appendTo|sc_setScroll||sc_fireCallbacks|currentPage|end|before|Number|of|document|onTouch|onResize|hide|parseInt|floor|show|ms_getTrueLargestSize|selector|currentPosition|destroy|primarySizePercentage|ms_getPercentage|org|onTimeoutStart|onTimeoutPause|onTimeoutEnd|sz_storeMargin|stopped|pre|post|updater|minimum|gn_getVisibleItemsPrev|cf_getAdjust|onEnd|clone|cf_getAlignPadding|cf_mapWrapperSizes|ms_getSizes|a_wsz|a_new|not|a_cfs_vis|updateSizes|eval|sz_setSizes|pgs|deviation|nv_showNavi|sz_restoreOrigCss|mouseenter|mouseleave|pauseOnEvent|keys|throttle||di|go_getNaviObject|is_false|sz|element|starting_position|_cfs_isCarousel||_cfs_init|go_getPrevNextObject|defaults|up|ms_getParentSize|ms_getMaxDimension|center|in_getResponsiveValues|bottom|in_getAlignPadding|go_complementPrevNextObject|cf_getSynchArr|onPauseStart|onPausePause|onPauseEnd|pauseDuration|marginBottom|newPosition|sz_setResponsiveSizes|_cfs_unbind_events|finish|interval|type|conditions|gn_getVisibleOrg|backward|sc_hideHiddenItems|a_lef_vis|sc_getDuration|_a_paddingnew|sc_showHiddenItems|sc_mapCallbackArguments|sc_afterScroll|sc_fireQueue|cf_setCookie|gn_getVisibleItemsNextTestCircular|slideToPage|valid|linkAnchors|value|_cfs_bind_buttons|click|_cfs_unbind_buttons|scrolled|onMouse|swP|swN|delay|pauseOnResize|debounce|onWindowResize|_windowHeight|nh||ns3|continue|classnames|set|cf_getKeyCode|gn_getItemsPrevFilter||gn_getItemsNextFilter|seco|nw|ms_getLargestSize|toLowerCase|ms_hasVariableSizes|sta|cf_getItemAdjustMinMax|is_null|console|caroufredsel|No|found|go_getItemsObject|go_getScrollObject|go_getAutoObject|go_getPaginationObject|go_getSwipeObject|go_getMousewheelObject|cf_getDimensions|in_complementItems|in_complementPrimarySize|in_complementSecondarySize|upDateOnWindowResize|in_complementVisibleItems|cf_getPadding|500|go_complementAutoObject|go_complementPaginationObject|go_complementSwipeObject|go_complementMousewheelObject|_cfs_build|in_mapCss|textAlign|float|marginTop|marginLeft|absolute|_cfs_origCssZindex|_cfs_bind_events|stop|paused|enough|needed|page|slide_|configuration|gn_getScrollItemsPrevFilter|Scrolling|gi_getOldItemsPrev|gi_getNewItemsPrev|directscroll|concat|gn_getScrollItemsNextFilter|forward|gi_getOldItemsNext|gi_getNewItemsNext|jumpToStart|after|the|append|removeItem|round|hash|index|selected|gn_getVisibleItemsPrevFilter|Item|keyup|keyCode|scN|down|cursor|mcN|configs|classname|cf_getCookie|random|itm|onCreate|swing|namespace|pageAnchorBuilder|span|progressbarUpdater|new|Date|_cfs_isHidden|triggerOnTouchEnd|_cfs_tempCssMargin|_cfs_origCss|attr|style|newS|secp|ms_getPaddingBorderMargin|l1|l2|join|innerWidth|innerHeight|dx|Set|undefined|jQuery|log|caroufredsel_cookie_|relative|fixed|overflow|setInterval|setTimeout|or|Callback|returned|Page|resumed|currently|slide_prev|prependTo|slide_next|prevPage|nextPage|prepend|carousel|insertItem|Correct|insert|Appending|item|add|detach|currentVisible|body|find|Preventing|non|sliding|replaceWith|widths|heights|automatically|ontouchstart|in|swipeUp|swipeDown|swipeLeft|swipeRight|move|200|300|resize|wrap|class|animate|unshift|location|cfs|div|caroufredsel_wrapper|href|charAt|setTime|1000|expires|toGMTString|path|ease|orgDuration|shift|clearTimeout|clearInterval|skipped|Hiding|navigation|disabled|2500|Width|outer|px|em|even|odd|Infinity|immediate|bt_mousesheelNumber|Array|Object|isNaN|String|Function|Boolean|DEPRECATED|support|it|will|be|removed|Use|instead|quadratic|cubic|elastic|106|126".split("|"), 
0, {}));
jQuery.cookie = function(key, value, options) {
  if(arguments.length > 1 && String(value) !== "[object Object]") {
    options = jQuery.extend({}, options);
    if(value === null || value === undefined) {
      options.expires = -1
    }
    if(typeof options.expires === "number") {
      var days = options.expires, t = options.expires = new Date;
      t.setDate(t.getDate() + days)
    }
    value = String(value);
    return document.cookie = [encodeURIComponent(key), "=", options.raw ? value : encodeURIComponent(value), options.expires ? "; expires=" + options.expires.toUTCString() : "", options.path ? "; path=" + options.path : "", options.domain ? "; domain=" + options.domain : "", options.secure ? "; secure" : ""].join("")
  }
  options = value || {};
  var result, decode = options.raw ? function(s) {
    return s
  } : decodeURIComponent;
  return(result = (new RegExp("(?:^|; )" + encodeURIComponent(key) + "=([^;]*)")).exec(document.cookie)) ? decode(result[1]) : null
};
(function($) {
  var tmp, loading, overlay, wrap, outer, content, close, title, nav_left, nav_right, selectedIndex = 0, selectedOpts = {}, selectedArray = [], currentIndex = 0, currentOpts = {}, currentArray = [], ajaxLoader = null, imgPreloader = new Image, imgRegExp = /\.(jpg|gif|png|bmp|jpeg)(.*)?$/i, swfRegExp = /[^\.]\.(swf)\s*$/i, loadingTimer, loadingFrame = 1, titleHeight = 0, titleStr = "", start_pos, final_pos, busy = false, fx = $.extend($("<div/>")[0], {prop:0}), isIE6 = $.browser.msie && ($.browser.version < 
  7 && !window.XMLHttpRequest), _abort = function() {
    loading.hide();
    imgPreloader.onerror = imgPreloader.onload = null;
    if(ajaxLoader) {
      ajaxLoader.abort()
    }
    tmp.empty()
  }, _error = function() {
    if(false === selectedOpts.onError(selectedArray, selectedIndex, selectedOpts)) {
      loading.hide();
      busy = false;
      return
    }
    selectedOpts.titleShow = false;
    selectedOpts.width = "auto";
    selectedOpts.height = "auto";
    tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');
    _process_inline()
  }, _start = function() {
    var obj = selectedArray[selectedIndex], href, type, title, str, emb, ret;
    _abort();
    selectedOpts = $.extend({}, $.fn.fancybox.defaults, typeof $(obj).data("fancybox") == "undefined" ? selectedOpts : $(obj).data("fancybox"));
    ret = selectedOpts.onStart(selectedArray, selectedIndex, selectedOpts);
    if(ret === false) {
      busy = false;
      return
    }else {
      if(typeof ret == "object") {
        selectedOpts = $.extend(selectedOpts, ret)
      }
    }
    title = selectedOpts.title || ((obj.nodeName ? $(obj).attr("title") : obj.title) || "");
    if(obj.nodeName && !selectedOpts.orig) {
      selectedOpts.orig = $(obj).children("img:first").length ? $(obj).children("img:first") : $(obj)
    }
    if(title === "" && (selectedOpts.orig && selectedOpts.titleFromAlt)) {
      title = selectedOpts.orig.attr("alt")
    }
    href = selectedOpts.href || ((obj.nodeName ? $(obj).attr("href") : obj.href) || null);
    if(/^(?:javascript)/i.test(href) || href == "#") {
      href = null
    }
    if(selectedOpts.type) {
      type = selectedOpts.type;
      if(!href) {
        href = selectedOpts.content
      }
    }else {
      if(selectedOpts.content) {
        type = "html"
      }else {
        if(href) {
          if(href.match(imgRegExp)) {
            type = "image"
          }else {
            if(href.match(swfRegExp)) {
              type = "swf"
            }else {
              if($(obj).hasClass("iframe")) {
                type = "iframe"
              }else {
                if(href.indexOf("#") === 0) {
                  type = "inline"
                }else {
                  type = "ajax"
                }
              }
            }
          }
        }
      }
    }
    if(!type) {
      _error();
      return
    }
    if(type == "inline") {
      obj = href.substr(href.indexOf("#"));
      type = $(obj).length > 0 ? "inline" : "ajax"
    }
    selectedOpts.type = type;
    selectedOpts.href = href;
    selectedOpts.title = title;
    if(selectedOpts.autoDimensions) {
      if(selectedOpts.type == "html" || (selectedOpts.type == "inline" || selectedOpts.type == "ajax")) {
        selectedOpts.width = "auto";
        selectedOpts.height = "auto"
      }else {
        selectedOpts.autoDimensions = false
      }
    }
    if(selectedOpts.modal) {
      selectedOpts.overlayShow = true;
      selectedOpts.hideOnOverlayClick = false;
      selectedOpts.hideOnContentClick = false;
      selectedOpts.enableEscapeButton = false;
      selectedOpts.showCloseButton = false
    }
    selectedOpts.padding = parseInt(selectedOpts.padding, 10);
    selectedOpts.margin = parseInt(selectedOpts.margin, 10);
    tmp.css("padding", selectedOpts.padding + selectedOpts.margin);
    $(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change", function() {
      $(this).replaceWith(content.children())
    });
    switch(type) {
      case "html":
        tmp.html(selectedOpts.content);
        _process_inline();
        break;
      case "inline":
        if($(obj).parent().is("#fancybox-content") === true) {
          busy = false;
          return
        }
        $('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup", function() {
          $(this).replaceWith(content.children())
        }).bind("fancybox-cancel", function() {
          $(this).replaceWith(tmp.children())
        });
        $(obj).appendTo(tmp);
        _process_inline();
        break;
      case "image":
        busy = false;
        $.fancybox.showActivity();
        imgPreloader = new Image;
        imgPreloader.onerror = function() {
          _error()
        };
        imgPreloader.onload = function() {
          busy = true;
          imgPreloader.onerror = imgPreloader.onload = null;
          _process_image()
        };
        imgPreloader.src = href;
        break;
      case "swf":
        selectedOpts.scrolling = "no";
        str = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"><param name="movie" value="' + href + '"></param>';
        emb = "";
        $.each(selectedOpts.swf, function(name, val) {
          str += '<param name="' + name + '" value="' + val + '"></param>';
          emb += " " + name + '="' + val + '"'
        });
        str += '<embed src="' + href + '" type="application/x-shockwave-flash" width="' + selectedOpts.width + '" height="' + selectedOpts.height + '"' + emb + "></embed></object>";
        tmp.html(str);
        _process_inline();
        break;
      case "ajax":
        busy = false;
        $.fancybox.showActivity();
        selectedOpts.ajax.win = selectedOpts.ajax.success;
        ajaxLoader = $.ajax($.extend({}, selectedOpts.ajax, {url:href, data:selectedOpts.ajax.data || {}, error:function(XMLHttpRequest, textStatus, errorThrown) {
          if(XMLHttpRequest.status > 0) {
            _error()
          }
        }, success:function(data, textStatus, XMLHttpRequest) {
          var o = typeof XMLHttpRequest == "object" ? XMLHttpRequest : ajaxLoader;
          if(o.status == 200) {
            if(typeof selectedOpts.ajax.win == "function") {
              ret = selectedOpts.ajax.win(href, data, textStatus, XMLHttpRequest);
              if(ret === false) {
                loading.hide();
                return
              }else {
                if(typeof ret == "string" || typeof ret == "object") {
                  data = ret
                }
              }
            }
            tmp.html(data);
            _process_inline()
          }
        }}));
        break;
      case "iframe":
        _show();
        break
    }
  }, _process_inline = function() {
    var w = selectedOpts.width, h = selectedOpts.height;
    if(w.toString().indexOf("%") > -1) {
      w = parseInt(($(window).width() - selectedOpts.margin * 2) * parseFloat(w) / 100, 10) + "px"
    }else {
      w = w == "auto" ? "auto" : w + "px"
    }
    if(h.toString().indexOf("%") > -1) {
      h = parseInt(($(window).height() - selectedOpts.margin * 2) * parseFloat(h) / 100, 10) + "px"
    }else {
      h = h == "auto" ? "auto" : h + "px"
    }
    tmp.wrapInner('<div style="width:' + w + ";height:" + h + ";overflow: " + (selectedOpts.scrolling == "auto" ? "auto" : selectedOpts.scrolling == "yes" ? "scroll" : "hidden") + ';position:relative;"></div>');
    selectedOpts.width = tmp.width();
    selectedOpts.height = tmp.height();
    _show()
  }, _process_image = function() {
    selectedOpts.width = imgPreloader.width;
    selectedOpts.height = imgPreloader.height;
    $("<img />").attr({"id":"fancybox-img", "src":imgPreloader.src, "alt":selectedOpts.title}).appendTo(tmp);
    _show()
  }, _show = function() {
    $("#fancybox-outer").css("background", "white");
    $(".joyride-close-tip").click();
    var pos, equal;
    loading.hide();
    if(wrap.is(":visible") && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      $.event.trigger("fancybox-cancel");
      busy = false;
      return
    }
    busy = true;
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    if(wrap.is(":visible") && currentOpts.titlePosition !== "outside") {
      wrap.css("height", wrap.height())
    }
    currentArray = selectedArray;
    currentIndex = selectedIndex;
    currentOpts = selectedOpts;
    if(currentOpts.overlayShow) {
      overlay.css({"background-color":currentOpts.overlayColor, "opacity":currentOpts.overlayOpacity, "cursor":currentOpts.hideOnOverlayClick ? "pointer" : "auto", "height":$(document).height()});
      if(!overlay.is(":visible")) {
        if(isIE6) {
          $("select:not(#fancybox-tmp select)").filter(function() {
            return this.style.visibility !== "hidden"
          }).css({"visibility":"hidden"}).one("fancybox-cleanup", function() {
            this.style.visibility = "inherit"
          })
        }
        overlay.show()
      }
    }else {
      overlay.hide()
    }
    final_pos = _get_zoom_to();
    _process_title();
    if(wrap.is(":visible")) {
      $(close.add(nav_left).add(nav_right)).hide();
      pos = wrap.position(), start_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      equal = start_pos.width == final_pos.width && start_pos.height == final_pos.height;
      content.fadeTo(currentOpts.changeFade, 0.3, function() {
        var finish_resizing = function() {
          content.html(tmp.contents()).fadeTo(currentOpts.changeFade, 1, _finish)
        };
        $.event.trigger("fancybox-change");
        content.empty().removeAttr("filter").css({"border-width":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2});
        if(equal) {
          finish_resizing()
        }else {
          fx.prop = 0;
          $(fx).animate({prop:1}, {duration:currentOpts.changeSpeed, easing:currentOpts.easingChange, step:_draw, complete:finish_resizing})
        }
      });
      return
    }
    wrap.removeAttr("style");
    content.css("border-width", currentOpts.padding);
    if(currentOpts.transitionIn == "elastic") {
      start_pos = _get_zoom_from();
      content.html(tmp.contents());
      wrap.show();
      if(currentOpts.opacity) {
        final_pos.opacity = 0
      }
      fx.prop = 0;
      $(fx).animate({prop:1}, {duration:currentOpts.speedIn, easing:currentOpts.easingIn, step:_draw, complete:_finish});
      return
    }
    if(currentOpts.titlePosition == "inside" && titleHeight > 0) {
      title.show()
    }
    content.css({"width":final_pos.width - currentOpts.padding * 2, "height":selectedOpts.autoDimensions ? "auto" : final_pos.height - titleHeight - currentOpts.padding * 2}).html(tmp.contents());
    wrap.css(final_pos).fadeIn(currentOpts.transitionIn == "none" ? 0 : currentOpts.speedIn, _finish)
  }, _format_title = function(title) {
    if(title && title.length) {
      if(currentOpts.titlePosition == "float") {
        return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">' + title + '</td><td id="fancybox-title-float-right"></td></tr></table>'
      }
      return'<div id="fancybox-title-' + currentOpts.titlePosition + '">' + title + "</div>"
    }
    return false
  }, _process_title = function() {
    titleStr = currentOpts.title || "";
    titleHeight = 0;
    title.empty().removeAttr("style").removeClass();
    if(currentOpts.titleShow === false) {
      title.hide();
      return
    }
    titleStr = $.isFunction(currentOpts.titleFormat) ? currentOpts.titleFormat(titleStr, currentArray, currentIndex, currentOpts) : _format_title(titleStr);
    if(!titleStr || titleStr === "") {
      title.hide();
      return
    }
    title.addClass("fancybox-title-" + currentOpts.titlePosition).html(titleStr).appendTo("body").show();
    switch(currentOpts.titlePosition) {
      case "inside":
        title.css({"width":final_pos.width - currentOpts.padding * 2, "marginLeft":currentOpts.padding, "marginRight":currentOpts.padding});
        titleHeight = title.outerHeight(true);
        title.appendTo(outer);
        final_pos.height += titleHeight;
        break;
      case "over":
        title.css({"marginLeft":currentOpts.padding, "width":final_pos.width - currentOpts.padding * 2, "bottom":currentOpts.padding}).appendTo(outer);
        break;
      case "float":
        title.css("left", parseInt((title.width() - final_pos.width - 40) / 2, 10) * -1).appendTo(wrap);
        break;
      default:
        title.css({"width":final_pos.width - currentOpts.padding * 2, "paddingLeft":currentOpts.padding, "paddingRight":currentOpts.padding}).appendTo(wrap);
        break
    }
    title.hide()
  }, _set_navigation = function() {
    if(currentOpts.enableEscapeButton || currentOpts.enableKeyboardNav) {
      $(document).bind("keydown.fb", function(e) {
        if(e.keyCode == 27 && currentOpts.enableEscapeButton) {
          e.preventDefault();
          $.fancybox.close()
        }else {
          if((e.keyCode == 37 || e.keyCode == 39) && (currentOpts.enableKeyboardNav && (e.target.tagName !== "INPUT" && (e.target.tagName !== "TEXTAREA" && e.target.tagName !== "SELECT")))) {
            e.preventDefault();
            $.fancybox[e.keyCode == 37 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!currentOpts.showNavArrows) {
      nav_left.hide();
      nav_right.hide();
      return
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex !== 0) {
      nav_left.show()
    }
    if(currentOpts.cyclic && currentArray.length > 1 || currentIndex != currentArray.length - 1) {
      nav_right.show()
    }
  }, _finish = function() {
    if(!$.support.opacity) {
      content.get(0).style.removeAttribute("filter");
      wrap.get(0).style.removeAttribute("filter")
    }
    if(selectedOpts.autoDimensions) {
      content.css("height", "auto")
    }
    wrap.css("height", "auto");
    if(titleStr && titleStr.length) {
      title.show()
    }
    if(currentOpts.showCloseButton) {
      close.show()
    }
    _set_navigation();
    if(currentOpts.hideOnContentClick) {
      content.bind("click", $.fancybox.close)
    }
    if(currentOpts.hideOnOverlayClick) {
      overlay.bind("click", $.fancybox.close)
    }
    $(window).bind("resize.fb", $.fancybox.resize);
    if(currentOpts.centerOnScroll) {
      $(window).bind("scroll.fb", $.fancybox.center)
    }
    if(currentOpts.type == "iframe") {
      $('<iframe id="fancybox-frame" name="fancybox-frame' + (new Date).getTime() + '" frameborder="0" hspace="0" ' + ($.browser.msie ? 'allowtransparency="true""' : "") + ' scrolling="' + selectedOpts.scrolling + '" src="' + currentOpts.href + '"></iframe>').appendTo(content)
    }
    wrap.show();
    busy = false;
    $.fancybox.center();
    currentOpts.onComplete(currentArray, currentIndex, currentOpts);
    _preload_images()
  }, _preload_images = function() {
    var href, objNext;
    if(currentArray.length - 1 > currentIndex) {
      href = currentArray[currentIndex + 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
    if(currentIndex > 0) {
      href = currentArray[currentIndex - 1].href;
      if(typeof href !== "undefined" && href.match(imgRegExp)) {
        objNext = new Image;
        objNext.src = href
      }
    }
  }, _draw = function(pos) {
    var dim = {width:parseInt(start_pos.width + (final_pos.width - start_pos.width) * pos, 10), height:parseInt(start_pos.height + (final_pos.height - start_pos.height) * pos, 10), top:parseInt(start_pos.top + (final_pos.top - start_pos.top) * pos, 10), left:parseInt(start_pos.left + (final_pos.left - start_pos.left) * pos, 10)};
    if(typeof final_pos.opacity !== "undefined") {
      dim.opacity = pos < 0.5 ? 0.5 : pos
    }
    wrap.css(dim);
    content.css({"width":dim.width - currentOpts.padding * 2, "height":dim.height - titleHeight * pos - currentOpts.padding * 2})
  }, _get_viewport = function() {
    return[$(window).width() - currentOpts.margin * 2, $(window).height() - currentOpts.margin * 2, $(document).scrollLeft() + currentOpts.margin, $(document).scrollTop() + currentOpts.margin]
  }, _get_zoom_to = function() {
    var view = _get_viewport(), to = {}, resize = currentOpts.autoScale, double_padding = currentOpts.padding * 2, ratio;
    if(currentOpts.width.toString().indexOf("%") > -1) {
      to.width = parseInt(view[0] * parseFloat(currentOpts.width) / 100, 10)
    }else {
      to.width = currentOpts.width + double_padding
    }
    if(currentOpts.height.toString().indexOf("%") > -1) {
      to.height = parseInt(view[1] * parseFloat(currentOpts.height) / 100, 10)
    }else {
      to.height = currentOpts.height + double_padding
    }
    if(resize && (to.width > view[0] || to.height > view[1])) {
      if(selectedOpts.type == "image" || selectedOpts.type == "swf") {
        ratio = currentOpts.width / currentOpts.height;
        if(to.width > view[0]) {
          to.width = view[0];
          to.height = parseInt((to.width - double_padding) / ratio + double_padding, 10)
        }
        if(to.height > view[1]) {
          to.height = view[1];
          to.width = parseInt((to.height - double_padding) * ratio + double_padding, 10)
        }
      }else {
        to.width = Math.min(to.width, view[0]);
        to.height = Math.min(to.height, view[1])
      }
    }
    to.top = parseInt(Math.max(view[3] - 20, view[3] + (view[1] - to.height - 40) * 0.5), 10);
    to.left = parseInt(Math.max(view[2] - 20, view[2] + (view[0] - to.width - 40) * 0.5), 10);
    return to
  }, _get_obj_pos = function(obj) {
    var pos = obj.offset();
    pos.top += parseInt(obj.css("paddingTop"), 10) || 0;
    pos.left += parseInt(obj.css("paddingLeft"), 10) || 0;
    pos.top += parseInt(obj.css("border-top-width"), 10) || 0;
    pos.left += parseInt(obj.css("border-left-width"), 10) || 0;
    pos.width = obj.width();
    pos.height = obj.height();
    return pos
  }, _get_zoom_from = function() {
    var orig = selectedOpts.orig ? $(selectedOpts.orig) : false, from = {}, pos, view;
    if(orig && orig.length) {
      pos = _get_obj_pos(orig);
      from = {width:pos.width + currentOpts.padding * 2, height:pos.height + currentOpts.padding * 2, top:pos.top - currentOpts.padding - 20, left:pos.left - currentOpts.padding - 20}
    }else {
      view = _get_viewport();
      from = {width:currentOpts.padding * 2, height:currentOpts.padding * 2, top:parseInt(view[3] + view[1] * 0.5, 10), left:parseInt(view[2] + view[0] * 0.5, 10)}
    }
    return from
  }, _animate_loading = function() {
    if(!loading.is(":visible")) {
      clearInterval(loadingTimer);
      return
    }
    $("div", loading).css("top", loadingFrame * -40 + "px");
    loadingFrame = (loadingFrame + 1) % 12
  };
  $.fn.fancybox = function(options) {
    if(!$(this).length) {
      return this
    }
    $(this).data("fancybox", $.extend({}, options, $.metadata ? $(this).metadata() : {})).unbind("click.fb").bind("click.fb", function(e) {
      e.preventDefault();
      if(busy) {
        return
      }
      busy = true;
      $(this).blur();
      selectedArray = [];
      selectedIndex = 0;
      var rel = $(this).attr("rel") || "";
      if(!rel || (rel == "" || rel === "nofollow")) {
        selectedArray.push(this)
      }else {
        selectedArray = $("a[rel=" + rel + "], area[rel=" + rel + "]");
        selectedIndex = selectedArray.index(this)
      }
      _start();
      return
    });
    return this
  };
  $.fancybox = function(obj) {
    var opts;
    if(busy) {
      return
    }
    busy = true;
    opts = typeof arguments[1] !== "undefined" ? arguments[1] : {};
    selectedArray = [];
    selectedIndex = parseInt(opts.index, 10) || 0;
    if($.isArray(obj)) {
      for(var i = 0, j = obj.length;i < j;i++) {
        if(typeof obj[i] == "object") {
          $(obj[i]).data("fancybox", $.extend({}, opts, obj[i]))
        }else {
          obj[i] = $({}).data("fancybox", $.extend({content:obj[i]}, opts))
        }
      }
      selectedArray = jQuery.merge(selectedArray, obj)
    }else {
      if(typeof obj == "object") {
        $(obj).data("fancybox", $.extend({}, opts, obj))
      }else {
        obj = $({}).data("fancybox", $.extend({content:obj}, opts))
      }
      selectedArray.push(obj)
    }
    if(selectedIndex > selectedArray.length || selectedIndex < 0) {
      selectedIndex = 0
    }
    _start()
  };
  $.fancybox.showActivity = function() {
    clearInterval(loadingTimer);
    loading.show();
    loadingTimer = setInterval(_animate_loading, 66)
  };
  $.fancybox.hideActivity = function() {
    loading.hide()
  };
  $.fancybox.next = function() {
    return $.fancybox.pos(currentIndex + 1)
  };
  $.fancybox.prev = function() {
    return $.fancybox.pos(currentIndex - 1)
  };
  $.fancybox.pos = function(pos) {
    if(busy) {
      return
    }
    pos = parseInt(pos);
    selectedArray = currentArray;
    if(pos > -1 && pos < currentArray.length) {
      selectedIndex = pos;
      _start()
    }else {
      if(currentOpts.cyclic && currentArray.length > 1) {
        selectedIndex = pos >= currentArray.length ? 0 : currentArray.length - 1;
        _start()
      }
    }
    return
  };
  $.fancybox.cancel = function() {
    if(busy) {
      return
    }
    busy = true;
    $.event.trigger("fancybox-cancel");
    _abort();
    selectedOpts.onCancel(selectedArray, selectedIndex, selectedOpts);
    busy = false
  };
  $.fancybox.close = function() {
    $(".joyride-close-tip").click();
    if(busy || wrap.is(":hidden")) {
      return
    }
    busy = true;
    if(currentOpts && false === currentOpts.onCleanup(currentArray, currentIndex, currentOpts)) {
      busy = false;
      return
    }
    _abort();
    $(close.add(nav_left).add(nav_right)).hide();
    $(content.add(overlay)).unbind();
    $(window).unbind("resize.fb scroll.fb");
    $(document).unbind("keydown.fb");
    content.find("iframe").attr("src", isIE6 && /^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank");
    if(currentOpts.titlePosition !== "inside") {
      title.empty()
    }
    wrap.stop();
    function _cleanup() {
      overlay.fadeOut("fast");
      title.empty().hide();
      wrap.hide();
      $.event.trigger("fancybox-cleanup");
      content.empty();
      currentOpts.onClosed(currentArray, currentIndex, currentOpts);
      currentArray = selectedOpts = [];
      currentIndex = selectedIndex = 0;
      currentOpts = selectedOpts = {};
      busy = false
    }
    if(currentOpts.transitionOut == "elastic") {
      start_pos = _get_zoom_from();
      var pos = wrap.position();
      final_pos = {top:pos.top, left:pos.left, width:wrap.width(), height:wrap.height()};
      if(currentOpts.opacity) {
        final_pos.opacity = 1
      }
      title.empty().hide();
      fx.prop = 1;
      $(fx).animate({prop:0}, {duration:currentOpts.speedOut, easing:currentOpts.easingOut, step:_draw, complete:_cleanup})
    }else {
      wrap.fadeOut(currentOpts.transitionOut == "none" ? 0 : currentOpts.speedOut, _cleanup)
    }
  };
  $.fancybox.resize = function() {
    if(overlay.is(":visible")) {
      overlay.css("height", $(document).height())
    }
    $.fancybox.center(true)
  };
  $.fancybox.center = function() {
    if(currentOpts && currentOpts.center === false) {
      return
    }
    var view, align;
    if(busy) {
      return
    }
    align = arguments[0] === true ? 1 : 0;
    view = _get_viewport();
    if(!align && (wrap.width() > view[0] || wrap.height() > view[1])) {
      return
    }
    wrap.stop().animate({"top":parseInt(Math.max(view[3] - 20, view[3] + (view[1] - content.height() - 40) * 0.5 - currentOpts.padding)), "left":parseInt(Math.max(view[2] - 20, view[2] + (view[0] - content.width() - 40) * 0.5 - currentOpts.padding))}, typeof arguments[0] == "number" ? arguments[0] : 200)
  };
  $.fancybox.init = function() {
    if($("#fancybox-wrap").length) {
      return
    }
    $("body").append(tmp = $('<div id="fancybox-tmp"></div>'), loading = $('<div id="fancybox-loading"><div></div></div>'), overlay = $('<div id="fancybox-overlay"></div>'), wrap = $('<div id="fancybox-wrap"></div>'));
    outer = $('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);
    outer.append(content = $('<div id="fancybox-content"></div>'), close = $('<a id="fancybox-close"></a>'), title = $('<div id="fancybox-title"></div>'), nav_left = $('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'), nav_right = $('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));
    close.click($.fancybox.close);
    loading.click($.fancybox.cancel);
    nav_left.click(function(e) {
      e.preventDefault();
      $.fancybox.prev()
    });
    nav_right.click(function(e) {
      e.preventDefault();
      $.fancybox.next()
    });
    if($.fn.mousewheel) {
      wrap.bind("mousewheel.fb", function(e, delta) {
        if(busy) {
          e.preventDefault()
        }else {
          if($(e.target).get(0).clientHeight == 0 || $(e.target).get(0).scrollHeight === $(e.target).get(0).clientHeight) {
            e.preventDefault();
            $.fancybox[delta > 0 ? "prev" : "next"]()
          }
        }
      })
    }
    if(!$.support.opacity) {
      wrap.addClass("fancybox-ie")
    }
    if(isIE6) {
      loading.addClass("fancybox-ie6");
      wrap.addClass("fancybox-ie6");
      $('<iframe id="fancybox-hide-sel-frame" src="' + (/^https/i.test(window.location.href || "") ? "javascript:void(false)" : "about:blank") + '" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)
    }
  };
  $.fn.fancybox.defaults = {padding:10, margin:40, opacity:false, modal:false, cyclic:false, scrolling:"auto", width:560, height:340, autoScale:true, autoDimensions:true, centerOnScroll:false, ajax:{}, swf:{wmode:"transparent"}, hideOnOverlayClick:true, hideOnContentClick:false, overlayShow:true, overlayOpacity:0.7, overlayColor:"#777", titleShow:true, titlePosition:"float", titleFormat:null, titleFromAlt:false, transitionIn:"fade", transitionOut:"fade", speedIn:300, speedOut:300, changeSpeed:300, 
  changeFade:"fast", easingIn:"swing", easingOut:"swing", showCloseButton:true, showNavArrows:true, enableEscapeButton:true, enableKeyboardNav:true, center:true, onStart:function() {
  }, onCancel:function() {
  }, onComplete:function() {
  }, onCleanup:function() {
  }, onClosed:function() {
  }, onError:function() {
  }};
  $(document).ready(function() {
    $.fancybox.init()
  })
})(jQuery);
(function($) {
  var feature = {};
  feature.fileapi = $("<input type='file'/>").get(0).files !== undefined;
  feature.formdata = window.FormData !== undefined;
  $.fn.ajaxSubmit = function(options) {
    if(!this.length) {
      log("ajaxSubmit: skipping submit process - no element selected");
      return this
    }
    var method, action, url, $form = this;
    if(typeof options == "function") {
      options = {success:options}
    }
    method = this.attr("method");
    action = this.attr("action");
    url = typeof action === "string" ? $.trim(action) : "";
    url = url || (window.location.href || "");
    if(url) {
      url = (url.match(/^([^#]+)/) || [])[1]
    }
    options = $.extend(true, {url:url, success:$.ajaxSettings.success, type:method || "GET", iframeSrc:/^https/i.test(window.location.href || "") ? "javascript:false" : "about:blank"}, options);
    var veto = {};
    this.trigger("form-pre-serialize", [this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-pre-serialize trigger");
      return this
    }
    if(options.beforeSerialize && options.beforeSerialize(this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSerialize callback");
      return this
    }
    var traditional = options.traditional;
    if(traditional === undefined) {
      traditional = $.ajaxSettings.traditional
    }
    var elements = [];
    var qx, a = this.formToArray(options.semantic, elements);
    if(options.data) {
      options.extraData = options.data;
      qx = $.param(options.data, traditional)
    }
    if(options.beforeSubmit && options.beforeSubmit(a, this, options) === false) {
      log("ajaxSubmit: submit aborted via beforeSubmit callback");
      return this
    }
    this.trigger("form-submit-validate", [a, this, options, veto]);
    if(veto.veto) {
      log("ajaxSubmit: submit vetoed via form-submit-validate trigger");
      return this
    }
    var q = $.param(a, traditional);
    if(qx) {
      q = q ? q + "&" + qx : qx
    }
    if(options.type.toUpperCase() == "GET") {
      options.url += (options.url.indexOf("?") >= 0 ? "&" : "?") + q;
      options.data = null
    }else {
      options.data = q
    }
    var callbacks = [];
    if(options.resetForm) {
      callbacks.push(function() {
        $form.resetForm()
      })
    }
    if(options.clearForm) {
      callbacks.push(function() {
        $form.clearForm(options.includeHidden)
      })
    }
    if(!options.dataType && options.target) {
      var oldSuccess = options.success || function() {
      };
      callbacks.push(function(data) {
        var fn = options.replaceTarget ? "replaceWith" : "html";
        $(options.target)[fn](data).each(oldSuccess, arguments)
      })
    }else {
      if(options.success) {
        callbacks.push(options.success)
      }
    }
    options.success = function(data, status, xhr) {
      var context = options.context || options;
      for(var i = 0, max = callbacks.length;i < max;i++) {
        callbacks[i].apply(context, [data, status, xhr || $form, $form])
      }
    };
    var fileInputs = $("input:file:enabled[value]", this);
    var hasFileInputs = fileInputs.length > 0;
    var mp = "multipart/form-data";
    var multipart = $form.attr("enctype") == mp || $form.attr("encoding") == mp;
    var fileAPI = feature.fileapi && feature.formdata;
    log("fileAPI :" + fileAPI);
    var shouldUseFrame = (hasFileInputs || multipart) && !fileAPI;
    if(options.iframe !== false && (options.iframe || shouldUseFrame)) {
      if(options.closeKeepAlive) {
        $.get(options.closeKeepAlive, function() {
          fileUploadIframe(a)
        })
      }else {
        fileUploadIframe(a)
      }
    }else {
      if((hasFileInputs || multipart) && fileAPI) {
        fileUploadXhr(a)
      }else {
        $.ajax(options)
      }
    }
    for(var k = 0;k < elements.length;k++) {
      elements[k] = null
    }
    this.trigger("form-submit-notify", [this, options]);
    return this;
    function fileUploadXhr(a) {
      var formdata = new FormData;
      for(var i = 0;i < a.length;i++) {
        formdata.append(a[i].name, a[i].value)
      }
      if(options.extraData) {
        for(var p in options.extraData) {
          if(options.extraData.hasOwnProperty(p)) {
            formdata.append(p, options.extraData[p])
          }
        }
      }
      options.data = null;
      var s = $.extend(true, {}, $.ajaxSettings, options, {contentType:false, processData:false, cache:false, type:"POST"});
      if(options.uploadProgress) {
        s.xhr = function() {
          var xhr = jQuery.ajaxSettings.xhr();
          if(xhr.upload) {
            xhr.upload.onprogress = function(event) {
              var percent = 0;
              var position = event.loaded || event.position;
              var total = event.total;
              if(event.lengthComputable) {
                percent = Math.ceil(position / total * 100)
              }
              options.uploadProgress(event, position, total, percent)
            }
          }
          return xhr
        }
      }
      s.data = null;
      var beforeSend = s.beforeSend;
      s.beforeSend = function(xhr, o) {
        o.data = formdata;
        if(beforeSend) {
          beforeSend.call(o, xhr, options)
        }
      };
      $.ajax(s)
    }
    function fileUploadIframe(a) {
      var form = $form[0], el, i, s, g, id, $io, io, xhr, sub, n, timedOut, timeoutHandle;
      var useProp = !!$.fn.prop;
      if($(":input[name=submit],:input[id=submit]", form).length) {
        return
      }
      if(a) {
        for(i = 0;i < elements.length;i++) {
          el = $(elements[i]);
          if(useProp) {
            el.prop("disabled", false)
          }else {
            el.removeAttr("disabled")
          }
        }
      }
      s = $.extend(true, {}, $.ajaxSettings, options);
      s.context = s.context || s;
      id = "jqFormIO" + (new Date).getTime();
      if(s.iframeTarget) {
        $io = $(s.iframeTarget);
        n = $io.attr("name");
        if(!n) {
          $io.attr("name", id)
        }else {
          id = n
        }
      }else {
        $io = $('<iframe name="' + id + '" src="' + s.iframeSrc + '" />');
        $io.css({position:"absolute", top:"-1000px", left:"-1000px"})
      }
      io = $io[0];
      xhr = {aborted:0, responseText:null, responseXML:null, status:0, statusText:"n/a", getAllResponseHeaders:function() {
      }, getResponseHeader:function() {
      }, setRequestHeader:function() {
      }, abort:function(status) {
        var e = status === "timeout" ? "timeout" : "aborted";
        log("aborting upload... " + e);
        this.aborted = 1;
        $io.attr("src", s.iframeSrc);
        xhr.error = e;
        if(s.error) {
          s.error.call(s.context, xhr, e, status)
        }
        if(g) {
          $.event.trigger("ajaxError", [xhr, s, e])
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, e)
        }
      }};
      g = s.global;
      if(g && 0 === $.active++) {
        $.event.trigger("ajaxStart")
      }
      if(g) {
        $.event.trigger("ajaxSend", [xhr, s])
      }
      if(s.beforeSend && s.beforeSend.call(s.context, xhr, s) === false) {
        if(s.global) {
          $.active--
        }
        return
      }
      if(xhr.aborted) {
        return
      }
      sub = form.clk;
      if(sub) {
        n = sub.name;
        if(n && !sub.disabled) {
          s.extraData = s.extraData || {};
          s.extraData[n] = sub.value;
          if(sub.type == "image") {
            s.extraData[n + ".x"] = form.clk_x;
            s.extraData[n + ".y"] = form.clk_y
          }
        }
      }
      var CLIENT_TIMEOUT_ABORT = 1;
      var SERVER_ABORT = 2;
      function getDoc(frame) {
        var doc = frame.contentWindow ? frame.contentWindow.document : frame.contentDocument ? frame.contentDocument : frame.document;
        return doc
      }
      var csrf_token = $("meta[name=csrf-token]").attr("content");
      var csrf_param = $("meta[name=csrf-param]").attr("content");
      if(csrf_param && csrf_token) {
        s.extraData = s.extraData || {};
        s.extraData[csrf_param] = csrf_token
      }
      function doSubmit() {
        var t = $form.attr("target"), a = $form.attr("action");
        form.setAttribute("target", id);
        if(!method) {
          form.setAttribute("method", "POST")
        }
        if(a != s.url) {
          form.setAttribute("action", s.url)
        }
        if(!s.skipEncodingOverride && (!method || /post/i.test(method))) {
          $form.attr({encoding:"multipart/form-data", enctype:"multipart/form-data"})
        }
        if(s.timeout) {
          timeoutHandle = setTimeout(function() {
            timedOut = true;
            cb(CLIENT_TIMEOUT_ABORT)
          }, s.timeout)
        }
        function checkState() {
          try {
            var state = getDoc(io).readyState;
            log("state = " + state);
            if(state && state.toLowerCase() == "uninitialized") {
              setTimeout(checkState, 50)
            }
          }catch(e) {
            log("Server abort: ", e, " (", e.name, ")");
            cb(SERVER_ABORT);
            if(timeoutHandle) {
              clearTimeout(timeoutHandle)
            }
            timeoutHandle = undefined
          }
        }
        var extraInputs = [];
        try {
          if(s.extraData) {
            for(var n in s.extraData) {
              if(s.extraData.hasOwnProperty(n)) {
                extraInputs.push($('<input type="hidden" name="' + n + '">').attr("value", s.extraData[n]).appendTo(form)[0])
              }
            }
          }
          if(!s.iframeTarget) {
            $io.appendTo("body");
            if(io.attachEvent) {
              io.attachEvent("onload", cb)
            }else {
              io.addEventListener("load", cb, false)
            }
          }
          setTimeout(checkState, 15);
          form.submit()
        }finally {
          form.setAttribute("action", a);
          if(t) {
            form.setAttribute("target", t)
          }else {
            $form.removeAttr("target")
          }
          $(extraInputs).remove()
        }
      }
      if(s.forceSync) {
        doSubmit()
      }else {
        setTimeout(doSubmit, 10)
      }
      var data, doc, domCheckCount = 50, callbackProcessed;
      function cb(e) {
        if(xhr.aborted || callbackProcessed) {
          return
        }
        try {
          doc = getDoc(io)
        }catch(ex) {
          log("cannot access response document: ", ex);
          e = SERVER_ABORT
        }
        if(e === CLIENT_TIMEOUT_ABORT && xhr) {
          xhr.abort("timeout");
          return
        }else {
          if(e == SERVER_ABORT && xhr) {
            xhr.abort("server abort");
            return
          }
        }
        if(!doc || doc.location.href == s.iframeSrc) {
          if(!timedOut) {
            return
          }
        }
        if(io.detachEvent) {
          io.detachEvent("onload", cb)
        }else {
          io.removeEventListener("load", cb, false)
        }
        var status = "success", errMsg;
        try {
          if(timedOut) {
            throw"timeout";
          }
          var isXml = s.dataType == "xml" || (doc.XMLDocument || $.isXMLDoc(doc));
          log("isXml=" + isXml);
          if(!isXml && (window.opera && (doc.body === null || !doc.body.innerHTML))) {
            if(--domCheckCount) {
              log("requeing onLoad callback, DOM not available");
              setTimeout(cb, 250);
              return
            }
          }
          var docRoot = doc.body ? doc.body : doc.documentElement;
          xhr.responseText = docRoot ? docRoot.innerHTML : null;
          xhr.responseXML = doc.XMLDocument ? doc.XMLDocument : doc;
          if(isXml) {
            s.dataType = "xml"
          }
          xhr.getResponseHeader = function(header) {
            var headers = {"content-type":s.dataType};
            return headers[header]
          };
          if(docRoot) {
            xhr.status = Number(docRoot.getAttribute("status")) || xhr.status;
            xhr.statusText = docRoot.getAttribute("statusText") || xhr.statusText
          }
          var dt = (s.dataType || "").toLowerCase();
          var scr = /(json|script|text)/.test(dt);
          if(scr || s.textarea) {
            var ta = doc.getElementsByTagName("textarea")[0];
            if(ta) {
              xhr.responseText = ta.value;
              xhr.status = Number(ta.getAttribute("status")) || xhr.status;
              xhr.statusText = ta.getAttribute("statusText") || xhr.statusText
            }else {
              if(scr) {
                var pre = doc.getElementsByTagName("pre")[0];
                var b = doc.getElementsByTagName("body")[0];
                if(pre) {
                  xhr.responseText = pre.textContent ? pre.textContent : pre.innerText
                }else {
                  if(b) {
                    xhr.responseText = b.textContent ? b.textContent : b.innerText
                  }
                }
              }
            }
          }else {
            if(dt == "xml" && (!xhr.responseXML && xhr.responseText)) {
              xhr.responseXML = toXml(xhr.responseText)
            }
          }
          try {
            data = httpData(xhr, dt, s)
          }catch(e) {
            status = "parsererror";
            xhr.error = errMsg = e || status
          }
        }catch(e) {
          log("error caught: ", e);
          status = "error";
          xhr.error = errMsg = e || status
        }
        if(xhr.aborted) {
          log("upload aborted");
          status = null
        }
        if(xhr.status) {
          status = xhr.status >= 200 && xhr.status < 300 || xhr.status === 304 ? "success" : "error"
        }
        if(status === "success") {
          if(s.success) {
            s.success.call(s.context, data, "success", xhr)
          }
          if(g) {
            $.event.trigger("ajaxSuccess", [xhr, s])
          }
        }else {
          if(status) {
            if(errMsg === undefined) {
              errMsg = xhr.statusText
            }
            if(s.error) {
              s.error.call(s.context, xhr, status, errMsg)
            }
            if(g) {
              $.event.trigger("ajaxError", [xhr, s, errMsg])
            }
          }
        }
        if(g) {
          $.event.trigger("ajaxComplete", [xhr, s])
        }
        if(g && !--$.active) {
          $.event.trigger("ajaxStop")
        }
        if(s.complete) {
          s.complete.call(s.context, xhr, status)
        }
        callbackProcessed = true;
        if(s.timeout) {
          clearTimeout(timeoutHandle)
        }
        setTimeout(function() {
          if(!s.iframeTarget) {
            $io.remove()
          }
          xhr.responseXML = null
        }, 100)
      }
      var toXml = $.parseXML || function(s, doc) {
        if(window.ActiveXObject) {
          doc = new ActiveXObject("Microsoft.XMLDOM");
          doc.async = "false";
          doc.loadXML(s)
        }else {
          doc = (new DOMParser).parseFromString(s, "text/xml")
        }
        return doc && (doc.documentElement && doc.documentElement.nodeName != "parsererror") ? doc : null
      };
      var parseJSON = $.parseJSON || function(s) {
        return window["eval"]("(" + s + ")")
      };
      var httpData = function(xhr, type, s) {
        var ct = xhr.getResponseHeader("content-type") || "", xml = type === "xml" || !type && ct.indexOf("xml") >= 0, data = xml ? xhr.responseXML : xhr.responseText;
        if(xml && data.documentElement.nodeName === "parsererror") {
          if($.error) {
            $.error("parsererror")
          }
        }
        if(s && s.dataFilter) {
          data = s.dataFilter(data, type)
        }
        if(typeof data === "string") {
          if(type === "json" || !type && ct.indexOf("json") >= 0) {
            data = parseJSON(data)
          }else {
            if(type === "script" || !type && ct.indexOf("javascript") >= 0) {
              $.globalEval(data)
            }
          }
        }
        return data
      }
    }
  };
  $.fn.ajaxForm = function(options) {
    options = options || {};
    options.delegation = options.delegation && $.isFunction($.fn.on);
    if(!options.delegation && this.length === 0) {
      var o = {s:this.selector, c:this.context};
      if(!$.isReady && o.s) {
        log("DOM not ready, queuing ajaxForm");
        $(function() {
          $(o.s, o.c).ajaxForm(options)
        });
        return this
      }
      log("terminating; zero elements found by selector" + ($.isReady ? "" : " (DOM not ready)"));
      return this
    }
    if(options.delegation) {
      $(document).off("submit.form-plugin", this.selector, doAjaxSubmit).off("click.form-plugin", this.selector, captureSubmittingElement).on("submit.form-plugin", this.selector, options, doAjaxSubmit).on("click.form-plugin", this.selector, options, captureSubmittingElement);
      return this
    }
    return this.ajaxFormUnbind().bind("submit.form-plugin", options, doAjaxSubmit).bind("click.form-plugin", options, captureSubmittingElement)
  };
  function doAjaxSubmit(e) {
    var options = e.data;
    if(!e.isDefaultPrevented()) {
      e.preventDefault();
      $(this).ajaxSubmit(options)
    }
  }
  function captureSubmittingElement(e) {
    var target = e.target;
    var $el = $(target);
    if(!$el.is(":submit,input:image")) {
      var t = $el.closest(":submit");
      if(t.length === 0) {
        return
      }
      target = t[0]
    }
    var form = this;
    form.clk = target;
    if(target.type == "image") {
      if(e.offsetX !== undefined) {
        form.clk_x = e.offsetX;
        form.clk_y = e.offsetY
      }else {
        if(typeof $.fn.offset == "function") {
          var offset = $el.offset();
          form.clk_x = e.pageX - offset.left;
          form.clk_y = e.pageY - offset.top
        }else {
          form.clk_x = e.pageX - target.offsetLeft;
          form.clk_y = e.pageY - target.offsetTop
        }
      }
    }
    setTimeout(function() {
      form.clk = form.clk_x = form.clk_y = null
    }, 100)
  }
  $.fn.ajaxFormUnbind = function() {
    return this.unbind("submit.form-plugin click.form-plugin")
  };
  $.fn.formToArray = function(semantic, elements) {
    var a = [];
    if(this.length === 0) {
      return a
    }
    var form = this[0];
    var els = semantic ? form.getElementsByTagName("*") : form.elements;
    if(!els) {
      return a
    }
    var i, j, n, v, el, max, jmax;
    for(i = 0, max = els.length;i < max;i++) {
      el = els[i];
      n = el.name;
      if(!n) {
        continue
      }
      if(semantic && (form.clk && el.type == "image")) {
        if(!el.disabled && form.clk == el) {
          a.push({name:n, value:$(el).val(), type:el.type});
          a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
        }
        continue
      }
      v = $.fieldValue(el, true);
      if(v && v.constructor == Array) {
        if(elements) {
          elements.push(el)
        }
        for(j = 0, jmax = v.length;j < jmax;j++) {
          a.push({name:n, value:v[j]})
        }
      }else {
        if(feature.fileapi && (el.type == "file" && !el.disabled)) {
          if(elements) {
            elements.push(el)
          }
          var files = el.files;
          if(files.length) {
            for(j = 0;j < files.length;j++) {
              a.push({name:n, value:files[j], type:el.type})
            }
          }else {
            a.push({name:n, value:"", type:el.type})
          }
        }else {
          if(v !== null && typeof v != "undefined") {
            if(elements) {
              elements.push(el)
            }
            a.push({name:n, value:v, type:el.type, required:el.required})
          }
        }
      }
    }
    if(!semantic && form.clk) {
      var $input = $(form.clk), input = $input[0];
      n = input.name;
      if(n && (!input.disabled && input.type == "image")) {
        a.push({name:n, value:$input.val()});
        a.push({name:n + ".x", value:form.clk_x}, {name:n + ".y", value:form.clk_y})
      }
    }
    return a
  };
  $.fn.formSerialize = function(semantic) {
    return $.param(this.formToArray(semantic))
  };
  $.fn.fieldSerialize = function(successful) {
    var a = [];
    this.each(function() {
      var n = this.name;
      if(!n) {
        return
      }
      var v = $.fieldValue(this, successful);
      if(v && v.constructor == Array) {
        for(var i = 0, max = v.length;i < max;i++) {
          a.push({name:n, value:v[i]})
        }
      }else {
        if(v !== null && typeof v != "undefined") {
          a.push({name:this.name, value:v})
        }
      }
    });
    return $.param(a)
  };
  $.fn.fieldValue = function(successful) {
    for(var val = [], i = 0, max = this.length;i < max;i++) {
      var el = this[i];
      var v = $.fieldValue(el, successful);
      if(v === null || (typeof v == "undefined" || v.constructor == Array && !v.length)) {
        continue
      }
      if(v.constructor == Array) {
        $.merge(val, v)
      }else {
        val.push(v)
      }
    }
    return val
  };
  $.fieldValue = function(el, successful) {
    var n = el.name, t = el.type, tag = el.tagName.toLowerCase();
    if(successful === undefined) {
      successful = true
    }
    if(successful && (!n || (el.disabled || (t == "reset" || (t == "button" || ((t == "checkbox" || t == "radio") && !el.checked || ((t == "submit" || t == "image") && (el.form && el.form.clk != el) || tag == "select" && el.selectedIndex == -1))))))) {
      return null
    }
    if(tag == "select") {
      var index = el.selectedIndex;
      if(index < 0) {
        return null
      }
      var a = [], ops = el.options;
      var one = t == "select-one";
      var max = one ? index + 1 : ops.length;
      for(var i = one ? index : 0;i < max;i++) {
        var op = ops[i];
        if(op.selected) {
          var v = op.value;
          if(!v) {
            v = op.attributes && (op.attributes["value"] && !op.attributes["value"].specified) ? op.text : op.value
          }
          if(one) {
            return v
          }
          a.push(v)
        }
      }
      return a
    }
    return $(el).val()
  };
  $.fn.clearForm = function(includeHidden) {
    return this.each(function() {
      $("input,select,textarea", this).clearFields(includeHidden)
    })
  };
  $.fn.clearFields = $.fn.clearInputs = function(includeHidden) {
    var re = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;
    return this.each(function() {
      var t = this.type, tag = this.tagName.toLowerCase();
      if(re.test(t) || tag == "textarea") {
        this.value = ""
      }else {
        if(t == "checkbox" || t == "radio") {
          this.checked = false
        }else {
          if(tag == "select") {
            this.selectedIndex = -1
          }else {
            if(includeHidden) {
              if(includeHidden === true && /hidden/.test(t) || typeof includeHidden == "string" && $(this).is(includeHidden)) {
                this.value = ""
              }
            }
          }
        }
      }
    })
  };
  $.fn.resetForm = function() {
    return this.each(function() {
      if(typeof this.reset == "function" || typeof this.reset == "object" && !this.reset.nodeType) {
        this.reset()
      }
    })
  };
  $.fn.enable = function(b) {
    if(b === undefined) {
      b = true
    }
    return this.each(function() {
      this.disabled = !b
    })
  };
  $.fn.selected = function(select) {
    if(select === undefined) {
      select = true
    }
    return this.each(function() {
      var t = this.type;
      if(t == "checkbox" || t == "radio") {
        this.checked = select
      }else {
        if(this.tagName.toLowerCase() == "option") {
          var $sel = $(this).parent("select");
          if(select && ($sel[0] && $sel[0].type == "select-one")) {
            $sel.find("option").selected(false)
          }
          this.selected = select
        }
      }
    })
  };
  $.fn.ajaxSubmit.debug = false;
  function log() {
    if(!$.fn.ajaxSubmit.debug) {
      return
    }
    var msg = "[jquery.form] " + Array.prototype.join.call(arguments, "");
    if(window.console && window.console.log) {
      window.console.log(msg)
    }else {
      if(window.opera && window.opera.postError) {
        window.opera.postError(msg)
      }
    }
  }
})(jQuery);
(function($) {
  $.fn.joyride = function(options) {
    var settings = {"tipLocation":"bottom", "scrollSpeed":300, "timer":0, "startTimerOnClick":false, "nextButton":true, "tipAnimation":"fade", "tipAnimationFadeSpeed":300, "cookieMonster":false, "cookieName":"JoyRide", "cookieDomain":false, "tipContainer":"body", "inline":false, "tipContent":"#joyRideTipContent", "postRideCallback":$.noop, "postStepCallback":$.noop, "postInitCallback":$.noop};
    var options = $.extend(settings, options);
    return this.each(function() {
      if($(options.tipContent).length === 0) {
        return
      }
      $(options.tipContent).hide();
      var bodyOffset = $(options.tipContainer).children("*").first().position(), tipContent = $(options.tipContent + " > li"), count = skipCount = 0, prevCount = -1, timerIndicatorInstance, timerIndicatorTemplate = '<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>';
      var tipTemplate = function(tipClass, index, buttonText, self) {
        return'<div class="joyride-tip-guide ' + tipClass + '" id="joyRidePopup' + index + '"><span class="joyride-nub"></span><div class="joyride-content-wrapper">' + $(self).html() + buttonText + '<a href="#close" class="joyride-close-tip"></a>' + timerIndicatorInstance + "</div></div>"
      };
      var tipLayout = function(tipClass, index, buttonText, self) {
        if(index == 0 && (settings.startTimerOnClick && settings.timer > 0) || settings.timer == 0) {
          timerIndicatorInstance = ""
        }else {
          timerIndicatorInstance = timerIndicatorTemplate
        }
        if(!tipClass) {
          tipClass = ""
        }
        if(buttonText) {
          buttonText = '<a href="#" class="joyride-next-tip small nice radius yellow button">' + buttonText + "</a>"
        }else {
          buttonText = ""
        }
        if(settings.inline) {
          $(tipTemplate(tipClass, index, buttonText, self)).insertAfter("#" + $(self).data("id"))
        }else {
          $(options.tipContainer).append(tipTemplate(tipClass, index, buttonText, self))
        }
      };
      if(!settings.cookieMonster || !$.cookie(settings.cookieName)) {
        tipContent.each(function(index) {
          var buttonText = $(this).data("text"), tipClass = $(this).attr("class"), self = this;
          if(settings.nextButton && !buttonText) {
            buttonText = "Next"
          }
          if(settings.nextButton || !settings.nextButton && settings.startTimerOnClick) {
            if($(this).attr("class")) {
              tipLayout(tipClass, index, buttonText, self)
            }else {
              tipLayout(false, index, buttonText, self)
            }
          }else {
            if(!settings.nextButton) {
              if($(this).attr("class")) {
                tipLayout(tipClass, index, "", self)
              }else {
                tipLayout(false, index, "", self)
              }
            }
          }
          $("#joyRidePopup" + index).hide();
          if(index === 0) {
            $("#joyRidePopup" + index).addClass("joyRideCurrent")
          }
        })
      }
      showNextTip = function() {
        var parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID), opt = {};
        $.each(($(tipContent[count]).data("options") || ":").split(";"), function(i, s) {
          var p = s.split(":");
          if(p.length == 2) {
            opt[$.trim(p[0])] = $.trim(p[1])
          }
        });
        var tipSettings = $.extend({}, settings, opt);
        while(parentElement.offset() === null) {
          count++;
          skipCount++;
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
          parentElementID = $(tipContent[count]).data("id"), parentElement = $("#" + parentElementID);
          if($(tipContent).length < count) {
            break
          }
        }
        if(count === 0 && settings.onInitCallback != $.noop) {
          settings.onInitCallback()
        }
        var windowHalf = Math.ceil($(window).height() / 2), currentTip = $("#joyRidePopup" + count), currentTipPosition = parentElement.offset(), currentParentHeight = parentElement.outerHeight(), currentTipHeight = currentTip.outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2), tipOffset = 0;
        if(currentTip.length === 0) {
          return
        }
        $(".joyRideCurrent").removeClass("joyRideCurrent");
        $(currentTip).addClass("joyRideCurrent");
        if(count < tipContent.length) {
          if(settings.tipAnimation == "pop") {
            $(".joyride-timer-indicator").width(0);
            if(settings.timer > 0) {
              currentTip.show().children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
            }else {
              currentTip.show()
            }
          }else {
            if(settings.tipAnimation == "fade") {
              $(".joyride-timer-indicator").width(0);
              if(settings.timer > 0) {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed).children(".joyride-timer-indicator-wrap").children(".joyride-timer-indicator").animate({width:$(".joyride-timer-indicator-wrap").width()}, settings.timer)
              }else {
                currentTip.fadeIn(settings.tipAnimationFadeSpeed)
              }
            }
          }
          var nub = currentTip.children(".joyride-nub");
          var left = currentTipPosition.left - bodyOffset.left;
          nub.removeClass("bottom").removeClass("top").removeClass("right");
          if($(window).scrollLeft() + $(window).width() < left + currentTip.width()) {
            left -= currentTip.width() - nub.offset().left * 2;
            nub.addClass("right")
          }
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(tipSettings.tipLocation.indexOf("top") != -1) {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top});
                nub.addClass("top").css({left:left})
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight)});
                nub.addClass("bottom").css({left:left})
              }
            }else {
              currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight});
              nub.addClass("top").css({left:left})
            }
          }else {
            if(tipSettings.tipLocation == "top") {
              if(currentTipHeight >= currentTipPosition.top) {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight - bodyOffset.top, left:left});
                nub.addClass("top")
              }else {
                currentTip.offset({top:currentTipPosition.top - (currentTipHeight + bodyOffset.top + nubHeight), left:left});
                nub.addClass("bottom")
              }
            }else {
              if(tipSettings.tipLocation == "bottom") {
                currentTip.offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:left});
                nub.addClass("top")
              }
            }
          }
          if(tipSettings.tipLocation.indexOf("right") != -1) {
            currentTip.offset({left:currentTipPosition.left - bodyOffset.left - currentTip.width() + parentElement.width()});
            currentTip.children(".joyride-nub").addClass("right")
          }
          tipOffset = Math.ceil(currentTip.offset().top - windowHalf);
          $("html, body").animate({scrollTop:tipOffset}, settings.scrollSpeed);
          if(count > 0) {
            if(skipCount > 0) {
              var hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              var hideCount = prevCount
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).hide()
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeOut(settings.tipAnimationFadeSpeed)
              }
            }
          }
        }else {
          if(tipContent.length - 1 < count) {
            var hideCnt;
            if(skipCount > 0) {
              hideCount = prevCount - skipCount;
              skipCount = 0
            }else {
              hideCount = prevCount
            }
            if(settings.cookieMonster == true) {
              $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
            }
            if(settings.tipAnimation == "pop") {
              $("#joyRidePopup" + hideCount).fadeTo(0, 0)
            }else {
              if(settings.tipAnimation == "fade") {
                $("#joyRidePopup" + hideCount).fadeTo(settings.tipAnimationFadeSpeed, 0)
              }
            }
          }
        }
        count++;
        if(prevCount < 0) {
          prevCount = 0
        }else {
          if(tipContent.length - 1 > prevCount) {
            prevCount++
          }
        }
        if(settings.postStepCallback != $.noop) {
          settings.postStepCallback(prevCount)
        }
      };
      if(!settings.inline || (!settings.cookieMonster || !$.cookie(settings.cookieName))) {
        $(window).resize(function() {
          var parentElementID = $(tipContent[prevCount]).data("id"), currentTipPosition = $("#" + parentElementID).offset(), currentParentHeight = $("#" + parentElementID).outerHeight(), currentTipHeight = $("#joyRidePopup" + prevCount).outerHeight(), nubHeight = Math.ceil($(".joyride-nub").outerHeight() / 2);
          if(Modernizr.mq("only screen and (max-width: 769px)")) {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:0});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:currentTipPosition.left - bodyOffset.left})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:0});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:currentTipPosition.left - bodyOffset.left})
                }
              }
            }
          }else {
            if(settings.tipLocation == "bottom") {
              $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + currentParentHeight + nubHeight, left:currentTipPosition.left});
              $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
            }else {
              if(settings.tipLocation == "top") {
                if(currentTipPosition.top <= currentTipHeight) {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top + nubHeight + currentParentHeight, left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("top").removeClass("bottom").css({left:""})
                }else {
                  $("#joyRidePopup" + prevCount).offset({top:currentTipPosition.top - (currentTipHeight + nubHeight), left:currentTipPosition.left});
                  $("#joyRidePopup" + prevCount).children(".joyride-nub").addClass("bottom").removeClass("top").css({left:""})
                }
              }
            }
          }
        })
      }
      var interval_id = null, showTimerState = false;
      if(!settings.startTimerOnClick && settings.timer > 0) {
        showNextTip();
        interval_id = setInterval(function() {
          showNextTip()
        }, settings.timer)
      }else {
        showNextTip()
      }
      var endTip = function(e, interval_id, cookie, self) {
        e.preventDefault();
        clearInterval(interval_id);
        if(cookie) {
          $.cookie(settings.cookieName, "ridden", {expires:365, domain:settings.cookieDomain})
        }
        $(self).parent().parent().hide();
        if(settings.postRideCallback != $.noop) {
          settings.postRideCallback()
        }
        $(".joyRideCurrent").removeClass("joyRideCurrent")
      };
      $(".joyride-close-tip").click(function(e) {
        endTip(e, interval_id, settings.cookieMonster, this)
      });
      $(".joyride-next-tip").click(function(e) {
        e.preventDefault();
        if(count >= tipContent.length) {
          endTip(e, interval_id, settings.cookieMonster, this)
        }
        if(settings.timer > 0 && settings.startTimerOnClick) {
          showNextTip();
          clearInterval(interval_id);
          interval_id = setInterval(function() {
            showNextTip()
          }, settings.timer)
        }else {
          if(settings.timer > 0 && !settings.startTimerOnClick) {
            clearInterval(interval_id);
            interval_id = setInterval(function() {
              showNextTip()
            }, settings.timer)
          }else {
            showNextTip()
          }
        }
      })
    })
  }
})(jQuery);
(function(a) {
  function d(b) {
    var c = b || window.event, d = [].slice.call(arguments, 1), e = 0, f = !0, g = 0, h = 0;
    return b = a.event.fix(c), b.type = "mousewheel", c.wheelDelta && (e = c.wheelDelta / 120), c.detail && (e = -c.detail / 3), h = e, c.axis !== undefined && (c.axis === c.HORIZONTAL_AXIS && (h = 0, g = -1 * e)), c.wheelDeltaY !== undefined && (h = c.wheelDeltaY / 120), c.wheelDeltaX !== undefined && (g = -1 * c.wheelDeltaX / 120), d.unshift(b, e, g, h), (a.event.dispatch || a.event.handle).apply(this, d)
  }
  var b = ["DOMMouseScroll", "mousewheel"];
  if(a.event.fixHooks) {
    for(var c = b.length;c;) {
      a.event.fixHooks[b[--c]] = a.event.mouseHooks
    }
  }
  a.event.special.mousewheel = {setup:function() {
    if(this.addEventListener) {
      for(var a = b.length;a;) {
        this.addEventListener(b[--a], d, !1)
      }
    }else {
      this.onmousewheel = d
    }
  }, teardown:function() {
    if(this.removeEventListener) {
      for(var a = b.length;a;) {
        this.removeEventListener(b[--a], d, !1)
      }
    }else {
      this.onmousewheel = null
    }
  }}, a.fn.extend({mousewheel:function(a) {
    return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
  }, unmousewheel:function(a) {
    return this.unbind("mousewheel", a)
  }})
})(jQuery);
(function(c) {
  var b = {init:function(e) {
    var f = {set_width:false, set_height:false, horizontalScroll:false, scrollInertia:950, mouseWheel:true, mouseWheelPixels:"auto", autoDraggerLength:true, autoHideScrollbar:false, snapAmount:null, snapOffset:0, scrollButtons:{enable:false, scrollType:"continuous", scrollSpeed:"auto", scrollAmount:40}, advanced:{updateOnBrowserResize:true, updateOnContentResize:false, autoExpandHorizontalScroll:false, autoScrollOnFocus:true, normalizeMouseWheelDelta:false}, contentTouchScroll:true, callbacks:{onScrollStart:function() {
    }, onScroll:function() {
    }, onTotalScroll:function() {
    }, onTotalScrollBack:function() {
    }, onTotalScrollOffset:0, onTotalScrollBackOffset:0, whileScrolling:function() {
    }}, theme:"light"}, e = c.extend(true, f, e);
    return this.each(function() {
      var m = c(this);
      if(e.set_width) {
        m.css("width", e.set_width)
      }
      if(e.set_height) {
        m.css("height", e.set_height)
      }
      if(!c(document).data("mCustomScrollbar-index")) {
        c(document).data("mCustomScrollbar-index", "1")
      }else {
        var t = parseInt(c(document).data("mCustomScrollbar-index"));
        c(document).data("mCustomScrollbar-index", t + 1)
      }
      m.wrapInner("<div class='mCustomScrollBox mCS-" + e.theme + "' id='mCSB_" + c(document).data("mCustomScrollbar-index") + "' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_" + c(document).data("mCustomScrollbar-index"));
      var g = m.children(".mCustomScrollBox");
      if(e.horizontalScroll) {
        g.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");
        var k = g.children(".mCSB_h_wrapper");
        k.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:k.children().outerWidth(), position:"relative"}).unwrap()
      }else {
        g.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />")
      }
      var o = g.children(".mCSB_container");
      if(c.support.touch) {
        o.addClass("mCS_touch")
      }
      o.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");
      var l = g.children(".mCSB_scrollTools"), h = l.children(".mCSB_draggerContainer"), q = h.children(".mCSB_dragger");
      if(e.horizontalScroll) {
        q.data("minDraggerWidth", q.width())
      }else {
        q.data("minDraggerHeight", q.height())
      }
      if(e.scrollButtons.enable) {
        if(e.horizontalScroll) {
          l.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>")
        }else {
          l.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")
        }
      }
      g.bind("scroll", function() {
        if(!m.is(".mCS_disabled")) {
          g.scrollTop(0).scrollLeft(0)
        }
      });
      m.data({mCS_Init:true, mCustomScrollbarIndex:c(document).data("mCustomScrollbar-index"), horizontalScroll:e.horizontalScroll, scrollInertia:e.scrollInertia, scrollEasing:"mcsEaseOut", mouseWheel:e.mouseWheel, mouseWheelPixels:e.mouseWheelPixels, autoDraggerLength:e.autoDraggerLength, autoHideScrollbar:e.autoHideScrollbar, snapAmount:e.snapAmount, snapOffset:e.snapOffset, scrollButtons_enable:e.scrollButtons.enable, scrollButtons_scrollType:e.scrollButtons.scrollType, scrollButtons_scrollSpeed:e.scrollButtons.scrollSpeed, 
      scrollButtons_scrollAmount:e.scrollButtons.scrollAmount, autoExpandHorizontalScroll:e.advanced.autoExpandHorizontalScroll, autoScrollOnFocus:e.advanced.autoScrollOnFocus, normalizeMouseWheelDelta:e.advanced.normalizeMouseWheelDelta, contentTouchScroll:e.contentTouchScroll, onScrollStart_Callback:e.callbacks.onScrollStart, onScroll_Callback:e.callbacks.onScroll, onTotalScroll_Callback:e.callbacks.onTotalScroll, onTotalScrollBack_Callback:e.callbacks.onTotalScrollBack, onTotalScroll_Offset:e.callbacks.onTotalScrollOffset, 
      onTotalScrollBack_Offset:e.callbacks.onTotalScrollBackOffset, whileScrolling_Callback:e.callbacks.whileScrolling, bindEvent_scrollbar_drag:false, bindEvent_content_touch:false, bindEvent_scrollbar_click:false, bindEvent_mousewheel:false, bindEvent_buttonsContinuous_y:false, bindEvent_buttonsContinuous_x:false, bindEvent_buttonsPixels_y:false, bindEvent_buttonsPixels_x:false, bindEvent_focusin:false, bindEvent_autoHideScrollbar:false, mCSB_buttonScrollRight:false, mCSB_buttonScrollLeft:false, 
      mCSB_buttonScrollDown:false, mCSB_buttonScrollUp:false});
      if(e.horizontalScroll) {
        if(m.css("max-width") !== "none") {
          if(!e.advanced.updateOnContentResize) {
            e.advanced.updateOnContentResize = true
          }
        }
      }else {
        if(m.css("max-height") !== "none") {
          var s = false, r = parseInt(m.css("max-height"));
          if(m.css("max-height").indexOf("%") >= 0) {
            s = r, r = m.parent().height() * s / 100
          }
          m.css("overflow", "hidden");
          g.css("max-height", r)
        }
      }
      m.mCustomScrollbar("update");
      if(e.advanced.updateOnBrowserResize) {
        var i, j = c(window).width(), u = c(window).height();
        c(window).bind("resize." + m.data("mCustomScrollbarIndex"), function() {
          if(i) {
            clearTimeout(i)
          }
          i = setTimeout(function() {
            if(!m.is(".mCS_disabled") && !m.is(".mCS_destroyed")) {
              var w = c(window).width(), v = c(window).height();
              if(j !== w || u !== v) {
                if(m.css("max-height") !== "none" && s) {
                  g.css("max-height", m.parent().height() * s / 100)
                }
                m.mCustomScrollbar("update");
                j = w;
                u = v
              }
            }
          }, 150)
        })
      }
      if(e.advanced.updateOnContentResize) {
        var p;
        if(e.horizontalScroll) {
          var n = o.outerWidth()
        }else {
          var n = o.outerHeight()
        }
        p = setInterval(function() {
          if(e.horizontalScroll) {
            if(e.advanced.autoExpandHorizontalScroll) {
              o.css({position:"absolute", width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:o.outerWidth(), position:"relative"}).unwrap()
            }
            var v = o.outerWidth()
          }else {
            var v = o.outerHeight()
          }
          if(v != n) {
            m.mCustomScrollbar("update");
            n = v
          }
        }, 300)
      }
    })
  }, update:function() {
    var n = c(this), k = n.children(".mCustomScrollBox"), q = k.children(".mCSB_container");
    q.removeClass("mCS_no_scrollbar");
    n.removeClass("mCS_disabled mCS_destroyed");
    k.scrollTop(0).scrollLeft(0);
    var y = k.children(".mCSB_scrollTools"), o = y.children(".mCSB_draggerContainer"), m = o.children(".mCSB_dragger");
    if(n.data("horizontalScroll")) {
      var A = y.children(".mCSB_buttonLeft"), t = y.children(".mCSB_buttonRight"), f = k.width();
      if(n.data("autoExpandHorizontalScroll")) {
        q.css({position:"absolute", width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:q.outerWidth(), position:"relative"}).unwrap()
      }
      var z = q.outerWidth()
    }else {
      var w = y.children(".mCSB_buttonUp"), g = y.children(".mCSB_buttonDown"), r = k.height(), i = q.outerHeight()
    }
    if(i > r && !n.data("horizontalScroll")) {
      y.css("display", "block");
      var s = o.height();
      if(n.data("autoDraggerLength")) {
        var u = Math.round(r / i * s), l = m.data("minDraggerHeight");
        if(u <= l) {
          m.css({height:l})
        }else {
          if(u >= s - 10) {
            var p = s - 10;
            m.css({height:p})
          }else {
            m.css({height:u})
          }
        }
        m.children(".mCSB_dragger_bar").css({"line-height":m.height() + "px"})
      }
      var B = m.height(), x = (i - r) / (s - B);
      n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t);
      var D = Math.abs(q.position().top);
      n.mCustomScrollbar("scrollTo", D, {scrollInertia:0, trigger:"internal"})
    }else {
      if(z > f && n.data("horizontalScroll")) {
        y.css("display", "block");
        var h = o.width();
        if(n.data("autoDraggerLength")) {
          var j = Math.round(f / z * h), C = m.data("minDraggerWidth");
          if(j <= C) {
            m.css({width:C})
          }else {
            if(j >= h - 10) {
              var e = h - 10;
              m.css({width:e})
            }else {
              m.css({width:j})
            }
          }
        }
        var v = m.width(), x = (z - f) / (h - v);
        n.data("scrollAmount", x).mCustomScrollbar("scrolling", k, q, o, m, w, g, A, t);
        var D = Math.abs(q.position().left);
        n.mCustomScrollbar("scrollTo", D, {scrollInertia:0, trigger:"internal"})
      }else {
        k.unbind("mousewheel focusin");
        if(n.data("horizontalScroll")) {
          m.add(q).css("left", 0)
        }else {
          m.add(q).css("top", 0)
        }
        y.css("display", "none");
        q.addClass("mCS_no_scrollbar");
        n.data({bindEvent_mousewheel:false, bindEvent_focusin:false})
      }
    }
  }, scrolling:function(h, p, m, j, w, e, A, v) {
    var k = c(this);
    if(!k.data("bindEvent_scrollbar_drag")) {
      var n, o;
      if(c.support.msPointer) {
        j.bind("MSPointerDown", function(H) {
          H.preventDefault();
          k.data({on_drag:true});
          j.addClass("mCSB_dragger_onDrag");
          var G = c(this), J = G.offset(), F = H.originalEvent.pageX - J.left, I = H.originalEvent.pageY - J.top;
          if(F < G.width() && (F > 0 && (I < G.height() && I > 0))) {
            n = I;
            o = F
          }
        });
        c(document).bind("MSPointerMove." + k.data("mCustomScrollbarIndex"), function(H) {
          H.preventDefault();
          if(k.data("on_drag")) {
            var G = j, J = G.offset(), F = H.originalEvent.pageX - J.left, I = H.originalEvent.pageY - J.top;
            D(n, o, I, F)
          }
        }).bind("MSPointerUp." + k.data("mCustomScrollbarIndex"), function(x) {
          k.data({on_drag:false});
          j.removeClass("mCSB_dragger_onDrag")
        })
      }else {
        j.bind("mousedown touchstart", function(H) {
          H.preventDefault();
          H.stopImmediatePropagation();
          var G = c(this), K = G.offset(), F, J;
          if(H.type === "touchstart") {
            var I = H.originalEvent.touches[0] || H.originalEvent.changedTouches[0];
            F = I.pageX - K.left;
            J = I.pageY - K.top
          }else {
            k.data({on_drag:true});
            j.addClass("mCSB_dragger_onDrag");
            F = H.pageX - K.left;
            J = H.pageY - K.top
          }
          if(F < G.width() && (F > 0 && (J < G.height() && J > 0))) {
            n = J;
            o = F
          }
        }).bind("touchmove", function(H) {
          H.preventDefault();
          H.stopImmediatePropagation();
          var K = H.originalEvent.touches[0] || H.originalEvent.changedTouches[0], G = c(this), J = G.offset(), F = K.pageX - J.left, I = K.pageY - J.top;
          D(n, o, I, F)
        });
        c(document).bind("mousemove." + k.data("mCustomScrollbarIndex"), function(H) {
          if(k.data("on_drag")) {
            var G = j, J = G.offset(), F = H.pageX - J.left, I = H.pageY - J.top;
            D(n, o, I, F)
          }
        }).bind("mouseup." + k.data("mCustomScrollbarIndex"), function(x) {
          k.data({on_drag:false});
          j.removeClass("mCSB_dragger_onDrag")
        })
      }
      k.data({bindEvent_scrollbar_drag:true})
    }
    function D(G, H, I, F) {
      if(k.data("horizontalScroll")) {
        k.mCustomScrollbar("scrollTo", j.position().left - H + F, {moveDragger:true, trigger:"internal"})
      }else {
        k.mCustomScrollbar("scrollTo", j.position().top - G + I, {moveDragger:true, trigger:"internal"})
      }
    }
    if(c.support.touch && k.data("contentTouchScroll")) {
      if(!k.data("bindEvent_content_touch")) {
        var l, B, r, s, u, C, E;
        p.bind("touchstart", function(x) {
          x.stopImmediatePropagation();
          l = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0];
          B = c(this);
          r = B.offset();
          u = l.pageX - r.left;
          s = l.pageY - r.top;
          C = s;
          E = u
        });
        p.bind("touchmove", function(x) {
          x.preventDefault();
          x.stopImmediatePropagation();
          l = x.originalEvent.touches[0] || x.originalEvent.changedTouches[0];
          B = c(this).parent();
          r = B.offset();
          u = l.pageX - r.left;
          s = l.pageY - r.top;
          if(k.data("horizontalScroll")) {
            k.mCustomScrollbar("scrollTo", E - u, {trigger:"internal"})
          }else {
            k.mCustomScrollbar("scrollTo", C - s, {trigger:"internal"})
          }
        })
      }
    }
    if(!k.data("bindEvent_scrollbar_click")) {
      m.bind("click", function(F) {
        var x = (F.pageY - m.offset().top) * k.data("scrollAmount"), y = c(F.target);
        if(k.data("horizontalScroll")) {
          x = (F.pageX - m.offset().left) * k.data("scrollAmount")
        }
        if(y.hasClass("mCSB_draggerContainer") || y.hasClass("mCSB_draggerRail")) {
          k.mCustomScrollbar("scrollTo", x, {trigger:"internal", scrollEasing:"draggerRailEase"})
        }
      });
      k.data({bindEvent_scrollbar_click:true})
    }
    if(k.data("mouseWheel")) {
      if(!k.data("bindEvent_mousewheel")) {
        h.bind("mousewheel", function(H, J) {
          var G, F = k.data("mouseWheelPixels"), x = Math.abs(p.position().top), I = j.position().top, y = m.height() - j.height();
          if(k.data("normalizeMouseWheelDelta")) {
            if(J < 0) {
              J = -1
            }else {
              J = 1
            }
          }
          if(F === "auto") {
            F = 100 + Math.round(k.data("scrollAmount") / 2)
          }
          if(k.data("horizontalScroll")) {
            I = j.position().left;
            y = m.width() - j.width();
            x = Math.abs(p.position().left)
          }
          if(J > 0 && I !== 0 || J < 0 && I !== y) {
            H.preventDefault();
            H.stopImmediatePropagation()
          }
          G = x - J * F;
          k.mCustomScrollbar("scrollTo", G, {trigger:"internal"})
        });
        k.data({bindEvent_mousewheel:true})
      }
    }
    if(k.data("scrollButtons_enable")) {
      if(k.data("scrollButtons_scrollType") === "pixels") {
        if(k.data("horizontalScroll")) {
          v.add(A).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend", i, g);
          k.data({bindEvent_buttonsContinuous_x:false});
          if(!k.data("bindEvent_buttonsPixels_x")) {
            v.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().left) + k.data("scrollButtons_scrollAmount"))
            });
            A.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().left) - k.data("scrollButtons_scrollAmount"))
            });
            k.data({bindEvent_buttonsPixels_x:true})
          }
        }else {
          e.add(w).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend", i, g);
          k.data({bindEvent_buttonsContinuous_y:false});
          if(!k.data("bindEvent_buttonsPixels_y")) {
            e.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().top) + k.data("scrollButtons_scrollAmount"))
            });
            w.bind("click", function(x) {
              x.preventDefault();
              q(Math.abs(p.position().top) - k.data("scrollButtons_scrollAmount"))
            });
            k.data({bindEvent_buttonsPixels_y:true})
          }
        }
        function q(x) {
          if(!j.data("preventAction")) {
            j.data("preventAction", true);
            k.mCustomScrollbar("scrollTo", x, {trigger:"internal"})
          }
        }
      }else {
        if(k.data("horizontalScroll")) {
          v.add(A).unbind("click");
          k.data({bindEvent_buttonsPixels_x:false});
          if(!k.data("bindEvent_buttonsContinuous_x")) {
            v.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollRight:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().left) + x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var i = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollRight"))
            };
            v.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", i);
            A.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollLeft:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().left) - x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var g = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollLeft"))
            };
            A.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", g);
            k.data({bindEvent_buttonsContinuous_x:true})
          }
        }else {
          e.add(w).unbind("click");
          k.data({bindEvent_buttonsPixels_y:false});
          if(!k.data("bindEvent_buttonsContinuous_y")) {
            e.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollDown:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().top) + x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var t = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollDown"))
            };
            e.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", t);
            w.bind("mousedown touchstart MSPointerDown", function(y) {
              y.preventDefault();
              var x = z();
              k.data({mCSB_buttonScrollUp:setInterval(function() {
                k.mCustomScrollbar("scrollTo", Math.abs(p.position().top) - x, {trigger:"internal", scrollEasing:"easeOutCirc"})
              }, 17)})
            });
            var f = function(x) {
              x.preventDefault();
              clearInterval(k.data("mCSB_buttonScrollUp"))
            };
            w.bind("mouseup touchend MSPointerUp mouseout MSPointerOut", f);
            k.data({bindEvent_buttonsContinuous_y:true})
          }
        }
        function z() {
          var x = k.data("scrollButtons_scrollSpeed");
          if(k.data("scrollButtons_scrollSpeed") === "auto") {
            x = Math.round((k.data("scrollInertia") + 100) / 40)
          }
          return x
        }
      }
    }
    if(k.data("autoScrollOnFocus")) {
      if(!k.data("bindEvent_focusin")) {
        h.bind("focusin", function() {
          h.scrollTop(0).scrollLeft(0);
          var x = c(document.activeElement);
          if(x.is("input,textarea,select,button,a[tabindex],area,object")) {
            var G = p.position().top, y = x.position().top, F = h.height() - x.outerHeight();
            if(k.data("horizontalScroll")) {
              G = p.position().left;
              y = x.position().left;
              F = h.width() - x.outerWidth()
            }
            if(G + y < 0 || G + y > F) {
              k.mCustomScrollbar("scrollTo", y, {trigger:"internal"})
            }
          }
        });
        k.data({bindEvent_focusin:true})
      }
    }
    if(k.data("autoHideScrollbar")) {
      if(!k.data("bindEvent_autoHideScrollbar")) {
        h.bind("mouseenter", function(x) {
          h.addClass("mCS-mouse-over");
          d.showScrollbar.call(h.children(".mCSB_scrollTools"))
        }).bind("mouseleave touchend", function(x) {
          h.removeClass("mCS-mouse-over");
          if(x.type === "mouseleave") {
            d.hideScrollbar.call(h.children(".mCSB_scrollTools"))
          }
        });
        k.data({bindEvent_autoHideScrollbar:true})
      }
    }
  }, scrollTo:function(e, f) {
    var i = c(this), o = {moveDragger:false, trigger:"external", callbacks:true, scrollInertia:i.data("scrollInertia"), scrollEasing:i.data("scrollEasing")}, f = c.extend(o, f), p, g = i.children(".mCustomScrollBox"), k = g.children(".mCSB_container"), r = g.children(".mCSB_scrollTools"), j = r.children(".mCSB_draggerContainer"), h = j.children(".mCSB_dragger"), t = draggerSpeed = f.scrollInertia, q, s, m, l;
    if(!k.hasClass("mCS_no_scrollbar")) {
      i.data({mCS_trigger:f.trigger});
      if(i.data("mCS_Init")) {
        f.callbacks = false
      }
      if(e || e === 0) {
        if(typeof e === "number") {
          if(f.moveDragger) {
            p = e;
            if(i.data("horizontalScroll")) {
              e = h.position().left * i.data("scrollAmount")
            }else {
              e = h.position().top * i.data("scrollAmount")
            }
            draggerSpeed = 0
          }else {
            p = e / i.data("scrollAmount")
          }
        }else {
          if(typeof e === "string") {
            var v;
            if(e === "top") {
              v = 0
            }else {
              if(e === "bottom" && !i.data("horizontalScroll")) {
                v = k.outerHeight() - g.height()
              }else {
                if(e === "left") {
                  v = 0
                }else {
                  if(e === "right" && i.data("horizontalScroll")) {
                    v = k.outerWidth() - g.width()
                  }else {
                    if(e === "first") {
                      v = i.find(".mCSB_container").find(":first")
                    }else {
                      if(e === "last") {
                        v = i.find(".mCSB_container").find(":last")
                      }else {
                        v = i.find(e)
                      }
                    }
                  }
                }
              }
            }
            if(v.length === 1) {
              if(i.data("horizontalScroll")) {
                e = v.position().left
              }else {
                e = v.position().top
              }
              p = e / i.data("scrollAmount")
            }else {
              p = e = v
            }
          }
        }
        if(i.data("horizontalScroll")) {
          if(i.data("onTotalScrollBack_Offset")) {
            s = -i.data("onTotalScrollBack_Offset")
          }
          if(i.data("onTotalScroll_Offset")) {
            l = g.width() - k.outerWidth() + i.data("onTotalScroll_Offset")
          }
          if(p < 0) {
            p = e = 0;
            clearInterval(i.data("mCSB_buttonScrollLeft"));
            if(!s) {
              q = true
            }
          }else {
            if(p >= j.width() - h.width()) {
              p = j.width() - h.width();
              e = g.width() - k.outerWidth();
              clearInterval(i.data("mCSB_buttonScrollRight"));
              if(!l) {
                m = true
              }
            }else {
              e = -e
            }
          }
          var n = i.data("snapAmount");
          if(n) {
            e = Math.round(e / n) * n - i.data("snapOffset")
          }
          d.mTweenAxis.call(this, h[0], "left", Math.round(p), draggerSpeed, f.scrollEasing);
          d.mTweenAxis.call(this, k[0], "left", Math.round(e), t, f.scrollEasing, {onStart:function() {
            if(f.callbacks && !i.data("mCS_tweenRunning")) {
              u("onScrollStart")
            }
            if(i.data("autoHideScrollbar")) {
              d.showScrollbar.call(r)
            }
          }, onUpdate:function() {
            if(f.callbacks) {
              u("whileScrolling")
            }
          }, onComplete:function() {
            if(f.callbacks) {
              u("onScroll");
              if(q || s && k.position().left >= s) {
                u("onTotalScrollBack")
              }
              if(m || l && k.position().left <= l) {
                u("onTotalScroll")
              }
            }
            h.data("preventAction", false);
            i.data("mCS_tweenRunning", false);
            if(i.data("autoHideScrollbar")) {
              if(!g.hasClass("mCS-mouse-over")) {
                d.hideScrollbar.call(r)
              }
            }
          }})
        }else {
          if(i.data("onTotalScrollBack_Offset")) {
            s = -i.data("onTotalScrollBack_Offset")
          }
          if(i.data("onTotalScroll_Offset")) {
            l = g.height() - k.outerHeight() + i.data("onTotalScroll_Offset")
          }
          if(p < 0) {
            p = e = 0;
            clearInterval(i.data("mCSB_buttonScrollUp"));
            if(!s) {
              q = true
            }
          }else {
            if(p >= j.height() - h.height()) {
              p = j.height() - h.height();
              e = g.height() - k.outerHeight();
              clearInterval(i.data("mCSB_buttonScrollDown"));
              if(!l) {
                m = true
              }
            }else {
              e = -e
            }
          }
          var n = i.data("snapAmount");
          if(n) {
            e = Math.round(e / n) * n - i.data("snapOffset")
          }
          d.mTweenAxis.call(this, h[0], "top", Math.round(p), draggerSpeed, f.scrollEasing);
          d.mTweenAxis.call(this, k[0], "top", Math.round(e), t, f.scrollEasing, {onStart:function() {
            if(f.callbacks && !i.data("mCS_tweenRunning")) {
              u("onScrollStart")
            }
            if(i.data("autoHideScrollbar")) {
              d.showScrollbar.call(r)
            }
          }, onUpdate:function() {
            if(f.callbacks) {
              u("whileScrolling")
            }
          }, onComplete:function() {
            if(f.callbacks) {
              u("onScroll");
              if(q || s && k.position().top >= s) {
                u("onTotalScrollBack")
              }
              if(m || l && k.position().top <= l) {
                u("onTotalScroll")
              }
            }
            h.data("preventAction", false);
            i.data("mCS_tweenRunning", false);
            if(i.data("autoHideScrollbar")) {
              if(!g.hasClass("mCS-mouse-over")) {
                d.hideScrollbar.call(r)
              }
            }
          }})
        }
        if(i.data("mCS_Init")) {
          i.data({mCS_Init:false})
        }
      }
    }
    function u(w) {
      this.mcs = {top:k.position().top, left:k.position().left, draggerTop:h.position().top, draggerLeft:h.position().left, topPct:Math.round(100 * Math.abs(k.position().top) / Math.abs(k.outerHeight() - g.height())), leftPct:Math.round(100 * Math.abs(k.position().left) / Math.abs(k.outerWidth() - g.width()))};
      switch(w) {
        case "onScrollStart":
          i.data("mCS_tweenRunning", true).data("onScrollStart_Callback").call(i, this.mcs);
          break;
        case "whileScrolling":
          i.data("whileScrolling_Callback").call(i, this.mcs);
          break;
        case "onScroll":
          i.data("onScroll_Callback").call(i, this.mcs);
          break;
        case "onTotalScrollBack":
          i.data("onTotalScrollBack_Callback").call(i, this.mcs);
          break;
        case "onTotalScroll":
          i.data("onTotalScroll_Callback").call(i, this.mcs);
          break
      }
    }
  }, stop:function() {
    var g = c(this), e = g.children().children(".mCSB_container"), f = g.children().children().children().children(".mCSB_dragger");
    d.mTweenAxisStop.call(this, e[0]);
    d.mTweenAxisStop.call(this, f[0])
  }, disable:function(e) {
    var j = c(this), f = j.children(".mCustomScrollBox"), h = f.children(".mCSB_container"), g = f.children(".mCSB_scrollTools"), i = g.children().children(".mCSB_dragger");
    f.unbind("mousewheel focusin mouseenter mouseleave touchend");
    h.unbind("touchstart touchmove");
    if(e) {
      if(j.data("horizontalScroll")) {
        i.add(h).css("left", 0)
      }else {
        i.add(h).css("top", 0)
      }
    }
    g.css("display", "none");
    h.addClass("mCS_no_scrollbar");
    j.data({bindEvent_mousewheel:false, bindEvent_focusin:false, bindEvent_content_touch:false, bindEvent_autoHideScrollbar:false}).addClass("mCS_disabled")
  }, destroy:function() {
    var e = c(this);
    e.removeClass("mCustomScrollbar _mCS_" + e.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove();
    c(document).unbind("mousemove." + e.data("mCustomScrollbarIndex") + " mouseup." + e.data("mCustomScrollbarIndex") + " MSPointerMove." + e.data("mCustomScrollbarIndex") + " MSPointerUp." + e.data("mCustomScrollbarIndex"));
    c(window).unbind("resize." + e.data("mCustomScrollbarIndex"))
  }}, d = {showScrollbar:function() {
    this.stop().animate({opacity:1}, "fast")
  }, hideScrollbar:function() {
    this.stop().animate({opacity:0}, "fast")
  }, mTweenAxis:function(g, i, h, f, o, y) {
    var y = y || {}, v = y.onStart || function() {
    }, p = y.onUpdate || function() {
    }, w = y.onComplete || function() {
    };
    var n = t(), l, j = 0, r = g.offsetTop, s = g.style;
    if(i === "left") {
      r = g.offsetLeft
    }
    var m = h - r;
    q();
    e();
    function t() {
      if(window.performance && window.performance.now) {
        return window.performance.now()
      }else {
        if(window.performance && window.performance.webkitNow) {
          return window.performance.webkitNow()
        }else {
          if(Date.now) {
            return Date.now()
          }else {
            return(new Date).getTime()
          }
        }
      }
    }
    function x() {
      if(!j) {
        v.call()
      }
      j = t() - n;
      u();
      if(j >= g._time) {
        g._time = j > g._time ? j + l - (j - g._time) : j + l - 1;
        if(g._time < j + 1) {
          g._time = j + 1
        }
      }
      if(g._time < f) {
        g._id = _request(x)
      }else {
        w.call()
      }
    }
    function u() {
      if(f > 0) {
        g.currVal = k(g._time, r, m, f, o);
        s[i] = Math.round(g.currVal) + "px"
      }else {
        s[i] = h + "px"
      }
      p.call()
    }
    function e() {
      l = 1E3 / 60;
      g._time = j + l;
      _request = !window.requestAnimationFrame ? function(z) {
        u();
        return setTimeout(z, 0.01)
      } : window.requestAnimationFrame;
      g._id = _request(x)
    }
    function q() {
      if(g._id == null) {
        return
      }
      if(!window.requestAnimationFrame) {
        clearTimeout(g._id)
      }else {
        window.cancelAnimationFrame(g._id)
      }
      g._id = null
    }
    function k(B, A, F, E, C) {
      switch(C) {
        case "linear":
          return F * B / E + A;
          break;
        case "easeOutQuad":
          B /= E;
          return-F * B * (B - 2) + A;
          break;
        case "easeInOutQuad":
          B /= E / 2;
          if(B < 1) {
            return F / 2 * B * B + A
          }
          B--;
          return-F / 2 * (B * (B - 2) - 1) + A;
          break;
        case "easeOutCubic":
          B /= E;
          B--;
          return F * (B * B * B + 1) + A;
          break;
        case "easeOutQuart":
          B /= E;
          B--;
          return-F * (B * B * B * B - 1) + A;
          break;
        case "easeOutQuint":
          B /= E;
          B--;
          return F * (B * B * B * B * B + 1) + A;
          break;
        case "easeOutCirc":
          B /= E;
          B--;
          return F * Math.sqrt(1 - B * B) + A;
          break;
        case "easeOutSine":
          return F * Math.sin(B / E * (Math.PI / 2)) + A;
          break;
        case "easeOutExpo":
          return F * (-Math.pow(2, -10 * B / E) + 1) + A;
          break;
        case "mcsEaseOut":
          var D = (B /= E) * B, z = D * B;
          return A + F * (0.499999999999997 * z * D + -2.5 * D * D + 5.5 * z + -6.5 * D + 4 * B);
          break;
        case "draggerRailEase":
          B /= E / 2;
          if(B < 1) {
            return F / 2 * B * B * B + A
          }
          B -= 2;
          return F / 2 * (B * B * B + 2) + A;
          break
      }
    }
  }, mTweenAxisStop:function(e) {
    if(e._id == null) {
      return
    }
    if(!window.requestAnimationFrame) {
      clearTimeout(e._id)
    }else {
      window.cancelAnimationFrame(e._id)
    }
    e._id = null
  }, rafPolyfill:function() {
    var f = ["ms", "moz", "webkit", "o"], e = f.length;
    while(--e > -1 && !window.requestAnimationFrame) {
      window.requestAnimationFrame = window[f[e] + "RequestAnimationFrame"];
      window.cancelAnimationFrame = window[f[e] + "CancelAnimationFrame"] || window[f[e] + "CancelRequestAnimationFrame"]
    }
  }};
  d.rafPolyfill.call();
  c.support.touch = !!("ontouchstart" in window);
  c.support.msPointer = window.navigator.msPointerEnabled;
  var a = "https:" == document.location.protocol ? "https:" : "http:";
  c.event.special.mousewheel || document.write('<script src="' + a + '//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js">\x3c/script>');
  c.fn.mCustomScrollbar = function(e) {
    if(b[e]) {
      return b[e].apply(this, Array.prototype.slice.call(arguments, 1))
    }else {
      if(typeof e === "object" || !e) {
        return b.init.apply(this, arguments)
      }else {
        c.error("Method " + e + " does not exist")
      }
    }
  }
})(jQuery);
(function(r) {
  r.fn.qrcode = function(h) {
    var s;
    function u(a) {
      this.mode = s;
      this.data = a
    }
    function o(a, c) {
      this.typeNumber = a;
      this.errorCorrectLevel = c;
      this.modules = null;
      this.moduleCount = 0;
      this.dataCache = null;
      this.dataList = []
    }
    function q(a, c) {
      if(void 0 == a.length) {
        throw Error(a.length + "/" + c);
      }
      for(var d = 0;d < a.length && 0 == a[d];) {
        d++
      }
      this.num = Array(a.length - d + c);
      for(var b = 0;b < a.length - d;b++) {
        this.num[b] = a[b + d]
      }
    }
    function p(a, c) {
      this.totalCount = a;
      this.dataCount = c
    }
    function t() {
      this.buffer = [];
      this.length = 0
    }
    u.prototype = {getLength:function() {
      return this.data.length
    }, write:function(a) {
      for(var c = 0;c < this.data.length;c++) {
        a.put(this.data.charCodeAt(c), 8)
      }
    }};
    o.prototype = {addData:function(a) {
      this.dataList.push(new u(a));
      this.dataCache = null
    }, isDark:function(a, c) {
      if(0 > a || (this.moduleCount <= a || (0 > c || this.moduleCount <= c))) {
        throw Error(a + "," + c);
      }
      return this.modules[a][c]
    }, getModuleCount:function() {
      return this.moduleCount
    }, make:function() {
      if(1 > this.typeNumber) {
        for(var a = 1, a = 1;40 > a;a++) {
          for(var c = p.getRSBlocks(a, this.errorCorrectLevel), d = new t, b = 0, e = 0;e < c.length;e++) {
            b += c[e].dataCount
          }
          for(e = 0;e < this.dataList.length;e++) {
            c = this.dataList[e], d.put(c.mode, 4), d.put(c.getLength(), j.getLengthInBits(c.mode, a)), c.write(d)
          }
          if(d.getLengthInBits() <= 8 * b) {
            break
          }
        }
        this.typeNumber = a
      }
      this.makeImpl(!1, this.getBestMaskPattern())
    }, makeImpl:function(a, c) {
      this.moduleCount = 4 * this.typeNumber + 17;
      this.modules = Array(this.moduleCount);
      for(var d = 0;d < this.moduleCount;d++) {
        this.modules[d] = Array(this.moduleCount);
        for(var b = 0;b < this.moduleCount;b++) {
          this.modules[d][b] = null
        }
      }
      this.setupPositionProbePattern(0, 0);
      this.setupPositionProbePattern(this.moduleCount - 7, 0);
      this.setupPositionProbePattern(0, this.moduleCount - 7);
      this.setupPositionAdjustPattern();
      this.setupTimingPattern();
      this.setupTypeInfo(a, c);
      7 <= this.typeNumber && this.setupTypeNumber(a);
      null == this.dataCache && (this.dataCache = o.createData(this.typeNumber, this.errorCorrectLevel, this.dataList));
      this.mapData(this.dataCache, c)
    }, setupPositionProbePattern:function(a, c) {
      for(var d = -1;7 >= d;d++) {
        if(!(-1 >= a + d || this.moduleCount <= a + d)) {
          for(var b = -1;7 >= b;b++) {
            -1 >= c + b || (this.moduleCount <= c + b || (this.modules[a + d][c + b] = 0 <= d && (6 >= d && (0 == b || 6 == b)) || (0 <= b && (6 >= b && (0 == d || 6 == d)) || 2 <= d && (4 >= d && (2 <= b && 4 >= b))) ? !0 : !1))
          }
        }
      }
    }, getBestMaskPattern:function() {
      for(var a = 0, c = 0, d = 0;8 > d;d++) {
        this.makeImpl(!0, d);
        var b = j.getLostPoint(this);
        if(0 == d || a > b) {
          a = b, c = d
        }
      }
      return c
    }, createMovieClip:function(a, c, d) {
      a = a.createEmptyMovieClip(c, d);
      this.make();
      for(c = 0;c < this.modules.length;c++) {
        for(var d = 1 * c, b = 0;b < this.modules[c].length;b++) {
          var e = 1 * b;
          this.modules[c][b] && (a.beginFill(0, 100), a.moveTo(e, d), a.lineTo(e + 1, d), a.lineTo(e + 1, d + 1), a.lineTo(e, d + 1), a.endFill())
        }
      }
      return a
    }, setupTimingPattern:function() {
      for(var a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[a][6] && (this.modules[a][6] = 0 == a % 2)
      }
      for(a = 8;a < this.moduleCount - 8;a++) {
        null == this.modules[6][a] && (this.modules[6][a] = 0 == a % 2)
      }
    }, setupPositionAdjustPattern:function() {
      for(var a = j.getPatternPosition(this.typeNumber), c = 0;c < a.length;c++) {
        for(var d = 0;d < a.length;d++) {
          var b = a[c], e = a[d];
          if(null == this.modules[b][e]) {
            for(var f = -2;2 >= f;f++) {
              for(var i = -2;2 >= i;i++) {
                this.modules[b + f][e + i] = -2 == f || (2 == f || (-2 == i || (2 == i || 0 == f && 0 == i))) ? !0 : !1
              }
            }
          }
        }
      }
    }, setupTypeNumber:function(a) {
      for(var c = j.getBCHTypeNumber(this.typeNumber), d = 0;18 > d;d++) {
        var b = !a && 1 == (c >> d & 1);
        this.modules[Math.floor(d / 3)][d % 3 + this.moduleCount - 8 - 3] = b
      }
      for(d = 0;18 > d;d++) {
        b = !a && 1 == (c >> d & 1), this.modules[d % 3 + this.moduleCount - 8 - 3][Math.floor(d / 3)] = b
      }
    }, setupTypeInfo:function(a, c) {
      for(var d = j.getBCHTypeInfo(this.errorCorrectLevel << 3 | c), b = 0;15 > b;b++) {
        var e = !a && 1 == (d >> b & 1);
        6 > b ? this.modules[b][8] = e : 8 > b ? this.modules[b + 1][8] = e : this.modules[this.moduleCount - 15 + b][8] = e
      }
      for(b = 0;15 > b;b++) {
        e = !a && 1 == (d >> b & 1), 8 > b ? this.modules[8][this.moduleCount - b - 1] = e : 9 > b ? this.modules[8][15 - b - 1 + 1] = e : this.modules[8][15 - b - 1] = e
      }
      this.modules[this.moduleCount - 8][8] = !a
    }, mapData:function(a, c) {
      for(var d = -1, b = this.moduleCount - 1, e = 7, f = 0, i = this.moduleCount - 1;0 < i;i -= 2) {
        for(6 == i && i--;;) {
          for(var g = 0;2 > g;g++) {
            if(null == this.modules[b][i - g]) {
              var n = !1;
              f < a.length && (n = 1 == (a[f] >>> e & 1));
              j.getMask(c, b, i - g) && (n = !n);
              this.modules[b][i - g] = n;
              e--;
               -1 == e && (f++, e = 7)
            }
          }
          b += d;
          if(0 > b || this.moduleCount <= b) {
            b -= d;
            d = -d;
            break
          }
        }
      }
    }};
    o.PAD0 = 236;
    o.PAD1 = 17;
    o.createData = function(a, c, d) {
      for(var c = p.getRSBlocks(a, c), b = new t, e = 0;e < d.length;e++) {
        var f = d[e];
        b.put(f.mode, 4);
        b.put(f.getLength(), j.getLengthInBits(f.mode, a));
        f.write(b)
      }
      for(e = a = 0;e < c.length;e++) {
        a += c[e].dataCount
      }
      if(b.getLengthInBits() > 8 * a) {
        throw Error("code length overflow. (" + b.getLengthInBits() + ">" + 8 * a + ")");
      }
      for(b.getLengthInBits() + 4 <= 8 * a && b.put(0, 4);0 != b.getLengthInBits() % 8;) {
        b.putBit(!1)
      }
      for(;!(b.getLengthInBits() >= 8 * a);) {
        b.put(o.PAD0, 8);
        if(b.getLengthInBits() >= 8 * a) {
          break
        }
        b.put(o.PAD1, 8)
      }
      return o.createBytes(b, c)
    };
    o.createBytes = function(a, c) {
      for(var d = 0, b = 0, e = 0, f = Array(c.length), i = Array(c.length), g = 0;g < c.length;g++) {
        var n = c[g].dataCount, h = c[g].totalCount - n, b = Math.max(b, n), e = Math.max(e, h);
        f[g] = Array(n);
        for(var k = 0;k < f[g].length;k++) {
          f[g][k] = 255 & a.buffer[k + d]
        }
        d += n;
        k = j.getErrorCorrectPolynomial(h);
        n = (new q(f[g], k.getLength() - 1)).mod(k);
        i[g] = Array(k.getLength() - 1);
        for(k = 0;k < i[g].length;k++) {
          h = k + n.getLength() - i[g].length, i[g][k] = 0 <= h ? n.get(h) : 0
        }
      }
      for(k = g = 0;k < c.length;k++) {
        g += c[k].totalCount
      }
      d = Array(g);
      for(k = n = 0;k < b;k++) {
        for(g = 0;g < c.length;g++) {
          k < f[g].length && (d[n++] = f[g][k])
        }
      }
      for(k = 0;k < e;k++) {
        for(g = 0;g < c.length;g++) {
          k < i[g].length && (d[n++] = i[g][k])
        }
      }
      return d
    };
    s = 4;
    for(var j = {PATTERN_POSITION_TABLE:[[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], 
    [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]], G15:1335, G18:7973, G15_MASK:21522, getBCHTypeInfo:function(a) {
      for(var c = a << 10;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G15);) {
        c ^= j.G15 << j.getBCHDigit(c) - j.getBCHDigit(j.G15)
      }
      return(a << 10 | c) ^ j.G15_MASK
    }, getBCHTypeNumber:function(a) {
      for(var c = a << 12;0 <= j.getBCHDigit(c) - j.getBCHDigit(j.G18);) {
        c ^= j.G18 << j.getBCHDigit(c) - j.getBCHDigit(j.G18)
      }
      return a << 12 | c
    }, getBCHDigit:function(a) {
      for(var c = 0;0 != a;) {
        c++, a >>>= 1
      }
      return c
    }, getPatternPosition:function(a) {
      return j.PATTERN_POSITION_TABLE[a - 1]
    }, getMask:function(a, c, d) {
      switch(a) {
        case 0:
          return 0 == (c + d) % 2;
        case 1:
          return 0 == c % 2;
        case 2:
          return 0 == d % 3;
        case 3:
          return 0 == (c + d) % 3;
        case 4:
          return 0 == (Math.floor(c / 2) + Math.floor(d / 3)) % 2;
        case 5:
          return 0 == c * d % 2 + c * d % 3;
        case 6:
          return 0 == (c * d % 2 + c * d % 3) % 2;
        case 7:
          return 0 == (c * d % 3 + (c + d) % 2) % 2;
        default:
          throw Error("bad maskPattern:" + a);
      }
    }, getErrorCorrectPolynomial:function(a) {
      for(var c = new q([1], 0), d = 0;d < a;d++) {
        c = c.multiply(new q([1, l.gexp(d)], 0))
      }
      return c
    }, getLengthInBits:function(a, c) {
      if(1 <= c && 10 > c) {
        switch(a) {
          case 1:
            return 10;
          case 2:
            return 9;
          case s:
            return 8;
          case 8:
            return 8;
          default:
            throw Error("mode:" + a);
        }
      }else {
        if(27 > c) {
          switch(a) {
            case 1:
              return 12;
            case 2:
              return 11;
            case s:
              return 16;
            case 8:
              return 10;
            default:
              throw Error("mode:" + a);
          }
        }else {
          if(41 > c) {
            switch(a) {
              case 1:
                return 14;
              case 2:
                return 13;
              case s:
                return 16;
              case 8:
                return 12;
              default:
                throw Error("mode:" + a);
            }
          }else {
            throw Error("type:" + c);
          }
        }
      }
    }, getLostPoint:function(a) {
      for(var c = a.getModuleCount(), d = 0, b = 0;b < c;b++) {
        for(var e = 0;e < c;e++) {
          for(var f = 0, i = a.isDark(b, e), g = -1;1 >= g;g++) {
            if(!(0 > b + g || c <= b + g)) {
              for(var h = -1;1 >= h;h++) {
                0 > e + h || (c <= e + h || (0 == g && 0 == h || i == a.isDark(b + g, e + h) && f++))
              }
            }
          }
          5 < f && (d += 3 + f - 5)
        }
      }
      for(b = 0;b < c - 1;b++) {
        for(e = 0;e < c - 1;e++) {
          if(f = 0, a.isDark(b, e) && f++, a.isDark(b + 1, e) && f++, a.isDark(b, e + 1) && f++, a.isDark(b + 1, e + 1) && f++, 0 == f || 4 == f) {
            d += 3
          }
        }
      }
      for(b = 0;b < c;b++) {
        for(e = 0;e < c - 6;e++) {
          a.isDark(b, e) && (!a.isDark(b, e + 1) && (a.isDark(b, e + 2) && (a.isDark(b, e + 3) && (a.isDark(b, e + 4) && (!a.isDark(b, e + 5) && (a.isDark(b, e + 6) && (d += 40)))))))
        }
      }
      for(e = 0;e < c;e++) {
        for(b = 0;b < c - 6;b++) {
          a.isDark(b, e) && (!a.isDark(b + 1, e) && (a.isDark(b + 2, e) && (a.isDark(b + 3, e) && (a.isDark(b + 4, e) && (!a.isDark(b + 5, e) && (a.isDark(b + 6, e) && (d += 40)))))))
        }
      }
      for(e = f = 0;e < c;e++) {
        for(b = 0;b < c;b++) {
          a.isDark(b, e) && f++
        }
      }
      a = Math.abs(100 * f / c / c - 50) / 5;
      return d + 10 * a
    }}, l = {glog:function(a) {
      if(1 > a) {
        throw Error("glog(" + a + ")");
      }
      return l.LOG_TABLE[a]
    }, gexp:function(a) {
      for(;0 > a;) {
        a += 255
      }
      for(;256 <= a;) {
        a -= 255
      }
      return l.EXP_TABLE[a]
    }, EXP_TABLE:Array(256), LOG_TABLE:Array(256)}, m = 0;8 > m;m++) {
      l.EXP_TABLE[m] = 1 << m
    }
    for(m = 8;256 > m;m++) {
      l.EXP_TABLE[m] = l.EXP_TABLE[m - 4] ^ l.EXP_TABLE[m - 5] ^ l.EXP_TABLE[m - 6] ^ l.EXP_TABLE[m - 8]
    }
    for(m = 0;255 > m;m++) {
      l.LOG_TABLE[l.EXP_TABLE[m]] = m
    }
    q.prototype = {get:function(a) {
      return this.num[a]
    }, getLength:function() {
      return this.num.length
    }, multiply:function(a) {
      for(var c = Array(this.getLength() + a.getLength() - 1), d = 0;d < this.getLength();d++) {
        for(var b = 0;b < a.getLength();b++) {
          c[d + b] ^= l.gexp(l.glog(this.get(d)) + l.glog(a.get(b)))
        }
      }
      return new q(c, 0)
    }, mod:function(a) {
      if(0 > this.getLength() - a.getLength()) {
        return this
      }
      for(var c = l.glog(this.get(0)) - l.glog(a.get(0)), d = Array(this.getLength()), b = 0;b < this.getLength();b++) {
        d[b] = this.get(b)
      }
      for(b = 0;b < a.getLength();b++) {
        d[b] ^= l.gexp(l.glog(a.get(b)) + c)
      }
      return(new q(d, 0)).mod(a)
    }};
    p.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 
    14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], 
    [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 
    70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 
    74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 
    117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 
    145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], 
    [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];
    p.getRSBlocks = function(a, c) {
      var d = p.getRsBlockTable(a, c);
      if(void 0 == d) {
        throw Error("bad rs block @ typeNumber:" + a + "/errorCorrectLevel:" + c);
      }
      for(var b = d.length / 3, e = [], f = 0;f < b;f++) {
        for(var h = d[3 * f + 0], g = d[3 * f + 1], j = d[3 * f + 2], l = 0;l < h;l++) {
          e.push(new p(g, j))
        }
      }
      return e
    };
    p.getRsBlockTable = function(a, c) {
      switch(c) {
        case 1:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 0];
        case 0:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 1];
        case 3:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 2];
        case 2:
          return p.RS_BLOCK_TABLE[4 * (a - 1) + 3]
      }
    };
    t.prototype = {get:function(a) {
      return 1 == (this.buffer[Math.floor(a / 8)] >>> 7 - a % 8 & 1)
    }, put:function(a, c) {
      for(var d = 0;d < c;d++) {
        this.putBit(1 == (a >>> c - d - 1 & 1))
      }
    }, getLengthInBits:function() {
      return this.length
    }, putBit:function(a) {
      var c = Math.floor(this.length / 8);
      this.buffer.length <= c && this.buffer.push(0);
      a && (this.buffer[c] |= 128 >>> this.length % 8);
      this.length++
    }};
    "string" === typeof h && (h = {text:h});
    h = r.extend({}, {render:"canvas", width:256, height:256, typeNumber:-1, correctLevel:2, background:"#ffffff", foreground:"#000000"}, h);
    return this.each(function() {
      var a;
      if("canvas" == h.render) {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        var c = document.createElement("canvas");
        c.width = h.width;
        c.height = h.height;
        for(var d = c.getContext("2d"), b = h.width / a.getModuleCount(), e = h.height / a.getModuleCount(), f = 0;f < a.getModuleCount();f++) {
          for(var i = 0;i < a.getModuleCount();i++) {
            d.fillStyle = a.isDark(f, i) ? h.foreground : h.background;
            var g = Math.ceil((i + 1) * b) - Math.floor(i * b), j = Math.ceil((f + 1) * b) - Math.floor(f * b);
            d.fillRect(Math.round(i * b), Math.round(f * e), g, j)
          }
        }
      }else {
        a = new o(h.typeNumber, h.correctLevel);
        a.addData(h.text);
        a.make();
        c = r("<table></table>").css("width", h.width + "px").css("height", h.height + "px").css("border", "0px").css("border-collapse", "collapse").css("background-color", h.background);
        d = h.width / a.getModuleCount();
        b = h.height / a.getModuleCount();
        for(e = 0;e < a.getModuleCount();e++) {
          f = r("<tr></tr>").css("height", b + "px").appendTo(c);
          for(i = 0;i < a.getModuleCount();i++) {
            r("<td></td>").css("width", d + "px").css("background-color", a.isDark(e, i) ? h.foreground : h.background).appendTo(f)
          }
        }
      }
      a = c;
      jQuery(a).appendTo(this)
    })
  }
})(jQuery);
(function($) {
  $.support.touch = "ontouchend" in document;
  if(!$.support.touch) {
    return
  }
  var mouseProto = $.ui.mouse.prototype, _mouseInit = mouseProto._mouseInit, _mouseDestroy = mouseProto._mouseDestroy, touchHandled;
  function simulateMouseEvent(event, simulatedType) {
    if(event.originalEvent.touches.length > 1) {
      return
    }
    event.preventDefault();
    var touch = event.originalEvent.changedTouches[0], simulatedEvent = document.createEvent("MouseEvents");
    simulatedEvent.initMouseEvent(simulatedType, true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
    console.log("dispatch simulated event: " + simulatedType);
    event.target.dispatchEvent(simulatedEvent)
  }
  mouseProto._touchStart = function(event) {
    console.log("mouseProto._touchStart");
    var self = this;
    if(touchHandled || !self._mouseCapture(event.originalEvent.changedTouches[0])) {
      return
    }
    touchHandled = true;
    self._touchMoved = false;
    simulateMouseEvent(event, "mouseover");
    simulateMouseEvent(event, "mousemove");
    simulateMouseEvent(event, "mousedown")
  };
  mouseProto._touchMove = function(event) {
    console.log("mouseProto._touchMove");
    if(!touchHandled) {
      return
    }
    this._touchMoved = true;
    simulateMouseEvent(event, "mousemove")
  };
  mouseProto._touchEnd = function(event) {
    if(!touchHandled) {
      return
    }
    simulateMouseEvent(event, "mouseup");
    simulateMouseEvent(event, "mouseout");
    if(!this._touchMoved) {
      simulateMouseEvent(event, "click")
    }
    touchHandled = false
  };
  mouseProto._mouseInit = function() {
    var self = this;
    self.element.bind({touchstart:$.proxy(self, "_touchStart"), touchmove:$.proxy(self, "_touchMove"), touchend:$.proxy(self, "_touchEnd")});
    _mouseInit.call(self)
  };
  mouseProto._mouseDestroy = function() {
    var self = this;
    self.element.unbind({touchstart:$.proxy(self, "_touchStart"), touchmove:$.proxy(self, "_touchMove"), touchend:$.proxy(self, "_touchEnd")});
    _mouseDestroy.call(self)
  }
})(jQuery);
(function(n, t, i) {
  var g = "TEXTAREA", d = "function", nt = "password", c = "maxLength", v = "type", r = "", u = !0, rt = "placeholder", h = !1, tt = "watermark", s = tt, o = "watermarkClass", w = "watermarkFocus", a = "watermarkSubmit", b = "watermarkMaxLength", e = "watermarkPassword", f = "watermarkText", l = /\r/g, ft = /^(button|checkbox|hidden|image|radio|range|reset|submit)$/i, it = "input:data(" + s + "),textarea:data(" + s + ")", p = ":watermarkable", k = ["Page_ClientValidate"], y = h, ut = rt in document.createElement("input");
  n.watermark = n.watermark || {version:"3.1.4", runOnce:u, options:{className:tt, useNative:u, hideBeforeUnload:u}, hide:function(t) {
    n(t).filter(it).each(function() {
      n.watermark._hide(n(this))
    })
  }, _hide:function(n, i) {
    var a = n[0], w = (a.value || r).replace(l, r), h = n.data(f) || r, p = n.data(b) || 0, y = n.data(o), s, u;
    h.length && (w == h && (a.value = r, n.data(e) && ((n.attr(v) || r) === "text" && (s = n.data(e) || [], u = n.parent() || [], s.length && (u.length && (u[0].removeChild(n[0]), u[0].appendChild(s[0]), n = s)))), p && (n.attr(c, p), n.removeData(b)), i && (n.attr("autocomplete", "off"), t.setTimeout(function() {
      n.select()
    }, 1)))), y && n.removeClass(y)
  }, show:function(t) {
    n(t).filter(it).each(function() {
      n.watermark._show(n(this))
    })
  }, _show:function(t) {
    var p = t[0], g = (p.value || r).replace(l, r), i = t.data(f) || r, k = t.attr(v) || r, d = t.data(o), h, s, a;
    g.length != 0 && g != i || t.data(w) ? n.watermark._hide(t) : (y = u, t.data(e) && (k === nt && (h = t.data(e) || [], s = t.parent() || [], h.length && (s.length && (s[0].removeChild(t[0]), s[0].appendChild(h[0]), t = h, t.attr(c, i.length), p = t[0])))), (k === "text" || k === "search") && (a = t.attr(c) || 0, a > 0 && (i.length > a && (t.data(b, a), t.attr(c, i.length)))), d && t.addClass(d), p.value = i)
  }, hideAll:function() {
    y && (n.watermark.hide(p), y = h)
  }, showAll:function() {
    n.watermark.show(p)
  }}, n.fn.watermark = n.fn.watermark || function(i, y) {
    var tt = "string";
    if(!this.length) {
      return this
    }
    var k = h, b = typeof i == tt;
    return b && (i = i.replace(l, r)), typeof y == "object" ? (k = typeof y.className == tt, y = n.extend({}, n.watermark.options, y)) : typeof y == tt ? (k = u, y = n.extend({}, n.watermark.options, {className:y})) : y = n.watermark.options, typeof y.useNative != d && (y.useNative = y.useNative ? function() {
      return u
    } : function() {
      return h
    }), this.each(function() {
      var et = "dragleave", ot = "dragenter", ft = this, h = n(ft), st, d, tt, it;
      if(h.is(p)) {
        if(h.data(s)) {
          (b || k) && (n.watermark._hide(h), b && h.data(f, i), k && h.data(o, y.className))
        }else {
          if(ut && (y.useNative.call(ft, h) && (h.attr("tagName") || r) !== g)) {
            b && h.attr(rt, i);
            return
          }
          h.data(f, b ? i : r), h.data(o, y.className), h.data(s, 1), (h.attr(v) || r) === nt ? (st = h.wrap("<span>").parent(), d = n(st.html().replace(/type=["']?password["']?/i, 'type="text"')), d.data(f, h.data(f)), d.data(o, h.data(o)), d.data(s, 1), d.attr(c, i.length), d.focus(function() {
            n.watermark._hide(d, u)
          }).bind(ot, function() {
            n.watermark._hide(d)
          }).bind("dragend", function() {
            t.setTimeout(function() {
              d.blur()
            }, 1)
          }), h.blur(function() {
            n.watermark._show(h)
          }).bind(et, function() {
            n.watermark._show(h)
          }), d.data(e, h), h.data(e, d)) : h.focus(function() {
            h.data(w, 1), n.watermark._hide(h, u)
          }).blur(function() {
            h.data(w, 0), n.watermark._show(h)
          }).bind(ot, function() {
            n.watermark._hide(h)
          }).bind(et, function() {
            n.watermark._show(h)
          }).bind("dragend", function() {
            t.setTimeout(function() {
              n.watermark._show(h)
            }, 1)
          }).bind("drop", function(n) {
            var i = h[0], t = n.originalEvent.dataTransfer.getData("Text");
            (i.value || r).replace(l, r).replace(t, r) === h.data(f) && (i.value = t), h.focus()
          }), ft.form && (tt = ft.form, it = n(tt), it.data(a) || (it.submit(n.watermark.hideAll), tt.submit ? (it.data(a, tt.submit), tt.submit = function(t, i) {
            return function() {
              var r = i.data(a);
              n.watermark.hideAll(), r.apply ? r.apply(t, Array.prototype.slice.call(arguments)) : r()
            }
          }(tt, it)) : (it.data(a, 1), tt.submit = function(t) {
            return function() {
              n.watermark.hideAll(), delete t.submit, t.submit()
            }
          }(tt))))
        }
        n.watermark._show(h)
      }
    })
  }, n.watermark.runOnce && (n.watermark.runOnce = h, n.extend(n.expr[":"], {data:n.expr.createPseudo ? n.expr.createPseudo(function(t) {
    return function(i) {
      return!!n.data(i, t)
    }
  }) : function(t, i, r) {
    return!!n.data(t, r[3])
  }, watermarkable:function(n) {
    var t, i = n.nodeName;
    return i === g ? u : i !== "INPUT" ? h : (t = n.getAttribute(v), !t || !ft.test(t))
  }}), function(t) {
    n.fn.val = function() {
      var u = this, e = Array.prototype.slice.call(arguments), o;
      return u.length ? e.length ? (t.apply(u, e), n.watermark.show(u), u) : u.data(s) ? (o = (u[0].value || r).replace(l, r), o === (u.data(f) || r) ? r : o) : t.apply(u) : e.length ? u : i
    }
  }(n.fn.val), k.length && n(function() {
    for(var u, r, i = k.length - 1;i >= 0;i--) {
      u = k[i], r = t[u], typeof r == d && (t[u] = function(t) {
        return function() {
          return n.watermark.hideAll(), t.apply(null, Array.prototype.slice.call(arguments))
        }
      }(r))
    }
  }), n(t).bind("beforeunload", function() {
    n.watermark.options.hideBeforeUnload && n.watermark.hideAll()
  }))
})(jQuery, window);
!function(a) {
  if("object" == typeof exports && "undefined" != typeof module) {
    module.exports = a()
  }else {
    if("function" == typeof define && define.amd) {
      define([], a)
    }else {
      var b;
      "undefined" != typeof window ? b = window : "undefined" != typeof global ? b = global : "undefined" != typeof self && (b = self), b.JSZip = a()
    }
  }
}(function() {
  return function a(b, c, d) {
    function e(g, h) {
      if(!c[g]) {
        if(!b[g]) {
          var i = "function" == typeof require && require;
          if(!h && i) {
            return i(g, !0)
          }
          if(f) {
            return f(g, !0)
          }
          throw new Error("Cannot find module '" + g + "'");
        }
        var j = c[g] = {exports:{}};
        b[g][0].call(j.exports, function(a) {
          var c = b[g][1][a];
          return e(c ? c : a)
        }, j, j.exports, a, b, c, d)
      }
      return c[g].exports
    }
    for(var f = "function" == typeof require && require, g = 0;g < d.length;g++) {
      e(d[g])
    }
    return e
  }({1:[function(a, b, c) {
    var d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
    c.encode = function(a) {
      for(var b, c, e, f, g, h, i, j = "", k = 0;k < a.length;) {
        b = a.charCodeAt(k++), c = a.charCodeAt(k++), e = a.charCodeAt(k++), f = b >> 2, g = (3 & b) << 4 | c >> 4, h = (15 & c) << 2 | e >> 6, i = 63 & e, isNaN(c) ? h = i = 64 : isNaN(e) && (i = 64), j = j + d.charAt(f) + d.charAt(g) + d.charAt(h) + d.charAt(i)
      }
      return j
    }, c.decode = function(a) {
      var b, c, e, f, g, h, i, j = "", k = 0;
      for(a = a.replace(/[^A-Za-z0-9\+\/\=]/g, "");k < a.length;) {
        f = d.indexOf(a.charAt(k++)), g = d.indexOf(a.charAt(k++)), h = d.indexOf(a.charAt(k++)), i = d.indexOf(a.charAt(k++)), b = f << 2 | g >> 4, c = (15 & g) << 4 | h >> 2, e = (3 & h) << 6 | i, j += String.fromCharCode(b), 64 != h && (j += String.fromCharCode(c)), 64 != i && (j += String.fromCharCode(e))
      }
      return j
    }
  }, {}], 2:[function(a, b) {
    function c() {
      this.compressedSize = 0, this.uncompressedSize = 0, this.crc32 = 0, this.compressionMethod = null, this.compressedContent = null
    }
    c.prototype = {getContent:function() {
      return null
    }, getCompressedContent:function() {
      return null
    }}, b.exports = c
  }, {}], 3:[function(a, b, c) {
    c.STORE = {magic:"\x00\x00", compress:function(a) {
      return a
    }, uncompress:function(a) {
      return a
    }, compressInputType:null, uncompressInputType:null}, c.DEFLATE = a("./flate")
  }, {"./flate":8}], 4:[function(a, b) {
    var c = a("./utils"), d = [0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615, 3915621685, 2657392035, 249268274, 2044508324, 3772115230, 2547177864, 162941995, 2125561021, 3887607047, 2428444049, 498536548, 1789927666, 4089016648, 2227061214, 450548861, 1843258603, 4107580753, 2211677639, 325883990, 1684777152, 4251122042, 2321926636, 335633487, 1661365465, 4195302755, 2366115317, 997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 901097722, 
    1119000684, 3686517206, 2898065728, 853044451, 1172266101, 3705015759, 2882616665, 651767980, 1373503546, 3369554304, 3218104598, 565507253, 1454621731, 3485111705, 3099436303, 671266974, 1594198024, 3322730930, 2970347812, 795835527, 1483230225, 3244367275, 3060149565, 1994146192, 31158534, 2563907772, 4023717930, 1907459465, 112637215, 2680153253, 3904427059, 2013776290, 251722036, 2517215374, 3775830040, 2137656763, 141376813, 2439277719, 3865271297, 1802195444, 476864866, 2238001368, 4066508878, 
    1812370925, 453092731, 2181625025, 4111451223, 1706088902, 314042704, 2344532202, 4240017532, 1658658271, 366619977, 2362670323, 4224994405, 1303535960, 984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 879679996, 2909243462, 3663771856, 1141124467, 855842277, 2852801631, 3708648649, 1342533948, 654459306, 3188396048, 3373015174, 1466479909, 544179635, 3110523913, 3462522015, 1591671054, 702138776, 2966460450, 3352799412, 1504918807, 783551873, 3082640443, 
    3233442989, 3988292384, 2596254646, 62317068, 1957810842, 3939845945, 2647816111, 81470997, 1943803523, 3814918930, 2489596804, 225274430, 2053790376, 3826175755, 2466906013, 167816743, 2097651377, 4027552580, 2265490386, 503444072, 1762050814, 4150417245, 2154129355, 426522225, 1852507879, 4275313526, 2312317920, 282753626, 1742555852, 4189708143, 2394877945, 397917763, 1622183637, 3604390888, 2714866558, 953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 
    906185462, 1090812512, 3747672003, 2825379669, 829329135, 1181335161, 3412177804, 3160834842, 628085408, 1382605366, 3423369109, 3138078467, 570562233, 1426400815, 3317316542, 2998733608, 733239954, 1555261956, 3268935591, 3050360625, 752459403, 1541320221, 2607071920, 3965973030, 1969922972, 40735498, 2617837225, 3943577151, 1913087877, 83908371, 2512341634, 3803740692, 2075208622, 213261112, 2463272603, 3855990285, 2094854071, 198958881, 2262029012, 4057260610, 1759359992, 534414190, 2176718541, 
    4139329115, 1873836001, 414664567, 2282248934, 4279200368, 1711684554, 285281116, 2405801727, 4167216745, 1634467795, 376229701, 2685067896, 3608007406, 1308918612, 956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 936918E3, 2847714899, 3736837829, 1202900863, 817233897, 3183342108, 3401237130, 1404277552, 615818150, 3134207493, 3453421203, 1423857449, 601450431, 3009837614, 3294710456, 1567103746, 711928724, 3020668471, 3272380065, 1510334235, 755167117];
    b.exports = function(a, b) {
      if("undefined" == typeof a || !a.length) {
        return 0
      }
      var e = "string" !== c.getTypeOf(a);
      "undefined" == typeof b && (b = 0);
      var f = 0, g = 0, h = 0;
      b = -1 ^ b;
      for(var i = 0, j = a.length;j > i;i++) {
        h = e ? a[i] : a.charCodeAt(i), g = 255 & (b ^ h), f = d[g], b = b >>> 8 ^ f
      }
      return-1 ^ b
    }
  }, {"./utils":21}], 5:[function(a, b) {
    function c() {
      this.data = null, this.length = 0, this.index = 0
    }
    var d = a("./utils");
    c.prototype = {checkOffset:function(a) {
      this.checkIndex(this.index + a)
    }, checkIndex:function(a) {
      if(this.length < a || 0 > a) {
        throw new Error("End of data reached (data length = " + this.length + ", asked index = " + a + "). Corrupted zip ?");
      }
    }, setIndex:function(a) {
      this.checkIndex(a), this.index = a
    }, skip:function(a) {
      this.setIndex(this.index + a)
    }, byteAt:function() {
    }, readInt:function(a) {
      var b, c = 0;
      for(this.checkOffset(a), b = this.index + a - 1;b >= this.index;b--) {
        c = (c << 8) + this.byteAt(b)
      }
      return this.index += a, c
    }, readString:function(a) {
      return d.transformTo("string", this.readData(a))
    }, readData:function() {
    }, lastIndexOfSignature:function() {
    }, readDate:function() {
      var a = this.readInt(4);
      return new Date((a >> 25 & 127) + 1980, (a >> 21 & 15) - 1, a >> 16 & 31, a >> 11 & 31, a >> 5 & 63, (31 & a) << 1)
    }}, b.exports = c
  }, {"./utils":21}], 6:[function(a, b, c) {
    c.base64 = !1, c.binary = !1, c.dir = !1, c.createFolders = !1, c.date = null, c.compression = null, c.compressionOptions = null, c.comment = null, c.unixPermissions = null, c.dosPermissions = null
  }, {}], 7:[function(a, b, c) {
    var d = a("./utils");
    c.string2binary = function(a) {
      return d.string2binary(a)
    }, c.string2Uint8Array = function(a) {
      return d.transformTo("uint8array", a)
    }, c.uint8Array2String = function(a) {
      return d.transformTo("string", a)
    }, c.string2Blob = function(a) {
      var b = d.transformTo("arraybuffer", a);
      return d.arrayBuffer2Blob(b)
    }, c.arrayBuffer2Blob = function(a) {
      return d.arrayBuffer2Blob(a)
    }, c.transformTo = function(a, b) {
      return d.transformTo(a, b)
    }, c.getTypeOf = function(a) {
      return d.getTypeOf(a)
    }, c.checkSupport = function(a) {
      return d.checkSupport(a)
    }, c.MAX_VALUE_16BITS = d.MAX_VALUE_16BITS, c.MAX_VALUE_32BITS = d.MAX_VALUE_32BITS, c.pretty = function(a) {
      return d.pretty(a)
    }, c.findCompression = function(a) {
      return d.findCompression(a)
    }, c.isRegExp = function(a) {
      return d.isRegExp(a)
    }
  }, {"./utils":21}], 8:[function(a, b, c) {
    var d = "undefined" != typeof Uint8Array && ("undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array), e = a("pako");
    c.uncompressInputType = d ? "uint8array" : "array", c.compressInputType = d ? "uint8array" : "array", c.magic = "\b\x00", c.compress = function(a, b) {
      return e.deflateRaw(a, {level:b.level || -1})
    }, c.uncompress = function(a) {
      return e.inflateRaw(a)
    }
  }, {pako:24}], 9:[function(a, b) {
    function c(a, b) {
      return this instanceof c ? (this.files = {}, this.comment = null, this.root = "", a && this.load(a, b), void(this.clone = function() {
        var a = new c;
        for(var b in this) {
          "function" != typeof this[b] && (a[b] = this[b])
        }
        return a
      })) : new c(a, b)
    }
    var d = a("./base64");
    c.prototype = a("./object"), c.prototype.load = a("./load"), c.support = a("./support"), c.defaults = a("./defaults"), c.utils = a("./deprecatedPublicUtils"), c.base64 = {encode:function(a) {
      return d.encode(a)
    }, decode:function(a) {
      return d.decode(a)
    }}, c.compressions = a("./compressions"), b.exports = c
  }, {"./base64":1, "./compressions":3, "./defaults":6, "./deprecatedPublicUtils":7, "./load":10, "./object":13, "./support":17}], 10:[function(a, b) {
    var c = a("./base64"), d = a("./zipEntries");
    b.exports = function(a, b) {
      var e, f, g, h;
      for(b = b || {}, b.base64 && (a = c.decode(a)), f = new d(a, b), e = f.files, g = 0;g < e.length;g++) {
        h = e[g], this.file(h.fileName, h.decompressed, {binary:!0, optimizedBinaryString:!0, date:h.date, dir:h.dir, comment:h.fileComment.length ? h.fileComment : null, unixPermissions:h.unixPermissions, dosPermissions:h.dosPermissions, createFolders:b.createFolders})
      }
      return f.zipComment.length && (this.comment = f.zipComment), this
    }
  }, {"./base64":1, "./zipEntries":22}], 11:[function(a, b) {
    (function(a) {
      b.exports = function(b, c) {
        return new a(b, c)
      }, b.exports.test = function(b) {
        return a.isBuffer(b)
      }
    }).call(this, "undefined" != typeof Buffer ? Buffer : void 0)
  }, {}], 12:[function(a, b) {
    function c(a) {
      this.data = a, this.length = this.data.length, this.index = 0
    }
    var d = a("./uint8ArrayReader");
    c.prototype = new d, c.prototype.readData = function(a) {
      this.checkOffset(a);
      var b = this.data.slice(this.index, this.index + a);
      return this.index += a, b
    }, b.exports = c
  }, {"./uint8ArrayReader":18}], 13:[function(a, b) {
    var c = a("./support"), d = a("./utils"), e = a("./crc32"), f = a("./signature"), g = a("./defaults"), h = a("./base64"), i = a("./compressions"), j = a("./compressedObject"), k = a("./nodeBuffer"), l = a("./utf8"), m = a("./stringWriter"), n = a("./uint8ArrayWriter"), o = function(a) {
      if(a._data instanceof j && (a._data = a._data.getContent(), a.options.binary = !0, a.options.base64 = !1, "uint8array" === d.getTypeOf(a._data))) {
        var b = a._data;
        a._data = new Uint8Array(b.length), 0 !== b.length && a._data.set(b, 0)
      }
      return a._data
    }, p = function(a) {
      var b = o(a), e = d.getTypeOf(b);
      return"string" === e ? !a.options.binary && c.nodebuffer ? k(b, "utf-8") : a.asBinary() : b
    }, q = function(a) {
      var b = o(this);
      return null === b || "undefined" == typeof b ? "" : (this.options.base64 && (b = h.decode(b)), b = a && this.options.binary ? D.utf8decode(b) : d.transformTo("string", b), a || (this.options.binary || (b = d.transformTo("string", D.utf8encode(b)))), b)
    }, r = function(a, b, c) {
      this.name = a, this.dir = c.dir, this.date = c.date, this.comment = c.comment, this.unixPermissions = c.unixPermissions, this.dosPermissions = c.dosPermissions, this._data = b, this.options = c, this._initialMetadata = {dir:c.dir, date:c.date}
    };
    r.prototype = {asText:function() {
      return q.call(this, !0)
    }, asBinary:function() {
      return q.call(this, !1)
    }, asNodeBuffer:function() {
      var a = p(this);
      return d.transformTo("nodebuffer", a)
    }, asUint8Array:function() {
      var a = p(this);
      return d.transformTo("uint8array", a)
    }, asArrayBuffer:function() {
      return this.asUint8Array().buffer
    }};
    var s = function(a, b) {
      var c, d = "";
      for(c = 0;b > c;c++) {
        d += String.fromCharCode(255 & a), a >>>= 8
      }
      return d
    }, t = function() {
      var a, b, c = {};
      for(a = 0;a < arguments.length;a++) {
        for(b in arguments[a]) {
          arguments[a].hasOwnProperty(b) && ("undefined" == typeof c[b] && (c[b] = arguments[a][b]))
        }
      }
      return c
    }, u = function(a) {
      return a = a || {}, a.base64 !== !0 || (null !== a.binary && void 0 !== a.binary || (a.binary = !0)), a = t(a, g), a.date = a.date || new Date, null !== a.compression && (a.compression = a.compression.toUpperCase()), a
    }, v = function(a, b, c) {
      var e, f = d.getTypeOf(b);
      if(c = u(c), "string" == typeof c.unixPermissions && (c.unixPermissions = parseInt(c.unixPermissions, 8)), c.unixPermissions && (16384 & c.unixPermissions && (c.dir = !0)), c.dosPermissions && (16 & c.dosPermissions && (c.dir = !0)), c.dir && (a = x(a)), c.createFolders && ((e = w(a)) && y.call(this, e, !0)), c.dir || (null === b || "undefined" == typeof b)) {
        c.base64 = !1, c.binary = !1, b = null, f = null
      }else {
        if("string" === f) {
          c.binary && (!c.base64 && (c.optimizedBinaryString !== !0 && (b = d.string2binary(b))))
        }else {
          if(c.base64 = !1, c.binary = !0, !(f || b instanceof j)) {
            throw new Error("The data of '" + a + "' is in an unsupported format !");
          }
          "arraybuffer" === f && (b = d.transformTo("uint8array", b))
        }
      }
      var g = new r(a, b, c);
      return this.files[a] = g, g
    }, w = function(a) {
      "/" == a.slice(-1) && (a = a.substring(0, a.length - 1));
      var b = a.lastIndexOf("/");
      return b > 0 ? a.substring(0, b) : ""
    }, x = function(a) {
      return"/" != a.slice(-1) && (a += "/"), a
    }, y = function(a, b) {
      return b = "undefined" != typeof b ? b : !1, a = x(a), this.files[a] || v.call(this, a, null, {dir:!0, createFolders:b}), this.files[a]
    }, z = function(a, b, c) {
      var f, g = new j;
      return a._data instanceof j ? (g.uncompressedSize = a._data.uncompressedSize, g.crc32 = a._data.crc32, 0 === g.uncompressedSize || a.dir ? (b = i.STORE, g.compressedContent = "", g.crc32 = 0) : a._data.compressionMethod === b.magic ? g.compressedContent = a._data.getCompressedContent() : (f = a._data.getContent(), g.compressedContent = b.compress(d.transformTo(b.compressInputType, f), c))) : (f = p(a), (!f || (0 === f.length || a.dir)) && (b = i.STORE, f = ""), g.uncompressedSize = f.length, 
      g.crc32 = e(f), g.compressedContent = b.compress(d.transformTo(b.compressInputType, f), c)), g.compressedSize = g.compressedContent.length, g.compressionMethod = b.magic, g
    }, A = function(a, b) {
      var c = a;
      return a || (c = b ? 16893 : 33204), (65535 & c) << 16
    }, B = function(a) {
      return 63 & (a || 0)
    }, C = function(a, b, c, g, h) {
      var i, j, k, m, n = (c.compressedContent, d.transformTo("string", l.utf8encode(b.name))), o = b.comment || "", p = d.transformTo("string", l.utf8encode(o)), q = n.length !== b.name.length, r = p.length !== o.length, t = b.options, u = "", v = "", w = "";
      k = b._initialMetadata.dir !== b.dir ? b.dir : t.dir, m = b._initialMetadata.date !== b.date ? b.date : t.date;
      var x = 0, y = 0;
      k && (x |= 16), "UNIX" === h ? (y = 798, x |= A(b.unixPermissions, k)) : (y = 20, x |= B(b.dosPermissions, k)), i = m.getHours(), i <<= 6, i |= m.getMinutes(), i <<= 5, i |= m.getSeconds() / 2, j = m.getFullYear() - 1980, j <<= 4, j |= m.getMonth() + 1, j <<= 5, j |= m.getDate(), q && (v = s(1, 1) + s(e(n), 4) + n, u += "up" + s(v.length, 2) + v), r && (w = s(1, 1) + s(this.crc32(p), 4) + p, u += "uc" + s(w.length, 2) + w);
      var z = "";
      z += "\n\x00", z += q || r ? "\x00\b" : "\x00\x00", z += c.compressionMethod, z += s(i, 2), z += s(j, 2), z += s(c.crc32, 4), z += s(c.compressedSize, 4), z += s(c.uncompressedSize, 4), z += s(n.length, 2), z += s(u.length, 2);
      var C = f.LOCAL_FILE_HEADER + z + n + u, D = f.CENTRAL_FILE_HEADER + s(y, 2) + z + s(p.length, 2) + "\x00\x00\x00\x00" + s(x, 4) + s(g, 4) + n + u + p;
      return{fileRecord:C, dirRecord:D, compressedObject:c}
    }, D = {load:function() {
      throw new Error("Load method is not defined. Is the file jszip-load.js included ?");
    }, filter:function(a) {
      var b, c, d, e, f = [];
      for(b in this.files) {
        this.files.hasOwnProperty(b) && (d = this.files[b], e = new r(d.name, d._data, t(d.options)), c = b.slice(this.root.length, b.length), b.slice(0, this.root.length) === this.root && (a(c, e) && f.push(e)))
      }
      return f
    }, file:function(a, b, c) {
      if(1 === arguments.length) {
        if(d.isRegExp(a)) {
          var e = a;
          return this.filter(function(a, b) {
            return!b.dir && e.test(a)
          })
        }
        return this.filter(function(b, c) {
          return!c.dir && b === a
        })[0] || null
      }
      return a = this.root + a, v.call(this, a, b, c), this
    }, folder:function(a) {
      if(!a) {
        return this
      }
      if(d.isRegExp(a)) {
        return this.filter(function(b, c) {
          return c.dir && a.test(b)
        })
      }
      var b = this.root + a, c = y.call(this, b), e = this.clone();
      return e.root = c.name, e
    }, remove:function(a) {
      a = this.root + a;
      var b = this.files[a];
      if(b || ("/" != a.slice(-1) && (a += "/"), b = this.files[a]), b && !b.dir) {
        delete this.files[a]
      }else {
        for(var c = this.filter(function(b, c) {
          return c.name.slice(0, a.length) === a
        }), d = 0;d < c.length;d++) {
          delete this.files[c[d].name]
        }
      }
      return this
    }, generate:function(a) {
      a = t(a || {}, {base64:!0, compression:"STORE", compressionOptions:null, type:"base64", platform:"DOS", comment:null, mimeType:"application/zip"}), d.checkSupport(a.type), ("darwin" === a.platform || ("freebsd" === a.platform || ("linux" === a.platform || "sunos" === a.platform))) && (a.platform = "UNIX"), "win32" === a.platform && (a.platform = "DOS");
      var b, c, e = [], g = 0, j = 0, k = d.transformTo("string", this.utf8encode(a.comment || (this.comment || "")));
      for(var l in this.files) {
        if(this.files.hasOwnProperty(l)) {
          var o = this.files[l], p = o.options.compression || a.compression.toUpperCase(), q = i[p];
          if(!q) {
            throw new Error(p + " is not a valid compression method !");
          }
          var r = o.options.compressionOptions || (a.compressionOptions || {}), u = z.call(this, o, q, r), v = C.call(this, l, o, u, g, a.platform);
          g += v.fileRecord.length + u.compressedSize, j += v.dirRecord.length, e.push(v)
        }
      }
      var w = "";
      w = f.CENTRAL_DIRECTORY_END + "\x00\x00\x00\x00" + s(e.length, 2) + s(e.length, 2) + s(j, 4) + s(g, 4) + s(k.length, 2) + k;
      var x = a.type.toLowerCase();
      for(b = "uint8array" === x || ("arraybuffer" === x || ("blob" === x || "nodebuffer" === x)) ? new n(g + j + w.length) : new m(g + j + w.length), c = 0;c < e.length;c++) {
        b.append(e[c].fileRecord), b.append(e[c].compressedObject.compressedContent)
      }
      for(c = 0;c < e.length;c++) {
        b.append(e[c].dirRecord)
      }
      b.append(w);
      var y = b.finalize();
      switch(a.type.toLowerCase()) {
        case "uint8array":
        ;
        case "arraybuffer":
        ;
        case "nodebuffer":
          return d.transformTo(a.type.toLowerCase(), y);
        case "blob":
          return d.arrayBuffer2Blob(d.transformTo("arraybuffer", y), a.mimeType);
        case "base64":
          return a.base64 ? h.encode(y) : y;
        default:
          return y
      }
    }, crc32:function(a, b) {
      return e(a, b)
    }, utf8encode:function(a) {
      return d.transformTo("string", l.utf8encode(a))
    }, utf8decode:function(a) {
      return l.utf8decode(a)
    }};
    b.exports = D
  }, {"./base64":1, "./compressedObject":2, "./compressions":3, "./crc32":4, "./defaults":6, "./nodeBuffer":11, "./signature":14, "./stringWriter":16, "./support":17, "./uint8ArrayWriter":19, "./utf8":20, "./utils":21}], 14:[function(a, b, c) {
    c.LOCAL_FILE_HEADER = "PK\u0003\u0004", c.CENTRAL_FILE_HEADER = "PK\u0001\u0002", c.CENTRAL_DIRECTORY_END = "PK\u0005\u0006", c.ZIP64_CENTRAL_DIRECTORY_LOCATOR = "PK\u0006\u0007", c.ZIP64_CENTRAL_DIRECTORY_END = "PK\u0006\u0006", c.DATA_DESCRIPTOR = "PK\u0007\b"
  }, {}], 15:[function(a, b) {
    function c(a, b) {
      this.data = a, b || (this.data = e.string2binary(this.data)), this.length = this.data.length, this.index = 0
    }
    var d = a("./dataReader"), e = a("./utils");
    c.prototype = new d, c.prototype.byteAt = function(a) {
      return this.data.charCodeAt(a)
    }, c.prototype.lastIndexOfSignature = function(a) {
      return this.data.lastIndexOf(a)
    }, c.prototype.readData = function(a) {
      this.checkOffset(a);
      var b = this.data.slice(this.index, this.index + a);
      return this.index += a, b
    }, b.exports = c
  }, {"./dataReader":5, "./utils":21}], 16:[function(a, b) {
    var c = a("./utils"), d = function() {
      this.data = []
    };
    d.prototype = {append:function(a) {
      a = c.transformTo("string", a), this.data.push(a)
    }, finalize:function() {
      return this.data.join("")
    }}, b.exports = d
  }, {"./utils":21}], 17:[function(a, b, c) {
    (function(a) {
      if(c.base64 = !0, c.array = !0, c.string = !0, c.arraybuffer = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array, c.nodebuffer = "undefined" != typeof a, c.uint8array = "undefined" != typeof Uint8Array, "undefined" == typeof ArrayBuffer) {
        c.blob = !1
      }else {
        var b = new ArrayBuffer(0);
        try {
          c.blob = 0 === (new Blob([b], {type:"application/zip"})).size
        }catch(d) {
          try {
            var e = window.BlobBuilder || (window.WebKitBlobBuilder || (window.MozBlobBuilder || window.MSBlobBuilder)), f = new e;
            f.append(b), c.blob = 0 === f.getBlob("application/zip").size
          }catch(d) {
            c.blob = !1
          }
        }
      }
    }).call(this, "undefined" != typeof Buffer ? Buffer : void 0)
  }, {}], 18:[function(a, b) {
    function c(a) {
      a && (this.data = a, this.length = this.data.length, this.index = 0)
    }
    var d = a("./dataReader");
    c.prototype = new d, c.prototype.byteAt = function(a) {
      return this.data[a]
    }, c.prototype.lastIndexOfSignature = function(a) {
      for(var b = a.charCodeAt(0), c = a.charCodeAt(1), d = a.charCodeAt(2), e = a.charCodeAt(3), f = this.length - 4;f >= 0;--f) {
        if(this.data[f] === b && (this.data[f + 1] === c && (this.data[f + 2] === d && this.data[f + 3] === e))) {
          return f
        }
      }
      return-1
    }, c.prototype.readData = function(a) {
      if(this.checkOffset(a), 0 === a) {
        return new Uint8Array(0)
      }
      var b = this.data.subarray(this.index, this.index + a);
      return this.index += a, b
    }, b.exports = c
  }, {"./dataReader":5}], 19:[function(a, b) {
    var c = a("./utils"), d = function(a) {
      this.data = new Uint8Array(a), this.index = 0
    };
    d.prototype = {append:function(a) {
      0 !== a.length && (a = c.transformTo("uint8array", a), this.data.set(a, this.index), this.index += a.length)
    }, finalize:function() {
      return this.data
    }}, b.exports = d
  }, {"./utils":21}], 20:[function(a, b, c) {
    for(var d = a("./utils"), e = a("./support"), f = a("./nodeBuffer"), g = new Array(256), h = 0;256 > h;h++) {
      g[h] = h >= 252 ? 6 : h >= 248 ? 5 : h >= 240 ? 4 : h >= 224 ? 3 : h >= 192 ? 2 : 1
    }
    g[254] = g[254] = 1;
    var i = function(a) {
      var b, c, d, f, g, h = a.length, i = 0;
      for(f = 0;h > f;f++) {
        c = a.charCodeAt(f), 55296 === (64512 & c) && (h > f + 1 && (d = a.charCodeAt(f + 1), 56320 === (64512 & d) && (c = 65536 + (c - 55296 << 10) + (d - 56320), f++))), i += 128 > c ? 1 : 2048 > c ? 2 : 65536 > c ? 3 : 4
      }
      for(b = e.uint8array ? new Uint8Array(i) : new Array(i), g = 0, f = 0;i > g;f++) {
        c = a.charCodeAt(f), 55296 === (64512 & c) && (h > f + 1 && (d = a.charCodeAt(f + 1), 56320 === (64512 & d) && (c = 65536 + (c - 55296 << 10) + (d - 56320), f++))), 128 > c ? b[g++] = c : 2048 > c ? (b[g++] = 192 | c >>> 6, b[g++] = 128 | 63 & c) : 65536 > c ? (b[g++] = 224 | c >>> 12, b[g++] = 128 | c >>> 6 & 63, b[g++] = 128 | 63 & c) : (b[g++] = 240 | c >>> 18, b[g++] = 128 | c >>> 12 & 63, b[g++] = 128 | c >>> 6 & 63, b[g++] = 128 | 63 & c)
      }
      return b
    }, j = function(a, b) {
      var c;
      for(b = b || a.length, b > a.length && (b = a.length), c = b - 1;c >= 0 && 128 === (192 & a[c]);) {
        c--
      }
      return 0 > c ? b : 0 === c ? b : c + g[a[c]] > b ? c : b
    }, k = function(a) {
      var b, c, e, f, h = a.length, i = new Array(2 * h);
      for(c = 0, b = 0;h > b;) {
        if(e = a[b++], 128 > e) {
          i[c++] = e
        }else {
          if(f = g[e], f > 4) {
            i[c++] = 65533, b += f - 1
          }else {
            for(e &= 2 === f ? 31 : 3 === f ? 15 : 7;f > 1 && h > b;) {
              e = e << 6 | 63 & a[b++], f--
            }
            f > 1 ? i[c++] = 65533 : 65536 > e ? i[c++] = e : (e -= 65536, i[c++] = 55296 | e >> 10 & 1023, i[c++] = 56320 | 1023 & e)
          }
        }
      }
      return i.length !== c && (i.subarray ? i = i.subarray(0, c) : i.length = c), d.applyFromCharCode(i)
    };
    c.utf8encode = function(a) {
      return e.nodebuffer ? f(a, "utf-8") : i(a)
    }, c.utf8decode = function(a) {
      if(e.nodebuffer) {
        return d.transformTo("nodebuffer", a).toString("utf-8")
      }
      a = d.transformTo(e.uint8array ? "uint8array" : "array", a);
      for(var b = [], c = 0, f = a.length, g = 65536;f > c;) {
        var h = j(a, Math.min(c + g, f));
        b.push(e.uint8array ? k(a.subarray(c, h)) : k(a.slice(c, h))), c = h
      }
      return b.join("")
    }
  }, {"./nodeBuffer":11, "./support":17, "./utils":21}], 21:[function(a, b, c) {
    function d(a) {
      return a
    }
    function e(a, b) {
      for(var c = 0;c < a.length;++c) {
        b[c] = 255 & a.charCodeAt(c)
      }
      return b
    }
    function f(a) {
      var b = 65536, d = [], e = a.length, f = c.getTypeOf(a), g = 0, h = !0;
      try {
        switch(f) {
          case "uint8array":
            String.fromCharCode.apply(null, new Uint8Array(0));
            break;
          case "nodebuffer":
            String.fromCharCode.apply(null, j(0))
        }
      }catch(i) {
        h = !1
      }
      if(!h) {
        for(var k = "", l = 0;l < a.length;l++) {
          k += String.fromCharCode(a[l])
        }
        return k
      }
      for(;e > g && b > 1;) {
        try {
          d.push("array" === f || "nodebuffer" === f ? String.fromCharCode.apply(null, a.slice(g, Math.min(g + b, e))) : String.fromCharCode.apply(null, a.subarray(g, Math.min(g + b, e)))), g += b
        }catch(i) {
          b = Math.floor(b / 2)
        }
      }
      return d.join("")
    }
    function g(a, b) {
      for(var c = 0;c < a.length;c++) {
        b[c] = a[c]
      }
      return b
    }
    var h = a("./support"), i = a("./compressions"), j = a("./nodeBuffer");
    c.string2binary = function(a) {
      for(var b = "", c = 0;c < a.length;c++) {
        b += String.fromCharCode(255 & a.charCodeAt(c))
      }
      return b
    }, c.arrayBuffer2Blob = function(a, b) {
      c.checkSupport("blob"), b = b || "application/zip";
      try {
        return new Blob([a], {type:b})
      }catch(d) {
        try {
          var e = window.BlobBuilder || (window.WebKitBlobBuilder || (window.MozBlobBuilder || window.MSBlobBuilder)), f = new e;
          return f.append(a), f.getBlob(b)
        }catch(d) {
          throw new Error("Bug : can't construct the Blob.");
        }
      }
    }, c.applyFromCharCode = f;
    var k = {};
    k.string = {string:d, array:function(a) {
      return e(a, new Array(a.length))
    }, arraybuffer:function(a) {
      return k.string.uint8array(a).buffer
    }, uint8array:function(a) {
      return e(a, new Uint8Array(a.length))
    }, nodebuffer:function(a) {
      return e(a, j(a.length))
    }}, k.array = {string:f, array:d, arraybuffer:function(a) {
      return(new Uint8Array(a)).buffer
    }, uint8array:function(a) {
      return new Uint8Array(a)
    }, nodebuffer:function(a) {
      return j(a)
    }}, k.arraybuffer = {string:function(a) {
      return f(new Uint8Array(a))
    }, array:function(a) {
      return g(new Uint8Array(a), new Array(a.byteLength))
    }, arraybuffer:d, uint8array:function(a) {
      return new Uint8Array(a)
    }, nodebuffer:function(a) {
      return j(new Uint8Array(a))
    }}, k.uint8array = {string:f, array:function(a) {
      return g(a, new Array(a.length))
    }, arraybuffer:function(a) {
      return a.buffer
    }, uint8array:d, nodebuffer:function(a) {
      return j(a)
    }}, k.nodebuffer = {string:f, array:function(a) {
      return g(a, new Array(a.length))
    }, arraybuffer:function(a) {
      return k.nodebuffer.uint8array(a).buffer
    }, uint8array:function(a) {
      return g(a, new Uint8Array(a.length))
    }, nodebuffer:d}, c.transformTo = function(a, b) {
      if(b || (b = ""), !a) {
        return b
      }
      c.checkSupport(a);
      var d = c.getTypeOf(b), e = k[d][a](b);
      return e
    }, c.getTypeOf = function(a) {
      return"string" == typeof a ? "string" : "[object Array]" === Object.prototype.toString.call(a) ? "array" : h.nodebuffer && j.test(a) ? "nodebuffer" : h.uint8array && a instanceof Uint8Array ? "uint8array" : h.arraybuffer && a instanceof ArrayBuffer ? "arraybuffer" : void 0
    }, c.checkSupport = function(a) {
      var b = h[a.toLowerCase()];
      if(!b) {
        throw new Error(a + " is not supported by this browser");
      }
    }, c.MAX_VALUE_16BITS = 65535, c.MAX_VALUE_32BITS = -1, c.pretty = function(a) {
      var b, c, d = "";
      for(c = 0;c < (a || "").length;c++) {
        b = a.charCodeAt(c), d += "\\x" + (16 > b ? "0" : "") + b.toString(16).toUpperCase()
      }
      return d
    }, c.findCompression = function(a) {
      for(var b in i) {
        if(i.hasOwnProperty(b) && i[b].magic === a) {
          return i[b]
        }
      }
      return null
    }, c.isRegExp = function(a) {
      return"[object RegExp]" === Object.prototype.toString.call(a)
    }
  }, {"./compressions":3, "./nodeBuffer":11, "./support":17}], 22:[function(a, b) {
    function c(a, b) {
      this.files = [], this.loadOptions = b, a && this.load(a)
    }
    var d = a("./stringReader"), e = a("./nodeBufferReader"), f = a("./uint8ArrayReader"), g = a("./utils"), h = a("./signature"), i = a("./zipEntry"), j = a("./support"), k = a("./object");
    c.prototype = {checkSignature:function(a) {
      var b = this.reader.readString(4);
      if(b !== a) {
        throw new Error("Corrupted zip or bug : unexpected signature (" + g.pretty(b) + ", expected " + g.pretty(a) + ")");
      }
    }, readBlockEndOfCentral:function() {
      this.diskNumber = this.reader.readInt(2), this.diskWithCentralDirStart = this.reader.readInt(2), this.centralDirRecordsOnThisDisk = this.reader.readInt(2), this.centralDirRecords = this.reader.readInt(2), this.centralDirSize = this.reader.readInt(4), this.centralDirOffset = this.reader.readInt(4), this.zipCommentLength = this.reader.readInt(2), this.zipComment = this.reader.readString(this.zipCommentLength), this.zipComment = k.utf8decode(this.zipComment)
    }, readBlockZip64EndOfCentral:function() {
      this.zip64EndOfCentralSize = this.reader.readInt(8), this.versionMadeBy = this.reader.readString(2), this.versionNeeded = this.reader.readInt(2), this.diskNumber = this.reader.readInt(4), this.diskWithCentralDirStart = this.reader.readInt(4), this.centralDirRecordsOnThisDisk = this.reader.readInt(8), this.centralDirRecords = this.reader.readInt(8), this.centralDirSize = this.reader.readInt(8), this.centralDirOffset = this.reader.readInt(8), this.zip64ExtensibleData = {};
      for(var a, b, c, d = this.zip64EndOfCentralSize - 44, e = 0;d > e;) {
        a = this.reader.readInt(2), b = this.reader.readInt(4), c = this.reader.readString(b), this.zip64ExtensibleData[a] = {id:a, length:b, value:c}
      }
    }, readBlockZip64EndOfCentralLocator:function() {
      if(this.diskWithZip64CentralDirStart = this.reader.readInt(4), this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8), this.disksCount = this.reader.readInt(4), this.disksCount > 1) {
        throw new Error("Multi-volumes zip are not supported");
      }
    }, readLocalFiles:function() {
      var a, b;
      for(a = 0;a < this.files.length;a++) {
        b = this.files[a], this.reader.setIndex(b.localHeaderOffset), this.checkSignature(h.LOCAL_FILE_HEADER), b.readLocalPart(this.reader), b.handleUTF8(), b.processAttributes()
      }
    }, readCentralDir:function() {
      var a;
      for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4) === h.CENTRAL_FILE_HEADER;) {
        a = new i({zip64:this.zip64}, this.loadOptions), a.readCentralPart(this.reader), this.files.push(a)
      }
    }, readEndOfCentral:function() {
      var a = this.reader.lastIndexOfSignature(h.CENTRAL_DIRECTORY_END);
      if(-1 === a) {
        var b = !0;
        try {
          this.reader.setIndex(0), this.checkSignature(h.LOCAL_FILE_HEADER), b = !1
        }catch(c) {
        }
        throw new Error(b ? "Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html" : "Corrupted zip : can't find end of central directory");
      }
      if(this.reader.setIndex(a), this.checkSignature(h.CENTRAL_DIRECTORY_END), this.readBlockEndOfCentral(), this.diskNumber === g.MAX_VALUE_16BITS || (this.diskWithCentralDirStart === g.MAX_VALUE_16BITS || (this.centralDirRecordsOnThisDisk === g.MAX_VALUE_16BITS || (this.centralDirRecords === g.MAX_VALUE_16BITS || (this.centralDirSize === g.MAX_VALUE_32BITS || this.centralDirOffset === g.MAX_VALUE_32BITS))))) {
        if(this.zip64 = !0, a = this.reader.lastIndexOfSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR), -1 === a) {
          throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");
        }
        this.reader.setIndex(a), this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_LOCATOR), this.readBlockZip64EndOfCentralLocator(), this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir), this.checkSignature(h.ZIP64_CENTRAL_DIRECTORY_END), this.readBlockZip64EndOfCentral()
      }
    }, prepareReader:function(a) {
      var b = g.getTypeOf(a);
      this.reader = "string" !== b || j.uint8array ? "nodebuffer" === b ? new e(a) : new f(g.transformTo("uint8array", a)) : new d(a, this.loadOptions.optimizedBinaryString)
    }, load:function(a) {
      this.prepareReader(a), this.readEndOfCentral(), this.readCentralDir(), this.readLocalFiles()
    }}, b.exports = c
  }, {"./nodeBufferReader":12, "./object":13, "./signature":14, "./stringReader":15, "./support":17, "./uint8ArrayReader":18, "./utils":21, "./zipEntry":23}], 23:[function(a, b) {
    function c(a, b) {
      this.options = a, this.loadOptions = b
    }
    var d = a("./stringReader"), e = a("./utils"), f = a("./compressedObject"), g = a("./object"), h = 0, i = 3;
    c.prototype = {isEncrypted:function() {
      return 1 === (1 & this.bitFlag)
    }, useUTF8:function() {
      return 2048 === (2048 & this.bitFlag)
    }, prepareCompressedContent:function(a, b, c) {
      return function() {
        var d = a.index;
        a.setIndex(b);
        var e = a.readData(c);
        return a.setIndex(d), e
      }
    }, prepareContent:function(a, b, c, d, f) {
      return function() {
        var a = e.transformTo(d.uncompressInputType, this.getCompressedContent()), b = d.uncompress(a);
        if(b.length !== f) {
          throw new Error("Bug : uncompressed data size mismatch");
        }
        return b
      }
    }, readLocalPart:function(a) {
      var b, c;
      if(a.skip(22), this.fileNameLength = a.readInt(2), c = a.readInt(2), this.fileName = a.readString(this.fileNameLength), a.skip(c), -1 == this.compressedSize || -1 == this.uncompressedSize) {
        throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");
      }
      if(b = e.findCompression(this.compressionMethod), null === b) {
        throw new Error("Corrupted zip : compression " + e.pretty(this.compressionMethod) + " unknown (inner file : " + this.fileName + ")");
      }
      if(this.decompressed = new f, this.decompressed.compressedSize = this.compressedSize, this.decompressed.uncompressedSize = this.uncompressedSize, this.decompressed.crc32 = this.crc32, this.decompressed.compressionMethod = this.compressionMethod, this.decompressed.getCompressedContent = this.prepareCompressedContent(a, a.index, this.compressedSize, b), this.decompressed.getContent = this.prepareContent(a, a.index, this.compressedSize, b, this.uncompressedSize), this.loadOptions.checkCRC32 && 
      (this.decompressed = e.transformTo("string", this.decompressed.getContent()), g.crc32(this.decompressed) !== this.crc32)) {
        throw new Error("Corrupted zip : CRC32 mismatch");
      }
    }, readCentralPart:function(a) {
      if(this.versionMadeBy = a.readInt(2), this.versionNeeded = a.readInt(2), this.bitFlag = a.readInt(2), this.compressionMethod = a.readString(2), this.date = a.readDate(), this.crc32 = a.readInt(4), this.compressedSize = a.readInt(4), this.uncompressedSize = a.readInt(4), this.fileNameLength = a.readInt(2), this.extraFieldsLength = a.readInt(2), this.fileCommentLength = a.readInt(2), this.diskNumberStart = a.readInt(2), this.internalFileAttributes = a.readInt(2), this.externalFileAttributes = 
      a.readInt(4), this.localHeaderOffset = a.readInt(4), this.isEncrypted()) {
        throw new Error("Encrypted zip are not supported");
      }
      this.fileName = a.readString(this.fileNameLength), this.readExtraFields(a), this.parseZIP64ExtraField(a), this.fileComment = a.readString(this.fileCommentLength)
    }, processAttributes:function() {
      this.unixPermissions = null, this.dosPermissions = null;
      var a = this.versionMadeBy >> 8;
      this.dir = 16 & this.externalFileAttributes ? !0 : !1, a === h && (this.dosPermissions = 63 & this.externalFileAttributes), a === i && (this.unixPermissions = this.externalFileAttributes >> 16 & 65535), this.dir || ("/" !== this.fileName.slice(-1) || (this.dir = !0))
    }, parseZIP64ExtraField:function() {
      if(this.extraFields[1]) {
        var a = new d(this.extraFields[1].value);
        this.uncompressedSize === e.MAX_VALUE_32BITS && (this.uncompressedSize = a.readInt(8)), this.compressedSize === e.MAX_VALUE_32BITS && (this.compressedSize = a.readInt(8)), this.localHeaderOffset === e.MAX_VALUE_32BITS && (this.localHeaderOffset = a.readInt(8)), this.diskNumberStart === e.MAX_VALUE_32BITS && (this.diskNumberStart = a.readInt(4))
      }
    }, readExtraFields:function(a) {
      var b, c, d, e = a.index;
      for(this.extraFields = this.extraFields || {};a.index < e + this.extraFieldsLength;) {
        b = a.readInt(2), c = a.readInt(2), d = a.readString(c), this.extraFields[b] = {id:b, length:c, value:d}
      }
    }, handleUTF8:function() {
      if(this.useUTF8()) {
        this.fileName = g.utf8decode(this.fileName), this.fileComment = g.utf8decode(this.fileComment)
      }else {
        var a = this.findExtraFieldUnicodePath();
        null !== a && (this.fileName = a);
        var b = this.findExtraFieldUnicodeComment();
        null !== b && (this.fileComment = b)
      }
    }, findExtraFieldUnicodePath:function() {
      var a = this.extraFields[28789];
      if(a) {
        var b = new d(a.value);
        return 1 !== b.readInt(1) ? null : g.crc32(this.fileName) !== b.readInt(4) ? null : g.utf8decode(b.readString(a.length - 5))
      }
      return null
    }, findExtraFieldUnicodeComment:function() {
      var a = this.extraFields[25461];
      if(a) {
        var b = new d(a.value);
        return 1 !== b.readInt(1) ? null : g.crc32(this.fileComment) !== b.readInt(4) ? null : g.utf8decode(b.readString(a.length - 5))
      }
      return null
    }}, b.exports = c
  }, {"./compressedObject":2, "./object":13, "./stringReader":15, "./utils":21}], 24:[function(a, b) {
    var c = a("./lib/utils/common").assign, d = a("./lib/deflate"), e = a("./lib/inflate"), f = a("./lib/zlib/constants"), g = {};
    c(g, d, e, f), b.exports = g
  }, {"./lib/deflate":25, "./lib/inflate":26, "./lib/utils/common":27, "./lib/zlib/constants":30}], 25:[function(a, b, c) {
    function d(a, b) {
      var c = new s(b);
      if(c.push(a, !0), c.err) {
        throw c.msg;
      }
      return c.result
    }
    function e(a, b) {
      return b = b || {}, b.raw = !0, d(a, b)
    }
    function f(a, b) {
      return b = b || {}, b.gzip = !0, d(a, b)
    }
    var g = a("./zlib/deflate.js"), h = a("./utils/common"), i = a("./utils/strings"), j = a("./zlib/messages"), k = a("./zlib/zstream"), l = 0, m = 4, n = 0, o = 1, p = -1, q = 0, r = 8, s = function(a) {
      this.options = h.assign({level:p, method:r, chunkSize:16384, windowBits:15, memLevel:8, strategy:q, to:""}, a || {});
      var b = this.options;
      b.raw && b.windowBits > 0 ? b.windowBits = -b.windowBits : b.gzip && (b.windowBits > 0 && (b.windowBits < 16 && (b.windowBits += 16))), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new k, this.strm.avail_out = 0;
      var c = g.deflateInit2(this.strm, b.level, b.method, b.windowBits, b.memLevel, b.strategy);
      if(c !== n) {
        throw new Error(j[c]);
      }
      b.header && g.deflateSetHeader(this.strm, b.header)
    };
    s.prototype.push = function(a, b) {
      var c, d, e = this.strm, f = this.options.chunkSize;
      if(this.ended) {
        return!1
      }
      d = b === ~~b ? b : b === !0 ? m : l, e.input = "string" == typeof a ? i.string2buf(a) : a, e.next_in = 0, e.avail_in = e.input.length;
      do {
        if(0 === e.avail_out && (e.output = new h.Buf8(f), e.next_out = 0, e.avail_out = f), c = g.deflate(e, d), c !== o && c !== n) {
          return this.onEnd(c), this.ended = !0, !1
        }
        (0 === e.avail_out || 0 === e.avail_in && d === m) && this.onData("string" === this.options.to ? i.buf2binstring(h.shrinkBuf(e.output, e.next_out)) : h.shrinkBuf(e.output, e.next_out))
      }while((e.avail_in > 0 || 0 === e.avail_out) && c !== o);
      return d === m ? (c = g.deflateEnd(this.strm), this.onEnd(c), this.ended = !0, c === n) : !0
    }, s.prototype.onData = function(a) {
      this.chunks.push(a)
    }, s.prototype.onEnd = function(a) {
      a === n && (this.result = "string" === this.options.to ? this.chunks.join("") : h.flattenChunks(this.chunks)), this.chunks = [], this.err = a, this.msg = this.strm.msg
    }, c.Deflate = s, c.deflate = d, c.deflateRaw = e, c.gzip = f
  }, {"./utils/common":27, "./utils/strings":28, "./zlib/deflate.js":32, "./zlib/messages":37, "./zlib/zstream":39}], 26:[function(a, b, c) {
    function d(a, b) {
      var c = new m(b);
      if(c.push(a, !0), c.err) {
        throw c.msg;
      }
      return c.result
    }
    function e(a, b) {
      return b = b || {}, b.raw = !0, d(a, b)
    }
    var f = a("./zlib/inflate.js"), g = a("./utils/common"), h = a("./utils/strings"), i = a("./zlib/constants"), j = a("./zlib/messages"), k = a("./zlib/zstream"), l = a("./zlib/gzheader"), m = function(a) {
      this.options = g.assign({chunkSize:16384, windowBits:0, to:""}, a || {});
      var b = this.options;
      b.raw && (b.windowBits >= 0 && (b.windowBits < 16 && (b.windowBits = -b.windowBits, 0 === b.windowBits && (b.windowBits = -15)))), !(b.windowBits >= 0 && b.windowBits < 16) || (a && a.windowBits || (b.windowBits += 32)), b.windowBits > 15 && (b.windowBits < 48 && (0 === (15 & b.windowBits) && (b.windowBits |= 15))), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new k, this.strm.avail_out = 0;
      var c = f.inflateInit2(this.strm, b.windowBits);
      if(c !== i.Z_OK) {
        throw new Error(j[c]);
      }
      this.header = new l, f.inflateGetHeader(this.strm, this.header)
    };
    m.prototype.push = function(a, b) {
      var c, d, e, j, k, l = this.strm, m = this.options.chunkSize;
      if(this.ended) {
        return!1
      }
      d = b === ~~b ? b : b === !0 ? i.Z_FINISH : i.Z_NO_FLUSH, l.input = "string" == typeof a ? h.binstring2buf(a) : a, l.next_in = 0, l.avail_in = l.input.length;
      do {
        if(0 === l.avail_out && (l.output = new g.Buf8(m), l.next_out = 0, l.avail_out = m), c = f.inflate(l, i.Z_NO_FLUSH), c !== i.Z_STREAM_END && c !== i.Z_OK) {
          return this.onEnd(c), this.ended = !0, !1
        }
        l.next_out && ((0 === l.avail_out || (c === i.Z_STREAM_END || 0 === l.avail_in && d === i.Z_FINISH)) && ("string" === this.options.to ? (e = h.utf8border(l.output, l.next_out), j = l.next_out - e, k = h.buf2string(l.output, e), l.next_out = j, l.avail_out = m - j, j && g.arraySet(l.output, l.output, e, j, 0), this.onData(k)) : this.onData(g.shrinkBuf(l.output, l.next_out))))
      }while(l.avail_in > 0 && c !== i.Z_STREAM_END);
      return c === i.Z_STREAM_END && (d = i.Z_FINISH), d === i.Z_FINISH ? (c = f.inflateEnd(this.strm), this.onEnd(c), this.ended = !0, c === i.Z_OK) : !0
    }, m.prototype.onData = function(a) {
      this.chunks.push(a)
    }, m.prototype.onEnd = function(a) {
      a === i.Z_OK && (this.result = "string" === this.options.to ? this.chunks.join("") : g.flattenChunks(this.chunks)), this.chunks = [], this.err = a, this.msg = this.strm.msg
    }, c.Inflate = m, c.inflate = d, c.inflateRaw = e, c.ungzip = d
  }, {"./utils/common":27, "./utils/strings":28, "./zlib/constants":30, "./zlib/gzheader":33, "./zlib/inflate.js":35, "./zlib/messages":37, "./zlib/zstream":39}], 27:[function(a, b, c) {
    var d = "undefined" != typeof Uint8Array && ("undefined" != typeof Uint16Array && "undefined" != typeof Int32Array);
    c.assign = function(a) {
      for(var b = Array.prototype.slice.call(arguments, 1);b.length;) {
        var c = b.shift();
        if(c) {
          if("object" != typeof c) {
            throw new TypeError(c + "must be non-object");
          }
          for(var d in c) {
            c.hasOwnProperty(d) && (a[d] = c[d])
          }
        }
      }
      return a
    }, c.shrinkBuf = function(a, b) {
      return a.length === b ? a : a.subarray ? a.subarray(0, b) : (a.length = b, a)
    };
    var e = {arraySet:function(a, b, c, d, e) {
      if(b.subarray && a.subarray) {
        return void a.set(b.subarray(c, c + d), e)
      }
      for(var f = 0;d > f;f++) {
        a[e + f] = b[c + f]
      }
    }, flattenChunks:function(a) {
      var b, c, d, e, f, g;
      for(d = 0, b = 0, c = a.length;c > b;b++) {
        d += a[b].length
      }
      for(g = new Uint8Array(d), e = 0, b = 0, c = a.length;c > b;b++) {
        f = a[b], g.set(f, e), e += f.length
      }
      return g
    }}, f = {arraySet:function(a, b, c, d, e) {
      for(var f = 0;d > f;f++) {
        a[e + f] = b[c + f]
      }
    }, flattenChunks:function(a) {
      return[].concat.apply([], a)
    }};
    c.setTyped = function(a) {
      a ? (c.Buf8 = Uint8Array, c.Buf16 = Uint16Array, c.Buf32 = Int32Array, c.assign(c, e)) : (c.Buf8 = Array, c.Buf16 = Array, c.Buf32 = Array, c.assign(c, f))
    }, c.setTyped(d)
  }, {}], 28:[function(a, b, c) {
    function d(a, b) {
      if(65537 > b && (a.subarray && g || !a.subarray && f)) {
        return String.fromCharCode.apply(null, e.shrinkBuf(a, b))
      }
      for(var c = "", d = 0;b > d;d++) {
        c += String.fromCharCode(a[d])
      }
      return c
    }
    var e = a("./common"), f = !0, g = !0;
    try {
      String.fromCharCode.apply(null, [0])
    }catch(h) {
      f = !1
    }
    try {
      String.fromCharCode.apply(null, new Uint8Array(1))
    }catch(h) {
      g = !1
    }
    for(var i = new e.Buf8(256), j = 0;256 > j;j++) {
      i[j] = j >= 252 ? 6 : j >= 248 ? 5 : j >= 240 ? 4 : j >= 224 ? 3 : j >= 192 ? 2 : 1
    }
    i[254] = i[254] = 1, c.string2buf = function(a) {
      var b, c, d, f, g, h = a.length, i = 0;
      for(f = 0;h > f;f++) {
        c = a.charCodeAt(f), 55296 === (64512 & c) && (h > f + 1 && (d = a.charCodeAt(f + 1), 56320 === (64512 & d) && (c = 65536 + (c - 55296 << 10) + (d - 56320), f++))), i += 128 > c ? 1 : 2048 > c ? 2 : 65536 > c ? 3 : 4
      }
      for(b = new e.Buf8(i), g = 0, f = 0;i > g;f++) {
        c = a.charCodeAt(f), 55296 === (64512 & c) && (h > f + 1 && (d = a.charCodeAt(f + 1), 56320 === (64512 & d) && (c = 65536 + (c - 55296 << 10) + (d - 56320), f++))), 128 > c ? b[g++] = c : 2048 > c ? (b[g++] = 192 | c >>> 6, b[g++] = 128 | 63 & c) : 65536 > c ? (b[g++] = 224 | c >>> 12, b[g++] = 128 | c >>> 6 & 63, b[g++] = 128 | 63 & c) : (b[g++] = 240 | c >>> 18, b[g++] = 128 | c >>> 12 & 63, b[g++] = 128 | c >>> 6 & 63, b[g++] = 128 | 63 & c)
      }
      return b
    }, c.buf2binstring = function(a) {
      return d(a, a.length)
    }, c.binstring2buf = function(a) {
      for(var b = new e.Buf8(a.length), c = 0, d = b.length;d > c;c++) {
        b[c] = a.charCodeAt(c)
      }
      return b
    }, c.buf2string = function(a, b) {
      var c, e, f, g, h = b || a.length, j = new Array(2 * h);
      for(e = 0, c = 0;h > c;) {
        if(f = a[c++], 128 > f) {
          j[e++] = f
        }else {
          if(g = i[f], g > 4) {
            j[e++] = 65533, c += g - 1
          }else {
            for(f &= 2 === g ? 31 : 3 === g ? 15 : 7;g > 1 && h > c;) {
              f = f << 6 | 63 & a[c++], g--
            }
            g > 1 ? j[e++] = 65533 : 65536 > f ? j[e++] = f : (f -= 65536, j[e++] = 55296 | f >> 10 & 1023, j[e++] = 56320 | 1023 & f)
          }
        }
      }
      return d(j, e)
    }, c.utf8border = function(a, b) {
      var c;
      for(b = b || a.length, b > a.length && (b = a.length), c = b - 1;c >= 0 && 128 === (192 & a[c]);) {
        c--
      }
      return 0 > c ? b : 0 === c ? b : c + i[a[c]] > b ? c : b
    }
  }, {"./common":27}], 29:[function(a, b) {
    function c(a, b, c, d) {
      for(var e = 65535 & a | 0, f = a >>> 16 & 65535 | 0, g = 0;0 !== c;) {
        g = c > 2E3 ? 2E3 : c, c -= g;
        do {
          e = e + b[d++] | 0, f = f + e | 0
        }while(--g);
        e %= 65521, f %= 65521
      }
      return e | f << 16 | 0
    }
    b.exports = c
  }, {}], 30:[function(a, b) {
    b.exports = {Z_NO_FLUSH:0, Z_PARTIAL_FLUSH:1, Z_SYNC_FLUSH:2, Z_FULL_FLUSH:3, Z_FINISH:4, Z_BLOCK:5, Z_TREES:6, Z_OK:0, Z_STREAM_END:1, Z_NEED_DICT:2, Z_ERRNO:-1, Z_STREAM_ERROR:-2, Z_DATA_ERROR:-3, Z_BUF_ERROR:-5, Z_NO_COMPRESSION:0, Z_BEST_SPEED:1, Z_BEST_COMPRESSION:9, Z_DEFAULT_COMPRESSION:-1, Z_FILTERED:1, Z_HUFFMAN_ONLY:2, Z_RLE:3, Z_FIXED:4, Z_DEFAULT_STRATEGY:0, Z_BINARY:0, Z_TEXT:1, Z_UNKNOWN:2, Z_DEFLATED:8}
  }, {}], 31:[function(a, b) {
    function c() {
      for(var a, b = [], c = 0;256 > c;c++) {
        a = c;
        for(var d = 0;8 > d;d++) {
          a = 1 & a ? 3988292384 ^ a >>> 1 : a >>> 1
        }
        b[c] = a
      }
      return b
    }
    function d(a, b, c, d) {
      var f = e, g = d + c;
      a = -1 ^ a;
      for(var h = d;g > h;h++) {
        a = a >>> 8 ^ f[255 & (a ^ b[h])]
      }
      return-1 ^ a
    }
    var e = c();
    b.exports = d
  }, {}], 32:[function(a, b, c) {
    function d(a, b) {
      return a.msg = G[b], b
    }
    function e(a) {
      return(a << 1) - (a > 4 ? 9 : 0)
    }
    function f(a) {
      for(var b = a.length;--b >= 0;) {
        a[b] = 0
      }
    }
    function g(a) {
      var b = a.state, c = b.pending;
      c > a.avail_out && (c = a.avail_out), 0 !== c && (C.arraySet(a.output, b.pending_buf, b.pending_out, c, a.next_out), a.next_out += c, b.pending_out += c, a.total_out += c, a.avail_out -= c, b.pending -= c, 0 === b.pending && (b.pending_out = 0))
    }
    function h(a, b) {
      D._tr_flush_block(a, a.block_start >= 0 ? a.block_start : -1, a.strstart - a.block_start, b), a.block_start = a.strstart, g(a.strm)
    }
    function i(a, b) {
      a.pending_buf[a.pending++] = b
    }
    function j(a, b) {
      a.pending_buf[a.pending++] = b >>> 8 & 255, a.pending_buf[a.pending++] = 255 & b
    }
    function k(a, b, c, d) {
      var e = a.avail_in;
      return e > d && (e = d), 0 === e ? 0 : (a.avail_in -= e, C.arraySet(b, a.input, a.next_in, e, c), 1 === a.state.wrap ? a.adler = E(a.adler, b, e, c) : 2 === a.state.wrap && (a.adler = F(a.adler, b, e, c)), a.next_in += e, a.total_in += e, e)
    }
    function l(a, b) {
      var c, d, e = a.max_chain_length, f = a.strstart, g = a.prev_length, h = a.nice_match, i = a.strstart > a.w_size - jb ? a.strstart - (a.w_size - jb) : 0, j = a.window, k = a.w_mask, l = a.prev, m = a.strstart + ib, n = j[f + g - 1], o = j[f + g];
      a.prev_length >= a.good_match && (e >>= 2), h > a.lookahead && (h = a.lookahead);
      do {
        if(c = b, j[c + g] === o && (j[c + g - 1] === n && (j[c] === j[f] && j[++c] === j[f + 1]))) {
          f += 2, c++;
          do {
          }while(j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && (j[++f] === j[++c] && m > f))))))));
          if(d = ib - (m - f), f = m - ib, d > g) {
            if(a.match_start = b, g = d, d >= h) {
              break
            }
            n = j[f + g - 1], o = j[f + g]
          }
        }
      }while((b = l[b & k]) > i && 0 !== --e);
      return g <= a.lookahead ? g : a.lookahead
    }
    function m(a) {
      var b, c, d, e, f, g = a.w_size;
      do {
        if(e = a.window_size - a.lookahead - a.strstart, a.strstart >= g + (g - jb)) {
          C.arraySet(a.window, a.window, g, g, 0), a.match_start -= g, a.strstart -= g, a.block_start -= g, c = a.hash_size, b = c;
          do {
            d = a.head[--b], a.head[b] = d >= g ? d - g : 0
          }while(--c);
          c = g, b = c;
          do {
            d = a.prev[--b], a.prev[b] = d >= g ? d - g : 0
          }while(--c);
          e += g
        }
        if(0 === a.strm.avail_in) {
          break
        }
        if(c = k(a.strm, a.window, a.strstart + a.lookahead, e), a.lookahead += c, a.lookahead + a.insert >= hb) {
          for(f = a.strstart - a.insert, a.ins_h = a.window[f], a.ins_h = (a.ins_h << a.hash_shift ^ a.window[f + 1]) & a.hash_mask;a.insert && (a.ins_h = (a.ins_h << a.hash_shift ^ a.window[f + hb - 1]) & a.hash_mask, a.prev[f & a.w_mask] = a.head[a.ins_h], a.head[a.ins_h] = f, f++, a.insert--, !(a.lookahead + a.insert < hb));) {
          }
        }
      }while(a.lookahead < jb && 0 !== a.strm.avail_in)
    }
    function n(a, b) {
      var c = 65535;
      for(c > a.pending_buf_size - 5 && (c = a.pending_buf_size - 5);;) {
        if(a.lookahead <= 1) {
          if(m(a), 0 === a.lookahead && b === H) {
            return sb
          }
          if(0 === a.lookahead) {
            break
          }
        }
        a.strstart += a.lookahead, a.lookahead = 0;
        var d = a.block_start + c;
        if((0 === a.strstart || a.strstart >= d) && (a.lookahead = a.strstart - d, a.strstart = d, h(a, !1), 0 === a.strm.avail_out)) {
          return sb
        }
        if(a.strstart - a.block_start >= a.w_size - jb && (h(a, !1), 0 === a.strm.avail_out)) {
          return sb
        }
      }
      return a.insert = 0, b === K ? (h(a, !0), 0 === a.strm.avail_out ? ub : vb) : a.strstart > a.block_start && (h(a, !1), 0 === a.strm.avail_out) ? sb : sb
    }
    function o(a, b) {
      for(var c, d;;) {
        if(a.lookahead < jb) {
          if(m(a), a.lookahead < jb && b === H) {
            return sb
          }
          if(0 === a.lookahead) {
            break
          }
        }
        if(c = 0, a.lookahead >= hb && (a.ins_h = (a.ins_h << a.hash_shift ^ a.window[a.strstart + hb - 1]) & a.hash_mask, c = a.prev[a.strstart & a.w_mask] = a.head[a.ins_h], a.head[a.ins_h] = a.strstart), 0 !== c && (a.strstart - c <= a.w_size - jb && (a.match_length = l(a, c))), a.match_length >= hb) {
          if(d = D._tr_tally(a, a.strstart - a.match_start, a.match_length - hb), a.lookahead -= a.match_length, a.match_length <= a.max_lazy_match && a.lookahead >= hb) {
            a.match_length--;
            do {
              a.strstart++, a.ins_h = (a.ins_h << a.hash_shift ^ a.window[a.strstart + hb - 1]) & a.hash_mask, c = a.prev[a.strstart & a.w_mask] = a.head[a.ins_h], a.head[a.ins_h] = a.strstart
            }while(0 !== --a.match_length);
            a.strstart++
          }else {
            a.strstart += a.match_length, a.match_length = 0, a.ins_h = a.window[a.strstart], a.ins_h = (a.ins_h << a.hash_shift ^ a.window[a.strstart + 1]) & a.hash_mask
          }
        }else {
          d = D._tr_tally(a, 0, a.window[a.strstart]), a.lookahead--, a.strstart++
        }
        if(d && (h(a, !1), 0 === a.strm.avail_out)) {
          return sb
        }
      }
      return a.insert = a.strstart < hb - 1 ? a.strstart : hb - 1, b === K ? (h(a, !0), 0 === a.strm.avail_out ? ub : vb) : a.last_lit && (h(a, !1), 0 === a.strm.avail_out) ? sb : tb
    }
    function p(a, b) {
      for(var c, d, e;;) {
        if(a.lookahead < jb) {
          if(m(a), a.lookahead < jb && b === H) {
            return sb
          }
          if(0 === a.lookahead) {
            break
          }
        }
        if(c = 0, a.lookahead >= hb && (a.ins_h = (a.ins_h << a.hash_shift ^ a.window[a.strstart + hb - 1]) & a.hash_mask, c = a.prev[a.strstart & a.w_mask] = a.head[a.ins_h], a.head[a.ins_h] = a.strstart), a.prev_length = a.match_length, a.prev_match = a.match_start, a.match_length = hb - 1, 0 !== c && (a.prev_length < a.max_lazy_match && (a.strstart - c <= a.w_size - jb && (a.match_length = l(a, c), a.match_length <= 5 && ((a.strategy === S || a.match_length === hb && a.strstart - a.match_start > 
        4096) && (a.match_length = hb - 1))))), a.prev_length >= hb && a.match_length <= a.prev_length) {
          e = a.strstart + a.lookahead - hb, d = D._tr_tally(a, a.strstart - 1 - a.prev_match, a.prev_length - hb), a.lookahead -= a.prev_length - 1, a.prev_length -= 2;
          do {
            ++a.strstart <= e && (a.ins_h = (a.ins_h << a.hash_shift ^ a.window[a.strstart + hb - 1]) & a.hash_mask, c = a.prev[a.strstart & a.w_mask] = a.head[a.ins_h], a.head[a.ins_h] = a.strstart)
          }while(0 !== --a.prev_length);
          if(a.match_available = 0, a.match_length = hb - 1, a.strstart++, d && (h(a, !1), 0 === a.strm.avail_out)) {
            return sb
          }
        }else {
          if(a.match_available) {
            if(d = D._tr_tally(a, 0, a.window[a.strstart - 1]), d && h(a, !1), a.strstart++, a.lookahead--, 0 === a.strm.avail_out) {
              return sb
            }
          }else {
            a.match_available = 1, a.strstart++, a.lookahead--
          }
        }
      }
      return a.match_available && (d = D._tr_tally(a, 0, a.window[a.strstart - 1]), a.match_available = 0), a.insert = a.strstart < hb - 1 ? a.strstart : hb - 1, b === K ? (h(a, !0), 0 === a.strm.avail_out ? ub : vb) : a.last_lit && (h(a, !1), 0 === a.strm.avail_out) ? sb : tb
    }
    function q(a, b) {
      for(var c, d, e, f, g = a.window;;) {
        if(a.lookahead <= ib) {
          if(m(a), a.lookahead <= ib && b === H) {
            return sb
          }
          if(0 === a.lookahead) {
            break
          }
        }
        if(a.match_length = 0, a.lookahead >= hb && (a.strstart > 0 && (e = a.strstart - 1, d = g[e], d === g[++e] && (d === g[++e] && d === g[++e])))) {
          f = a.strstart + ib;
          do {
          }while(d === g[++e] && (d === g[++e] && (d === g[++e] && (d === g[++e] && (d === g[++e] && (d === g[++e] && (d === g[++e] && (d === g[++e] && f > e))))))));
          a.match_length = ib - (f - e), a.match_length > a.lookahead && (a.match_length = a.lookahead)
        }
        if(a.match_length >= hb ? (c = D._tr_tally(a, 1, a.match_length - hb), a.lookahead -= a.match_length, a.strstart += a.match_length, a.match_length = 0) : (c = D._tr_tally(a, 0, a.window[a.strstart]), a.lookahead--, a.strstart++), c && (h(a, !1), 0 === a.strm.avail_out)) {
          return sb
        }
      }
      return a.insert = 0, b === K ? (h(a, !0), 0 === a.strm.avail_out ? ub : vb) : a.last_lit && (h(a, !1), 0 === a.strm.avail_out) ? sb : tb
    }
    function r(a, b) {
      for(var c;;) {
        if(0 === a.lookahead && (m(a), 0 === a.lookahead)) {
          if(b === H) {
            return sb
          }
          break
        }
        if(a.match_length = 0, c = D._tr_tally(a, 0, a.window[a.strstart]), a.lookahead--, a.strstart++, c && (h(a, !1), 0 === a.strm.avail_out)) {
          return sb
        }
      }
      return a.insert = 0, b === K ? (h(a, !0), 0 === a.strm.avail_out ? ub : vb) : a.last_lit && (h(a, !1), 0 === a.strm.avail_out) ? sb : tb
    }
    function s(a) {
      a.window_size = 2 * a.w_size, f(a.head), a.max_lazy_match = B[a.level].max_lazy, a.good_match = B[a.level].good_length, a.nice_match = B[a.level].nice_length, a.max_chain_length = B[a.level].max_chain, a.strstart = 0, a.block_start = 0, a.lookahead = 0, a.insert = 0, a.match_length = a.prev_length = hb - 1, a.match_available = 0, a.ins_h = 0
    }
    function t() {
      this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = Y, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 
      0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new C.Buf16(2 * fb), this.dyn_dtree = new C.Buf16(2 * (2 * db + 1)), this.bl_tree = new C.Buf16(2 * (2 * eb + 1)), f(this.dyn_ltree), f(this.dyn_dtree), f(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = 
      new C.Buf16(gb + 1), this.heap = new C.Buf16(2 * cb + 1), f(this.heap), this.heap_len = 0, this.heap_max = 0, this.depth = new C.Buf16(2 * cb + 1), f(this.depth), this.l_buf = 0, this.lit_bufsize = 0, this.last_lit = 0, this.d_buf = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0
    }
    function u(a) {
      var b;
      return a && a.state ? (a.total_in = a.total_out = 0, a.data_type = X, b = a.state, b.pending = 0, b.pending_out = 0, b.wrap < 0 && (b.wrap = -b.wrap), b.status = b.wrap ? lb : qb, a.adler = 2 === b.wrap ? 0 : 1, b.last_flush = H, D._tr_init(b), M) : d(a, O)
    }
    function v(a) {
      var b = u(a);
      return b === M && s(a.state), b
    }
    function w(a, b) {
      return a && a.state ? 2 !== a.state.wrap ? O : (a.state.gzhead = b, M) : O
    }
    function x(a, b, c, e, f, g) {
      if(!a) {
        return O
      }
      var h = 1;
      if(b === R && (b = 6), 0 > e ? (h = 0, e = -e) : e > 15 && (h = 2, e -= 16), 1 > f || (f > Z || (c !== Y || (8 > e || (e > 15 || (0 > b || (b > 9 || (0 > g || g > V)))))))) {
        return d(a, O)
      }
      8 === e && (e = 9);
      var i = new t;
      return a.state = i, i.strm = a, i.wrap = h, i.gzhead = null, i.w_bits = e, i.w_size = 1 << i.w_bits, i.w_mask = i.w_size - 1, i.hash_bits = f + 7, i.hash_size = 1 << i.hash_bits, i.hash_mask = i.hash_size - 1, i.hash_shift = ~~((i.hash_bits + hb - 1) / hb), i.window = new C.Buf8(2 * i.w_size), i.head = new C.Buf16(i.hash_size), i.prev = new C.Buf16(i.w_size), i.lit_bufsize = 1 << f + 6, i.pending_buf_size = 4 * i.lit_bufsize, i.pending_buf = new C.Buf8(i.pending_buf_size), i.d_buf = i.lit_bufsize >> 
      1, i.l_buf = 3 * i.lit_bufsize, i.level = b, i.strategy = g, i.method = c, v(a)
    }
    function y(a, b) {
      return x(a, b, Y, $, _, W)
    }
    function z(a, b) {
      var c, h, k, l;
      if(!a || (!a.state || (b > L || 0 > b))) {
        return a ? d(a, O) : O
      }
      if(h = a.state, !a.output || (!a.input && 0 !== a.avail_in || h.status === rb && b !== K)) {
        return d(a, 0 === a.avail_out ? Q : O)
      }
      if(h.strm = a, c = h.last_flush, h.last_flush = b, h.status === lb) {
        if(2 === h.wrap) {
          a.adler = 0, i(h, 31), i(h, 139), i(h, 8), h.gzhead ? (i(h, (h.gzhead.text ? 1 : 0) + (h.gzhead.hcrc ? 2 : 0) + (h.gzhead.extra ? 4 : 0) + (h.gzhead.name ? 8 : 0) + (h.gzhead.comment ? 16 : 0)), i(h, 255 & h.gzhead.time), i(h, h.gzhead.time >> 8 & 255), i(h, h.gzhead.time >> 16 & 255), i(h, h.gzhead.time >> 24 & 255), i(h, 9 === h.level ? 2 : h.strategy >= T || h.level < 2 ? 4 : 0), i(h, 255 & h.gzhead.os), h.gzhead.extra && (h.gzhead.extra.length && (i(h, 255 & h.gzhead.extra.length), 
          i(h, h.gzhead.extra.length >> 8 & 255))), h.gzhead.hcrc && (a.adler = F(a.adler, h.pending_buf, h.pending, 0)), h.gzindex = 0, h.status = mb) : (i(h, 0), i(h, 0), i(h, 0), i(h, 0), i(h, 0), i(h, 9 === h.level ? 2 : h.strategy >= T || h.level < 2 ? 4 : 0), i(h, wb), h.status = qb)
        }else {
          var m = Y + (h.w_bits - 8 << 4) << 8, n = -1;
          n = h.strategy >= T || h.level < 2 ? 0 : h.level < 6 ? 1 : 6 === h.level ? 2 : 3, m |= n << 6, 0 !== h.strstart && (m |= kb), m += 31 - m % 31, h.status = qb, j(h, m), 0 !== h.strstart && (j(h, a.adler >>> 16), j(h, 65535 & a.adler)), a.adler = 1
        }
      }
      if(h.status === mb) {
        if(h.gzhead.extra) {
          for(k = h.pending;h.gzindex < (65535 & h.gzhead.extra.length) && (h.pending !== h.pending_buf_size || (h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), g(a), k = h.pending, h.pending !== h.pending_buf_size));) {
            i(h, 255 & h.gzhead.extra[h.gzindex]), h.gzindex++
          }
          h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), h.gzindex === h.gzhead.extra.length && (h.gzindex = 0, h.status = nb)
        }else {
          h.status = nb
        }
      }
      if(h.status === nb) {
        if(h.gzhead.name) {
          k = h.pending;
          do {
            if(h.pending === h.pending_buf_size && (h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), g(a), k = h.pending, h.pending === h.pending_buf_size)) {
              l = 1;
              break
            }
            l = h.gzindex < h.gzhead.name.length ? 255 & h.gzhead.name.charCodeAt(h.gzindex++) : 0, i(h, l)
          }while(0 !== l);
          h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), 0 === l && (h.gzindex = 0, h.status = ob)
        }else {
          h.status = ob
        }
      }
      if(h.status === ob) {
        if(h.gzhead.comment) {
          k = h.pending;
          do {
            if(h.pending === h.pending_buf_size && (h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), g(a), k = h.pending, h.pending === h.pending_buf_size)) {
              l = 1;
              break
            }
            l = h.gzindex < h.gzhead.comment.length ? 255 & h.gzhead.comment.charCodeAt(h.gzindex++) : 0, i(h, l)
          }while(0 !== l);
          h.gzhead.hcrc && (h.pending > k && (a.adler = F(a.adler, h.pending_buf, h.pending - k, k))), 0 === l && (h.status = pb)
        }else {
          h.status = pb
        }
      }
      if(h.status === pb && (h.gzhead.hcrc ? (h.pending + 2 > h.pending_buf_size && g(a), h.pending + 2 <= h.pending_buf_size && (i(h, 255 & a.adler), i(h, a.adler >> 8 & 255), a.adler = 0, h.status = qb)) : h.status = qb), 0 !== h.pending) {
        if(g(a), 0 === a.avail_out) {
          return h.last_flush = -1, M
        }
      }else {
        if(0 === a.avail_in && (e(b) <= e(c) && b !== K)) {
          return d(a, Q)
        }
      }
      if(h.status === rb && 0 !== a.avail_in) {
        return d(a, Q)
      }
      if(0 !== a.avail_in || (0 !== h.lookahead || b !== H && h.status !== rb)) {
        var o = h.strategy === T ? r(h, b) : h.strategy === U ? q(h, b) : B[h.level].func(h, b);
        if((o === ub || o === vb) && (h.status = rb), o === sb || o === ub) {
          return 0 === a.avail_out && (h.last_flush = -1), M
        }
        if(o === tb && (b === I ? D._tr_align(h) : b !== L && (D._tr_stored_block(h, 0, 0, !1), b === J && (f(h.head), 0 === h.lookahead && (h.strstart = 0, h.block_start = 0, h.insert = 0))), g(a), 0 === a.avail_out)) {
          return h.last_flush = -1, M
        }
      }
      return b !== K ? M : h.wrap <= 0 ? N : (2 === h.wrap ? (i(h, 255 & a.adler), i(h, a.adler >> 8 & 255), i(h, a.adler >> 16 & 255), i(h, a.adler >> 24 & 255), i(h, 255 & a.total_in), i(h, a.total_in >> 8 & 255), i(h, a.total_in >> 16 & 255), i(h, a.total_in >> 24 & 255)) : (j(h, a.adler >>> 16), j(h, 65535 & a.adler)), g(a), h.wrap > 0 && (h.wrap = -h.wrap), 0 !== h.pending ? M : N)
    }
    function A(a) {
      var b;
      return a && a.state ? (b = a.state.status, b !== lb && (b !== mb && (b !== nb && (b !== ob && (b !== pb && (b !== qb && b !== rb))))) ? d(a, O) : (a.state = null, b === qb ? d(a, P) : M)) : O
    }
    var B, C = a("../utils/common"), D = a("./trees"), E = a("./adler32"), F = a("./crc32"), G = a("./messages"), H = 0, I = 1, J = 3, K = 4, L = 5, M = 0, N = 1, O = -2, P = -3, Q = -5, R = -1, S = 1, T = 2, U = 3, V = 4, W = 0, X = 2, Y = 8, Z = 9, $ = 15, _ = 8, ab = 29, bb = 256, cb = bb + 1 + ab, db = 30, eb = 19, fb = 2 * cb + 1, gb = 15, hb = 3, ib = 258, jb = ib + hb + 1, kb = 32, lb = 42, mb = 69, nb = 73, ob = 91, pb = 103, qb = 113, rb = 666, sb = 1, tb = 2, ub = 3, vb = 4, wb = 3, xb = 
    function(a, b, c, d, e) {
      this.good_length = a, this.max_lazy = b, this.nice_length = c, this.max_chain = d, this.func = e
    };
    B = [new xb(0, 0, 0, 0, n), new xb(4, 4, 8, 4, o), new xb(4, 5, 16, 8, o), new xb(4, 6, 32, 32, o), new xb(4, 4, 16, 16, p), new xb(8, 16, 32, 32, p), new xb(8, 16, 128, 128, p), new xb(8, 32, 128, 256, p), new xb(32, 128, 258, 1024, p), new xb(32, 258, 258, 4096, p)], c.deflateInit = y, c.deflateInit2 = x, c.deflateReset = v, c.deflateResetKeep = u, c.deflateSetHeader = w, c.deflate = z, c.deflateEnd = A, c.deflateInfo = "pako deflate (from Nodeca project)"
  }, {"../utils/common":27, "./adler32":29, "./crc32":31, "./messages":37, "./trees":38}], 33:[function(a, b) {
    function c() {
      this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1
    }
    b.exports = c
  }, {}], 34:[function(a, b) {
    var c = 30, d = 12;
    b.exports = function(a, b) {
      var e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C;
      e = a.state, f = a.next_in, B = a.input, g = f + (a.avail_in - 5), h = a.next_out, C = a.output, i = h - (b - a.avail_out), j = h + (a.avail_out - 257), k = e.dmax, l = e.wsize, m = e.whave, n = e.wnext, o = e.window, p = e.hold, q = e.bits, r = e.lencode, s = e.distcode, t = (1 << e.lenbits) - 1, u = (1 << e.distbits) - 1;
      a:do {
        15 > q && (p += B[f++] << q, q += 8, p += B[f++] << q, q += 8), v = r[p & t];
        b:for(;;) {
          if(w = v >>> 24, p >>>= w, q -= w, w = v >>> 16 & 255, 0 === w) {
            C[h++] = 65535 & v
          }else {
            if(!(16 & w)) {
              if(0 === (64 & w)) {
                v = r[(65535 & v) + (p & (1 << w) - 1)];
                continue b
              }
              if(32 & w) {
                e.mode = d;
                break a
              }
              a.msg = "invalid literal/length code", e.mode = c;
              break a
            }
            x = 65535 & v, w &= 15, w && (w > q && (p += B[f++] << q, q += 8), x += p & (1 << w) - 1, p >>>= w, q -= w), 15 > q && (p += B[f++] << q, q += 8, p += B[f++] << q, q += 8), v = s[p & u];
            c:for(;;) {
              if(w = v >>> 24, p >>>= w, q -= w, w = v >>> 16 & 255, !(16 & w)) {
                if(0 === (64 & w)) {
                  v = s[(65535 & v) + (p & (1 << w) - 1)];
                  continue c
                }
                a.msg = "invalid distance code", e.mode = c;
                break a
              }
              if(y = 65535 & v, w &= 15, w > q && (p += B[f++] << q, q += 8, w > q && (p += B[f++] << q, q += 8)), y += p & (1 << w) - 1, y > k) {
                a.msg = "invalid distance too far back", e.mode = c;
                break a
              }
              if(p >>>= w, q -= w, w = h - i, y > w) {
                if(w = y - w, w > m && e.sane) {
                  a.msg = "invalid distance too far back", e.mode = c;
                  break a
                }
                if(z = 0, A = o, 0 === n) {
                  if(z += l - w, x > w) {
                    x -= w;
                    do {
                      C[h++] = o[z++]
                    }while(--w);
                    z = h - y, A = C
                  }
                }else {
                  if(w > n) {
                    if(z += l + n - w, w -= n, x > w) {
                      x -= w;
                      do {
                        C[h++] = o[z++]
                      }while(--w);
                      if(z = 0, x > n) {
                        w = n, x -= w;
                        do {
                          C[h++] = o[z++]
                        }while(--w);
                        z = h - y, A = C
                      }
                    }
                  }else {
                    if(z += n - w, x > w) {
                      x -= w;
                      do {
                        C[h++] = o[z++]
                      }while(--w);
                      z = h - y, A = C
                    }
                  }
                }
                for(;x > 2;) {
                  C[h++] = A[z++], C[h++] = A[z++], C[h++] = A[z++], x -= 3
                }
                x && (C[h++] = A[z++], x > 1 && (C[h++] = A[z++]))
              }else {
                z = h - y;
                do {
                  C[h++] = C[z++], C[h++] = C[z++], C[h++] = C[z++], x -= 3
                }while(x > 2);
                x && (C[h++] = C[z++], x > 1 && (C[h++] = C[z++]))
              }
              break
            }
          }
          break
        }
      }while(g > f && j > h);
      x = q >> 3, f -= x, q -= x << 3, p &= (1 << q) - 1, a.next_in = f, a.next_out = h, a.avail_in = g > f ? 5 + (g - f) : 5 - (f - g), a.avail_out = j > h ? 257 + (j - h) : 257 - (h - j), e.hold = p, e.bits = q
    }
  }, {}], 35:[function(a, b, c) {
    function d(a) {
      return(a >>> 24 & 255) + (a >>> 8 & 65280) + ((65280 & a) << 8) + ((255 & a) << 24)
    }
    function e() {
      this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new r.Buf16(320), 
      this.work = new r.Buf16(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0
    }
    function f(a) {
      var b;
      return a && a.state ? (b = a.state, a.total_in = a.total_out = b.total = 0, a.msg = "", b.wrap && (a.adler = 1 & b.wrap), b.mode = K, b.last = 0, b.havedict = 0, b.dmax = 32768, b.head = null, b.hold = 0, b.bits = 0, b.lencode = b.lendyn = new r.Buf32(ob), b.distcode = b.distdyn = new r.Buf32(pb), b.sane = 1, b.back = -1, C) : F
    }
    function g(a) {
      var b;
      return a && a.state ? (b = a.state, b.wsize = 0, b.whave = 0, b.wnext = 0, f(a)) : F
    }
    function h(a, b) {
      var c, d;
      return a && a.state ? (d = a.state, 0 > b ? (c = 0, b = -b) : (c = (b >> 4) + 1, 48 > b && (b &= 15)), b && (8 > b || b > 15) ? F : (null !== d.window && (d.wbits !== b && (d.window = null)), d.wrap = c, d.wbits = b, g(a))) : F
    }
    function i(a, b) {
      var c, d;
      return a ? (d = new e, a.state = d, d.window = null, c = h(a, b), c !== C && (a.state = null), c) : F
    }
    function j(a) {
      return i(a, rb)
    }
    function k(a) {
      if(sb) {
        var b;
        for(p = new r.Buf32(512), q = new r.Buf32(32), b = 0;144 > b;) {
          a.lens[b++] = 8
        }
        for(;256 > b;) {
          a.lens[b++] = 9
        }
        for(;280 > b;) {
          a.lens[b++] = 7
        }
        for(;288 > b;) {
          a.lens[b++] = 8
        }
        for(v(x, a.lens, 0, 288, p, 0, a.work, {bits:9}), b = 0;32 > b;) {
          a.lens[b++] = 5
        }
        v(y, a.lens, 0, 32, q, 0, a.work, {bits:5}), sb = !1
      }
      a.lencode = p, a.lenbits = 9, a.distcode = q, a.distbits = 5
    }
    function l(a, b, c, d) {
      var e, f = a.state;
      return null === f.window && (f.wsize = 1 << f.wbits, f.wnext = 0, f.whave = 0, f.window = new r.Buf8(f.wsize)), d >= f.wsize ? (r.arraySet(f.window, b, c - f.wsize, f.wsize, 0), f.wnext = 0, f.whave = f.wsize) : (e = f.wsize - f.wnext, e > d && (e = d), r.arraySet(f.window, b, c - d, e, f.wnext), d -= e, d ? (r.arraySet(f.window, b, c - d, d, 0), f.wnext = d, f.whave = f.wsize) : (f.wnext += e, f.wnext === f.wsize && (f.wnext = 0), f.whave < f.wsize && (f.whave += e))), 0
    }
    function m(a, b) {
      var c, e, f, g, h, i, j, m, n, o, p, q, ob, pb, qb, rb, sb, tb, ub, vb, wb, xb, yb, zb, Ab = 0, Bb = new r.Buf8(4), Cb = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
      if(!a || (!a.state || (!a.output || !a.input && 0 !== a.avail_in))) {
        return F
      }
      c = a.state, c.mode === V && (c.mode = W), h = a.next_out, f = a.output, j = a.avail_out, g = a.next_in, e = a.input, i = a.avail_in, m = c.hold, n = c.bits, o = i, p = j, xb = C;
      a:for(;;) {
        switch(c.mode) {
          case K:
            if(0 === c.wrap) {
              c.mode = W;
              break
            }
            for(;16 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if(2 & c.wrap && 35615 === m) {
              c.check = 0, Bb[0] = 255 & m, Bb[1] = m >>> 8 & 255, c.check = t(c.check, Bb, 2, 0), m = 0, n = 0, c.mode = L;
              break
            }
            if(c.flags = 0, c.head && (c.head.done = !1), !(1 & c.wrap) || (((255 & m) << 8) + (m >> 8)) % 31) {
              a.msg = "incorrect header check", c.mode = lb;
              break
            }
            if((15 & m) !== J) {
              a.msg = "unknown compression method", c.mode = lb;
              break
            }
            if(m >>>= 4, n -= 4, wb = (15 & m) + 8, 0 === c.wbits) {
              c.wbits = wb
            }else {
              if(wb > c.wbits) {
                a.msg = "invalid window size", c.mode = lb;
                break
              }
            }
            c.dmax = 1 << wb, a.adler = c.check = 1, c.mode = 512 & m ? T : V, m = 0, n = 0;
            break;
          case L:
            for(;16 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if(c.flags = m, (255 & c.flags) !== J) {
              a.msg = "unknown compression method", c.mode = lb;
              break
            }
            if(57344 & c.flags) {
              a.msg = "unknown header flags set", c.mode = lb;
              break
            }
            c.head && (c.head.text = m >> 8 & 1), 512 & c.flags && (Bb[0] = 255 & m, Bb[1] = m >>> 8 & 255, c.check = t(c.check, Bb, 2, 0)), m = 0, n = 0, c.mode = M;
          case M:
            for(;32 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            c.head && (c.head.time = m), 512 & c.flags && (Bb[0] = 255 & m, Bb[1] = m >>> 8 & 255, Bb[2] = m >>> 16 & 255, Bb[3] = m >>> 24 & 255, c.check = t(c.check, Bb, 4, 0)), m = 0, n = 0, c.mode = N;
          case N:
            for(;16 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            c.head && (c.head.xflags = 255 & m, c.head.os = m >> 8), 512 & c.flags && (Bb[0] = 255 & m, Bb[1] = m >>> 8 & 255, c.check = t(c.check, Bb, 2, 0)), m = 0, n = 0, c.mode = O;
          case O:
            if(1024 & c.flags) {
              for(;16 > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              c.length = m, c.head && (c.head.extra_len = m), 512 & c.flags && (Bb[0] = 255 & m, Bb[1] = m >>> 8 & 255, c.check = t(c.check, Bb, 2, 0)), m = 0, n = 0
            }else {
              c.head && (c.head.extra = null)
            }
            c.mode = P;
          case P:
            if(1024 & c.flags && (q = c.length, q > i && (q = i), q && (c.head && (wb = c.head.extra_len - c.length, c.head.extra || (c.head.extra = new Array(c.head.extra_len)), r.arraySet(c.head.extra, e, g, q, wb)), 512 & c.flags && (c.check = t(c.check, e, q, g)), i -= q, g += q, c.length -= q), c.length)) {
              break a
            }
            c.length = 0, c.mode = Q;
          case Q:
            if(2048 & c.flags) {
              if(0 === i) {
                break a
              }
              q = 0;
              do {
                wb = e[g + q++], c.head && (wb && (c.length < 65536 && (c.head.name += String.fromCharCode(wb))))
              }while(wb && i > q);
              if(512 & c.flags && (c.check = t(c.check, e, q, g)), i -= q, g += q, wb) {
                break a
              }
            }else {
              c.head && (c.head.name = null)
            }
            c.length = 0, c.mode = R;
          case R:
            if(4096 & c.flags) {
              if(0 === i) {
                break a
              }
              q = 0;
              do {
                wb = e[g + q++], c.head && (wb && (c.length < 65536 && (c.head.comment += String.fromCharCode(wb))))
              }while(wb && i > q);
              if(512 & c.flags && (c.check = t(c.check, e, q, g)), i -= q, g += q, wb) {
                break a
              }
            }else {
              c.head && (c.head.comment = null)
            }
            c.mode = S;
          case S:
            if(512 & c.flags) {
              for(;16 > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              if(m !== (65535 & c.check)) {
                a.msg = "header crc mismatch", c.mode = lb;
                break
              }
              m = 0, n = 0
            }
            c.head && (c.head.hcrc = c.flags >> 9 & 1, c.head.done = !0), a.adler = c.check = 0, c.mode = V;
            break;
          case T:
            for(;32 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            a.adler = c.check = d(m), m = 0, n = 0, c.mode = U;
          case U:
            if(0 === c.havedict) {
              return a.next_out = h, a.avail_out = j, a.next_in = g, a.avail_in = i, c.hold = m, c.bits = n, E
            }
            a.adler = c.check = 1, c.mode = V;
          case V:
            if(b === A || b === B) {
              break a
            }
          ;
          case W:
            if(c.last) {
              m >>>= 7 & n, n -= 7 & n, c.mode = ib;
              break
            }
            for(;3 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            switch(c.last = 1 & m, m >>>= 1, n -= 1, 3 & m) {
              case 0:
                c.mode = X;
                break;
              case 1:
                if(k(c), c.mode = bb, b === B) {
                  m >>>= 2, n -= 2;
                  break a
                }
                break;
              case 2:
                c.mode = $;
                break;
              case 3:
                a.msg = "invalid block type", c.mode = lb
            }
            m >>>= 2, n -= 2;
            break;
          case X:
            for(m >>>= 7 & n, n -= 7 & n;32 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if((65535 & m) !== (m >>> 16 ^ 65535)) {
              a.msg = "invalid stored block lengths", c.mode = lb;
              break
            }
            if(c.length = 65535 & m, m = 0, n = 0, c.mode = Y, b === B) {
              break a
            }
          ;
          case Y:
            c.mode = Z;
          case Z:
            if(q = c.length) {
              if(q > i && (q = i), q > j && (q = j), 0 === q) {
                break a
              }
              r.arraySet(f, e, g, q, h), i -= q, g += q, j -= q, h += q, c.length -= q;
              break
            }
            c.mode = V;
            break;
          case $:
            for(;14 > n;) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if(c.nlen = (31 & m) + 257, m >>>= 5, n -= 5, c.ndist = (31 & m) + 1, m >>>= 5, n -= 5, c.ncode = (15 & m) + 4, m >>>= 4, n -= 4, c.nlen > 286 || c.ndist > 30) {
              a.msg = "too many length or distance symbols", c.mode = lb;
              break
            }
            c.have = 0, c.mode = _;
          case _:
            for(;c.have < c.ncode;) {
              for(;3 > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              c.lens[Cb[c.have++]] = 7 & m, m >>>= 3, n -= 3
            }
            for(;c.have < 19;) {
              c.lens[Cb[c.have++]] = 0
            }
            if(c.lencode = c.lendyn, c.lenbits = 7, yb = {bits:c.lenbits}, xb = v(w, c.lens, 0, 19, c.lencode, 0, c.work, yb), c.lenbits = yb.bits, xb) {
              a.msg = "invalid code lengths set", c.mode = lb;
              break
            }
            c.have = 0, c.mode = ab;
          case ab:
            for(;c.have < c.nlen + c.ndist;) {
              for(;Ab = c.lencode[m & (1 << c.lenbits) - 1], qb = Ab >>> 24, rb = Ab >>> 16 & 255, sb = 65535 & Ab, !(n >= qb);) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              if(16 > sb) {
                m >>>= qb, n -= qb, c.lens[c.have++] = sb
              }else {
                if(16 === sb) {
                  for(zb = qb + 2;zb > n;) {
                    if(0 === i) {
                      break a
                    }
                    i--, m += e[g++] << n, n += 8
                  }
                  if(m >>>= qb, n -= qb, 0 === c.have) {
                    a.msg = "invalid bit length repeat", c.mode = lb;
                    break
                  }
                  wb = c.lens[c.have - 1], q = 3 + (3 & m), m >>>= 2, n -= 2
                }else {
                  if(17 === sb) {
                    for(zb = qb + 3;zb > n;) {
                      if(0 === i) {
                        break a
                      }
                      i--, m += e[g++] << n, n += 8
                    }
                    m >>>= qb, n -= qb, wb = 0, q = 3 + (7 & m), m >>>= 3, n -= 3
                  }else {
                    for(zb = qb + 7;zb > n;) {
                      if(0 === i) {
                        break a
                      }
                      i--, m += e[g++] << n, n += 8
                    }
                    m >>>= qb, n -= qb, wb = 0, q = 11 + (127 & m), m >>>= 7, n -= 7
                  }
                }
                if(c.have + q > c.nlen + c.ndist) {
                  a.msg = "invalid bit length repeat", c.mode = lb;
                  break
                }
                for(;q--;) {
                  c.lens[c.have++] = wb
                }
              }
            }
            if(c.mode === lb) {
              break
            }
            if(0 === c.lens[256]) {
              a.msg = "invalid code -- missing end-of-block", c.mode = lb;
              break
            }
            if(c.lenbits = 9, yb = {bits:c.lenbits}, xb = v(x, c.lens, 0, c.nlen, c.lencode, 0, c.work, yb), c.lenbits = yb.bits, xb) {
              a.msg = "invalid literal/lengths set", c.mode = lb;
              break
            }
            if(c.distbits = 6, c.distcode = c.distdyn, yb = {bits:c.distbits}, xb = v(y, c.lens, c.nlen, c.ndist, c.distcode, 0, c.work, yb), c.distbits = yb.bits, xb) {
              a.msg = "invalid distances set", c.mode = lb;
              break
            }
            if(c.mode = bb, b === B) {
              break a
            }
          ;
          case bb:
            c.mode = cb;
          case cb:
            if(i >= 6 && j >= 258) {
              a.next_out = h, a.avail_out = j, a.next_in = g, a.avail_in = i, c.hold = m, c.bits = n, u(a, p), h = a.next_out, f = a.output, j = a.avail_out, g = a.next_in, e = a.input, i = a.avail_in, m = c.hold, n = c.bits, c.mode === V && (c.back = -1);
              break
            }
            for(c.back = 0;Ab = c.lencode[m & (1 << c.lenbits) - 1], qb = Ab >>> 24, rb = Ab >>> 16 & 255, sb = 65535 & Ab, !(n >= qb);) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if(rb && 0 === (240 & rb)) {
              for(tb = qb, ub = rb, vb = sb;Ab = c.lencode[vb + ((m & (1 << tb + ub) - 1) >> tb)], qb = Ab >>> 24, rb = Ab >>> 16 & 255, sb = 65535 & Ab, !(n >= tb + qb);) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              m >>>= tb, n -= tb, c.back += tb
            }
            if(m >>>= qb, n -= qb, c.back += qb, c.length = sb, 0 === rb) {
              c.mode = hb;
              break
            }
            if(32 & rb) {
              c.back = -1, c.mode = V;
              break
            }
            if(64 & rb) {
              a.msg = "invalid literal/length code", c.mode = lb;
              break
            }
            c.extra = 15 & rb, c.mode = db;
          case db:
            if(c.extra) {
              for(zb = c.extra;zb > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              c.length += m & (1 << c.extra) - 1, m >>>= c.extra, n -= c.extra, c.back += c.extra
            }
            c.was = c.length, c.mode = eb;
          case eb:
            for(;Ab = c.distcode[m & (1 << c.distbits) - 1], qb = Ab >>> 24, rb = Ab >>> 16 & 255, sb = 65535 & Ab, !(n >= qb);) {
              if(0 === i) {
                break a
              }
              i--, m += e[g++] << n, n += 8
            }
            if(0 === (240 & rb)) {
              for(tb = qb, ub = rb, vb = sb;Ab = c.distcode[vb + ((m & (1 << tb + ub) - 1) >> tb)], qb = Ab >>> 24, rb = Ab >>> 16 & 255, sb = 65535 & Ab, !(n >= tb + qb);) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              m >>>= tb, n -= tb, c.back += tb
            }
            if(m >>>= qb, n -= qb, c.back += qb, 64 & rb) {
              a.msg = "invalid distance code", c.mode = lb;
              break
            }
            c.offset = sb, c.extra = 15 & rb, c.mode = fb;
          case fb:
            if(c.extra) {
              for(zb = c.extra;zb > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              c.offset += m & (1 << c.extra) - 1, m >>>= c.extra, n -= c.extra, c.back += c.extra
            }
            if(c.offset > c.dmax) {
              a.msg = "invalid distance too far back", c.mode = lb;
              break
            }
            c.mode = gb;
          case gb:
            if(0 === j) {
              break a
            }
            if(q = p - j, c.offset > q) {
              if(q = c.offset - q, q > c.whave && c.sane) {
                a.msg = "invalid distance too far back", c.mode = lb;
                break
              }
              q > c.wnext ? (q -= c.wnext, ob = c.wsize - q) : ob = c.wnext - q, q > c.length && (q = c.length), pb = c.window
            }else {
              pb = f, ob = h - c.offset, q = c.length
            }
            q > j && (q = j), j -= q, c.length -= q;
            do {
              f[h++] = pb[ob++]
            }while(--q);
            0 === c.length && (c.mode = cb);
            break;
          case hb:
            if(0 === j) {
              break a
            }
            f[h++] = c.length, j--, c.mode = cb;
            break;
          case ib:
            if(c.wrap) {
              for(;32 > n;) {
                if(0 === i) {
                  break a
                }
                i--, m |= e[g++] << n, n += 8
              }
              if(p -= j, a.total_out += p, c.total += p, p && (a.adler = c.check = c.flags ? t(c.check, f, p, h - p) : s(c.check, f, p, h - p)), p = j, (c.flags ? m : d(m)) !== c.check) {
                a.msg = "incorrect data check", c.mode = lb;
                break
              }
              m = 0, n = 0
            }
            c.mode = jb;
          case jb:
            if(c.wrap && c.flags) {
              for(;32 > n;) {
                if(0 === i) {
                  break a
                }
                i--, m += e[g++] << n, n += 8
              }
              if(m !== (4294967295 & c.total)) {
                a.msg = "incorrect length check", c.mode = lb;
                break
              }
              m = 0, n = 0
            }
            c.mode = kb;
          case kb:
            xb = D;
            break a;
          case lb:
            xb = G;
            break a;
          case mb:
            return H;
          case nb:
          ;
          default:
            return F
        }
      }
      return a.next_out = h, a.avail_out = j, a.next_in = g, a.avail_in = i, c.hold = m, c.bits = n, (c.wsize || p !== a.avail_out && (c.mode < lb && (c.mode < ib || b !== z))) && l(a, a.output, a.next_out, p - a.avail_out) ? (c.mode = mb, H) : (o -= a.avail_in, p -= a.avail_out, a.total_in += o, a.total_out += p, c.total += p, c.wrap && (p && (a.adler = c.check = c.flags ? t(c.check, f, p, a.next_out - p) : s(c.check, f, p, a.next_out - p))), a.data_type = c.bits + (c.last ? 64 : 0) + (c.mode === 
      V ? 128 : 0) + (c.mode === bb || c.mode === Y ? 256 : 0), (0 === o && 0 === p || b === z) && (xb === C && (xb = I)), xb)
    }
    function n(a) {
      if(!a || !a.state) {
        return F
      }
      var b = a.state;
      return b.window && (b.window = null), a.state = null, C
    }
    function o(a, b) {
      var c;
      return a && a.state ? (c = a.state, 0 === (2 & c.wrap) ? F : (c.head = b, b.done = !1, C)) : F
    }
    var p, q, r = a("../utils/common"), s = a("./adler32"), t = a("./crc32"), u = a("./inffast"), v = a("./inftrees"), w = 0, x = 1, y = 2, z = 4, A = 5, B = 6, C = 0, D = 1, E = 2, F = -2, G = -3, H = -4, I = -5, J = 8, K = 1, L = 2, M = 3, N = 4, O = 5, P = 6, Q = 7, R = 8, S = 9, T = 10, U = 11, V = 12, W = 13, X = 14, Y = 15, Z = 16, $ = 17, _ = 18, ab = 19, bb = 20, cb = 21, db = 22, eb = 23, fb = 24, gb = 25, hb = 26, ib = 27, jb = 28, kb = 29, lb = 30, mb = 31, nb = 32, ob = 852, pb = 592, 
    qb = 15, rb = qb, sb = !0;
    c.inflateReset = g, c.inflateReset2 = h, c.inflateResetKeep = f, c.inflateInit = j, c.inflateInit2 = i, c.inflate = m, c.inflateEnd = n, c.inflateGetHeader = o, c.inflateInfo = "pako inflate (from Nodeca project)"
  }, {"../utils/common":27, "./adler32":29, "./crc32":31, "./inffast":34, "./inftrees":36}], 36:[function(a, b) {
    var c = a("../utils/common"), d = 15, e = 852, f = 592, g = 0, h = 1, i = 2, j = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0], k = [16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78], l = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0], m = [16, 
    16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64];
    b.exports = function(a, b, n, o, p, q, r, s) {
      var t, u, v, w, x, y, z, A, B, C = s.bits, D = 0, E = 0, F = 0, G = 0, H = 0, I = 0, J = 0, K = 0, L = 0, M = 0, N = null, O = 0, P = new c.Buf16(d + 1), Q = new c.Buf16(d + 1), R = null, S = 0;
      for(D = 0;d >= D;D++) {
        P[D] = 0
      }
      for(E = 0;o > E;E++) {
        P[b[n + E]]++
      }
      for(H = C, G = d;G >= 1 && 0 === P[G];G--) {
      }
      if(H > G && (H = G), 0 === G) {
        return p[q++] = 20971520, p[q++] = 20971520, s.bits = 1, 0
      }
      for(F = 1;G > F && 0 === P[F];F++) {
      }
      for(F > H && (H = F), K = 1, D = 1;d >= D;D++) {
        if(K <<= 1, K -= P[D], 0 > K) {
          return-1
        }
      }
      if(K > 0 && (a === g || 1 !== G)) {
        return-1
      }
      for(Q[1] = 0, D = 1;d > D;D++) {
        Q[D + 1] = Q[D] + P[D]
      }
      for(E = 0;o > E;E++) {
        0 !== b[n + E] && (r[Q[b[n + E]]++] = E)
      }
      if(a === g ? (N = R = r, y = 19) : a === h ? (N = j, O -= 257, R = k, S -= 257, y = 256) : (N = l, R = m, y = -1), M = 0, E = 0, D = F, x = q, I = H, J = 0, v = -1, L = 1 << H, w = L - 1, a === h && L > e || a === i && L > f) {
        return 1
      }
      for(var T = 0;;) {
        T++, z = D - J, r[E] < y ? (A = 0, B = r[E]) : r[E] > y ? (A = R[S + r[E]], B = N[O + r[E]]) : (A = 96, B = 0), t = 1 << D - J, u = 1 << I, F = u;
        do {
          u -= t, p[x + (M >> J) + u] = z << 24 | A << 16 | B | 0
        }while(0 !== u);
        for(t = 1 << D - 1;M & t;) {
          t >>= 1
        }
        if(0 !== t ? (M &= t - 1, M += t) : M = 0, E++, 0 === --P[D]) {
          if(D === G) {
            break
          }
          D = b[n + r[E]]
        }
        if(D > H && (M & w) !== v) {
          for(0 === J && (J = H), x += F, I = D - J, K = 1 << I;G > I + J && (K -= P[I + J], !(0 >= K));) {
            I++, K <<= 1
          }
          if(L += 1 << I, a === h && L > e || a === i && L > f) {
            return 1
          }
          v = M & w, p[v] = H << 24 | I << 16 | x - q | 0
        }
      }
      return 0 !== M && (p[x + M] = D - J << 24 | 64 << 16 | 0), s.bits = H, 0
    }
  }, {"../utils/common":27}], 37:[function(a, b) {
    b.exports = {2:"need dictionary", 1:"stream end", 0:"", "-1":"file error", "-2":"stream error", "-3":"data error", "-4":"insufficient memory", "-5":"buffer error", "-6":"incompatible version"}
  }, {}], 38:[function(a, b, c) {
    function d(a) {
      for(var b = a.length;--b >= 0;) {
        a[b] = 0
      }
    }
    function e(a) {
      return 256 > a ? gb[a] : gb[256 + (a >>> 7)]
    }
    function f(a, b) {
      a.pending_buf[a.pending++] = 255 & b, a.pending_buf[a.pending++] = b >>> 8 & 255
    }
    function g(a, b, c) {
      a.bi_valid > V - c ? (a.bi_buf |= b << a.bi_valid & 65535, f(a, a.bi_buf), a.bi_buf = b >> V - a.bi_valid, a.bi_valid += c - V) : (a.bi_buf |= b << a.bi_valid & 65535, a.bi_valid += c)
    }
    function h(a, b, c) {
      g(a, c[2 * b], c[2 * b + 1])
    }
    function i(a, b) {
      var c = 0;
      do {
        c |= 1 & a, a >>>= 1, c <<= 1
      }while(--b > 0);
      return c >>> 1
    }
    function j(a) {
      16 === a.bi_valid ? (f(a, a.bi_buf), a.bi_buf = 0, a.bi_valid = 0) : a.bi_valid >= 8 && (a.pending_buf[a.pending++] = 255 & a.bi_buf, a.bi_buf >>= 8, a.bi_valid -= 8)
    }
    function k(a, b) {
      var c, d, e, f, g, h, i = b.dyn_tree, j = b.max_code, k = b.stat_desc.static_tree, l = b.stat_desc.has_stree, m = b.stat_desc.extra_bits, n = b.stat_desc.extra_base, o = b.stat_desc.max_length, p = 0;
      for(f = 0;U >= f;f++) {
        a.bl_count[f] = 0
      }
      for(i[2 * a.heap[a.heap_max] + 1] = 0, c = a.heap_max + 1;T > c;c++) {
        d = a.heap[c], f = i[2 * i[2 * d + 1] + 1] + 1, f > o && (f = o, p++), i[2 * d + 1] = f, d > j || (a.bl_count[f]++, g = 0, d >= n && (g = m[d - n]), h = i[2 * d], a.opt_len += h * (f + g), l && (a.static_len += h * (k[2 * d + 1] + g)))
      }
      if(0 !== p) {
        do {
          for(f = o - 1;0 === a.bl_count[f];) {
            f--
          }
          a.bl_count[f]--, a.bl_count[f + 1] += 2, a.bl_count[o]--, p -= 2
        }while(p > 0);
        for(f = o;0 !== f;f--) {
          for(d = a.bl_count[f];0 !== d;) {
            e = a.heap[--c], e > j || (i[2 * e + 1] !== f && (a.opt_len += (f - i[2 * e + 1]) * i[2 * e], i[2 * e + 1] = f), d--)
          }
        }
      }
    }
    function l(a, b, c) {
      var d, e, f = new Array(U + 1), g = 0;
      for(d = 1;U >= d;d++) {
        f[d] = g = g + c[d - 1] << 1
      }
      for(e = 0;b >= e;e++) {
        var h = a[2 * e + 1];
        0 !== h && (a[2 * e] = i(f[h]++, h))
      }
    }
    function m() {
      var a, b, c, d, e, f = new Array(U + 1);
      for(c = 0, d = 0;O - 1 > d;d++) {
        for(ib[d] = c, a = 0;a < 1 << _[d];a++) {
          hb[c++] = d
        }
      }
      for(hb[c - 1] = d, e = 0, d = 0;16 > d;d++) {
        for(jb[d] = e, a = 0;a < 1 << ab[d];a++) {
          gb[e++] = d
        }
      }
      for(e >>= 7;R > d;d++) {
        for(jb[d] = e << 7, a = 0;a < 1 << ab[d] - 7;a++) {
          gb[256 + e++] = d
        }
      }
      for(b = 0;U >= b;b++) {
        f[b] = 0
      }
      for(a = 0;143 >= a;) {
        eb[2 * a + 1] = 8, a++, f[8]++
      }
      for(;255 >= a;) {
        eb[2 * a + 1] = 9, a++, f[9]++
      }
      for(;279 >= a;) {
        eb[2 * a + 1] = 7, a++, f[7]++
      }
      for(;287 >= a;) {
        eb[2 * a + 1] = 8, a++, f[8]++
      }
      for(l(eb, Q + 1, f), a = 0;R > a;a++) {
        fb[2 * a + 1] = 5, fb[2 * a] = i(a, 5)
      }
      kb = new nb(eb, _, P + 1, Q, U), lb = new nb(fb, ab, 0, R, U), mb = new nb(new Array(0), bb, 0, S, W)
    }
    function n(a) {
      var b;
      for(b = 0;Q > b;b++) {
        a.dyn_ltree[2 * b] = 0
      }
      for(b = 0;R > b;b++) {
        a.dyn_dtree[2 * b] = 0
      }
      for(b = 0;S > b;b++) {
        a.bl_tree[2 * b] = 0
      }
      a.dyn_ltree[2 * X] = 1, a.opt_len = a.static_len = 0, a.last_lit = a.matches = 0
    }
    function o(a) {
      a.bi_valid > 8 ? f(a, a.bi_buf) : a.bi_valid > 0 && (a.pending_buf[a.pending++] = a.bi_buf), a.bi_buf = 0, a.bi_valid = 0
    }
    function p(a, b, c, d) {
      o(a), d && (f(a, c), f(a, ~c)), E.arraySet(a.pending_buf, a.window, b, c, a.pending), a.pending += c
    }
    function q(a, b, c, d) {
      var e = 2 * b, f = 2 * c;
      return a[e] < a[f] || a[e] === a[f] && d[b] <= d[c]
    }
    function r(a, b, c) {
      for(var d = a.heap[c], e = c << 1;e <= a.heap_len && (e < a.heap_len && (q(b, a.heap[e + 1], a.heap[e], a.depth) && e++), !q(b, d, a.heap[e], a.depth));) {
        a.heap[c] = a.heap[e], c = e, e <<= 1
      }
      a.heap[c] = d
    }
    function s(a, b, c) {
      var d, f, i, j, k = 0;
      if(0 !== a.last_lit) {
        do {
          d = a.pending_buf[a.d_buf + 2 * k] << 8 | a.pending_buf[a.d_buf + 2 * k + 1], f = a.pending_buf[a.l_buf + k], k++, 0 === d ? h(a, f, b) : (i = hb[f], h(a, i + P + 1, b), j = _[i], 0 !== j && (f -= ib[i], g(a, f, j)), d--, i = e(d), h(a, i, c), j = ab[i], 0 !== j && (d -= jb[i], g(a, d, j)))
        }while(k < a.last_lit)
      }
      h(a, X, b)
    }
    function t(a, b) {
      var c, d, e, f = b.dyn_tree, g = b.stat_desc.static_tree, h = b.stat_desc.has_stree, i = b.stat_desc.elems, j = -1;
      for(a.heap_len = 0, a.heap_max = T, c = 0;i > c;c++) {
        0 !== f[2 * c] ? (a.heap[++a.heap_len] = j = c, a.depth[c] = 0) : f[2 * c + 1] = 0
      }
      for(;a.heap_len < 2;) {
        e = a.heap[++a.heap_len] = 2 > j ? ++j : 0, f[2 * e] = 1, a.depth[e] = 0, a.opt_len--, h && (a.static_len -= g[2 * e + 1])
      }
      for(b.max_code = j, c = a.heap_len >> 1;c >= 1;c--) {
        r(a, f, c)
      }
      e = i;
      do {
        c = a.heap[1], a.heap[1] = a.heap[a.heap_len--], r(a, f, 1), d = a.heap[1], a.heap[--a.heap_max] = c, a.heap[--a.heap_max] = d, f[2 * e] = f[2 * c] + f[2 * d], a.depth[e] = (a.depth[c] >= a.depth[d] ? a.depth[c] : a.depth[d]) + 1, f[2 * c + 1] = f[2 * d + 1] = e, a.heap[1] = e++, r(a, f, 1)
      }while(a.heap_len >= 2);
      a.heap[--a.heap_max] = a.heap[1], k(a, b), l(f, j, a.bl_count)
    }
    function u(a, b, c) {
      var d, e, f = -1, g = b[1], h = 0, i = 7, j = 4;
      for(0 === g && (i = 138, j = 3), b[2 * (c + 1) + 1] = 65535, d = 0;c >= d;d++) {
        e = g, g = b[2 * (d + 1) + 1], ++h < i && e === g || (j > h ? a.bl_tree[2 * e] += h : 0 !== e ? (e !== f && a.bl_tree[2 * e]++, a.bl_tree[2 * Y]++) : 10 >= h ? a.bl_tree[2 * Z]++ : a.bl_tree[2 * $]++, h = 0, f = e, 0 === g ? (i = 138, j = 3) : e === g ? (i = 6, j = 3) : (i = 7, j = 4))
      }
    }
    function v(a, b, c) {
      var d, e, f = -1, i = b[1], j = 0, k = 7, l = 4;
      for(0 === i && (k = 138, l = 3), d = 0;c >= d;d++) {
        if(e = i, i = b[2 * (d + 1) + 1], !(++j < k && e === i)) {
          if(l > j) {
            do {
              h(a, e, a.bl_tree)
            }while(0 !== --j)
          }else {
            0 !== e ? (e !== f && (h(a, e, a.bl_tree), j--), h(a, Y, a.bl_tree), g(a, j - 3, 2)) : 10 >= j ? (h(a, Z, a.bl_tree), g(a, j - 3, 3)) : (h(a, $, a.bl_tree), g(a, j - 11, 7))
          }
          j = 0, f = e, 0 === i ? (k = 138, l = 3) : e === i ? (k = 6, l = 3) : (k = 7, l = 4)
        }
      }
    }
    function w(a) {
      var b;
      for(u(a, a.dyn_ltree, a.l_desc.max_code), u(a, a.dyn_dtree, a.d_desc.max_code), t(a, a.bl_desc), b = S - 1;b >= 3 && 0 === a.bl_tree[2 * cb[b] + 1];b--) {
      }
      return a.opt_len += 3 * (b + 1) + 5 + 5 + 4, b
    }
    function x(a, b, c, d) {
      var e;
      for(g(a, b - 257, 5), g(a, c - 1, 5), g(a, d - 4, 4), e = 0;d > e;e++) {
        g(a, a.bl_tree[2 * cb[e] + 1], 3)
      }
      v(a, a.dyn_ltree, b - 1), v(a, a.dyn_dtree, c - 1)
    }
    function y(a) {
      var b, c = 4093624447;
      for(b = 0;31 >= b;b++, c >>>= 1) {
        if(1 & c && 0 !== a.dyn_ltree[2 * b]) {
          return G
        }
      }
      if(0 !== a.dyn_ltree[18] || (0 !== a.dyn_ltree[20] || 0 !== a.dyn_ltree[26])) {
        return H
      }
      for(b = 32;P > b;b++) {
        if(0 !== a.dyn_ltree[2 * b]) {
          return H
        }
      }
      return G
    }
    function z(a) {
      pb || (m(), pb = !0), a.l_desc = new ob(a.dyn_ltree, kb), a.d_desc = new ob(a.dyn_dtree, lb), a.bl_desc = new ob(a.bl_tree, mb), a.bi_buf = 0, a.bi_valid = 0, n(a)
    }
    function A(a, b, c, d) {
      g(a, (J << 1) + (d ? 1 : 0), 3), p(a, b, c, !0)
    }
    function B(a) {
      g(a, K << 1, 3), h(a, X, eb), j(a)
    }
    function C(a, b, c, d) {
      var e, f, h = 0;
      a.level > 0 ? (a.strm.data_type === I && (a.strm.data_type = y(a)), t(a, a.l_desc), t(a, a.d_desc), h = w(a), e = a.opt_len + 3 + 7 >>> 3, f = a.static_len + 3 + 7 >>> 3, e >= f && (e = f)) : e = f = c + 5, e >= c + 4 && -1 !== b ? A(a, b, c, d) : a.strategy === F || f === e ? (g(a, (K << 1) + (d ? 1 : 0), 3), s(a, eb, fb)) : (g(a, (L << 1) + (d ? 1 : 0), 3), x(a, a.l_desc.max_code + 1, a.d_desc.max_code + 1, h + 1), s(a, a.dyn_ltree, a.dyn_dtree)), n(a), d && o(a)
    }
    function D(a, b, c) {
      return a.pending_buf[a.d_buf + 2 * a.last_lit] = b >>> 8 & 255, a.pending_buf[a.d_buf + 2 * a.last_lit + 1] = 255 & b, a.pending_buf[a.l_buf + a.last_lit] = 255 & c, a.last_lit++, 0 === b ? a.dyn_ltree[2 * c]++ : (a.matches++, b--, a.dyn_ltree[2 * (hb[c] + P + 1)]++, a.dyn_dtree[2 * e(b)]++), a.last_lit === a.lit_bufsize - 1
    }
    var E = a("../utils/common"), F = 4, G = 0, H = 1, I = 2, J = 0, K = 1, L = 2, M = 3, N = 258, O = 29, P = 256, Q = P + 1 + O, R = 30, S = 19, T = 2 * Q + 1, U = 15, V = 16, W = 7, X = 256, Y = 16, Z = 17, $ = 18, _ = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0], ab = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13], bb = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7], cb = [16, 17, 18, 0, 
    8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15], db = 512, eb = new Array(2 * (Q + 2));
    d(eb);
    var fb = new Array(2 * R);
    d(fb);
    var gb = new Array(db);
    d(gb);
    var hb = new Array(N - M + 1);
    d(hb);
    var ib = new Array(O);
    d(ib);
    var jb = new Array(R);
    d(jb);
    var kb, lb, mb, nb = function(a, b, c, d, e) {
      this.static_tree = a, this.extra_bits = b, this.extra_base = c, this.elems = d, this.max_length = e, this.has_stree = a && a.length
    }, ob = function(a, b) {
      this.dyn_tree = a, this.max_code = 0, this.stat_desc = b
    }, pb = !1;
    c._tr_init = z, c._tr_stored_block = A, c._tr_flush_block = C, c._tr_tally = D, c._tr_align = B
  }, {"../utils/common":27}], 39:[function(a, b) {
    function c() {
      this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0
    }
    b.exports = c
  }, {}]}, {}, [9])(9)
});
var LOEP = LOEP || {};
LOEP.IframeAPI = function(L, undefined) {
  var instance = function(settings) {
    var _settings;
    this.init = function(settings) {
      _settings = settings || {};
      _settings.action = _settings.action || "evaluate";
      if(["evaluate", "showchart"].indexOf(_settings.action) === -1) {
        return _onError("No valid action.")
      }
      if(typeof _settings.domain != "string") {
        return _onError("No valid domain.")
      }
      if(typeof _settings.loId == "undefined") {
        return _onError("Missing loId setting")
      }
      if(typeof _settings.evmethod == "undefined") {
        return _onError("Missing evmethod setting")
      }
      var isLocalFile;
      try {
        isLocalFile = window.location.href.indexOf("file://") === 0
      }catch(e) {
        isLocalFile = false
      }
      if(isLocalFile === false) {
        _settings.domain = _settings.domain.replace("http://", "").replace("https://", "").replace("//", "");
        _settings.domain = "//" + _settings.domain
      }else {
        if(_settings.domain.indexOf("//") === 0) {
          _settings.domain = _settings.domain.replace("//", "");
          _settings.domain = "http://" + _settings.domain
        }
      }
      window.addEventListener("message", _onLOEPMessage, false);
      if(typeof _settings.token == "string") {
        _initWithToken(_settings.token)
      }else {
        _requestLOEPToken(function(token) {
          _initWithToken(token)
        })
      }
    };
    var _initWithToken = function(token) {
      if(typeof token != "string") {
        return _onError("No LOEP session token available")
      }
      var url = _buildIframeURL(token);
      if(typeof url != "string") {
        return _onError("URL could not be built. Incorrect or missing params.")
      }
      var container = $(_settings.containerDOM)[0];
      if(typeof container == "undefined") {
        return _onError("Container not found.")
      }
      _insertIframe(container, url)
    };
    var _requestLOEPToken = function(callback) {
      var urlToRequestToken;
      if(typeof _settings.tokenURL == "string") {
        urlToRequestToken = _settings.tokenURL
      }else {
        urlToRequestToken = "/loep/session_token.json"
      }
      var params = {};
      params["action"] = _settings.action;
      if(typeof _settings.repository != "undefined") {
        params["repository"] = _settings.repository
      }
      params["lo_id_repository"] = _settings.loId;
      params["evmethod_name"] = _settings.evmethod;
      $.ajax({type:"POST", url:urlToRequestToken, data:{"session_token":params}, dataType:"json", success:function(response) {
        if(typeof response == "string") {
          callback(response)
        }else {
          if(typeof response == "object" && typeof response["auth_token"] == "string") {
            callback(response["auth_token"])
          }else {
            callback()
          }
        }
      }, error:function(xhr, ajaxOptions, thrownError) {
        callback()
      }})
    };
    var _buildIframeURL = function(token) {
      var url;
      try {
        url = _settings.domain;
        switch(_settings.action) {
          case "evaluate":
            var pluralizedEvMethod;
            if(/s$/.test(_settings.evmethod)) {
              pluralizedEvMethod = _settings.evmethod + "es"
            }else {
              pluralizedEvMethod = _settings.evmethod + "s"
            }
            url += "/evaluations/" + pluralizedEvMethod + "/embed?lo_id=" + _settings.loId;
            break;
          case "showchart":
            url += "/los/" + _settings.loId + "/representation?evmethods=" + _settings.evmethod;
            break;
          default:
            return
        }
        url += "&app_name=" + _settings.app;
        if(typeof _settings.repository == "string") {
          url += "&repository=" + _settings.repository
        }
        if(typeof _settings.user_id == "string") {
          url += "&id_user_app=" + _settings.user_id
        }
        url += "&session_token=" + token;
        if(_settings.ajax !== false) {
          url += "&ajax=true"
        }
        if(typeof _settings.language == "string") {
          url += "&locale=" + _settings.language
        }
      }catch(e) {
      }
      return url
    };
    var _insertIframe = function(container, url) {
      var iframe = $("<iframe/>", {style:"width:100%; height:100%; border:0;", iframeborder:"0", frameborder:"0", src:url, load:function(data) {
        _print("Iframe loaded.");
        if(typeof _settings.loadCallback == "function") {
          _settings.loadCallback()
        }
      }, error:function() {
      }});
      if(_settings.action == "showchart") {
        $(iframe).attr("overflow", "hidden");
        $(iframe).attr("scrolling", "no")
      }
      $(container).append(iframe)
    };
    var _onLOEPMessage = function(msg) {
      if(msg && (msg.data && msg.data.type == "LOEPMessage")) {
        _print("Message received.");
        var LOEPdata = msg.data;
        if(LOEPdata.success === true) {
          _print("Form submited successfuly.");
          if(typeof _settings.submitCallback == "function") {
            _settings.submitCallback(LOEPdata)
          }
        }else {
          if(LOEPdata.error === true) {
            var errorCode = LOEPdata.error_code;
            _onError(errorCode)
          }
        }
      }
    };
    var _onError = function(msg) {
      if(typeof msg != "string") {
        msg = ""
      }
      errorMsg = "[Error] " + msg;
      if(typeof _settings.errorCallback == "function") {
        _settings.errorCallback(errorMsg)
      }
      return _print(errorMsg)
    };
    var _print = function(msg) {
      if(_settings.debug === true && (console && console.log)) {
        msg = "LOEP: " + msg.toString();
        console.log(msg)
      }
      return msg
    };
    this.init(settings)
  };
  return{instance:instance}
}(LOEP);
window.Modernizr = function(a, b, c) {
  function x(a) {
    j.cssText = a
  }
  function y(a, b) {
    return x(m.join(a + ";") + (b || ""))
  }
  function z(a, b) {
    return typeof a === b
  }
  function A(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function B(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : z(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.2", e = {}, f = !0, g = b.documentElement, h = "modernizr", i = b.createElement(h), j = i.style, k, l = {}.toString, m = " -webkit- -moz- -o- -ms- ".split(" "), n = {}, o = {}, p = {}, q = [], r = q.slice, s, t = function(a, c, d, e) {
    var f, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : h + (d + 1), k.appendChild(j)
      }
    }
    return f = ["&#173;", "<style>", a, "</style>"].join(""), k.id = h, m.innerHTML += f, m.appendChild(k), l || g.appendChild(m), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, u = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return t("@media " + b + " { #" + h + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, v = {}.hasOwnProperty, w;
  !z(v, "undefined") && !z(v.call, "undefined") ? w = function(a, b) {
    return v.call(a, b)
  } : w = function(a, b) {
    return b in a && z(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = r.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(r.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(r.call(arguments)))
    };
    return e
  });
  var C = function(c, d) {
    var f = c.join(""), g = d.length;
    t(f, function(c, d) {
      var f = b.styleSheets[b.styleSheets.length - 1], h = f ? f.cssRules && f.cssRules[0] ? f.cssRules[0].cssText : f.cssText || "" : "", i = c.childNodes, j = {};
      while(g--) {
        j[i[g].id] = i[g]
      }
      e.touch = "ontouchstart" in a || (a.DocumentTouch && b instanceof DocumentTouch || (j.touch && j.touch.offsetTop) === 9)
    }, g, d)
  }([, ["@media (", m.join("touch-enabled),("), h, ")", "{#touch{top:9px;position:absolute}}"].join("")], [, "touch"]);
  n.touch = function() {
    return e.touch
  };
  for(var D in n) {
    w(n, D) && (s = D.toLowerCase(), e[s] = n[D](), q.push((e[s] ? "" : "no-") + s))
  }
  return e.addTest = function(a, b) {
    if(typeof a == "object") {
      for(var d in a) {
        w(a, d) && e.addTest(d, a[d])
      }
    }else {
      a = a.toLowerCase();
      if(e[a] !== c) {
        return e
      }
      b = typeof b == "function" ? b() : b, g.className += " " + (b ? "" : "no-") + a, e[a] = b
    }
    return e
  }, x(""), i = k = null, e._version = d, e._prefixes = m, e.mq = u, e.testStyles = t, g.className = g.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (f ? " js " + q.join(" ") : ""), e
}(this, this.document), function(a, b, c) {
  function d(a) {
    return o.call(a) == "[object Function]"
  }
  function e(a) {
    return typeof a == "string"
  }
  function f() {
  }
  function g(a) {
    return!a || (a == "loaded" || (a == "complete" || a == "uninitialized"))
  }
  function h() {
    var a = p.shift();
    q = 1, a ? a.t ? m(function() {
      (a.t == "c" ? B.injectCss : B.injectJs)(a.s, 0, a.a, a.x, a.e, 1)
    }, 0) : (a(), h()) : q = 0
  }
  function i(a, c, d, e, f, i, j) {
    function k(b) {
      if(!o && (g(l.readyState) && (u.r = o = 1, !q && h(), l.onload = l.onreadystatechange = null, b))) {
        a != "img" && m(function() {
          t.removeChild(l)
        }, 50);
        for(var d in y[c]) {
          y[c].hasOwnProperty(d) && y[c][d].onload()
        }
      }
    }
    var j = j || B.errorTimeout, l = {}, o = 0, r = 0, u = {t:d, s:c, e:f, a:i, x:j};
    y[c] === 1 && (r = 1, y[c] = [], l = b.createElement(a)), a == "object" ? l.data = c : (l.src = c, l.type = a), l.width = l.height = "0", l.onerror = l.onload = l.onreadystatechange = function() {
      k.call(this, r)
    }, p.splice(e, 0, u), a != "img" && (r || y[c] === 2 ? (t.insertBefore(l, s ? null : n), m(k, j)) : y[c].push(l))
  }
  function j(a, b, c, d, f) {
    return q = 0, b = b || "j", e(a) ? i(b == "c" ? v : u, a, b, this.i++, c, d, f) : (p.splice(this.i++, 0, a), p.length == 1 && h()), this
  }
  function k() {
    var a = B;
    return a.loader = {load:j, i:0}, a
  }
  var l = b.documentElement, m = a.setTimeout, n = b.getElementsByTagName("script")[0], o = {}.toString, p = [], q = 0, r = "MozAppearance" in l.style, s = r && !!b.createRange().compareNode, t = s ? l : n.parentNode, l = !!b.attachEvent, u = r ? "object" : l ? "script" : "img", v = l ? "script" : u, w = Array.isArray || function(a) {
    return o.call(a) == "[object Array]"
  }, x = [], y = {}, z = {timeout:function(a, b) {
    return b.length && (a.timeout = b[0]), a
  }}, A, B;
  B = function(a) {
    function b(a) {
      var a = a.split("!"), b = x.length, c = a.pop(), d = a.length, c = {url:c, origUrl:c, prefixes:a}, e, f, g;
      for(f = 0;f < d;f++) {
        g = a[f].split("="), (e = z[g.shift()]) && (c = e(c, g))
      }
      for(f = 0;f < b;f++) {
        c = x[f](c)
      }
      return c
    }
    function g(a, e, f, g, i) {
      var j = b(a), l = j.autoCallback;
      j.url.split(".").pop().split("?").shift(), j.bypass || (e && (e = d(e) ? e : e[a] || (e[g] || (e[a.split("/").pop().split("?")[0]] || h))), j.instead ? j.instead(a, e, f, g, i) : (y[j.url] ? j.noexec = !0 : y[j.url] = 1, f.load(j.url, j.forceCSS || !j.forceJS && "css" == j.url.split(".").pop().split("?").shift() ? "c" : c, j.noexec, j.attrs, j.timeout), (d(e) || d(l)) && f.load(function() {
        k(), e && e(j.origUrl, i, g), l && l(j.origUrl, i, g), y[j.url] = 2
      })))
    }
    function i(a, b) {
      function c(a, c) {
        if(a) {
          if(e(a)) {
            c || (j = function() {
              var a = [].slice.call(arguments);
              k.apply(this, a), l()
            }), g(a, j, b, 0, h)
          }else {
            if(Object(a) === a) {
              for(n in m = function() {
                var b = 0, c;
                for(c in a) {
                  a.hasOwnProperty(c) && b++
                }
                return b
              }(), a) {
                a.hasOwnProperty(n) && (!c && (!--m && (d(j) ? j = function() {
                  var a = [].slice.call(arguments);
                  k.apply(this, a), l()
                } : j[n] = function(a) {
                  return function() {
                    var b = [].slice.call(arguments);
                    a && a.apply(this, b), l()
                  }
                }(k[n]))), g(a[n], j, b, n, h))
              }
            }
          }
        }else {
          !c && l()
        }
      }
      var h = !!a.test, i = a.load || a.both, j = a.callback || f, k = j, l = a.complete || f, m, n;
      c(h ? a.yep : a.nope, !!i), i && c(i)
    }
    var j, l, m = this.yepnope.loader;
    if(e(a)) {
      g(a, 0, m, 0)
    }else {
      if(w(a)) {
        for(j = 0;j < a.length;j++) {
          l = a[j], e(l) ? g(l, 0, m, 0) : w(l) ? B(l) : Object(l) === l && i(l, m)
        }
      }else {
        Object(a) === a && i(a, m)
      }
    }
  }, B.addPrefix = function(a, b) {
    z[a] = b
  }, B.addFilter = function(a) {
    x.push(a)
  }, B.errorTimeout = 1E4, b.readyState == null && (b.addEventListener && (b.readyState = "loading", b.addEventListener("DOMContentLoaded", A = function() {
    b.removeEventListener("DOMContentLoaded", A, 0), b.readyState = "complete"
  }, 0))), a.yepnope = k(), a.yepnope.executeStack = h, a.yepnope.injectJs = function(a, c, d, e, i, j) {
    var k = b.createElement("script"), l, o, e = e || B.errorTimeout;
    k.src = a;
    for(o in d) {
      k.setAttribute(o, d[o])
    }
    c = j ? h : c || f, k.onreadystatechange = k.onload = function() {
      !l && (g(k.readyState) && (l = 1, c(), k.onload = k.onreadystatechange = null))
    }, m(function() {
      l || (l = 1, c(1))
    }, e), i ? k.onload() : n.parentNode.insertBefore(k, n)
  }, a.yepnope.injectCss = function(a, c, d, e, g, i) {
    var e = b.createElement("link"), j, c = i ? h : c || f;
    e.href = a, e.rel = "stylesheet", e.type = "text/css";
    for(j in d) {
      e.setAttribute(j, d[j])
    }
    g || (n.parentNode.insertBefore(e, n), m(c, 0))
  }
}(this, document), Modernizr.load = function() {
  yepnope.apply(window, [].slice.call(arguments, 0))
}, Modernizr.addTest("ie8compat", function() {
  return!window.addEventListener && (document.documentMode && document.documentMode === 7)
});
window.Modernizr = function(a, b, c) {
  function v(a) {
    i.cssText = a
  }
  function w(a, b) {
    return v(prefixes.join(a + ";") + (b || ""))
  }
  function x(a, b) {
    return typeof a === b
  }
  function y(a, b) {
    return!!~("" + a).indexOf(b)
  }
  function z(a, b, d) {
    for(var e in a) {
      var f = b[a[e]];
      if(f !== c) {
        return d === !1 ? a[e] : x(f, "function") ? f.bind(d || b) : f
      }
    }
    return!1
  }
  var d = "2.5.3", e = {}, f = b.documentElement, g = "modernizr", h = b.createElement(g), i = h.style, j, k = {}.toString, l = {}, m = {}, n = {}, o = [], p = o.slice, q, r = function(a, c, d, e) {
    var h, i, j, k = b.createElement("div"), l = b.body, m = l ? l : b.createElement("body");
    if(parseInt(d, 10)) {
      while(d--) {
        j = b.createElement("div"), j.id = e ? e[d] : g + (d + 1), k.appendChild(j)
      }
    }
    return h = ["&#173;", "<style>", a, "</style>"].join(""), k.id = g, (l ? k : m).innerHTML += h, m.appendChild(k), l || (m.style.background = "", f.appendChild(m)), i = c(k, a), l ? k.parentNode.removeChild(k) : m.parentNode.removeChild(m), !!i
  }, s = function(b) {
    var c = a.matchMedia || a.msMatchMedia;
    if(c) {
      return c(b).matches
    }
    var d;
    return r("@media " + b + " { #" + g + " { position: absolute; } }", function(b) {
      d = (a.getComputedStyle ? getComputedStyle(b, null) : b.currentStyle)["position"] == "absolute"
    }), d
  }, t = {}.hasOwnProperty, u;
  !x(t, "undefined") && !x(t.call, "undefined") ? u = function(a, b) {
    return t.call(a, b)
  } : u = function(a, b) {
    return b in a && x(a.constructor.prototype[b], "undefined")
  }, Function.prototype.bind || (Function.prototype.bind = function(b) {
    var c = this;
    if(typeof c != "function") {
      throw new TypeError;
    }
    var d = p.call(arguments, 1), e = function() {
      if(this instanceof e) {
        var a = function() {
        };
        a.prototype = c.prototype;
        var f = new a, g = c.apply(f, d.concat(p.call(arguments)));
        return Object(g) === g ? g : f
      }
      return c.apply(b, d.concat(p.call(arguments)))
    };
    return e
  });
  for(var A in l) {
    u(l, A) && (q = A.toLowerCase(), e[q] = l[A](), o.push((e[q] ? "" : "no-") + q))
  }
  return v(""), h = j = null, e._version = d, e.mq = s, e.testStyles = r, e
}(this, this.document);
(function($) {
  $.widget("ui.tagit", {options:{tagSource:[], triggerKeys:["enter", "comma", "tab"], initialTags:[], minLength:1, select:false, allowNewTags:true, caseSensitive:false, sortable:false, highlightOnExistColor:"#0F0", emptySearch:true, watermarkAllowMessage:"Add tags", watermarkDenyMessage:"Tags limit reached", tagsChanged:function(tagValue, action, element) {
  }}, _splitAt:/\ |,/g, _existingAtIndex:0, _pasteMetaKeyPressed:false, _keys:{backspace:[8], enter:[13], space:[32], comma:[44, 188], tab:[9]}, _sortable:{sorting:-1}, _create:function() {
    var self = this;
    this.tagsArray = [];
    this.timer = null;
    this.element.addClass("tagit");
    this.element.children("li").each(function() {
      var tag = $(this);
      var tagValue = tag.attr("tagValue");
      self.options.initialTags.push({label:tag.text(), value:tagValue ? tagValue : tag.text()})
    });
    self._splitAt = null;
    if($.inArray("space", self.options.triggerKeys) > 0 && $.inArray("comma", self.options.triggerKeys) > 0) {
      self._splitAt = /\ |,/g
    }else {
      if($.inArray("space", self.options.triggerKeys) > 0) {
        self._splitAt = /\ /g
      }else {
        if($.inArray("comma", self.options.triggerKeys) > 0) {
          self._splitAt = /,/g
        }
      }
    }
    this.element.html('<li class="tagit-new"><input class="tagit-input" type="text" /></li>');
    this.input = this.element.find(".tagit-input");
    if(typeof $().vewatermark == "function") {
      this.input.vewatermark(this.options.watermarkAllowMessage)
    }
    $(this.element).click(function(e) {
      if($(e.target).hasClass("tagit-close")) {
        var parent = $(e.target).parent();
        var tag = self.tagsArray[parent.index()];
        tag.element.remove();
        self._popTag(tag)
      }else {
        self.input.focus();
        if(self.options.emptySearch && ($(e.target).hasClass("tagit-input") && (self.input.val() == "" && self.input.autocomplete != undefined))) {
          self.input.autocomplete("search")
        }
      }
    });
    var os = this.options.select;
    this.options.appendTo = this.element;
    this.options.source = this.options.tagSource;
    this.options.select = function(event, ui) {
      self.input.data("autoCompleteTag", true);
      clearTimeout(self.timer);
      if(ui.item.label === undefined) {
        self._addTag(ui.item.value)
      }else {
        self._addTag(ui.item.label, ui.item.value)
      }
      event.stopPropagation();
      return false
    };
    this.options.focus = function(event, ui) {
      if(ui.item.label !== undefined && /^key/.test(event.originalEvent.originalEvent.type)) {
        self.input.val(ui.item.label);
        self.input.attr("tagValue", ui.item.value);
        return false
      }
    };
    this.options.autoFocus = !this.options.allowNewTags;
    this.input.autocomplete(this.options);
    this.options.select = os;
    this.input.keydown(function(e) {
      var lastLi = self.element.children(".tagit-choice:last");
      if(e.which == self._keys.backspace) {
        return self._backspace(lastLi)
      }
      if(self._isInitKey(e.which) && !(self._isTabKey(e.which) && (this.value == "" && !self.input.data("autoCompleteTag")))) {
        e.preventDefault();
        self.input.data("autoCompleteTag", false);
        if(self.options.allowNewTags && $(this).val().length >= self.options.minLength) {
          self._addTag($(this).val())
        }
      }
      if(self.options.maxLength !== undefined && self.input.val().length == self.options.maxLength) {
        e.preventDefault()
      }
      if(lastLi.hasClass("selected")) {
        lastLi.removeClass("selected")
      }
      _pasteMetaKeyPressed = e.metaKey;
      self.lastKey = e.which
    });
    this.input.keyup(function(e) {
      if(_pasteMetaKeyPressed && (e.which == 91 || e.which == 86)) {
        $(this).blur()
      }
      window.setTimeout(function() {
        _pasteMetaKeyPressed = e.metaKey
      }, 250)
    });
    this.input.blur(function(e) {
      self.currentLabel = $(this).val();
      self.currentValue = $(this).attr("tagValue");
      if(self.options.allowNewTags && self.currentLabel) {
        self.timer = setTimeout(function() {
          self._addTag(self.currentLabel, self.currentValue);
          self.currentValue = "";
          self.currentLabel = ""
        }, 400)
      }
      $(this).val("").removeAttr("tagValue");
      return true
    });
    if(!String.prototype.trim) {
      String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g, "")
      }
    }
    if(this.options.select) {
      this.select = $('<select class="tagit-hiddenSelect" name="' + this.element.attr("name") + '" multiple="multiple"></select>');
      this.element.after(this.select)
    }
    this._initialTags();
    if(self.options.sortable !== false) {
      var soptions = {items:".tagit-choice", containment:"parent", opacity:0.6, tolerance:"pointer", start:function(event, ui) {
        self._sortable.tag = $(ui.item);
        self._sortable.origIndex = self._sortable.tag.index()
      }, update:function(event, ui) {
        self._sortable.newIndex = self._sortable.tag.index();
        self._moveTag(self._sortable.origIndex, self._sortable.newIndex);
        if(self.options.tagsChanged) {
          var tag = self.tagsArray[self._sortable.newIndex];
          self.options.tagsChanged(tag.value, "moved", tag.element)
        }
      }};
      if(self.options.sortable == "handle") {
        soptions.handle = "a.ui-icon";
        soptions.cursor = "move"
      }
      self.element.sortable(soptions)
    }
  }, _popSelect:function(tag) {
    $("option:eq(" + tag.index + ")", this.select).remove();
    this.select.change()
  }, _addSelect:function(tag) {
    this.select.append('<option selected="selected" value="' + tag.value + '">' + tag.label + "</option>");
    this.select.change()
  }, _popTag:function(tag) {
    if(tag === undefined) {
      tag = this.tagsArray.pop()
    }else {
      this.tagsArray.splice(tag.index, 1)
    }
    if(typeof $().vewatermark == "function") {
      this.input.vewatermark(this.options.watermarkAllowMessage)
    }
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      this._popSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.value || tag.label, "popped", null)
    }
    return
  }, _addTag:function(label, value) {
    if(this.tagsArray.length > this.options.maxTags - 1) {
      $(this.input).blur();
      return false
    }
    this.input.autocomplete("close").val("");
    if(this._splitAt && label.search(this._splitAt) > 0) {
      var result = label.split(this._splitAt);
      for(var i = 0;i < result.length;i++) {
        this._addTag(result[i], value)
      }
      return
    }
    label = label.replace(/,+$/, "").trim();
    if(label == "") {
      return false
    }
    var tagExists = this._exists(label, value);
    if(tagExists !== false) {
      this._highlightExisting(tagExists);
      return false
    }
    if(this.tagsArray.length == this.options.maxTags - 1) {
      if(typeof $().vewatermark == "function") {
        this.input.vewatermark(this.options.watermarkDenyMessage)
      }
      $(this.input).blur()
    }
    var tag = this.tag(label, value);
    tag.element = $('<li class="tagit-choice"' + (value !== undefined ? ' tagValue="' + value + '"' : "") + ">" + (this.options.sortable == "handle" ? '<a class="ui-icon ui-icon-grip-dotted-vertical" style="float:left"></a>' : "") + label + '<a class="tagit-close">x</a></li>');
    tag.element.insertBefore(this.input.parent());
    this.tagsArray.push(tag);
    this.input.val("");
    if(this.options.select) {
      this._addSelect(tag)
    }
    if(this.options.tagsChanged) {
      this.options.tagsChanged(tag.label, "added", tag.element)
    }
    return true
  }, _removeTagWithValue:function(label, value) {
    var index = this._exists(label, value);
    if(index != false) {
      var tag = this.tagsArray[index];
      tag.element.remove();
      this._popTag(tag)
    }
  }, _exists:function(label, value) {
    if(this.tagsArray.length == 0) {
      return false
    }
    label = this._lowerIfCaseInsensitive(label);
    value = this._lowerIfCaseInsensitive(value);
    for(var ind in this.tagsArray) {
      if(this._lowerIfCaseInsensitive(this.tagsArray[ind].label) == label) {
        if(value !== undefined) {
          if(this._lowerIfCaseInsensitive(this.tagsArray[ind].value) == value) {
            return ind
          }
        }else {
          return ind
        }
      }
    }
    return false
  }, _highlightExisting:function(index) {
    if(this.options.highlightOnExistColor === undefined) {
      return
    }
    var tag = this.tagsArray[index];
    tag.element.stop();
    var initialColor = tag.element.css("color");
    tag.element.animate({color:this.options.highlightOnExistColor}, 100).animate({"color":initialColor}, 800)
  }, _isInitKey:function(keyCode) {
    var keyName = "";
    for(var key in this._keys) {
      if($.inArray(keyCode, this._keys[key]) != -1) {
        keyName = key
      }
    }
    if($.inArray(keyName, this.options.triggerKeys) != -1) {
      return true
    }
    return false
  }, _isTabKey:function(keyCode) {
    var tabKeys = this._keys["tab"];
    return $.inArray(keyCode, tabKeys) > -1
  }, _removeTag:function() {
    this._popTag();
    this.element.children(".tagit-choice:last").remove()
  }, _backspace:function(li) {
    if(this.input.val() == "") {
      if(this.lastKey == this._keys.backspace) {
        this._popTag();
        li.remove();
        this.lastKey = null
      }else {
        li.addClass("selected");
        this.lastKey = this._keys.backspace
      }
    }
    return true
  }, _initialTags:function() {
    var input = this;
    var _temp;
    if(this.options.tagsChanged) {
      _temp = this.options.tagsChanged
    }
    this.options.tagsChanged = null;
    if(this.options.initialTags.length != 0) {
      $(this.options.initialTags).each(function(i, element) {
        if(typeof element == "object") {
          input._addTag(element.label, element.value)
        }else {
          input._addTag(element)
        }
      })
    }
    this.options.tagsChanged = _temp
  }, _lowerIfCaseInsensitive:function(inp) {
    if(inp === undefined || typeof inp != typeof"a") {
      return inp
    }
    if(this.options.caseSensitive) {
      return inp
    }
    return inp.toLowerCase()
  }, _moveTag:function(old_index, new_index) {
    this.tagsArray.splice(new_index, 0, this.tagsArray.splice(old_index, 1)[0]);
    for(var ind in this.tagsArray) {
      this.tagsArray[ind].index = ind
    }
    if(this.options.select) {
      $("option:eq(" + old_index + ")", this.select).insertBefore($("option:eq(" + new_index + ")", this.select))
    }
  }, tags:function() {
    return this.tagsArray
  }, destroy:function() {
    $.Widget.prototype.destroy.apply(this, arguments);
    this.tagsArray = []
  }, reset:function() {
    this.element.find(".tagit-choice").remove();
    this.tagsArray = [];
    if(this.options.select) {
      this.select.children().remove();
      this.select.change()
    }
    this._initialTags();
    if(this.options.tagsChanged) {
      this.options.tagsChanged(null, "reset", null)
    }
    if(typeof $().vewatermark == "function") {
      this.input.vewatermark(this.options.watermarkAllowMessage)
    }
  }, fill:function(tags) {
    if(tags !== undefined) {
      this.options.initialTags = tags
    }
    this.reset()
  }, add:function(label, value) {
    if(typeof label == "object") {
      return this._addTag({label:label, value:value})
    }else {
      return this._addTag(label, value)
    }
  }, remove:function(value) {
    this._removeTagWithValue(value, value)
  }, tag:function(label, value, element) {
    var self = this;
    return{label:label, value:value === undefined ? label : value, element:element, index:self.tagsArray.length}
  }})
})(jQuery);
VISH.Renderer = function(V, $, undefined) {
  var init = function() {
    V.Renderer.Filter.init()
  };
  var renderSlide = function(slide) {
    var article;
    if(!extra_classes) {
      var extra_classes = ""
    }
    if(!extra_buttons) {
      var extra_buttons = ""
    }
    var isSlideset = V.Slideset.isSlideset(slide.type);
    if(isSlideset) {
      article = _renderSlideset(slide)
    }else {
      article = _renderStandardSlide(slide)
    }
    if(article) {
      $("section.slides").append($(article));
      if(isSlideset) {
        V.Slideset.draw(slide)
      }
    }
  };
  var _renderStandardSlide = function(slide, options) {
    var content = "";
    var classes = "";
    var extraClasses = "";
    var extraButtons = "";
    if(typeof options != "undefined") {
      if(typeof options.extraClasses == "string") {
        extraClasses = options.extraClasses
      }
      if(typeof options.extraButtons == "string") {
        extraButtons = options.extraButtons
      }
    }
    var elL = slide.elements.length;
    for(var i = 0;i < elL;i++) {
      var element = slide.elements[i];
      if(!V.Renderer.Filter.allowElement(element)) {
        content += V.Renderer.Filter.renderContentFiltered(element, slide.template)
      }else {
        if(element.type === V.Constant.TEXT) {
          content += _renderText(element, slide.template)
        }else {
          if(element.type === V.Constant.IMAGE) {
            content += _renderImage(element, slide.template)
          }else {
            if(element.type === V.Constant.VIDEO) {
              content += _renderHTML5Video(element, slide.template)
            }else {
              if(element.type === V.Constant.AUDIO) {
                content += _renderHTML5Audio(element, slide.template)
              }else {
                if(element.type === V.Constant.OBJECT) {
                  content += _renderObject(element, slide.template);
                  classes += "object "
                }else {
                  if(element.type === V.Constant.SNAPSHOT) {
                    content += _renderSnapshot(element, slide.template);
                    classes += "snapshot "
                  }else {
                    if(element.type === V.Constant.APPLET) {
                      content += _renderApplet(element, slide.template);
                      classes += "applet "
                    }else {
                      if(element.type === V.Constant.QUIZ) {
                        content += V.Quiz.render(element, slide.template);
                        classes += V.Constant.QUIZ
                      }else {
                        content += _renderEmpty(element, slide.template)
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    return"<article class='" + extraClasses + " " + classes + "' type='" + V.Constant.STANDARD + "' template='" + slide.template + "' id='" + slide.id + "'>" + extraButtons + content + "</article>"
  };
  var _renderSlideset = function(slidesetJSON) {
    var allSubslides = "";
    var subslidesL = slidesetJSON.slides.length;
    for(var i = 0;i < subslidesL;i++) {
      var subslide = slidesetJSON.slides[i];
      allSubslides += _renderStandardSlide(subslide, {extraClasses:"hide_in_smartcard", extraButtons:"<div class='close_subslide' id='close" + subslide.id + "'></div>"})
    }
    return $("<article type='" + slidesetJSON.type + "' id='" + slidesetJSON.id + "'>" + allSubslides + "</article>")
  };
  var _renderEmpty = function(element, template) {
    return"<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + " " + template + "_text" + "'></div>"
  };
  var _renderText = function(element, template) {
    return"<div id='" + element["id"] + "' class='VEtextArea " + template + "_" + element["areaid"] + " " + template + "_text" + "'>" + element["body"] + "</div>"
  };
  var _renderImage = function(element, template) {
    if(typeof element["style"] == "undefined") {
      style = "max-height: 100%; max-width: 100%;"
    }else {
      style = element["style"]
    }
    var div = $("<div id='" + element["id"] + "' class='" + template + "_" + element["areaid"] + "'></div>");
    var img = $("<img class='" + template + "_image' src='" + element["body"] + "' style='" + style + "' />");
    if(element["hyperlink"]) {
      var a = $("<a href='" + element["hyperlink"] + "' target='blank_'></a>");
      $(a).append(img);
      $(div).append(a)
    }else {
      $(div).append(img)
    }
    return V.Utils.getOuterHTML(div)
  };
  var _renderHTML5Video = function(videoJSON, template) {
    var rendered = "<div id='" + videoJSON["id"] + "' class='" + template + "_" + videoJSON["areaid"] + "'>";
    var video = V.Video.HTML5.renderVideoFromJSON(videoJSON, {id:V.Utils.getId(videoJSON["id"] + "_video"), extraClasses:[template + "_video"], timestamp:true});
    rendered = rendered + video + "</div>";
    return rendered
  };
  var _renderHTML5Audio = function(audioJSON, template) {
    var rendered = "<div id='" + audioJSON["id"] + "' class='" + template + "_" + audioJSON["areaid"] + "'>";
    var audio = V.Audio.HTML5.renderAudioFromJSON(audioJSON, {id:V.Utils.getId(audioJSON["id"] + "_audio"), extraClasses:[template + "_audio"], timestamp:true});
    rendered = rendered + audio + "</div>";
    return rendered
  };
  var _renderObject = function(element, template) {
    var objectSettings = element.settings || {};
    var loadingObjectClass = objectSettings.unloadObject === false ? "unloadableObject" : "";
    var objectInfo = V.Object.getObjectInfo(element.body);
    switch(objectInfo.type) {
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return V.Video.Youtube.renderVideoFromJSON(element, {extraClasses:"objectelement youtubeelement " + loadingObjectClass + " " + template + "_" + element["areaid"]});
        break;
      case V.Constant.MEDIA.SCORM_PACKAGE:
        return V.SCORM.renderSCORMFromJSON(element, {extraClasses:loadingObjectClass + " " + template + "_" + element["areaid"]});
        break;
      case V.Constant.MEDIA.WEB_APP:
        return V.Object.Webapp.renderWebappFromJSON(element, {extraClasses:loadingObjectClass + " " + template + "_" + element["areaid"]});
        break;
      case V.Constant.MEDIA.PDF:
        return V.Object.PDF.renderPDFFromJSON(element, {extraClasses:loadingObjectClass + " " + template + "_" + element["areaid"], source:objectInfo.source});
        break;
      default:
        var style = element["style"] ? element["style"] : "";
        var body = V.Utils.checkUrlProtocolInStringTag(element["body"]);
        var zoomInStyle = element["zoomInStyle"] ? element["zoomInStyle"] : "";
        return"<div id='" + element["id"] + "' class='objectelement " + loadingObjectClass + " " + template + "_" + element["areaid"] + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper='" + body + "'>" + "" + "</div>";
        break
    }
  };
  var _renderSnapshot = function(element, template) {
    var style = element["style"] ? element["style"] : "";
    var body = V.Utils.checkUrlProtocolInStringTag(element["body"]);
    var scrollTop = element["scrollTop"] ? element["scrollTop"] : 0;
    var scrollLeft = element["scrollLeft"] ? element["scrollLeft"] : 0;
    return"<div id='" + element["id"] + "' class='snapshotelement " + template + "_" + element["areaid"] + "' template='" + template + "' objectStyle='" + style + "' scrollTop='" + scrollTop + "' scrollTopOrigin='" + scrollTop + "' scrollLeft='" + scrollLeft + "' scrollLeftOrigin='" + scrollLeft + "' objectWrapper='" + body + "'>" + "" + "</div>"
  };
  var _renderApplet = function(element, template) {
    return"<div id='" + element["id"] + "' class='appletelement " + template + "_" + element["areaid"] + "' code='" + element["code"] + "' width='" + element["width"] + "' height='" + element["height"] + "' archive='" + element["archive"] + "' params='" + element["params"] + "' ></div>"
  };
  return{init:init, renderSlide:renderSlide}
}(VISH, jQuery);
VISH.Status = function(V, $, undefined) {
  var _device;
  var _isEmbed;
  var _container;
  var _containerType;
  var _isExternalDomain;
  var _isInExternalSite;
  var _isLocalFile;
  var _envName;
  var _scorm;
  var _isOnline;
  var _isPreview;
  var _isPreviewInsertMode;
  var _uniqMode;
  var _isSlave;
  var _isPreventDefault;
  var _isVEFocused;
  var _isWindowFocused;
  var _isCKEditorInstanceFocused;
  var _protocol;
  var init = function(callback) {
    _checkEmbed();
    _checkDomain();
    _checkContainer();
    _checkSite();
    _checkProtocol();
    _checkPreview();
    _checkUniqMode();
    _isVEFocused = false;
    _isWindowFocused = false;
    _isCKEditorInstanceFocused = false;
    V.Status.Device.init(function(returnedDevice) {
      _device = returnedDevice;
      _checkOnline();
      if(typeof callback === "function") {
        callback()
      }
    })
  };
  var _checkEmbed = function() {
    _isEmbed = window.location != window.parent.location ? true : false;
    return _isEmbed
  };
  var _checkDomain = function() {
    _isExternalDomain = false;
    if(_checkEmbed()) {
      try {
        var parent = window.parent;
        while(parent != window.top) {
          if(typeof parent.location.href === "undefined") {
            _isExternalDomain = true;
            break
          }else {
            parent = parent.parent
          }
        }
        if(typeof window.top.location.href === "undefined") {
          _isExternalDomain = true
        }
      }catch(e) {
        _isExternalDomain = true
      }
    }
    return _isExternalDomain
  };
  var _checkContainer = function() {
    _container = undefined;
    _containerType = "undefined";
    if(_isEmbed && !_isExternalDomain) {
      try {
        switch(window.frameElement.tagName) {
          case "OBJECT":
          ;
          case "IFRAME":
          ;
          default:
            _containerType = window.frameElement.tagName;
            _container = window.frameElement
        }
      }catch(e) {
      }
    }
  };
  var _checkSite = function() {
    var options = V.Utils.getOptions();
    if(typeof options["scorm"] == "boolean") {
      _scorm = options["scorm"]
    }else {
      _scorm = false
    }
    if(!_isExternalDomain) {
      _isLocalFile = window.top.location.href.indexOf("file://") === 0
    }else {
      _isLocalFile = false
    }
    _isInExternalSite = _isExternalDomain || _scorm;
    if(typeof options["environment"] == "object" && typeof options["environment"]["name"] == "string") {
      _envName = options["environment"]["name"]
    }
    if(typeof _envName != "string") {
      try {
        _envName = window.top.document.title
      }catch(e) {
        envName = "Unknown"
      }
    }
  };
  var _checkProtocol = function() {
    var protocol;
    try {
      protocol = document.location.protocol
    }catch(e) {
    }
    if(typeof protocol == "string") {
      var protocolMatch = protocol.match(/[\w]+/);
      if(protocolMatch instanceof Array && typeof protocolMatch[0] == "string") {
        protocol = protocolMatch[0]
      }else {
        protocol = undefined
      }
    }
    if(typeof protocol == "string") {
      _protocol = protocol
    }else {
      _protocol = "unknown"
    }
  };
  var _checkPreview = function() {
    var options = V.Utils.getOptions();
    if(typeof options["preview"] == "boolean") {
      _isPreview = options["preview"]
    }else {
      _isPreview = false
    }
    _isPreviewInsertMode = false;
    if(_isPreview) {
      var presentation = V.Viewer.getCurrentPresentation();
      if(presentation.insertMode === true) {
        _isPreviewInsertMode = true
      }
    }
  };
  var _checkUniqMode = function() {
    var hashParams = V.Utils.getHashParams();
    if(hashParams["uniq"] === "true") {
      _uniqMode = true
    }else {
      _uniqMode = false
    }
  };
  var _checkOnline = function() {
    if(_isLocalFile) {
      var img = $("<img style='display:none' src='" + V.ImagesPath + "blank.gif" + "' />");
      $(img).load(function(response) {
        _isOnline = true
      });
      $(img).error(function(response) {
        _isOnline = false
      });
      $("section.slides").append(img);
      _isOnline = true;
      return
    }
    $.ajax({async:true, cache:false, error:function(req, status, ex) {
      V.Debugging.log("Error: " + ex);
      _isOnline = false
    }, success:function(data, status, req) {
      _isOnline = true
    }, timeout:5E3, type:"GET", url:V.ImagesPath + "blank.gif"})
  };
  var getDevice = function() {
    return _device
  };
  var refreshDeviceAfterResize = function() {
    _device = V.Status.Device.fillScreen(_device)
  };
  var isEmbed = function() {
    return _isEmbed
  };
  var getContainer = function() {
    return _container
  };
  var getContainerType = function() {
    return _containerType
  };
  var isExternalDomain = function() {
    return _isExternalDomain
  };
  var isExternalSite = function() {
    return _isInExternalSite
  };
  var getEnvironmentName = function() {
    return _envName
  };
  var getIsLocalFile = function() {
    return _isLocalFile
  };
  var getProtocol = function() {
    if(typeof _protocol == "undefined") {
      _checkProtocol()
    }
    return _protocol
  };
  var isScorm = function() {
    return _scorm
  };
  var isOnline = function() {
    return _isOnline
  };
  var isPreview = function() {
    return _isPreview
  };
  var isPreviewInsertMode = function() {
    return _isPreviewInsertMode
  };
  var getIsUniqMode = function() {
    return _uniqMode
  };
  var isSlaveMode = function() {
    if(typeof _isSlave !== "undefined") {
      return _isSlave
    }else {
      return false
    }
  };
  var setSlaveMode = function(slaveMode) {
    if(slaveMode !== _isSlave) {
      if(slaveMode === true) {
        V.Events.unbindViewerEventListeners();
        V.Video.HTML5.showControls(false);
        _isSlave = true
      }else {
        V.Events.bindViewerEventListeners();
        V.Video.HTML5.showControls(true);
        _isSlave = false
      }
    }
  };
  var isPreventDefaultMode = function() {
    if(typeof _isPreventDefault !== "undefined") {
      return _isPreventDefault
    }else {
      return false
    }
  };
  var setPreventDefaultMode = function(preventDefault) {
    if(preventDefault !== _isPreventDefault) {
      if(preventDefault === true) {
        _isPreventDefault = true
      }else {
        _isPreventDefault = false
      }
    }
  };
  var setWindowFocus = function(focus) {
    if(typeof focus == "boolean") {
      _isWindowFocused = focus;
      _updateFocus(!focus)
    }
  };
  var setCKEditorInstanceFocused = function(focus) {
    if(typeof focus == "boolean") {
      _isCKEditorInstanceFocused = focus;
      _updateFocus(!focus)
    }
  };
  var _updateFocus = function(delayUpdate) {
    if(delayUpdate === true) {
      setTimeout(function() {
        _updateFocus()
      }, 100);
      return
    }
    var updatedFocus = _isWindowFocused || _isCKEditorInstanceFocused;
    if(updatedFocus != _isVEFocused) {
      _isVEFocused = updatedFocus;
      var params = new Object;
      params.focus = updatedFocus;
      V.EventsNotifier.notifyEvent(V.Constant.Event.onVEFocusChange, params)
    }
  };
  var isVEFocused = function() {
    return _isVEFocused
  };
  return{init:init, getDevice:getDevice, isExternalDomain:isExternalDomain, isEmbed:isEmbed, getContainer:getContainer, getContainerType:getContainerType, isScorm:isScorm, isExternalSite:isExternalSite, getEnvironmentName:getEnvironmentName, getProtocol:getProtocol, isPreview:isPreview, isPreviewInsertMode:isPreviewInsertMode, getIsUniqMode:getIsUniqMode, isOnline:isOnline, isSlaveMode:isSlaveMode, setSlaveMode:setSlaveMode, isPreventDefaultMode:isPreventDefaultMode, setPreventDefaultMode:setPreventDefaultMode, 
  setWindowFocus:setWindowFocus, setCKEditorInstanceFocused:setCKEditorInstanceFocused, refreshDeviceAfterResize:refreshDeviceAfterResize, isVEFocused:isVEFocused}
}(VISH, jQuery);
VISH.Status.Device = function(V, $, undefined) {
  var init = function(callback) {
    V.Status.Device.Browser.init();
    V.Status.Device.Features.init();
    _fillDevice(callback)
  };
  var _fillDevice = function(callback) {
    var storedDevice = V.Storage.get(V.Constant.Storage.Device);
    if(typeof storedDevice != "undefined") {
      device = storedDevice;
      _loadViewportForDevice(device, function() {
        fillScreen(device);
        if(typeof callback === "function") {
          callback(device)
        }
      });
      return
    }
    var device = {};
    device.browser = {};
    device.features = {};
    device.browser = V.Status.Device.Browser.fillBrowser();
    _fillUserAgentBeforeViewport(device);
    _loadViewportForDevice(device, function() {
      _fillUserAgentAfterViewport(device);
      fillScreen(device);
      device.features = V.Status.Device.Features.fillFeatures(device.browser);
      V.Storage.add(V.Constant.Storage.Device, device, false);
      if(device.android && device.browser.name === V.Constant.ANDROID_BROWSER) {
        if(device.hasTestingViewport === true && V.Storage.isSupported()) {
          _reloadOnAndroidTestingViewport(callback, device);
          return
        }
      }
      if(typeof callback === "function") {
        callback(device)
      }
    })
  };
  var _reloadOnAndroidTestingViewport = function(callback, device) {
    var attempts = 0;
    var maxAttempts = 3;
    var initialDevice = V.Storage.get(V.Constant.Storage.Device);
    if(typeof storedDevice !== "undefined") {
      location.reload(true);
      return
    }
    var waitTimer = setInterval(function() {
      var storedDevice = V.Storage.get(V.Constant.Storage.Device);
      if(typeof storedDevice !== "undefined") {
        clearInterval(waitTimer);
        location.reload(true)
      }else {
        attempts++;
        if(attempts >= maxAttempts) {
          clearInterval(waitTimer);
          callback(device)
        }
      }
    }, 1E3)
  };
  var _fillUserAgentBeforeViewport = function(device) {
    device.pixelRatio = window.devicePixelRatio || 1;
    device.iPhone = /iPhone/i.test(navigator.userAgent);
    device.iPhone4 = device.iPhone && device.pixelRatio == 2;
    device.iPad = /iPad/i.test(navigator.userAgent);
    device.iOS = device.iPhone || device.iPad;
    device.applePhone = device.iPhone || device.iPhone4;
    device.appleTablet = device.iPad;
    device.android = /android/i.test(navigator.userAgent)
  };
  var _loadViewportForDevice = function(device, callback) {
    if(device.iOS && device.browser.name === V.Constant.SAFARI) {
      _setViewportForIphone(callback)
    }else {
      if(device.android) {
        if(device.browser.name === V.Constant.CHROME) {
          _setViewportForChromeForAndroid(callback)
        }else {
          if(device.browser.name === V.Constant.ANDROID_BROWSER) {
            if(typeof device.desktop === "undefined") {
              device.hasTestingViewport = true;
              _setTestingViewportForAndroidBrowser(callback)
            }else {
              _setViewportForAndroidBrowser(callback)
            }
          }
        }
      }else {
        if(typeof callback === "function") {
          callback()
        }
      }
    }
  };
  var WAITING_TIME_FOR_VIEWPORT_LOAD = 1250;
  var _setViewport = function(viewportContent, callback) {
    var viewport = $("head>meta[name='viewport']");
    if(viewport.length === 0) {
      $("head").prepend('<meta name="viewport" content="' + viewportContent + '"/>')
    }else {
      $(viewport).attr("content", viewportContent)
    }
    setTimeout(function() {
      if(typeof callback === "function") {
        callback()
      }
    }, WAITING_TIME_FOR_VIEWPORT_LOAD)
  };
  var _setViewportForAndroidBrowser = function(callback) {
    _setViewport("user-scalable=yes", callback)
  };
  var _setTestingViewportForAndroidBrowser = function(callback) {
    _setViewport("width=device-width,height=device-height,user-scalable=yes", callback)
  };
  var _setViewportForChromeForAndroid = function(callback) {
    _setViewport("width=device-width,height=device-height,user-scalable=yes", callback)
  };
  var _setViewportForIphone = function(callback) {
    _setViewport("user-scalable=yes", callback)
  };
  var _fillUserAgentAfterViewport = function(device) {
    device.androidPhone = false;
    device.androidTablet = false;
    if(device.android) {
      if(/tablet/i.test(navigator.userAgent)) {
        device.androidTablet = true
      }else {
        var maxWidth = 960 * device.pixelRatio;
        var maxHeight = 720 * device.pixelRatio;
        var landscape = window.screen.availWidth > window.screen.availHeight;
        if(landscape) {
          if(window.screen.availWidth >= maxWidth && window.screen.availHeight >= maxHeight) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }else {
          if(window.screen.availWidth >= maxHeight && window.screen.availHeight >= maxWidth) {
            device.androidTablet = true
          }else {
            device.androidPhone = true
          }
        }
      }
    }
    device.mobile = device.applePhone || device.androidPhone;
    device.tablet = device.appleTablet || device.androidTablet;
    if(!device.mobile && !device.tablet) {
      device.desktop = true
    }else {
      device.desktop = false
    }
    if(typeof navigator == "object") {
      device.userAgent = navigator.userAgent;
      device.appName = navigator.appName;
      device.appVersion = navigator.appVersion;
      device.platform = navigator.platform;
      device.language = navigator.language
    }
  };
  var fillScreen = function(device) {
    device.viewport = {width:window.innerWidth, height:window.innerHeight};
    device.screen = {rWidth:window.screen.availWidth * device.pixelRatio, rHeight:window.screen.availHeight * device.pixelRatio, width:window.screen.availWidth, height:window.screen.availHeight};
    return device
  };
  return{init:init, fillScreen:fillScreen}
}(VISH, jQuery);
VISH.Utils = function(V, undefined) {
  var ids;
  var domIds;
  var init = function() {
    if(!domIds) {
      domIds = new Array;
      ids = []
    }
    jQuery.fn.cssNumber = function(prop) {
      var v = parseInt(this.css(prop), 10);
      return isNaN(v) ? 0 : v
    };
    jQuery.fn.reverse = [].reverse;
    String.prototype.replaceAll = function(find, replace) {
      var str = this;
      return str.replace(new RegExp(find.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"), "g"), replace)
    };
    Array.prototype.filter = function(fun) {
      if(this === void 0 || this === null) {
        throw new TypeError;
      }
      var t = Object(this);
      var len = t.length >>> 0;
      if(typeof fun !== "function") {
        throw new TypeError;
      }
      var res = [];
      var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
      for(var i = 0;i < len;i++) {
        if(i in t) {
          var val = t[i];
          if(fun.call(thisArg, val, i, t)) {
            res.push(val)
          }
        }
      }
      return res
    };
    if(!Array.prototype.map) {
      Array.prototype.map = function(fun) {
        if(this === void 0 || this === null) {
          throw new TypeError;
        }
        var t = Object(this);
        var len = t.length >>> 0;
        if(typeof fun !== "function") {
          throw new TypeError;
        }
        var res = new Array(len);
        var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
        for(var i = 0;i < len;i++) {
          if(i in t) {
            res[i] = fun.call(thisArg, t[i], i, t)
          }
        }
        return res
      }
    }
    if(!Array.prototype.indexOf) {
      Array.prototype.indexOf = function(elt) {
        var len = this.length >>> 0;
        var from = Number(arguments[1]) || 0;
        from = from < 0 ? Math.ceil(from) : Math.floor(from);
        if(from < 0) {
          from += len
        }
        for(;from < len;from++) {
          if(from in this && this[from] === elt) {
            return from
          }
        }
        return-1
      }
    }
    if(!Object.keys) {
      Object.keys = function() {
        var hasOwnProperty = Object.prototype.hasOwnProperty, hasDontEnumBug = !{toString:null}.propertyIsEnumerable("toString"), dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"], dontEnumsLength = dontEnums.length;
        return function(obj) {
          if(typeof obj !== "object" && (typeof obj !== "function" || obj === null)) {
            throw new TypeError("Object.keys called on non-object");
          }
          var result = [], prop, i;
          for(prop in obj) {
            if(hasOwnProperty.call(obj, prop)) {
              result.push(prop)
            }
          }
          if(hasDontEnumBug) {
            for(i = 0;i < dontEnumsLength;i++) {
              if(hasOwnProperty.call(obj, dontEnums[i])) {
                result.push(dontEnums[i])
              }
            }
          }
          return result
        }
      }()
    }
    if(typeof Array.prototype.forEach !== "function") {
      Array.prototype.forEach = function(callback) {
        for(var i = 0;i < this.length;i++) {
          callback.apply(this, [this[i], i, this])
        }
      }
    }
    if(typeof String.prototype.trim !== "function") {
      String.prototype.trim = function() {
        return this.replace(/^\s+|\s+$/g, "")
      }
    }
    jQuery.fn.vewatermark = function(text) {
      if(V.Status.getDevice().browser.name != V.Constant.IE) {
        $(this).watermark(text)
      }else {
        $(this).attr("placeholder", text)
      }
    };
    V.Utils.Loader.init()
  };
  var dimentionsToDraw = function(w_zone, h_zone, w_content, h_content) {
    var dimentions = {width:w_content, height:h_content};
    var aspect_ratio_zone = w_zone / h_zone;
    var aspect_ratio_content = w_content / h_content;
    if(aspect_ratio_zone > aspect_ratio_content) {
      dimentions.width = aspect_ratio_content * h_zone;
      dimentions.height = h_zone;
      return dimentions
    }else {
      dimentions.width = w_zone;
      dimentions.height = w_zone / aspect_ratio_content;
      return dimentions
    }
  };
  var fitChildInParent = function(child) {
    var parent = $(child).parent();
    var dimensions = V.Utils.dimentionsToDraw($(parent).width(), $(parent).height(), $(child).width(), $(child).height());
    $(child).width(dimensions.width);
    $(child).height(dimensions.height)
  };
  var getOptions = function() {
    if(V.Editing) {
      return V.Editor.getOptions()
    }else {
      return V.Viewer.getOptions()
    }
  };
  var getId = function(full_id_prefix, justCheck, separator) {
    if(!justCheck) {
      if(typeof full_id_prefix !== "string") {
        full_id_prefix = "unicID"
      }
      if(typeof separator !== "string") {
        separator = ""
      }
      if(typeof domIds[full_id_prefix] === "undefined") {
        domIds[full_id_prefix] = 0
      }
      domIds[full_id_prefix] = domIds[full_id_prefix] + 1;
      var full_id = full_id_prefix + separator + domIds[full_id_prefix]
    }else {
      var full_id = full_id_prefix;
      full_id_prefix = full_id_prefix.replace(full_id_prefix[full_id_prefix.length - 1], "")
    }
    if($("#" + full_id).length === 0 && ids.indexOf(full_id) === -1) {
      ids.push(full_id);
      return full_id
    }else {
      return getId(full_id_prefix, false, separator)
    }
  };
  var registerId = function(id) {
    if(ids.indexOf(id) === -1) {
      ids.push(id)
    }
  };
  var fixPresentation = function(presentation) {
    if(typeof presentation == "undefined" || (presentation === null || typeof presentation.slides == "undefined")) {
      return null
    }
    if(typeof presentation.VEVersion == "undefined") {
      presentation.VEVersion = "0.1"
    }
    presentation = _fixTypes(presentation);
    if(V.Slideset.isSlideset(presentation.type)) {
      presentation.type = V.Constant.PRESENTATION
    }
    if(!_checkIds(presentation)) {
      presentation = _overwriteIds(presentation)
    }
    presentation = _fixLicense(presentation);
    return presentation
  };
  var _fixTypes = function(presentation) {
    if(typeof presentation.type == "undefined") {
      presentation.type = V.Constant.PRESENTATION
    }
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      switch(slide.type) {
        case V.Constant.STANDARD:
          break;
        case V.Constant.FLASHCARD:
        ;
        case V.Constant.VTOUR:
        ;
        case V.Constant.EVIDEO:
          var subslides = slide.slides;
          if(subslides) {
            var ssL = subslides.length;
            for(var j = 0;j < ssL;j++) {
              if(typeof subslides[j].type == "undefined") {
                subslides[j].type = V.Constant.STANDARD
              }
            }
          }
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          slide.type = V.Constant.STANDARD;
          break
      }
    }
    return presentation
  };
  var _fixLicense = function(presentation) {
    if(typeof presentation.license != "object") {
      var options = V.Utils.getOptions();
      var isDraft = ["string", "boolean"].indexOf(typeof options.draft) === -1 || options.draft.toString() === "true";
      if(!isDraft) {
        var licenseKey = "cc-by-nc";
        presentation.license = {name:V.I18n.getTrans("i.License_" + licenseKey), key:licenseKey}
      }
    }
    return presentation
  };
  var _checkIds = function(presentation) {
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      if(!slide.id.match(/^article[0-9]+/g)) {
        return false
      }
      switch(slide.type) {
        case V.Constant.STANDARD:
          if(!_checkIdsStandardSlide(slide)) {
            return false
          }
          break;
        case V.Constant.FLASHCARD:
          if(!_checkIdsFlashcardSlide(slide)) {
            return false
          }
          break;
        case V.Constant.VTOUR:
          if(!_checkIdsVTourSlide(slide)) {
            return false
          }
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          break
      }
    }
    return true
  };
  var _checkIdsStandardSlide = function(slide) {
    var elements = slide.elements;
    var eL = elements.length;
    for(var j = 0;j < eL;j++) {
      if(elements[j].id.match(new RegExp("^" + slide.id, "g")) === null) {
        return false
      }
    }
    return true
  };
  var _checkIdsFlashcardSlide = function(slide) {
    return _checkSlideset(slide)
  };
  var _checkIdsVTourSlide = function(slide) {
    return _checkSlideset(slide)
  };
  var _checkSlideset = function(slideset) {
    var subslides = slideset.slides;
    var subslidesIds = [];
    if(subslides) {
      var ssL = subslides.length;
      for(var i = 0;i < ssL;i++) {
        var subslide = subslides[i];
        if(typeof subslide.id != "undefined") {
          subslidesIds.push(subslide.id)
        }
        if(!_checkIdsStandardSlide(subslide)) {
          return false
        }
      }
    }
    var pois = slideset.pois;
    if(typeof pois != "undefined") {
      var pL = pois.length;
      for(var j = 0;j < pL;j++) {
        var poi = pois[j];
        if(typeof poi.slide_id == "undefined") {
          return false
        }
        if(poi.slide_id.match(new RegExp("^" + slideset.id + "_article[0-9]+", "g")) === null) {
          return false
        }
        if(subslidesIds.indexOf(poi.slide_id) === -1) {
          return false
        }
      }
    }
    return true
  };
  var _overwriteIds = function(presentation) {
    var slides = presentation.slides;
    var sL = slides.length;
    for(var i = 0;i < sL;i++) {
      var slide = slides[i];
      slide.id = "article" + (i + 1).toString();
      switch(slide.type) {
        case V.Constant.STANDARD:
          slide = _overwriteIdsStandardSlide(slide);
          break;
        case V.Constant.FLASHCARD:
          slide = _overwriteIdsFlashcardSlide(slide);
          break;
        case V.Constant.VTOUR:
          slide = _overwriteIdsVTourSlide(slide);
          break;
        case V.Constant.QUIZ_SIMPLE:
          break;
        default:
          return
      }
    }
    return presentation
  };
  var _overwriteIdsStandardSlide = function(slide) {
    var elements = slide.elements;
    var eL = elements.length;
    for(var j = 0;j < eL;j++) {
      elements[j].id = slide.id + "_zone" + (j + 1).toString()
    }
    return slide
  };
  var _overwriteIdsFlashcardSlide = function(slide) {
    return _overwriteIdsSlideset(slide)
  };
  var _overwriteIdsVTourSlide = function(slide) {
    return _overwriteIdsSlideset(slide)
  };
  var _overwriteIdsSlideset = function(slideset) {
    var subslides = slideset.slides;
    var subslidesIds = new Array;
    if(subslides) {
      var ssL = subslides.length;
      for(var i = 0;i < ssL;i++) {
        var subslide = subslides[i];
        var oldId = subslide.id;
        subslide.id = slideset.id + "_article" + (i + 1).toString();
        subslidesIds[oldId] = subslide.id;
        subslide = _overwriteIdsStandardSlide(subslide)
      }
    }
    var newPois = [];
    var pois = slideset.pois;
    if(typeof pois != "undefined") {
      var pL = pois.length;
      for(var j = 0;j < pL;j++) {
        var poi = pois[j];
        if(typeof subslidesIds[poi.slide_id] != "undefined") {
          poi.slide_id = subslidesIds[poi.slide_id];
          newPois.push(poi)
        }
      }
      slideset.pois = newPois
    }
    return slideset
  };
  var showPNotValidDialog = function() {
    var options = {};
    options.width = 650;
    options.height = 220;
    options.text = V.I18n.getTrans("i.resourceNonCompatibleNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var getOuterHTML = function(tag) {
    if(typeof $(tag)[0].outerHTML == "undefined") {
      return $(tag).clone().wrap("<div></div>").parent().html()
    }else {
      return $(tag)[0].outerHTML
    }
  };
  var sendParentToURL = function(the_url) {
    window.top.location = the_url
  };
  var removeParamFromUrl = function(url, paramName) {
    if(typeof url !== "string" || typeof paramName !== "string") {
      return url
    }
    var splitHash = url.split("#");
    url = splitHash[0];
    var splitParams = url.split("?");
    if(splitParams.length === 2) {
      url = splitParams[0];
      var params = splitParams[1];
      var validParams = [];
      var splitParams = params.split("&");
      var sPL = splitParams.length;
      for(var i = 0;i < sPL;i++) {
        var splitParam = splitParams[i].split("=");
        if(splitParam[0] != paramName) {
          validParams.push({key:splitParam[0], value:splitParam[1]})
        }
      }
      var vPL = validParams.length;
      for(var j = 0;j < vPL;j++) {
        var param = validParams[j];
        if(j === 0) {
          url = url + "?"
        }else {
          url = url + "&"
        }
        url = url + param.key + "=" + param.value
      }
    }
    if(splitHash.length > 1) {
      url = url + "#" + splitHash[1]
    }
    return url
  };
  var addParamToUrl = function(url, paramName, paramValue) {
    if(typeof url !== "string" || (typeof paramName !== "string" || typeof paramValue !== "string")) {
      return url
    }
    url = removeParamFromUrl(url, paramName);
    var splitHash = url.split("#");
    url = splitHash[0];
    var param = paramName + "=" + paramValue;
    if(url.indexOf("?") > -1) {
      url += "&" + param
    }else {
      url += "?" + param
    }
    if(splitHash.length > 1) {
      url = url + "#" + splitHash[1]
    }
    return url
  };
  var getParamsFromUrl = function(url) {
    var params = {};
    if(typeof url !== "string") {
      return params
    }
    var split = url.split("?");
    if(split.length <= 1) {
      return params
    }else {
      var urlParams = split[1].split("#")[0].split("&");
      for(var i = 0;i < urlParams.length;i++) {
        var resultSplit = urlParams[i].split("=");
        if(resultSplit.length === 2) {
          params[resultSplit[0]] = resultSplit[1]
        }
      }
      return params
    }
  };
  var checkMiniumRequirements = function() {
    var browserRequirements = true;
    var device = V.Status.getDevice();
    switch(device.browser.name) {
      case V.Constant.IE:
        if(V.Editing) {
          if(device.browser.version < 9) {
            browserRequirements = false
          }
        }else {
          if(device.browser.version < 8) {
            browserRequirements = false
          }
        }
        break;
      case V.Constant.FIREFOX:
        break;
      case V.Constant.CHROME:
        break;
      default:
        break
    }
    if(!browserRequirements) {
      $.fancybox($("#requirements_form_wrapper").html(), {"autoDimensions":false, "width":650, "height":400, "showCloseButton":false, "padding":0, "onClosed":function() {
      }});
      return false
    }
    return true
  };
  var getSrcFromCSS = function(css) {
    try {
      if(typeof css == "string" && (css.indexOf("url") === 0 && css.length > 3)) {
        var quote = css[4];
        if(quote == '"' || quote == "'") {
          return css.substring(5, css.length - 2)
        }else {
          return css.substring(4, css.length - 1)
        }
      }
    }catch(e) {
    }
    return css
  };
  var getZoomInStyle = function(zoom) {
    var style = "";
    style = style + "-ms-transform: scale(" + zoom + "); ";
    style = style + "-ms-transform-origin: 0 0; ";
    style = style + "-moz-transform: scale(" + zoom + "); ";
    style = style + "-moz-transform-origin: 0 0; ";
    style = style + "-o-transform: scale(" + zoom + "); ";
    style = style + "-o-transform-origin: 0 0; ";
    style = style + "-webkit-transform: scale(" + zoom + "); ";
    style = style + "-webkit-transform-origin: 0 0; ";
    return style
  };
  var getZoomFromStyle = function(style) {
    var zoom = 1;
    if(!style) {
      return zoom
    }
    var moz_zoom_pattern = /-moz-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var webkit_zoom_pattern = /-webkit-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var opera_zoom_pattern = /-o-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    var ie_zoom_pattern = /-ms-transform: ?scale\(([0-9]+.[0-9]+)\)/g;
    $.each(style.split(";"), function(index, property) {
      if(property.match(moz_zoom_pattern) != null) {
        var result = moz_zoom_pattern.exec(property);
        if(result !== null && result[1]) {
          zoom = parseFloat(result[1]);
          return false
        }
      }else {
        if(property.match(webkit_zoom_pattern) != null) {
          var result = webkit_zoom_pattern.exec(property);
          if(result !== null && result[1]) {
            zoom = parseFloat(result[1]);
            return false
          }
        }else {
          if(property.match(opera_zoom_pattern) != null) {
            var result = opera_zoom_pattern.exec(property);
            if(result !== null && result[1]) {
              zoom = parseFloat(result[1]);
              return false
            }
          }else {
            if(property.match(ie_zoom_pattern) != null) {
              var result = ie_zoom_pattern.exec(property);
              if(result !== null && result[1]) {
                zoom = parseFloat(result[1]);
                return false
              }
            }
          }
        }
      }
    });
    return zoom
  };
  var getWidthFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[0]
  };
  var getHeightFromStyle = function(style, area) {
    return getPixelDimensionsFromStyle(style, area)[1]
  };
  var getPixelDimensionsFromStyle = function(style, area) {
    var dimensions = [];
    var width = null;
    var height = null;
    $.each(style.split(";"), function(index, property) {
      var width_percent_pattern = /width:\s?([0-9]+(\.[0-9]+)?)%/g;
      var width_px_pattern = /width:\s?([0-9]+(\.?[0-9]+)?)px/g;
      var height_percent_pattern = /height:\s?([0-9]+(\.[0-9]+)?)%/g;
      var height_px_pattern = /height:\s?([0-9]+(\.?[0-9]+)?)px/g;
      if(property.indexOf("width") !== -1) {
        if(property.match(width_px_pattern)) {
          var result = width_px_pattern.exec(property);
          if(result[1]) {
            width = result[1]
          }
        }else {
          if(property.match(width_percent_pattern)) {
            var result = width_percent_pattern.exec(property);
            if(result[1]) {
              var percent = result[1];
              if(area) {
                width = $(area).width() * percent / 100
              }
            }
          }
        }
      }else {
        if(property.indexOf("height") !== -1) {
          if(property.match(height_px_pattern)) {
            var result = height_px_pattern.exec(property);
            if(result[1]) {
              height = result[1]
            }
          }else {
            if(property.match(height_percent_pattern)) {
              var result = height_percent_pattern.exec(property);
              if(result[1]) {
                var percent = result[1];
                if(area) {
                  height = $(area).height() * percent / 100
                }
              }
            }
          }
        }
      }
    });
    dimensions.push(width);
    dimensions.push(height);
    return dimensions
  };
  var getFontSizeFromStyle = function(style) {
    if(!style) {
      return
    }
    var ft = null;
    $.each(style.split(";"), function(index, property) {
      var font_style_pattern = /font-size\s*:\s*((\d*\.)?\d+)px/i;
      if(property.match(font_style_pattern) != null) {
        var result = font_style_pattern.exec(property);
        if(result !== null && result[1] !== null) {
          ft = parseFloat(result[1]);
          return false
        }
      }
    });
    return ft
  };
  var addFontSizeToStyle = function(style, fontSize) {
    if(typeof style !== "string") {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("font-size") === -1 && property !== "") {
        filterStyle = filterStyle + property + "; "
      }
    });
    if(fontSize) {
      filterStyle = filterStyle + "font-size:" + fontSize + ";"
    }
    return filterStyle
  };
  var removeFontSizeInStyle = function(style) {
    if(typeof style !== "string") {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("font-size") === -1 && property !== "") {
        filterStyle = filterStyle + property + "; "
      }
    });
    return filterStyle
  };
  var getBackgroundPosition = function(elem) {
    var bp = {x:0, y:0};
    var ebp = $(elem).css("background-position").split(" ");
    var ebpL = ebp.length;
    if(ebpL === 2) {
      bp.x = parseInt(ebp[0], 10);
      bp.y = parseInt(ebp[1], 10)
    }else {
      if(ebp.length === 4 && ebp[0] === "left") {
        bp.x = parseInt(ebp[1], 10);
        bp.y = parseInt(ebp[3], 10)
      }
    }
    bp.x = isNaN(bp.x) ? 0 : bp.x;
    bp.y = isNaN(bp.y) ? 0 : bp.y;
    return bp
  };
  var addScale3DToElement = function(elem, scale) {
    $(elem).css("transform-origin", "0 0");
    $(elem).css("-ms-transform-origin", "0 0");
    $(elem).css("-webkit-transform-origin", "0 0");
    $(elem).css("transform", "scale3d(" + scale + "," + scale + ",1)");
    $(elem).css("-ms-transform", "scale3d(" + scale + "," + scale + ",1)");
    $(elem).css("-webkit-transform", "scale3d(" + scale + "," + scale + ",1)")
  };
  var showDialog = function(options) {
    _cleanDialog();
    var rootTemplate = $("#notification_template");
    if($(rootTemplate).length === 0) {
      return
    }
    if(!options || !options.text) {
      return
    }
    var width = "90%";
    var height;
    var showCloseButton = false;
    var notificationIconSrc;
    if(V.Editing) {
      notificationIconSrc = V.ImagesPath + "zonethumbs/content_fail.png"
    }
    if(options.width) {
      width = options.width
    }
    if(options.showCloseButton) {
      showCloseButton = options.showCloseButton
    }
    if(options.notificationIconSrc) {
      notificationIconSrc = options.notificationIconSrc
    }
    if(!notificationIconSrc) {
      options.textWrapperClass = "forceCenter"
    }
    if(typeof width == "string" && width.indexOf("%") != 0) {
      width = width.split("%")[0].trim();
      width = width * $(window).width() / 100
    }
    var notificationParent = $(rootTemplate).parent();
    $(rootTemplate).width(width);
    var text_wrapper = $(rootTemplate).find(".notification_row1");
    var buttons_wrapper = $(rootTemplate).find(".notification_row2");
    var imgIcon = $(text_wrapper).find(".notificationIcon");
    if(notificationIconSrc) {
      $(imgIcon).attr("src", notificationIconSrc);
      $(imgIcon).css("display", "inline")
    }
    if(options.notificationIconClass) {
      $(imgIcon).addClass(options.notificationIconClass)
    }
    if(options.textWrapperClass) {
      $(text_wrapper).addClass(options.textWrapperClass)
    }
    if(options.buttonsWrapperClass) {
      $(buttons_wrapper).addClass(options.buttonsWrapperClass)
    }
    $(text_wrapper).find(".notification_text").html(options.text);
    if(options.buttons) {
      var obLength = options.buttons.length;
      $(options.buttons).reverse().each(function(index, button) {
        var bNumber = obLength - index;
        var buttonDOM = $('<a href="#" buttonNumber="' + bNumber + '" class="button notification_button">' + button.text + "</a>");
        if(button.extraclass) {
          $(buttonDOM).addClass(button.extraclass)
        }
        $(buttons_wrapper).append(buttonDOM)
      })
    }
    if(options.middlerow) {
      var middlerow = document.createElement("div");
      $(middlerow).addClass("notification_middlerow");
      $(middlerow).append(options.middlerow);
      if(options.middlerowExtraClass) {
        $(middlerow).addClass(options.middlerowExtraClass)
      }
      $(buttons_wrapper).before(middlerow)
    }
    V.Utils.addTempShown(notificationParent);
    var adjustedHeight = $(text_wrapper).outerHeight(true) + $(buttons_wrapper).outerHeight(true);
    if(options.middlerow) {
      var middlerow = $(rootTemplate).find(".notification_middlerow");
      adjustedHeight = adjustedHeight + $(middlerow).outerHeight(true)
    }
    V.Utils.removeTempShown(notificationParent);
    var cloneTemplate = $(rootTemplate).clone();
    $(cloneTemplate).attr("id", "notification_template_cloned");
    $(notificationParent).append(cloneTemplate);
    var notification = $("#notification_template_cloned");
    if(options.buttons) {
      buttons_wrapper = $(notification).find(".notification_row2");
      $(buttons_wrapper).html("");
      var obLength = options.buttons.length;
      $(options.buttons).reverse().each(function(index, button) {
        var bNumber = obLength - index;
        var buttonDOM = $('<a href="#" buttonNumber="' + bNumber + '" class="button notification_button">' + button.text + "</a>");
        if(button.extraclass) {
          $(buttonDOM).addClass(button.extraclass)
        }
        $(buttons_wrapper).append(buttonDOM);
        $(buttons_wrapper).find(".button[buttonNumber='" + bNumber + "']").click(function(event) {
          event.preventDefault();
          button.callback()
        })
      })
    }
    $("a#link_to_notification_template").fancybox({"autoDimensions":false, "autoScale":true, "scrolling":"no", "width":width, "height":adjustedHeight, "padding":0, "hideOnOverlayClick":true, "hideOnContentClick":false, "showCloseButton":showCloseButton, "onStart":function(data) {
    }, "onComplete":function(data) {
    }, "onClosed":function(data) {
      _cleanDialog();
      if(options && typeof options.onClosedCallback == "function") {
        options.onClosedCallback()
      }
    }});
    $("a#link_to_notification_template").trigger("click")
  };
  var _cleanDialog = function() {
    var notificationWrapper = $("#notification_template_wrapper");
    $(notificationWrapper).html("");
    var notificationTemplate = document.createElement("div");
    $(notificationTemplate).attr("id", "notification_template");
    var row1 = document.createElement("div");
    $(row1).addClass("notification_row1");
    var img = document.createElement("img");
    $(img).addClass("notificationIcon");
    $(img).attr("style", "display:none");
    var span = document.createElement("span");
    $(span).addClass("notification_text");
    $(row1).append(img);
    $(row1).append(span);
    $(notificationTemplate).append(row1);
    var row2 = document.createElement("div");
    $(row2).addClass("notification_row2");
    $(notificationTemplate).append(row2);
    $(notificationWrapper).append(notificationTemplate)
  };
  var isObseleteVersion = function(version) {
    return _getVersionValue(V.VERSION) > _getVersionValue(version)
  };
  var _getVersionValue = function(version) {
    var vValue = 0;
    var coef = [100, 10, 1];
    try {
      var digits = version.split(".");
      for(var i = 0;i < digits.length;i++) {
        vValue += parseFloat(digits[i]) * coef[i]
      }
    }catch(e) {
      return 0
    }
    return vValue
  };
  var getSlideNumberFromHash = function() {
    try {
      if(getOptions()["readHashFromParent"] === true) {
        var location = window.parent.location
      }else {
        var location = window.location
      }
      if(typeof location == "undefined") {
        return
      }
      var sNumber = Math.max(1, Math.min(V.Slides.getSlidesQuantity(), parseInt(location.hash.split("?")[0].split("#").pop())));
      if(isNaN(sNumber)) {
        return undefined
      }else {
        return sNumber
      }
    }catch(err) {
      return undefined
    }
  };
  var updateHash = function() {
    var newHash = "#" + V.Slides.getCurrentSlideNumber();
    if(getOptions()["readHashFromParent"] === true) {
      window.parent.location.hash = newHash
    }
    var splitedHash = location.hash.split("?");
    if(splitedHash.length > 1) {
      newHash = newHash + "?" + splitedHash[1]
    }
    window.location.hash = newHash
  };
  var cleanHash = function() {
    window.location.hash = "";
    if(getOptions()["readHashFromParent"] === true) {
      window.parent.location.hash = ""
    }
    if(V.Status.getDevice().features.historypushState) {
      var locationWithoutHash = removeHashFromUrlString(document.location.href);
      window.history.replaceState("", "", locationWithoutHash);
      if(getOptions()["readHashFromParent"] === true) {
        var locationWithoutHash = removeHashFromUrlString(window.parent.document.location.href);
        window.parent.history.replaceState("", "", locationWithoutHash)
      }
    }
  };
  var removeHashFromUrlString = function(url) {
    return url.split("#")[0]
  };
  var getHashParams = function() {
    var params = {};
    var hash = window.location.hash;
    var splitHash = hash.split("?");
    if(splitHash.length > 1) {
      var hashParams = splitHash[1];
      var splitParams = hashParams.split("&");
      var sPL = splitParams.length;
      for(var i = 0;i < sPL;i++) {
        var paramInHash = splitParams[i];
        var splitParamInHash = paramInHash.split("=");
        if(splitParamInHash.length === 2) {
          params[splitParamInHash[0]] = splitParamInHash[1]
        }
      }
    }
    return params
  };
  var nAnimationsFinishedList = {};
  var checkAnimationsFinish = function(animationId, nAnimations, callback, callbackParams) {
    if(typeof nAnimationsFinishedList[animationId] == "undefined") {
      nAnimationsFinishedList[animationId] = 0
    }
    nAnimationsFinishedList[animationId] = nAnimationsFinishedList[animationId] + 1;
    if(nAnimationsFinishedList[animationId] === nAnimations) {
      nAnimationsFinishedList[animationId] = 0;
      if(typeof callback == "function") {
        callback(callbackParams)
      }
    }
  };
  var fomatTimeForMPlayer = function(s, sN) {
    sN = typeof sN == "number" ? sN : -1;
    var h = Math.floor(s / 3600);
    s -= h * 3600;
    var m = Math.floor(s / 60);
    s -= m * 60;
    s = Math.round(s);
    if(s === 60) {
      s = 0;
      m = m + 1;
      if(m === 60) {
        m = 0;
        h = h + 1
      }
    }
    return(h < 1 && sN < 5 ? "" : h + ":") + (sN > 3 && m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s)
  };
  var delayedFunctionTimestamps = {};
  var delayedFunctionTimers = {};
  var delayFunction = function(functionId, callbackFunction, PERIOD) {
    var dN = Date.now();
    if(typeof delayedFunctionTimestamps[functionId] != "undefined") {
      var diff = dN - delayedFunctionTimestamps[functionId];
      if(diff < PERIOD) {
        if(typeof delayedFunctionTimers[functionId] == "undefined") {
          delayedFunctionTimers[functionId] = setTimeout(function() {
            delayedFunctionTimers[functionId] = undefined;
            callbackFunction()
          }, PERIOD - diff)
        }
        return true
      }
    }
    if(typeof delayedFunctionTimers[functionId] != "undefined") {
      clearTimeout(delayedFunctionTimers[functionId]);
      delayedFunctionTimers[functionId] = undefined
    }
    delayedFunctionTimestamps[functionId] = dN;
    return false
  };
  var tempShownCounts = {};
  var addTempShown = function(els) {
    $(els).each(function(index, el) {
      var elId = $(el).attr("id");
      if(typeof elId == "undefined") {
        elId = V.Utils.getId("TmpShownId");
        $(el).attr("id", elId)
      }
      var tmpShownCount = typeof tempShownCounts[elId] != "undefined" ? tempShownCounts[elId] : 0;
      tempShownCounts[elId] = tmpShownCount + 1;
      if(tmpShownCount == 0) {
        $(el).addClass("temp_shown")
      }
    })
  };
  var removeTempShown = function(els) {
    $(els).each(function(index, el) {
      var elId = $(el).attr("id");
      if(typeof elId == "undefined") {
        elId = V.Utils.getId("TmpShownId");
        $(el).attr("id", elId)
      }
      var tmpShownCount = typeof tempShownCounts[elId] != "undefined" ? tempShownCounts[elId] : 0;
      var newTmpShownCount = Math.max(0, tmpShownCount - 1);
      tempShownCounts[elId] = newTmpShownCount;
      if(newTmpShownCount == 0) {
        setTimeout(function() {
          if(tempShownCounts[elId] === 0) {
            $(el).removeClass("temp_shown")
          }
        }, 1)
      }
    })
  };
  var shuffle = function(o) {
    for(var j, x, i = o.length;i;j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x) {
    }
    return o
  };
  var purgeString = function(str) {
    if(typeof str != "string") {
      return str
    }
    str = str.replace(/\u00e2\u20ac\u2039/g, "");
    str = str.replace(/\u00c2/g, "");
    str = str.replace(/&shy/g, "");
    str = str.replace(String.fromCharCode(8203), "");
    var charCodesToPurge = [32, 160, 173];
    var strL = str.length;
    var lastValidCharIndex = strL - 1;
    for(var i = strL - 1;i > -1;i--) {
      if(charCodesToPurge.indexOf(str.charCodeAt(i)) != -1) {
      }else {
        lastValidCharIndex = i;
        break
      }
    }
    str = str.substr(0, lastValidCharIndex + 1);
    strL = str.length;
    lastValidCharIndex = 0;
    for(var i = 0;i < strL;i++) {
      if(charCodesToPurge.indexOf(str.charCodeAt(i)) != -1) {
      }else {
        lastValidCharIndex = i;
        break
      }
    }
    str = str.substr(lastValidCharIndex, strL);
    return str
  };
  var getLevenshteinDistance = function(a, b) {
    var cost;
    var m = a.length;
    var n = b.length;
    if(m < n) {
      var c = a;
      a = b;
      b = c;
      var o = m;
      m = n;
      n = o
    }
    var r = new Array;
    r[0] = new Array;
    for(var c = 0;c < n + 1;c++) {
      r[0][c] = c
    }
    for(var i = 1;i < m + 1;i++) {
      r[i] = new Array;
      r[i][0] = i;
      for(var j = 1;j < n + 1;j++) {
        cost = a.charAt(i - 1) == b.charAt(j - 1) ? 0 : 1;
        r[i][j] = _minimator(r[i - 1][j] + 1, r[i][j - 1] + 1, r[i - 1][j - 1] + cost)
      }
    }
    return r[m][n]
  };
  var _minimator = function(x, y, z) {
    if(x < y && x < z) {
      return x
    }
    if(y < x && y < z) {
      return y
    }
    return z
  };
  var checkUrlProtocol = function(url) {
    if(typeof url == "string") {
      var protocolMatch = url.match(/^https?:\/\//);
      if(protocolMatch instanceof Array && protocolMatch.length === 1) {
        var urlProtocol = protocolMatch[0].replace("://", "");
        var documentProtocol = V.Status.getProtocol();
        if(urlProtocol != documentProtocol) {
          switch(documentProtocol) {
            case "https":
              url = "https" + url.replace(urlProtocol, "");
              break;
            case "http":
              break;
            default:
              break
          }
        }
      }
    }
    return url
  };
  var checkUrlProtocolInStringTag = function(stringTag) {
    var htmlElement = $(stringTag);
    if(typeof $(htmlElement).attr("src") != "undefined") {
      $(htmlElement).attr("src", V.Utils.checkUrlProtocol($(htmlElement).attr("src")))
    }
    return V.Utils.getOuterHTML(htmlElement)
  };
  return{init:init, getOptions:getOptions, dimentionsToDraw:dimentionsToDraw, fitChildInParent:fitChildInParent, getId:getId, registerId:registerId, getOuterHTML:getOuterHTML, getSrcFromCSS:getSrcFromCSS, checkMiniumRequirements:checkMiniumRequirements, addFontSizeToStyle:addFontSizeToStyle, removeFontSizeInStyle:removeFontSizeInStyle, getFontSizeFromStyle:getFontSizeFromStyle, getZoomFromStyle:getZoomFromStyle, getZoomInStyle:getZoomInStyle, getWidthFromStyle:getWidthFromStyle, getHeightFromStyle:getHeightFromStyle, 
  getPixelDimensionsFromStyle:getPixelDimensionsFromStyle, getBackgroundPosition:getBackgroundPosition, sendParentToURL:sendParentToURL, addParamToUrl:addParamToUrl, removeParamFromUrl:removeParamFromUrl, getParamsFromUrl:getParamsFromUrl, fixPresentation:fixPresentation, addScale3DToElement:addScale3DToElement, showDialog:showDialog, showPNotValidDialog:showPNotValidDialog, isObseleteVersion:isObseleteVersion, updateHash:updateHash, cleanHash:cleanHash, removeHashFromUrlString:removeHashFromUrlString, 
  getHashParams:getHashParams, getSlideNumberFromHash:getSlideNumberFromHash, checkAnimationsFinish:checkAnimationsFinish, fomatTimeForMPlayer:fomatTimeForMPlayer, delayFunction:delayFunction, addTempShown:addTempShown, removeTempShown:removeTempShown, shuffle:shuffle, purgeString:purgeString, checkUrlProtocol:checkUrlProtocol, checkUrlProtocolInStringTag:checkUrlProtocolInStringTag, getLevenshteinDistance:getLevenshteinDistance}
}(VISH);
VISH.Object = function(V, $, undefined) {
  var init = function() {
    V.Object.PDF.init();
    V.Object.GoogleDOC.init();
    V.Object.Webapp.init()
  };
  function objectInfo(wrapper, source, sourceType) {
    this.wrapper = wrapper;
    this.source = source;
    this.type = sourceType
  }
  var getObjectInfo = function(object) {
    var wrapper = null;
    if(typeof object == "string") {
      var videoPattern = new RegExp("^<video", "g");
      if(videoPattern.exec(object) != null) {
        wrapper = "VIDEO"
      }
      var audioPattern = new RegExp("^<audio", "g");
      if(audioPattern.exec(object) != null) {
        wrapper = "AUDIO"
      }
    }
    if(wrapper === null || typeof wrapper == "undefined") {
      var element = $(object)[0];
      if(typeof element != "undefined") {
        wrapper = element.tagName
      }
    }
    var source = _getSourceFromObject(object, wrapper);
    var type;
    switch(wrapper) {
      case "VIDEO":
        type = V.Constant.MEDIA.HTML5_VIDEO;
        break;
      case "AUDIO":
        type = V.Constant.MEDIA.HTML5_AUDIO;
        break;
      case "IFRAME":
        var objectTypeAttr = $(object).attr("objecttype");
        if(typeof objectTypeAttr == "string") {
          if(objectTypeAttr == V.Constant.MEDIA.SCORM_PACKAGE) {
            type = V.Constant.MEDIA.SCORM_PACKAGE;
            break
          }else {
            if(objectTypeAttr == V.Constant.MEDIA.WEB_APP) {
              type = V.Constant.MEDIA.WEB_APP;
              break
            }
          }
        }
      ;
      default:
        type = _getTypeFromSource(source)
    }
    return new objectInfo(wrapper, source, type)
  };
  var _getSourceFromObject = function(object, wrapper) {
    var source = null;
    switch(wrapper) {
      case null:
        source = object;
        break;
      case V.Constant.WRAPPER.EMBED:
        source = $(object).attr("src");
        break;
      case V.Constant.WRAPPER.OBJECT:
        if(typeof $(object).attr("src") != "undefined") {
          source = $(object).attr("src")
        }else {
          if(typeof $(object).attr("data") != "undefined") {
            source = $(object).attr("data")
          }
        }
        break;
      case V.Constant.WRAPPER.IFRAME:
        source = $(object).attr("src");
        break;
      case V.Constant.WRAPPER.VIDEO:
        return V.Video.HTML5.getSources(object);
      case V.Constant.WRAPPER.AUDIO:
        return V.Audio.HTML5.getSources(object);
      default:
        V.Debugging.log("Unrecognized object wrapper: " + wrapper);
        break
    }
    if(wrapper == null || wrapper == V.Constant.WRAPPER.IFRAME) {
      var googledoc_pattern = /(^https?:\/\/docs.google.com\/viewer\?url=)/g;
      var googleDocMatch = source.match(googledoc_pattern);
      if(googleDocMatch instanceof Array && googleDocMatch.length === 1) {
        source = source.replace(googleDocMatch[0], "").replace("&embedded=true", "")
      }
    }
    return source
  };
  var _getTypeFromSource = function(source) {
    if(typeof source == "object" && (source !== null && (typeof source.length == "number" && source.length > 0))) {
      source = source[0]
    }
    if(typeof source != "string") {
      return null
    }
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var www_urls_pattern = /(www[.])([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    var youtube_video_pattern = /(http(s)?:\/\/)?(((youtu.be\/)([aA-zZ0-9-]+))|((www.youtube.com\/((watch\?v=)|(embed\/)|(v\/)))([aA-z0-9-Z&=.])+))/g;
    var html5VideoFormats = ["mp4", "webm", "ogg"];
    var imageFormats = ["jpg", "jpeg", "png", "gif", "bmp", "svg"];
    var audioFormats = ["mp3", "wav", "ogg"];
    if(source.match(youtube_video_pattern) != null) {
      return V.Constant.MEDIA.YOUTUBE_VIDEO
    }
    source = source.split("?")[0];
    var extension = getExtensionFromSrc(source);
    if(imageFormats.indexOf(extension) != "-1") {
      return V.Constant.MEDIA.IMAGE
    }
    if(extension == "swf") {
      return V.Constant.MEDIA.FLASH
    }
    if(extension == "pdf") {
      return V.Constant.MEDIA.PDF
    }
    if(html5VideoFormats.indexOf(extension) != "-1") {
      return V.Constant.MEDIA.HTML5_VIDEO
    }
    if(audioFormats.indexOf(extension) != "-1") {
      return V.Constant.MEDIA.HTML5_AUDIO
    }
    if(extension == "json") {
      return V.Constant.MEDIA.JSON
    }
    if(extension == "doc" || extension == "docx") {
      return V.Constant.MEDIA.DOC
    }
    if(extension == "ppt" || extension == "pptx") {
      return V.Constant.MEDIA.PPT
    }
    if(extension == "odp") {
      return V.Constant.MEDIA.PPT
    }
    if(source.match(http_urls_pattern) != null || source.match(www_urls_pattern) != null) {
      return V.Constant.MEDIA.WEB
    }
    return extension
  };
  var getExtensionFromSrc = function(source) {
    return source.split(".").pop().split("&")[0].toLowerCase()
  };
  return{init:init, getExtensionFromSrc:getExtensionFromSrc, getObjectInfo:getObjectInfo}
}(VISH, jQuery);
VISH.Object.Webapp = function(V, $, undefined) {
  var init = function() {
    V.Object.Webapp.Handler.init()
  };
  var renderWebappFromJSON = function(webappJSON, options) {
    var style = webappJSON["style"] ? webappJSON["style"] : "";
    var body = webappJSON["body"];
    var webappBody = $(body);
    $(webappBody).attr("objecttype", V.Constant.MEDIA.WEB_APP);
    $(webappBody).attr("src", V.Utils.checkUrlProtocol($(webappBody).attr("src")));
    webappBody = V.Utils.getOuterHTML(webappBody);
    var zoomInStyle = webappJSON["zoomInStyle"] ? webappJSON["zoomInStyle"] : "";
    var classes = "objectelement";
    if(options) {
      if(options.extraClasses) {
        classes = classes + " " + options.extraClasses
      }
    }
    var _settings = "";
    if(typeof webappJSON["settings"] == "object") {
      try {
        _settings = JSON.stringify(webappJSON["settings"])
      }catch(e) {
      }
    }
    return"<div id='" + webappJSON["id"] + "' class='" + classes + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper='" + webappBody + "' settings='" + _settings + "'></div>"
  };
  return{init:init, renderWebappFromJSON:renderWebappFromJSON}
}(VISH, jQuery);
VISH.Themes = function(V, $, undefined) {
  var _initialized = false;
  var init = function() {
    if(_initialized === true) {
      return
    }
    V.Themes.Core.init();
    V.Themes.Presentation.init();
    _initialized = true
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor = function(V, $, undefined) {
  var initOptions;
  var initialPresentation = false;
  var draftPresentation;
  var _isDraft;
  var lastStoredPresentationStringify;
  var currentZone;
  var lastZone;
  var currentContainer;
  var contentAddModeForSlides = V.Constant.NONE;
  var init = function(options, presentation) {
    $("#waiting_overlay").show();
    V.Editing = true;
    $("body").addClass("ViSHEditorBody");
    V.Debugging.init(options);
    if(options) {
      initOptions = options;
      if(options.configuration && V.Configuration) {
        V.Configuration.init(options.configuration)
      }
    }else {
      initOptions = {}
    }
    if(V.Debugging.isDevelopping()) {
      if(!presentation && V.Debugging.getActionInit() == "loadSamples") {
        presentation = V.Debugging.getPresentationSamples()
      }
    }
    if(presentation) {
      initialPresentation = true
    }
    _isDraft = _initPresentationDraft();
    V.Utils.init();
    V.I18n.init(initOptions, presentation);
    V.Status.init(function() {
      _initAferStatusLoaded(options, presentation)
    })
  };
  var _initAferStatusLoaded = function(options, presentation) {
    if(!V.Utils.checkMiniumRequirements()) {
      $("#waiting_overlay").hide();
      return
    }
    V.Utils.Loader.loadDeviceCSS();
    V.Utils.Loader.loadLanguageCSS();
    V.Themes.init();
    V.Editor.Themes.init();
    V.Themes.Core.applyConfigTheme(function(VEtheme) {
      _initAferVEThemeLoaded(options, presentation)
    })
  };
  var _initAferVEThemeLoaded = function(options, presentation) {
    V.I18n.translateUI();
    V.Editor.ViewerAdapter.init();
    V.Object.init();
    V.Editor.IMSQTI.init();
    V.Editor.Dummies.init();
    V.Editor.API.init();
    V.EventsNotifier.init();
    V.Editor.Animations.init();
    V.Flashcard.init();
    V.VirtualTour.init();
    V.Editor.Slideset.init();
    V.Editor.Presentation.init();
    V.Renderer.init();
    V.Slides.init();
    V.User.init(options);
    V.Video.init();
    V.Audio.init();
    V.Editor.LRE.init(V.I18n.getLanguage());
    V.Editor.Settings.init();
    V.SCORM.init();
    if(initialPresentation) {
      var presentation = V.Utils.fixPresentation(presentation);
      if(presentation === null) {
        $("#waiting_overlay").hide();
        V.Utils.showPNotValidDialog();
        return
      }
      initialPresentation = true;
      draftPresentation = presentation;
      V.Editor.Settings.loadPresentationSettings(presentation);
      if(!isPresentationDraft()) {
        V.Editor.Tools.changePublishButtonStatus("unpublish")
      }
      V.Editor.Themes.Presentation.selectTheme(presentation.theme, false, function() {
        V.Editor.Renderer.init(presentation);
        _removeSelectableProperties();
        _initAferPresentationLoaded(options, presentation)
      })
    }else {
      initialPresentation = false;
      V.Editor.Settings.loadPresentationSettings();
      _initAferPresentationLoaded(options, presentation)
    }
  };
  var _initAferPresentationLoaded = function(options, presentation) {
    if(initialPresentation) {
      V.Editor.Slides.updateCurrentSlideFromHash()
    }
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber());
      V.Editor.Thumbnails.moveThumbnailsToSlide(V.Slides.getCurrentSlideNumber())
    });
    if(initialPresentation) {
      $(".object_wrapper").hide()
    }
    V.Editor.Text.init();
    V.Editor.Image.init();
    V.Editor.Video.init();
    V.Editor.Audio.init();
    V.Editor.Object.init();
    V.Editor.PDFex.init();
    V.Editor.EPackage.init();
    V.Editor.Presentation.Repository.init();
    V.Editor.Thumbnails.init();
    V.Editor.Quiz.init();
    V.Editor.Preview.init();
    V.Editor.Tools.init();
    V.Editor.Filter.init();
    V.Storage.init();
    V.Editor.Clipboard.init();
    V.Editor.Events.init();
    V.IframeMessenger.init();
    if(options.addons) {
      V.Addons.init(options.addons)
    }
    V.Editor.Utils.Loader.unloadAllObjects();
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    if(!initialPresentation) {
      var slide = V.Editor.Dummies.getDummy(V.Constant.STANDARD, {template:"1", slideNumber:1});
      V.Editor.Slides.addSlide(slide);
      V.Slides.goToSlide(1)
    }
    if(V.Configuration.getConfiguration().presentationSettings && !initialPresentation) {
      V.Editor.Settings.displaySettings()
    }
    $("#VEversion").html(V.VERSION);
    window.focus();
    V.Themes.Core.onThemeCallback(options, presentation);
    $("#waiting_overlay").hide()
  };
  var onSlideThumbClicked = function(event) {
    var slideThumb;
    if(event.currentTarget.tagName === "P") {
      slideThumb = $(event.currentTarget).parent().find(".stthumb")
    }else {
      slideThumb = event.currentTarget
    }
    var type = $(slideThumb).attr("type");
    if(!type) {
      type = V.Constant.STANDARD
    }
    var slideMode = contentAddModeForSlides;
    if(slideMode === V.Constant.STANDARD) {
      var options = {};
      if(type === V.Constant.STANDARD) {
        options.template = $(slideThumb).attr("template")
      }
      options.slideNumber = V.Slides.getSlidesQuantity() + 1;
      var slide = V.Editor.Dummies.getDummy(type, options);
      V.Editor.Slides.addSlide(slide)
    }else {
      if(slideMode === V.Constant.SLIDESET) {
        var slideset = V.Slides.getCurrentSlide();
        if(type === V.Constant.STANDARD && V.Slideset.isSlideset(slideset)) {
          var options = {};
          options.subslide = true;
          options.template = $(slideThumb).attr("template");
          options.slideset = slideset;
          var subslide = V.Editor.Dummies.getDummy(type, options);
          V.Editor.Slides.addSubslide(slideset, subslide)
        }
      }
    }
    $.fancybox.close()
  };
  var onAnimationThumbClicked = function() {
    $.fancybox.close()
  };
  var onEditableClicked = function(event) {
    $(this).removeClass("editable");
    setCurrentArea($(this));
    var content = $("#menuselect").clone();
    $(content).removeAttr("id");
    $(content).find("a").css("display", "none");
    $(content).find("a.all").addClass("thumb_shown");
    var zoneSize = $(this).attr("size");
    var sizeClass = zoneSize == V.Constant.EXTRA_SMALL ? V.Constant.SMALL : zoneSize;
    $(content).find("a." + sizeClass).addClass("thumb_shown");
    $(content).find("a > div").addClass("thumb_" + zoneSize);
    $(content).find("a.thumb_shown.uniq").each(function(index, uthumb) {
      var shouldBeShown = false;
      switch($(uthumb).attr("id")) {
        case "add_quiz_thumb":
          if($(V.Slides.getCurrentSlide()).children("div.vezone[type='quiz']").length < 1) {
            shouldBeShown = true
          }
          break;
        default:
          break
      }
      if(shouldBeShown === false) {
        $(uthumb).removeClass("thumb_shown")
      }
    });
    V.Editor.Tools.hideZoneToolTip($(this).find(".zone_tooltip"));
    $(this).append(content);
    V.Editor.Events.addZoneThumbsEvents(this)
  };
  var onDeleteItemClicked = function() {
    setCurrentArea($(this).parent());
    var options = {};
    options.width = 375;
    options.height = 135;
    options.notificationIconSrc = V.ImagesPath + "zonethumbs/" + getCurrentArea().attr("type") + ".png";
    options.text = V.I18n.getTrans("i.areyousureNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    var button2 = {};
    button2.text = V.I18n.getTrans("i.delete");
    button2.callback = function() {
      var area = getCurrentArea();
      area.html("");
      area.removeAttr("type");
      area.addClass("editable");
      V.Editor.Tools.addTooltipToZone(area);
      selectArea(null);
      V.Editor.Slides.updateThumbnail(V.Slides.getTargetSlide());
      $.fancybox.close()
    };
    options.buttons = [button1, button2];
    V.Utils.showDialog(options)
  };
  var onDeleteSlideClicked = function() {
    var article_to_delete = $(this).parent()[0];
    var options = {};
    options.width = 375;
    options.height = 130;
    options.notificationIconSrc = V.Editor.Thumbnails.getThumbnailURL(article_to_delete);
    options.notificationIconClass = "notificationIconDelete";
    options.text = V.I18n.getTrans("i.areyousureNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    var button2 = {};
    button2.text = V.I18n.getTrans("i.delete");
    button2.callback = function() {
      if(V.Slides.isSubslide(article_to_delete)) {
        V.Editor.Slides.removeSubslide(article_to_delete)
      }else {
        V.Editor.Slides.removeSlide(V.Slides.getCurrentSlide())
      }
      $.fancybox.close()
    };
    options.buttons = [button1, button2];
    V.Utils.showDialog(options)
  };
  var onSelectableClicked = function(event) {
    selectArea($(this));
    event.stopPropagation();
    event.preventDefault()
  };
  var onNoSelectableClicked = function(event) {
    var target = $(event.target);
    var targetParent = $(target).parent();
    if(!$(target).hasClass("noSelectableElement")) {
      if($("#fancybox-content").is(":visible")) {
        return
      }
      if($(targetParent).hasClass("selectable") || $(targetParent).hasClass("preventNoselectable")) {
        return
      }
      if(jQuery.contains($("#toolbar_wrapper")[0], event.target)) {
        return
      }
      if(event.target.id === "toolbar_wrapper") {
        return
      }
      var isWysiwygFancyboxEnabled = false;
      $(".cke_dialog").each(function(index, cke_dialog) {
        if(cke_dialog && jQuery.contains(cke_dialog, event.target)) {
          isWysiwygFancyboxEnabled = true;
          return false
        }
      });
      if(isWysiwygFancyboxEnabled) {
        return
      }
    }
    cleanArea()
  };
  var cleanArea = function() {
    V.Editor.Tools.cleanZoneTool(getCurrentArea());
    setCurrentArea(null);
    _removeSelectableProperties()
  };
  var _addSelectableProperties = function(zone) {
    $(zone).removeClass("zoneUnselected");
    $(zone).addClass("zoneSelected")
  };
  var _removeSelectableProperties = function(zone) {
    if(zone) {
      $(zone).removeClass("zoneSelected");
      $(zone).addClass("zoneUnselected")
    }else {
      $(".zoneSelected").addClass("zoneUnselected");
      $(".zoneSelected").removeClass("zoneSelected")
    }
  };
  var addDeleteButton = function(element) {
    element.append("<div class='delete_content'></div>")
  };
  var onSlideEnterEditor = function(e) {
    var slide = $(e.target);
    e.stopPropagation();
    if(V.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.onEnterSlideset(slide)
    }else {
      V.Editor.Utils.Loader.loadObjectsInEditorSlide(slide);
      setTimeout(function() {
        $(slide).find(".object_wrapper").show()
      }, 500)
    }
    V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber());
    cleanArea();
    V.Editor.Tools.loadToolsForSlide(slide)
  };
  var onSlideLeaveEditor = function(e) {
    var slide = $(e.target);
    e.stopPropagation();
    if(V.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.onLeaveSlideset(slide)
    }else {
      V.Editor.Utils.Loader.unloadObjectsInEditorSlide(slide);
      $(".object_wrapper").hide()
    }
  };
  var selectArea = function(area) {
    setCurrentArea(area);
    _removeSelectableProperties();
    _addSelectableProperties(area);
    V.Editor.Tools.loadToolsForZone(area)
  };
  var savePresentation = function() {
    var presentation = {};
    presentation = V.Editor.Settings.saveSettings();
    presentation = _saveEnvData(presentation);
    presentation.slides = [];
    V.Editor.Utils.Loader.loadAllObjects();
    $(".object_wrapper, .snapshot_wrapper").show();
    $("section.slides > article").each(function(index, slideDOM) {
      var slide = {};
      if(!V.Slideset.isSlideset(slideDOM)) {
        slide = _saveStandardSlide(slideDOM, presentation, false)
      }else {
        var slidesetModule = V.Editor.Slideset.getCreatorModule(slideDOM);
        V.Utils.addTempShown(slideDOM);
        slide = slidesetModule.getSlideHeader(slideDOM);
        $(slideDOM).find("article").each(function(index, subslideDOM) {
          var subslide = _saveStandardSlide(subslideDOM, presentation, true);
          slide.slides.push(subslide)
        });
        V.Utils.removeTempShown(slideDOM)
      }
      presentation.slides.push(slide)
    });
    V.Editor.Utils.Loader.unloadAllObjects();
    V.Editor.Utils.Loader.loadObjectsInEditorSlide(V.Slides.getCurrentSlide());
    return presentation
  };
  var _saveEnvData = function(presentation) {
    var originalPresentation = getDraftPresentation();
    var envMetadata;
    if(originalPresentation && originalPresentation["vishMetadata"]) {
      envMetadata = originalPresentation["vishMetadata"]
    }else {
      envMetadata = {}
    }
    envMetadata["name"] = V.Status.getEnvironmentName();
    envMetadata["draft"] = isPresentationDraft().toString();
    presentation["vishMetadata"] = envMetadata;
    return presentation
  };
  var _saveStandardSlide = function(slideDOM, presentation, isSubslide) {
    slide = {};
    slide.id = $(slideDOM).attr("id");
    slide.type = $(slideDOM).attr("type");
    slide.template = $(slideDOM).attr("template");
    slide.elements = [];
    V.Utils.addTempShown(slideDOM);
    $(slideDOM).find("div").each(function(i, div) {
      var element = {};
      if($(div).attr("areaid") !== undefined) {
        element.id = $(div).attr("id");
        element.type = $(div).attr("type");
        element.areaid = $(div).attr("areaid");
        var elSettings = $(div).attr("elSettings");
        if(typeof elSettings == "string") {
          try {
            element.settings = JSON.parse(elSettings)
          }catch(e) {
          }
        }
        if(element.type == V.Constant.TEXT) {
          var CKEditor = V.Editor.Text.getCKEditorFromZone(div);
          if(CKEditor !== null) {
            element.body = CKEditor.getData()
          }else {
            element.body = ""
          }
        }else {
          if(element.type == V.Constant.IMAGE) {
            element.body = $(div).find("img").attr("src");
            element.style = V.Editor.Utils.getStylesInPercentages($(div), $(div).find("img"));
            if($(div).attr("hyperlink")) {
              element.hyperlink = $(div).attr("hyperlink")
            }
            if($(div).attr("vishubpdfexid")) {
              element.options = {};
              element.options["vishubPdfexId"] = $(div).attr("vishubpdfexid")
            }
          }else {
            if(element.type == V.Constant.VIDEO) {
              var video = $(div).find("video");
              element.poster = $(video).attr("poster");
              element.style = V.Editor.Utils.getStylesInPercentages($(div), $(video));
              var sources = "";
              $(video).find("source").each(function(index, source) {
                if(index !== 0) {
                  sources = sources + ","
                }
                var sourceSrc = V.Utils.removeParamFromUrl($(source).attr("src"), "timestamp");
                var sourceMimeType = typeof $(source).attr("type") != "undefined" ? ', "type": "' + $(source).attr("type") + '"' : "";
                sources = sources + '{"src":"' + sourceSrc + '"' + sourceMimeType + "}"
              });
              sources = "[" + sources + "]";
              element.sources = sources
            }else {
              if(element.type == V.Constant.AUDIO) {
                var audio = $(div).find("audio");
                element.style = V.Editor.Utils.getStylesInPercentages($(div), $(audio));
                var sources = "";
                $(audio).find("source").each(function(index, source) {
                  if(index !== 0) {
                    sources = sources + ","
                  }
                  var sourceSrc = V.Utils.removeParamFromUrl($(source).attr("src"), "timestamp");
                  var sourceMimeType = typeof $(source).attr("type") != "undefined" ? ', "type": "' + $(source).attr("type") + '"' : "";
                  sources = sources + '{"src":"' + sourceSrc + '"' + sourceMimeType + "}"
                });
                sources = "[" + sources + "]";
                element.sources = sources
              }else {
                if(element.type === V.Constant.OBJECT) {
                  var wrapper = $(div).find(".object_wrapper")[0];
                  var object = $(wrapper).children()[0];
                  var myObject = $(object).clone();
                  $(myObject).removeAttr("style");
                  element.body = V.Utils.getOuterHTML(myObject);
                  element.style = V.Editor.Utils.getStylesInPercentages($(div), $(object).parent());
                  var zoom = V.Utils.getZoomFromStyle($(object).attr("style"));
                  if(zoom != 1) {
                    element.zoomInStyle = V.Utils.getZoomInStyle(zoom)
                  }
                  element.subtype = V.Object.getObjectInfo(myObject).type
                }else {
                  if(element.type === V.Constant.QUIZ) {
                    var quizJSON = VISH.Editor.Quiz.save(div);
                    element.quiztype = quizJSON.quizType;
                    element.selfA = quizJSON.selfA;
                    element.question = quizJSON.question;
                    if(typeof quizJSON.choices != "undefined") {
                      element.choices = quizJSON.choices
                    }
                    if(typeof quizJSON.answer != "undefined") {
                      element.answer = quizJSON.answer
                    }
                    if(quizJSON.extras) {
                      element.extras = quizJSON.extras
                    }
                    slide.containsQuiz = true
                  }else {
                    if(element.type === V.Constant.SNAPSHOT) {
                      var snapshotWrapper = $(div).find(".snapshot_wrapper");
                      var snapshotIframe = $(snapshotWrapper).children()[0];
                      $(snapshotIframe).removeAttr("style");
                      element.body = V.Utils.getOuterHTML(snapshotIframe);
                      element.style = V.Editor.Utils.getStylesInPercentages($(div), snapshotWrapper);
                      var scrollTopAttr = $(snapshotWrapper).attr("scrollTop");
                      if(typeof scrollTopAttr !== "undefined") {
                        element.scrollTop = scrollTopAttr;
                        element.scrollLeft = $(snapshotWrapper).attr("scrollLeft")
                      }else {
                        element.scrollTop = $(snapshotWrapper).scrollTop();
                        element.scrollLeft = $(snapshotWrapper).scrollLeft()
                      }
                      element.subtype = V.Constant.MEDIA.WEB
                    }else {
                      if(typeof element.type == "undefined") {
                      }
                    }
                  }
                }
              }
            }
          }
        }
        slide.elements.push(element)
      }
    });
    if(slide.containsQuiz) {
      var quizSlide = $.extend(true, {}, slide);
      quizSlide.type = V.Constant.QUIZ_SIMPLE;
      var quizPresentation = {};
      quizPresentation.title = presentation.title;
      quizPresentation.description = presentation.description;
      quizPresentation.author = presentation.author;
      quizPresentation.type = V.Constant.QUIZ_SIMPLE;
      quizPresentation.theme = presentation.theme;
      quizPresentation.slides = [quizSlide];
      for(var k = 0;k < slide.elements.length;k++) {
        if(slide.elements[k].type === V.Constant.QUIZ) {
          slide.elements[k].quiz_simple_json = quizPresentation
        }
      }
    }
    V.Utils.removeTempShown(slideDOM);
    return slide
  };
  var sendPresentation = function(presentation, order, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      if(order != "unpublish") {
        lastStoredPresentationStringify = JSON.stringify(presentation);
        if(order == "publish") {
          _isDraft = false
        }
      }else {
        _isDraft = true
      }
      setTimeout(function() {
        successCallback()
      }, 5E3);
      return
    }
    var createNewPresentation = typeof lastStoredPresentationStringify == "undefined" && !initialPresentation;
    var send_type;
    if(createNewPresentation) {
      send_type = "POST"
    }else {
      send_type = "PUT"
    }
    var params = {};
    if(typeof V.User.getToken() != "undefined") {
      params["authenticity_token"] = V.User.getToken()
    }
    if(order != "unpublish") {
      var jsonPresentation = JSON.stringify(presentation);
      params["excursion[json]"] = jsonPresentation
    }
    if(order === "publish") {
      params.draft = false
    }else {
      if(order === "unpublish") {
        params.draft = true
      }else {
        if(order === "save") {
          if(createNewPresentation) {
            params.draft = true
          }
        }
      }
    }
    $.ajax({type:send_type, url:V.UploadPresentationPath, data:params, success:function(data) {
      if(order != "unpublish") {
        lastStoredPresentationStringify = jsonPresentation;
        if(createNewPresentation && (typeof data != "undefined" && data.uploadPath)) {
          V.UploadPresentationPath = V.Utils.checkUrlProtocol(data.uploadPath);
          if(V.Status.getDevice().features.historypushState) {
            if(data.editPath) {
              window.top.history.replaceState("", "", V.Utils.checkUrlProtocol(data.editPath))
            }
          }
          if(data.id) {
            V.PresentationId = data.id
          }
        }
        if(order == "publish") {
          _isDraft = false
        }
      }else {
        _isDraft = true;
        if(typeof data != "undefined" && data.exitPath) {
          V.exitPath = V.Utils.checkUrlProtocol(data.exitPath)
        }
      }
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(xhr, error) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var getPresentationId = function() {
    if(typeof V.PresentationId != "undefined") {
      return V.PresentationId
    }
    var draftPresentation = V.Editor.getDraftPresentation();
    if(typeof draftPresentation != "undefined" && (typeof draftPresentation["vishMetadata"] != "undefined" && typeof draftPresentation["vishMetadata"]["id"] != "undefined")) {
      V.PresentationId = draftPresentation["vishMetadata"]["id"]
    }
    return V.PresentationId
  };
  var notifyTeacher = function() {
    if(typeof V.NotifyTeacherPath != "string") {
      return
    }
    var id = getPresentationId();
    var data = {"authenticity_token":V.User.getToken(), "user_data":V.User.getUser(), "excursion_data":id};
    $.ajax({type:"POST", url:V.NotifyTeacherPath, data:data, success:function(data) {
      var publish_button = $("#toolbar_publish_wrapper");
      publish_button.addClass("menu_item_disabled");
      publish_button.children("p").html(V.I18n.getTrans("i.notified_teacher"));
      publish_button.find("i").removeClass().addClass("icon-button icon-exclamation")
    }, error:function(data) {
      console.log("not done")
    }})
  };
  var getOptions = function() {
    return initOptions
  };
  var getTemplate = function(area) {
    if(area) {
      return area.parent().attr("template")
    }else {
      if(getCurrentArea()) {
        return getCurrentArea().parent().attr("template")
      }
    }
    return null
  };
  var getCurrentArea = function() {
    if(currentZone) {
      return currentZone
    }
    return null
  };
  var setCurrentArea = function(area) {
    if($(area).attr("id") != $(currentZone).attr("id")) {
      lastZone = currentZone;
      currentZone = area
    }
  };
  var getLastArea = function() {
    if(lastZone) {
      return lastZone
    }
    return null
  };
  var getCurrentContainer = function() {
    return currentContainer
  };
  var setCurrentContainer = function(container) {
    currentContainer = container
  };
  var getDraftPresentation = function() {
    return draftPresentation
  };
  var hasInitialPresentation = function() {
    return initialPresentation
  };
  var isZoneEmpty = function(zone) {
    return zone && $(zone).find(".delete_content").length === 0
  };
  var getContentAddMode = function() {
    return contentAddModeForSlides
  };
  var setContentAddMode = function(mode) {
    contentAddModeForSlides = mode
  };
  var getPresentationType = function() {
    if(!draftPresentation || !draftPresentation.type) {
      return V.Constant.PRESENTATION
    }
    return draftPresentation.type
  };
  var isPresentationDraft = function() {
    return _isDraft
  };
  var _initPresentationDraft = function() {
    if(initialPresentation) {
      if(typeof initOptions.draft === "boolean") {
        return initOptions.draft
      }else {
        if(typeof initOptions.draft === "string") {
          return!(initOptions.draft == "false")
        }else {
          return true
        }
      }
    }else {
      return true
    }
  };
  var hasBeenPublished = function() {
    if(initialPresentation) {
      if(!isPresentationDraft()) {
        return true
      }else {
        if(typeof draftPresentation["vishMetadata"] == "object" && draftPresentation["vishMetadata"]["released"] === "true") {
          return true
        }
      }
    }else {
      return false
    }
  };
  var hasBeenSaved = function() {
    return!(typeof lastStoredPresentationStringify == "undefined" && !initialPresentation)
  };
  var hasPresentationChanged = function() {
    try {
      var objectToCompare;
      if(typeof lastStoredPresentationStringify != "undefined") {
        objectToCompare = lastStoredPresentationStringify
      }else {
        if(typeof draftPresentation != "undefined") {
          objectToCompare = JSON.stringify(draftPresentation)
        }else {
          return true
        }
      }
      var currentPresentation = V.Editor.savePresentation();
      return!(objectToCompare === JSON.stringify(currentPresentation))
    }catch(e) {
      return true
    }
  };
  return{init:init, getOptions:getOptions, getTemplate:getTemplate, getCurrentArea:getCurrentArea, getLastArea:getLastArea, cleanArea:cleanArea, getCurrentContainer:getCurrentContainer, setCurrentContainer:setCurrentContainer, getPresentationType:getPresentationType, getDraftPresentation:getDraftPresentation, getPresentationId:getPresentationId, isPresentationDraft:isPresentationDraft, hasBeenPublished:hasBeenPublished, hasBeenSaved:hasBeenSaved, getContentAddMode:getContentAddMode, setContentAddMode:setContentAddMode, 
  hasInitialPresentation:hasInitialPresentation, isZoneEmpty:isZoneEmpty, savePresentation:savePresentation, sendPresentation:sendPresentation, notifyTeacher:notifyTeacher, setCurrentArea:setCurrentArea, selectArea:selectArea, onSlideEnterEditor:onSlideEnterEditor, onSlideLeaveEditor:onSlideLeaveEditor, onSlideThumbClicked:onSlideThumbClicked, onAnimationThumbClicked:onAnimationThumbClicked, onEditableClicked:onEditableClicked, onSelectableClicked:onSelectableClicked, onNoSelectableClicked:onNoSelectableClicked, 
  onDeleteItemClicked:onDeleteItemClicked, onDeleteSlideClicked:onDeleteSlideClicked, addDeleteButton:addDeleteButton, hasPresentationChanged:hasPresentationChanged}
}(VISH, jQuery);
VISH.Editor.Utils = function(V, $, undefined) {
  var setStyleInPixels = function(style, area) {
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("width") === -1 && property.indexOf("height") === -1) {
        filterStyle = filterStyle + property + "; "
      }
    });
    var dimensions = V.Utils.getPixelDimensionsFromStyle(style, area);
    if(dimensions && dimensions[0]) {
      filterStyle = filterStyle + "width: " + dimensions[0] + "px; ";
      if(dimensions[1]) {
        filterStyle = filterStyle + "height: " + dimensions[1] + "px; "
      }
    }
    return filterStyle
  };
  var addZoomToStyle = function(style, zoom) {
    if(!style) {
      return null
    }
    var filterStyle = "";
    $.each(style.split(";"), function(index, property) {
      if(property.indexOf("-ms-transform") === -1 && (property.indexOf("-moz-transform") === -1 && (property.indexOf("-o-transform") === -1 && (property.indexOf("-webkit-transform") === -1 && (property.indexOf("-moz-transform-origin") === -1 && (property.indexOf("-webkit-transform-origin") === -1 && (property.indexOf("-o-transform-origin") === -1 && property.indexOf("-ms-transform-origin") === -1))))))) {
        filterStyle = filterStyle + property + "; "
      }
    });
    if(zoom) {
      filterStyle = filterStyle + "-ms-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-ms-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-moz-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-moz-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-o-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-o-transform-origin: 0 0; ";
      filterStyle = filterStyle + "-webkit-transform: scale(" + zoom + "); ";
      filterStyle = filterStyle + "-webkit-transform-origin: 0 0; "
    }
    return filterStyle
  };
  var getStylesInPercentages = function(parent, element) {
    var WidthPercent = element.width() * 100 / parent.width();
    var HeightPercent = element.height() * 100 / parent.height();
    var TopPercent = element.position().top * 100 / parent.height();
    var LeftPercent = element.position().left * 100 / parent.width();
    return"position: relative; width:" + WidthPercent + "%; height:" + HeightPercent + "%; top:" + TopPercent + "%; left:" + LeftPercent + "%;"
  };
  var refreshDraggables = function(slide) {
    $(slide).find("[draggable='true']").draggable({cursor:"move", stop:function() {
      $(this).parent().click()
    }})
  };
  var refreshHTML5EVideo = function(slide) {
    if($(slide).attr("type") == "enrichedvideo" && $(slide).find("video[videotype=HTML5_VIDEO]")) {
      V.Editor.EVideo.onHTML5VideoReady($(slide).find(".evideoBody video")[0])
    }
  };
  var generateTable = function(options) {
    var title = "Unknown";
    var author = "";
    var description = "";
    var tableClass = "metadata";
    if(options) {
      if(options.title) {
        title = options.title
      }
      if(options.author) {
        author = options.author
      }
      if(options.description) {
        description = options.description
      }
      if(options.tableClass) {
        tableClass = options.tableClass
      }
      if(options.url) {
        title = "<a title='view resource' class='metadata_link' target='_blank' href='" + options.url + "'>" + title + "</a>"
      }
    }
    return'<table class="' + tableClass + '">' + '<tr class="even">' + '<td class="title header_left">' + V.I18n.getTrans("i.Title") + "</td>" + '<td class="title header_right"><div class="height_wrapper">' + title + "</div></td>" + "</tr>" + '<tr class="odd">' + '<td class="title">' + V.I18n.getTrans("i.Author") + "</td>" + '<td class="info"><div class="height_wrapper">' + author + "</div></td>" + "</tr>" + '<tr class="even">' + '<td colspan="2" class="title_description">' + V.I18n.getTrans("i.Description") + 
    "</td>" + "</tr>" + '<tr class="odd">' + '<td colspan="2" class="info_description"><div class="height_wrapper_description">' + description + "</div></td>" + "</tr>" + "</table>"
  };
  var convertToTagsArray = function(tags) {
    var tagsArray = [];
    if(!tags || tags.length == 0) {
      return tagsArray
    }
    $.each(tags, function(index, tag) {
      tagsArray.push(tag.value)
    });
    return tagsArray
  };
  var autocompleteUrls = function(input) {
    var http_urls_pattern = /(^http(s)?:\/\/)/g;
    var anchor_urls_pattern = /(^#)/g;
    var objectInfo = V.Object.getObjectInfo(input);
    if(objectInfo.wrapper == null && (input.match(http_urls_pattern) == null && input.match(anchor_urls_pattern) == null)) {
      return"http://" + input
    }else {
      return input
    }
  };
  var filterFilePath = function(path) {
    return path.replace("C:\\fakepath\\", "")
  };
  var replaceIdsForSlide = function(slide) {
    var slideId = V.Utils.getId("article");
    $(slide).attr("id", slideId);
    var slideType = V.Slides.getSlideType(slide);
    switch(slideType) {
      case V.Constant.STANDARD:
        slide = _replaceIdsForStandardSlide(slide, slideId);
        break;
      case V.Constant.FLASHCARD:
        slide = _replaceIdsForFlashcardSlide(slide, slideId);
        break;
      case V.Constant.VTOUR:
        slide = _replaceIdsForVirtualTourSlide(slide, slideId);
        break;
      default:
        return
    }
    return slide
  };
  var _replaceIdsForStandardSlide = function(slide, slideId) {
    $(slide).children("div[id][areaid]").each(function(index, zone) {
      zone = _replaceIdsForZone(zone, slideId)
    });
    return slide
  };
  var _replaceIdsForFlashcardSlide = function(flashcard, flashcardId) {
    var pois = $(flashcard).find("div.fc_poi");
    $(pois).each(function(index, poi) {
      var poiId = V.Utils.getId(flashcardId + "_poi");
      $(poi).attr("id", poiId)
    });
    var subslides = $(flashcard).find(".subslides > article.subslide");
    $(subslides).each(function(index, subSlide) {
      subSlide = _replaceIdsForSubSlide(subSlide, flashcardId)
    });
    return flashcard
  };
  var _replaceIdsForVirtualTourSlide = function(vt, vtId) {
    var canvas = $(vt).find(".map_canvas");
    var canvasId = V.Utils.getId(vtId + "_canvas");
    $(canvas).attr("id", canvasId);
    var subslides = $(vt).find(".subslides > article.subslide");
    $(subslides).each(function(index, subSlide) {
      subSlide = _replaceIdsForSubSlide(subSlide, vtId)
    });
    return vt
  };
  var _replaceIdsForSubSlide = function(subSlide, parentId) {
    var slideId = V.Utils.getId(parentId + "_article");
    $(subSlide).attr("id", slideId);
    $(subSlide).children(".close_subslide").attr("id", "close" + slideId);
    var zones = $(subSlide).children("div[id]").not(".close_subslide");
    $(zones).each(function(index, zone) {
      zone = _replaceIdsForZone(zone, slideId)
    })
  };
  var _replaceIdsForZone = function(zone, slideId) {
    var zoneId = V.Utils.getId(slideId + "_zone");
    $(zone).attr("id", zoneId);
    $(zone).find("[id]").each(function(index, el) {
      el = _replaceIdsForEl(el, zoneId)
    });
    return zone
  };
  var _replaceIdsForEl = function(el, zoneId) {
    var elName = _getNameOfEl(el);
    var elId = V.Utils.getId(zoneId + "_" + elName);
    $(el).attr("id", elId);
    return el
  };
  var _getNameOfEl = function(el) {
    var elName = $($(el).attr("id").split("_")).last()[0];
    if(elName.length > 1) {
      return elName.substring(0, elName.length - 1)
    }else {
      return elName
    }
  };
  var replaceIdsForSlideJSON = function(slide, forceId) {
    var slideType = slide.type;
    var slideId;
    if(forceId) {
      slideId = forceId
    }else {
      slideId = V.Utils.getId("article")
    }
    if(V.Slideset.isSlideset(slideType)) {
      slide = _replaceIdsForSlidesetJSON(slide, slideId)
    }else {
      slide = _replaceIdsForStandardSlideJSON(slide, slideId)
    }
    return slide
  };
  var _replaceIdsForStandardSlideJSON = function(slide, slideId) {
    var s = jQuery.extend(true, {}, slide);
    var oldId = s.id;
    s.id = slideId;
    var eL = s.elements.length;
    for(var i = 0;i < eL;i++) {
      var el = s.elements[i];
      if(el.id.match(new RegExp("^" + oldId, "g")) != null) {
        el.id = el.id.replace(oldId, s.id)
      }else {
        return null
      }
    }
    return s
  };
  var _replaceIdsForSlidesetJSON = function(slidesetJSON, slidesetId) {
    var newSubslideIds = {};
    var slideset = jQuery.extend(true, {}, slidesetJSON);
    slideset.id = slidesetId;
    var slidesetSlidesL = slideset.slides.length;
    for(var i = 0;i < slidesetSlidesL;i++) {
      var oldSubslideId = slideset.slides[i].id;
      slideset.slides[i] = _replaceIdsForStandardSlideJSON(slideset.slides[i], slideset.id + "_article" + (parseInt(i) + 1));
      if(slideset.slides[i] === null) {
        return null
      }
      newSubslideIds[oldSubslideId] = slideset.slides[i].id
    }
    var slidesetPoisL = slideset.pois.length;
    for(var j = 0;j < slidesetPoisL;j++) {
      slideset.pois[j].id = slideset.id + "_poi" + (parseInt(j) + 1);
      slideset.pois[j].slide_id = newSubslideIds[slideset.pois[j].slide_id]
    }
    return slideset
  };
  var loadTabTimer;
  var loadTab = function(tab_id) {
    $(".joyride-close-tip").click();
    $(".fancy_tab_content").hide();
    $("#" + tab_id + "_content").show();
    $(".fancy_tab").removeClass("fancy_selected");
    $("#" + tab_id).addClass("fancy_selected");
    $(".help_in_fancybox").not("#" + tab_id + "_help").hide();
    switch(tab_id) {
      case "tab_presentations_repo":
        V.Editor.Presentation.Repository.beforeLoadTab();
        break;
      case "tab_pic_thumbnails":
        V.Editor.Image.Thumbnails.beforeLoadTab();
        break;
      case "tab_pic_repo":
        V.Editor.Image.Repository.beforeLoadTab();
        break;
      case "tab_pic_flikr":
        V.Editor.Image.Flickr.beforeLoadTab();
        break;
      case "tab_pic_europeana":
        V.Editor.Image.Europeana.beforeLoadTab();
        break;
      case "tab_pic_lre":
        V.Editor.Image.LRE.beforeLoadTab();
        break;
      case "tab_video_repo":
        V.Editor.Video.Repository.beforeLoadTab();
        break;
      case "tab_video_youtube":
        V.Editor.Video.Youtube.beforeLoadTab();
        break;
      case "tab_audio_soundcloud":
        V.Editor.Audio.Soundcloud.beforeLoadTab();
        break;
      case "tab_object_repo":
        V.Editor.Object.Repository.beforeLoadTab();
        break;
      case "tab_object_lre":
        V.Editor.Object.LRE.beforeLoadTab();
        break;
      case "tab_live_resource":
        V.Editor.Object.Live.beforeLoadTab();
        break;
      default:
        break
    }
    $("#" + tab_id + "_help").show();
    if(typeof loadTabTimer != "undefined") {
      clearTimeout(loadTabTimer)
    }
    loadTabTimer = setTimeout(function() {
      if($("#" + tab_id + "_help").length > 0 && (!$("#" + tab_id + "_help").is(":visible") && $("#" + tab_id + "_content").is(":visible"))) {
        $("#" + tab_id + "_help").hide().show(1)
      }
    }, 0);
    switch(tab_id) {
      case "tab_slides":
        break;
      case "tab_presentations_repo":
        V.Editor.Presentation.Repository.onLoadTab();
        break;
      case "tab_pic_thumbnails":
        V.Editor.Image.Thumbnails.onLoadTab();
        break;
      case "tab_pic_from_url":
        V.Editor.Image.onLoadTab("url");
        break;
      case "tab_pic_upload":
        V.Editor.Image.onLoadTab("upload");
        break;
      case "tab_pic_repo":
        V.Editor.Image.Repository.onLoadTab();
        break;
      case "tab_pic_flikr":
        V.Editor.Image.Flickr.onLoadTab();
        break;
      case "tab_pic_europeana":
        V.Editor.Image.Europeana.onLoadTab();
        break;
      case "tab_pic_lre":
        V.Editor.Image.LRE.onLoadTab();
        break;
      case "tab_video_from_url":
        V.Editor.Video.onLoadTab();
        break;
      case "tab_video_repo":
        V.Editor.Video.Repository.onLoadTab();
        break;
      case "tab_video_youtube":
        V.Editor.Video.Youtube.onLoadTab();
        break;
      case "tab_object_from_url":
        V.Editor.Object.onLoadTab("url");
        break;
      case "tab_object_from_web":
        V.Editor.Object.Web.onLoadTab();
        break;
      case "tab_object_snapshot":
        V.Editor.Object.Snapshot.onLoadTab();
        break;
      case "tab_object_upload":
        V.Editor.Object.onLoadTab("upload");
        break;
      case "tab_object_repo":
        V.Editor.Object.Repository.onLoadTab();
        break;
      case "tab_object_lre":
        V.Editor.Object.LRE.onLoadTab();
        break;
      case "tab_live_resource":
        V.Editor.Object.Live.onLoadTab();
        break;
      case "tab_efile":
        V.Editor.Presentation.File.onLoadTab();
        break;
      case "tab_pdfex":
        V.Editor.PDFex.onLoadTab();
        break;
      case "tab_epackage":
        V.Editor.EPackage.onLoadTab();
        break;
      default:
        break
    }
    return false
  };
  var hideNonDefaultTabs = function() {
    $("div.fancy_tabs a.fancy_tab:not(.disabled)").show();
    $("a.venondefaulttab").hide()
  };
  var showErrorDialog = function(msg) {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = msg;
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var enableElementSettingsField = function(element, enable) {
    if(element instanceof Array) {
      for(var i = 0;i < element.length;i++) {
        enableElementSettingsField(element[i], enable)
      }
      return
    }
    if(enable) {
      $(element).parent().removeClass("disableSettingsField");
      $(element).removeAttr("disabled")
    }else {
      if($(element).is("input")) {
        if($(element).attr("type") === "checkbox") {
          var defaultCheckboxValue = $(element).attr("defaultvalue") === "true" ? true : false;
          $(element).prop("checked", defaultCheckboxValue)
        }
      }else {
        if($(element).is("select")) {
          var defaultSelectValue = $(element).find("option[selected='selected']").val();
          $(element).val(defaultSelectValue)
        }
      }
      $(element).parent().addClass("disableSettingsField");
      $(element).attr("disabled", "disabled")
    }
  };
  return{setStyleInPixels:setStyleInPixels, addZoomToStyle:addZoomToStyle, getStylesInPercentages:getStylesInPercentages, refreshDraggables:refreshDraggables, refreshHTML5EVideo:refreshHTML5EVideo, replaceIdsForSlide:replaceIdsForSlide, replaceIdsForSlideJSON:replaceIdsForSlideJSON, generateTable:generateTable, convertToTagsArray:convertToTagsArray, autocompleteUrls:autocompleteUrls, filterFilePath:filterFilePath, loadTab:loadTab, hideNonDefaultTabs:hideNonDefaultTabs, showErrorDialog:showErrorDialog, 
  enableElementSettingsField:enableElementSettingsField}
}(VISH, jQuery);
VISH.Editor.Text = function(V, $, undefined) {
  var initialized = false;
  var _initializedCKEditorInstances = {};
  var init = function() {
    if(!initialized) {
      $(document).on("click", ".textthumb", launchTextEditor);
      CKEDITOR.on("dialogDefinition", function(ev) {
        var dialogName = ev.data.name;
        var dialogDefinition = ev.data.definition;
        switch(dialogName) {
          case "link":
            dialogDefinition.getContents("info").remove("linkType");
            var protocols = dialogDefinition.getContents("info").get("protocol").items;
            protocols.splice(3, 1);
            protocols.splice(2, 1);
            dialogDefinition.removeContents("advanced");
            var targetTab = dialogDefinition.getContents("target");
            var targetField = targetTab.get("linkTargetType");
            targetField["default"] = "_blank";
            targetField.items.splice(6, 1);
            targetField.items.splice(4, 1);
            targetField.items.splice(1, 1);
            targetField.items.splice(0, 1);
            break;
          case "table":
            dialogDefinition.removeContents("advanced");
            var info = dialogDefinition.getContents("info");
            var alignment = info.get("cmbAlign");
            alignment.items.splice(0, 1);
            alignment["default"] = "center";
            info.remove("selHeaders");
            break;
          case "image":
            dialogDefinition.removeContents("advanced");
            var linkTab = dialogDefinition.getContents("Link");
            var targetField = linkTab.get("cmbTarget");
            targetField["default"] = "_blank";
            targetField.items.splice(4, 1);
            targetField.items.splice(2, 1);
            targetField.items.splice(0, 1);
            break;
          case "MediaEmbedDialog":
            break
        }
      });
      initialized = true
    }
  };
  var launchTextEditor = function(event, area, initial_text, options) {
    init();
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = $(this).parents(".selectable")
    }
    var isQuiz = $("div[type='quiz']").has(current_area).length > 0;
    var isTemplateArea = $(current_area).attr("areaid") !== undefined;
    if(isTemplateArea) {
      current_area.attr("type", "text")
    }
    var slide = $("article").has(current_area);
    var subslide = $("article > article").has(current_area);
    if(typeof $(current_area).attr("id") == "undefined") {
      $(current_area).attr("id", V.Utils.getId("TmpShownId"))
    }
    var disableTmpShown = options && options.disableTmpShown;
    if(!disableTmpShown) {
      V.Utils.addTempShown(current_area)
    }
    var currentAreaHeight = $(current_area).height();
    var currentAreaWidth = $(current_area).width();
    if(!disableTmpShown) {
      V.Utils.removeTempShown(current_area)
    }
    var wysiwygContainerId = V.Utils.getId();
    var wysiwygContainer = $("<div id='" + wysiwygContainerId + "' class='wysiwygTextArea'></div>");
    $(wysiwygContainer).attr("style", "width: 100%; height: 100%");
    $(current_area).append(wysiwygContainer);
    var config = {};
    config.toolbar = "Full";
    config.toolbar_Full = [{name:"first", items:["Bold", "Italic", "Underline", "-", "Subscript", "Superscript", "Font", "FontSize", "TextColor", "BGColor"]}, "/", {name:"lists", items:["NumberedList", "BulletedList", "Table"]}, {name:"alignment", items:["JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyBlock"]}, {name:"link", items:["Link"]}, {name:"Objects", items:["Image", "MediaEmbed"]}, {name:"symbols", items:["SpecialChar"]}];
    config.sharedSpaces = {top:"toolbar_text"};
    config.toolbarCanCollapse = false;
    config.resize_enabled = false;
    config.removePlugins = "elementspath";
    config.extraPlugins = "tableresize,autogrow,specialchar,mediaembed";
    if(options && options.autogrow) {
      config.autoGrow_minHeight = 34;
      config.autoGrow_maxHeight = 800
    }
    config.specialChars = [];
    config.specialChars = config.specialChars.concat([["&alpha;", "Alpha"]], [["&beta;", "Beta"]], [["&gamma;", "Gamma"]], [["&delta;", "Delta"]], [["&epsilon;", "Epsilon"]], [["&zeta;", "Zeta"]], [["&eta;", "Eta"]], [["&theta;", "Theta"]], [["&iota;", "Iota"]], [["&kappa;", "Kappa"]], [["&lambda;", "Lambda"]], [["&mu;", "Mu"]], [["&nu;", "Nu"]], [["&xi;", "Xi"]], [["&omicron;", "Omicron"]], [["&pi;", "Pi"]], [["&rho;", "Rho"]], [["&sigma;", "Sigma"]], [["&tau;", "Tau"]], [["&upsilon;", "Upsilon"]], 
    [["&phi;", "Phi"]], [["&chi;", "Chi"]], [["&psi;", "Psi"]], [["&omega;", "Omega"]], [["&divide;", ""]], [["&radic;", ""]], [["&bull;", ""]], [["&middot;", ""]], [["&plusmn;", ""]], [["&frac14;", ""]], [["&frac12;", ""]], [["&frac34;", ""]], [["&permil;", ""]], [["&weierp;", ""]], [["&image;", ""]], [["&real;", ""]], [["&forall;", ""]], [["&part;", ""]], [["&exist;", ""]], [["&empty;", ""]], [["&nabla;", ""]], [["&isin;", ""]], [["&notin;", ""]], [["&ni;", ""]], [["&prod;", ""]], [["&sum;", ""]], 
    [["&minus;", ""]], [["&lowast;", ""]], [["&prop;", ""]], [["&infin;", ""]], [["&ang;", ""]], [["&and;", ""]], [["&or;", ""]], [["&cap;", ""]], [["&cup;", ""]], [["&int;", ""]], [["&cong;", ""]], [["&asymp;", ""]], [["&ne;", ""]], [["&equiv;", ""]], [["&le;", ""]], [["&ge;", ""]], [["&sub;", ""]], [["&sup;", ""]], [["&nsub;", ""]], [["&sube;", ""]], [["&supe;", ""]], [["&oplus;", ""]], [["&otimes;", ""]], [["&perp;", ""]], [["&lang;", ""]], [["&rang;", ""]], [["&lceil;", ""]], [["&rceil;", ""]], 
    [["&lfloor;", ""]], [["&rfloor;", ""]], [["&fnof;", ""]], [["&lsquo;", ""]], [["&rsquo;", ""]], [["&ldquo;", ""]], [["&rdquo;", ""]], [["&larr;", ""]], [["&uarr;", ""]], [["&darr;", ""]], [["&rarr;", ""]], [["&harr;", ""]], [["&crarr;", ""]], [["&lArr;", ""]], [["&uArr;", ""]], [["&dArr;", ""]], [["&rArr;", ""]], [["&hArr;", ""]], [["&euro;", "Euro"]], [["&cent;", "Cent"]], [["&pound;", "Pound"]], [["&yen;", ""]], [["&curren;", ""]], [["&brvbar;", ""]], [["&sect;", ""]], [["&copy;", ""]], [["&reg;", 
    ""]], [["&ordf;", ""]], [["&ordm;", ""]], [["&deg;", ""]], [["&laquo;", ""]], [["&raquo;", ""]], [["&not;", ""]], [["&para;", ""]], [["&loz;", ""]], [["&spades;", ""]], [["&clubs;", ""]], [["&hearts;", ""]], [["&diams;", ""]], [["&dagger;", ""]]);
    config.width = "100%";
    config.height = currentAreaHeight;
    config.fontSize_defaultLabel = "12";
    var ckeditorBasePath = CKEDITOR.basePath.substr(0, CKEDITOR.basePath.indexOf("editor/"));
    config.skin = "vEditor," + ckeditorBasePath + "editor/skins/vEditor/";
    var newInstance = !(typeof initial_text === "string") || options && options.forceNew;
    if(newInstance) {
      var defaultFontSize = 12;
      var defaultAlignment = "left";
      switch($(current_area).attr("size")) {
        case V.Constant.EXTRA_SMALL:
          defaultFontSize = 18;
          break;
        case V.Constant.SMALL:
          defaultFontSize = 18;
          break;
        case V.Constant.MEDIUM:
          defaultFontSize = 26;
          break;
        case V.Constant.LARGE:
          defaultFontSize = 36;
          break;
        default:
          break
      }
      var areaId = $(current_area).attr("areaid");
      if(areaId) {
        var isCircleArea = $(current_area).attr("areaid").indexOf("circle") !== -1;
        if(isCircleArea) {
          defaultAlignment = "center"
        }
      }
      var initialTextColor = "color:#" + V.Editor.Themes.Presentation.getCurrentTheme().color;
      var blankTextColor = initialTextColor;
      if(options) {
        if(typeof options.fontSize == "number") {
          defaultFontSize = options.fontSize
        }
        if(options.placeholder === true) {
          initialTextColor = "color:#ccc"
        }
      }
      if(isTemplateArea || (typeof initial_text != "string" || initial_text === "")) {
        initial_text = "&shy"
      }
      initial_text = "<p style='text-align:" + defaultAlignment + ";'><span autoColor='true' style='" + initialTextColor + "'><span style='font-size:" + defaultFontSize + "px;'>" + initial_text + "</span></span></p>";
      initial_text_blank = "<p style='text-align:" + defaultAlignment + ";'><span autoColor='true' style='" + blankTextColor + "'><span style='font-size:" + defaultFontSize + "px;'>" + "&shy" + "</span></span></p>"
    }
    var ckeditor = CKEDITOR.appendTo(wysiwygContainerId, config);
    var myWidth = currentAreaWidth;
    var myHeight = currentAreaHeight;
    if(!newInstance) {
      if(!disableTmpShown) {
        V.Utils.addTempShown([slide, subslide, current_area])
      }
      setTimeout(function() {
        if(_initializedCKEditorInstances[ckeditor.name] !== true) {
          _initializedCKEditorInstances[ckeditor.name] = false;
          if(!disableTmpShown) {
            V.Utils.removeTempShown([slide, subslide, current_area])
          }
        }else {
          _initializedCKEditorInstances[ckeditor.name] = undefined
        }
      }, 6E3)
    }
    ckeditor.on("instanceReady", function() {
      if(initial_text) {
        ckeditor.setData(initial_text, function() {
          if(isQuiz) {
            if(!newInstance) {
              setTimeout(function() {
                if(!disableTmpShown) {
                  V.Utils.addTempShown([slide, subslide, current_area])
                }
                var iframeContent = _getCKEditorIframeContentFromInstance(ckeditor);
                var newMyHeight = $(iframeContent).find("html").height();
                if(newMyHeight > myHeight) {
                  ckeditor.resize(myWidth, newMyHeight)
                }
                if(!disableTmpShown) {
                  V.Utils.removeTempShown([slide, subslide, current_area])
                }
              }, 1E3)
            }
          }else {
          }
          _fixCKEDITORBug(ckeditor);
          if(newInstance) {
            if(isTemplateArea || options && options.focus) {
              ckeditor.focus()
            }
          }
          if(options && typeof options.callback == "function") {
            options.callback()
          }
        })
      }
      if(!newInstance) {
        if(typeof _initializedCKEditorInstances[ckeditor.name] == "undefined") {
          _initializedCKEditorInstances[ckeditor.name] = true;
          if(!disableTmpShown) {
            V.Utils.removeTempShown([slide, subslide, current_area])
          }
        }else {
          _initializedCKEditorInstances[ckeditor.name] = undefined
        }
      }
      if(options && (typeof options.onKeyup === "function" && options.placeholder != true)) {
        ckeditor.document.on("keyup", function(event) {
          options.onKeyup(current_area, ckeditor, event)
        })
      }
      if(!initial_text && (options && typeof options.callback == "function")) {
        options.callback()
      }
    });
    ckeditor.on("resize", function(event) {
    });
    ckeditor.on("focus", function(event) {
      V.Status.setCKEditorInstanceFocused(true);
      if(options && options.placeholder === true) {
        var a = $(initial_text).text().replace(/\s+/g, "");
        var b = $(event.editor.getData()).text().replace(/\s+/g, "");
        if(a == b) {
          setTimeout(function() {
            event.editor.setData(initial_text_blank, function() {
              if(options && typeof options.onKeyup === "function") {
                ckeditor.document.on("keyup", function(event) {
                  options.onKeyup(current_area, ckeditor, event)
                })
              }
            });
            event.editor.focus()
          }, 20)
        }
      }
      var area = getZoneForCKContainer(event.editor.container.$);
      V.Editor.selectArea(area)
    });
    ckeditor.on("blur", function(event) {
      V.Status.setCKEditorInstanceFocused(false)
    });
    ckeditor.getPlainText = _getPlainText;
    if(isTemplateArea) {
      V.Editor.addDeleteButton(current_area)
    }
  };
  var getCKEditorFromZone = function(zone) {
    if(!zone || (typeof CKEDITOR === "undefined" || typeof CKEDITOR.instances === "undefined")) {
      return null
    }
    var CKEditorInstance = null;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      var CKzone = getZoneForCKContainer(CKinstance.container.$);
      if($(CKzone).attr("id") === $(zone).attr("id")) {
        CKEditorInstance = CKinstance;
        return
      }
    });
    return CKEditorInstance
  };
  var getZoneForCKContainer = function(container) {
    var area;
    area = $("div[type='text']").has(container);
    if(area.length === 0) {
      area = $("div[type='quiz']").has(container)
    }
    return area
  };
  var getCKEditorIframeContentFromZone = function(zone) {
    var editor = getCKEditorFromZone(zone);
    if(!editor) {
      return null
    }
    return _getCKEditorIframeContentFromInstance(editor)
  };
  var _getCKEditorIframeContentFromInstance = function(editor) {
    var iframe = $(document.getElementById("cke_contents_" + editor.name)).find("iframe")[0];
    return $(iframe).contents()[0]
  };
  var getCKEditorFromTextArea = function(textArea) {
    if(!textArea || (typeof CKEDITOR === "undefined" || typeof CKEDITOR.instances === "undefined")) {
      return null
    }
    if(!$(textArea).hasClass(".cke_skin_vEditor")) {
      textArea = $(textArea).find(".cke_skin_vEditor");
      if(textArea.length > 0) {
        textArea = textArea[0]
      }
    }
    var CKEditorInstance = null;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      if(textArea === CKinstance.container.$) {
        CKEditorInstance = CKinstance;
        return
      }
    });
    return CKEditorInstance
  };
  var _getPlainText = function() {
    var _plainText = "";
    var validIndex = 0;
    $(this.getSnapshot()).each(function(index, p) {
      if(p.tagName == "SCRIPT") {
        return
      }
      if(validIndex != 0) {
        _plainText = _plainText + "\n"
      }
      _plainText = _plainText + $(p).text();
      validIndex += 1
    });
    return _plainText
  };
  var _fixCKEDITORBug = function(editor) {
    if(CKEDITOR.env.webkit) {
      var iframe = $(document.getElementById("cke_contents_" + editor.name)).find("iframe")[0];
      iframe.style.display = "none";
      iframe.style.display = "block"
    }
  };
  var refreshAutoColors = function() {
    var currentColor = "color:#" + V.Editor.Themes.Presentation.getCurrentTheme().color;
    jQuery.each(CKEDITOR.instances, function(name, CKinstance) {
      var iframe = $($(document.getElementById("cke_contents_" + CKinstance.name)).find("iframe")[0]).contents()[0];
      var spans = $(iframe).find("span[autocolor][style]");
      jQuery.each(spans, function(name, span) {
        $(span).attr("style", currentColor + ";")
      })
    })
  };
  return{init:init, launchTextEditor:launchTextEditor, getCKEditorFromZone:getCKEditorFromZone, getCKEditorIframeContentFromZone:getCKEditorIframeContentFromZone, getCKEditorFromTextArea:getCKEditorFromTextArea, refreshAutoColors:refreshAutoColors}
}(VISH, jQuery);
VISH.Editor.Video = function(V, $, undefined) {
  var contentToAdd = null;
  var contentAddMode = V.Constant.NONE;
  var urlDivId = "tab_video_from_url_content";
  var init = function() {
    V.Editor.Video.HTML5.init();
    V.Editor.Video.Repository.init();
    V.Editor.Video.Youtube.init();
    var urlInput = $("#" + urlDivId).find("input");
    $("#tab_video_from_url_content .previewButton").click(function(event) {
      if(V.Police.validateObject($(urlInput).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($(urlInput).val());
        V.Editor.Object.drawPreview("tab_video_from_url_content", contentToAdd)
      }else {
        contentToAdd = null
      }
    })
  };
  var onLoadTab = function(tab) {
    $("#tab_video_from_url_content").find("input").val("");
    V.Editor.Object.resetPreview("tab_video_from_url_content")
  };
  var addContent = function(content, options) {
    if(content) {
      contentToAdd = content
    }
    switch(contentAddMode) {
      case V.Constant.EVIDEO:
        V.Editor.EVideo.onVideoSelected(contentToAdd);
        break;
      default:
        V.Editor.Object.drawPreviewObject(contentToAdd)
    }
    contentAddMode = V.Constant.NONE
  };
  var getAddContentMode = function() {
    return contentAddMode
  };
  var setAddContentMode = function(mode) {
    V.Editor.Utils.hideNonDefaultTabs();
    switch(mode) {
      case V.Constant.NONE:
        break;
      case V.Constant.EVIDEO:
        $("#tab_audio_soundcloud").hide();
        break
    }
    contentAddMode = mode
  };
  var getDefaultTab = function() {
    var defaultTab = "tab_video_from_url";
    if(V.Configuration.getConfiguration()["Youtube"]) {
      defaultTab = "tab_video_youtube"
    }
    return defaultTab
  };
  return{init:init, onLoadTab:onLoadTab, addContent:addContent, getAddContentMode:getAddContentMode, setAddContentMode:setAddContentMode, getDefaultTab:getDefaultTab}
}(VISH, jQuery);
VISH.Editor.Audio = function(V, $, undefined) {
  var init = function() {
    V.Editor.Audio.HTML5.init();
    V.Editor.Audio.Soundcloud.init()
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.Image = function(V, $, undefined) {
  var contentToAdd = null;
  var contentAddMode = V.Constant.NONE;
  var uploadDivId = "tab_pic_upload_content";
  var urlDivId = "tab_pic_from_url_content";
  var urlInputId = "picture_url";
  var init = function() {
    V.Editor.Image.Flickr.init();
    VISH.Editor.Image.Europeana.init();
    V.Editor.Image.Repository.init();
    V.Editor.Image.LRE.init();
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = V.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " .upload_file_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + V.User.getName() + " via ViSH Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(V.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
          if(contentAddMode == V.Constant.THUMBNAIL) {
            $("#" + uploadDivId + " input[name='preferred_conversion']").val("avatar")
          }else {
            $("#" + uploadDivId + " input[name='preferred_conversion']").val("")
          }
          $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadImagePath);
          var tagList = $("#" + uploadDivId + " .tagList");
          $("#" + uploadDivId + " input[name='document[tag_list]']").val(V.Editor.Utils.convertToTagsArray($(tagList).tagit("tags")));
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      processResponse(xhr.responseText);
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, error:function(error) {
      V.Debugging.log("Upload error");
      V.Debugging.log(error)
    }})
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    V.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    V.Editor.Object.resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList)[0].children.length !== 0) {
      $(tagList).tagit("reset")
    }
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      var config = V.Configuration.getConfiguration();
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:config.tagsSettings.maxLength, maxTags:config.tagsSettings.maxTags, triggerKeys:config.tagsSettings.triggerKeys, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(V.Police.validateObject(jsonResponse.src)[0]) {
          V.Editor.Object.drawPreview(uploadDivId, jsonResponse.src);
          contentToAdd = jsonResponse.src
        }
      }
    }catch(e) {
    }
  };
  var addContent = function(content, options) {
    if(content) {
      contentToAdd = content
    }
    switch(contentAddMode) {
      case V.Constant.FLASHCARD:
        V.Editor.Flashcard.onBackgroundSelected(contentToAdd);
        break;
      case V.Constant.THUMBNAIL:
        V.Editor.Settings.onThumbnailSelected(contentToAdd);
        break;
      default:
        V.Editor.Object.drawPreviewObject(contentToAdd, {forceType:V.Constant.MEDIA.IMAGE})
    }
    contentAddMode = V.Constant.NONE
  };
  var drawImage = function(image_url, area, style, hyperlink, options) {
    var current_area;
    var renderOnInit = false;
    if(area) {
      current_area = area;
      renderOnInit = true
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var newStyle;
    if(style) {
      newStyle = V.Editor.Utils.setStyleInPixels(style, current_area)
    }else {
      var image_width = $(current_area).width();
      newStyle = "width:" + image_width + "px;"
    }
    var template = V.Editor.getTemplate(current_area);
    var nextImageId = V.Utils.getId();
    var idToDragAndResize = "draggable" + nextImageId;
    current_area.attr("type", "image");
    if(hyperlink) {
      current_area.attr("hyperlink", hyperlink)
    }
    if(typeof options != "undefined") {
      if(typeof options["vishubPdfexId"] != "undefined") {
        current_area.attr("vishubpdfexid", options["vishubPdfexId"])
      }
    }
    current_area.html("<img class='" + template + "_image' id='" + idToDragAndResize + "' draggable='true' title='Click to drag' src='" + image_url + "' style='" + newStyle + "'/>");
    if(!style) {
      var theImg = $("#" + idToDragAndResize);
      $(theImg).load(function() {
        V.Utils.addTempShown([$(current_area).parent(), $(current_area), $(theImg)]);
        var dimentionsToDraw = V.Utils.dimentionsToDraw($(current_area).width(), $(current_area).height(), $(theImg).width(), $(theImg).height());
        V.Utils.removeTempShown([$(current_area).parent(), $(current_area), $(theImg)]);
        $(theImg).width(dimentionsToDraw.width);
        if(dimentionsToDraw.height > 0) {
          $(theImg).height(dimentionsToDraw.height)
        }
      })
    }
    V.Editor.addDeleteButton(current_area);
    $("#" + idToDragAndResize).draggable({cursor:"move", stop:function() {
      $(this).parent().click()
    }});
    if(renderOnInit === false) {
      V.Editor.Slides.updateThumbnail(V.Slides.getTargetSlide())
    }
  };
  var getAddContentMode = function() {
    return contentAddMode
  };
  var setAddContentMode = function(mode) {
    V.Editor.Utils.hideNonDefaultTabs();
    switch(mode) {
      case V.Constant.THUMBNAIL:
        $("#picture_fancybox div.fancy_tabs a.fancy_tab").hide();
        $("#tab_pic_upload").not(".disabled").show();
        $("#tab_pic_thumbnails").not(".disabled").show();
        break;
      case V.Constant.NONE:
      ;
      case V.Constant.FLASHCARD:
        break
    }
    contentAddMode = mode
  };
  return{init:init, onLoadTab:onLoadTab, drawImage:drawImage, addContent:addContent, getAddContentMode:getAddContentMode, setAddContentMode:setAddContentMode}
}(VISH, jQuery);
VISH.Editor.Object = function(V, $, undefined) {
  var contentToAdd = null;
  var uploadDivId = "tab_object_upload_content";
  var urlDivId = "tab_object_from_url_content";
  var urlInputId = "object_embed_code";
  var _hiddenLinkToInitObjectSettings;
  var init = function() {
    V.Editor.Object.LRE.init();
    V.Editor.Object.Repository.init();
    V.Editor.Object.Live.init();
    V.Editor.Object.Web.init();
    V.Editor.Object.GoogleDOC.init();
    V.Editor.Object.PDF.init();
    V.Editor.Object.Snapshot.init();
    V.Editor.Object.Scorm.init();
    V.Editor.Object.Webapp.init();
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        drawPreview(urlDivId, contentToAdd)
      }
    });
    var options = V.Editor.getOptions();
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " .upload_file_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        if(options) {
          var description = "Uploaded by " + V.User.getName() + " via ViSH Editor";
          $("#" + uploadDivId + " input[name='document[description]']").val(description);
          $("#" + uploadDivId + " input[name='document[owner_id]']").val(V.User.getId());
          $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
          $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadObjectPath);
          var tagList = $("#" + uploadDivId + " .tagList");
          $("#" + uploadDivId + " input[name='document[tag_list]']").val(V.Editor.Utils.convertToTagsArray($(tagList).tagit("tags")));
          $(tagList).parent().hide();
          $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
        }
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      processResponse(xhr.responseText);
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, error:function(error) {
      V.Debugging.log("Upload error");
      V.Debugging.log(error)
    }});
    _hiddenLinkToInitObjectSettings = $('<a href="#objectSettings_fancybox" style="display:none"></a>');
    $(_hiddenLinkToInitObjectSettings).fancybox({"autoDimensions":false, "height":400, "width":400, "scrolling":"no", "showCloseButton":false, "padding":0, "onStart":function(data) {
      _onStartObjectSettingsFancybox()
    }, "onComplete":function(data) {
    }, "onClosed":function(data) {
    }});
    $("#objectSettings_fancybox").find("input[type='checkbox'][name='wappAPI']").change(function() {
      var wappScoreCheckbox = $("#objectSettings_fancybox").find("input[type='checkbox'][name='wappScore']");
      var wappScorePointsDOM = $("#objectSettings_fancybox").find("select[name='wappScorePoints']");
      if(!$(this).is(":checked")) {
        V.Editor.Utils.enableElementSettingsField([wappScoreCheckbox, wappScorePointsDOM], false)
      }else {
        V.Editor.Utils.enableElementSettingsField([wappScoreCheckbox], true)
      }
    });
    $("#objectSettings_fancybox").find("input[type='checkbox'][name='wappScore']").change(function() {
      var wappScorePointsDOM = $("#objectSettings_fancybox").find("select[name='wappScorePoints']");
      if(!$(this).is(":checked")) {
        V.Editor.Utils.enableElementSettingsField([wappScorePointsDOM], false)
      }else {
        V.Editor.Utils.enableElementSettingsField([wappScorePointsDOM], true);
        $(wappScorePointsDOM).val(10)
      }
    })
  };
  var onLoadTab = function(tab) {
    if(tab == "upload") {
      _onLoadUploadTab()
    }
    if(tab == "url") {
      _onLoadURLTab()
    }
  };
  var _onLoadURLTab = function() {
    contentToAdd = null;
    resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var _onLoadUploadTab = function() {
    contentToAdd = null;
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    V.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    resetPreview(uploadDivId);
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList)[0].children.length !== 0) {
      $(tagList).tagit("reset")
    }
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      var config = V.Configuration.getConfiguration();
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:config.tagsSettings.maxLength, maxTags:config.tagsSettings.maxTags, triggerKeys:config.tagsSettings.triggerKeys, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(V.Police.validateObject(jsonResponse.src)[0]) {
          var objectToDraw = jsonResponse.src;
          if(jsonResponse.type === V.Constant.MEDIA.SCORM_PACKAGE) {
            objectToDraw = V.Editor.Object.Scorm.generateWrapperForScorm(jsonResponse.src)
          }else {
            if(jsonResponse.type === V.Constant.MEDIA.WEB_APP) {
              objectToDraw = V.Editor.Object.Webapp.generateWrapper(jsonResponse.src)
            }
          }
          drawPreview(uploadDivId, objectToDraw);
          contentToAdd = objectToDraw
        }
      }
    }catch(e) {
    }
  };
  var previewBackground;
  var drawPreview = function(divId, src) {
    previewBackground = $("#" + divId + " .previewimgbox").css("background-image");
    $("#" + divId + " .previewimgbox").css("background-image", "none");
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    if($("#" + divId + " .previewimgbox .objectPreview").length > 0) {
      $("#" + divId + " .previewimgbox .objectPreview").remove()
    }
    var wrapper = $(renderObjectPreview(src));
    $("#" + divId + " .previewimgbox").append(wrapper);
    _loadSources(src, wrapper);
    $("#" + divId + " .previewimgbox button").show()
  };
  var resetPreview = function(divId) {
    $("#" + divId + " .previewimgbox button").hide();
    $("#" + divId + " .previewimgbox img.imagePreview").remove();
    $("#" + divId + " .previewimgbox .objectPreview").remove();
    if(previewBackground) {
      $("#" + divId + " .previewimgbox").css("background-image", previewBackground)
    }
  };
  var drawPreviewElement = function() {
    drawPreviewObject(contentToAdd)
  };
  var drawPreviewObject = function(content, options) {
    if(content) {
      drawObject(content, options);
      $.fancybox.close()
    }
  };
  var _loadSources = function(object, tag) {
    var objectInfo = V.Object.getObjectInfo(object);
    if(objectInfo.wrapper === V.Constant.WRAPPER.VIDEO || objectInfo.wrapper === null && objectInfo.type === V.Constant.MEDIA.HTML5_VIDEO) {
      var sources = typeof objectInfo.source == "object" ? objectInfo.source : [{src:objectInfo.source}];
      V.Video.HTML5.addSourcesToVideoTag(sources, tag, {timestamp:true})
    }else {
      if(objectInfo.wrapper === V.Constant.WRAPPER.AUDIO || objectInfo.wrapper === null && objectInfo.type === V.Constant.MEDIA.HTML5_AUDIO) {
        var sources = typeof objectInfo.source == "object" ? objectInfo.source : [{src:objectInfo.source}];
        V.Audio.HTML5.addSourcesToAudioTag(sources, tag, {timestamp:true})
      }
    }
  };
  var resizeObject = function(id, newWidth) {
    var parent = $("#" + id).parent();
    var aspectRatio = $("#" + id).width() / $("#" + id).height();
    var newWrapperHeight = Math.round(newWidth / aspectRatio);
    var newWrapperWidth = Math.round(newWidth);
    $(parent).width(newWrapperWidth);
    $(parent).height(newWrapperHeight);
    var zoom = V.Utils.getZoomFromStyle($("#" + id).attr("style"));
    if(zoom != 1) {
      newWidth = newWidth / zoom;
      var newHeight = Math.round(newWidth / aspectRatio);
      newWidth = Math.round(newWidth)
    }else {
      var newHeight = newWrapperHeight;
      var newWidth = newWrapperWidth
    }
    $("#" + id).width(newWidth);
    $("#" + id).height(newHeight)
  };
  var _adjustWrapperOfObject = function(objectID, current_area) {
    var proportion = $("#" + objectID).height() / $("#" + objectID).width();
    var maxWidth = current_area.width();
    var maxHeight = current_area.height();
    var width = $("#" + objectID).width();
    var height = $("#" + objectID).height();
    if(width > maxWidth) {
      $("#" + objectID).width(maxWidth);
      $("#" + objectID).height(width * proportion);
      width = maxWidth;
      height = $("#" + objectID).height()
    }
    if(height > maxHeight) {
      $("#" + objectID).height(maxHeight);
      $("#" + objectID).width(height / proportion);
      width = $("#" + objectID).width();
      height = maxHeight
    }
    var wrapper = $("#" + objectID).parent();
    if($(wrapper).hasClass("object_wrapper")) {
      $(wrapper).height($("#" + objectID).height());
      $(wrapper).width($("#" + objectID).width())
    }
  };
  var autofixWrapperedObjectAfterZoom = function(object, zoom) {
    var wrapper = $(object).parent();
    $(object).height($(wrapper).height() / zoom);
    $(object).width($(wrapper).width() / zoom)
  };
  var renderObjectPreview = function(object, options) {
    var objectInfo = V.Object.getObjectInfo(object);
    var objectType = objectInfo.type;
    if(options && typeof options.forceType == "string") {
      objectType = options.forceType
    }
    switch(objectInfo.wrapper) {
      case null:
        switch(objectType) {
          case V.Constant.MEDIA.IMAGE:
            return"<img class='imagePreview' src='" + object + "'></img>";
            break;
          case V.Constant.MEDIA.FLASH:
            object = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(object, "wmode", "opaque"));
            return"<embed class='objectPreview' src='" + object + "'></embed>";
            break;
          case V.Constant.MEDIA.PDF:
            return V.Editor.Object.PDF.generatePreviewWrapper(object);
            break;
          case V.Constant.MEDIA.DOC:
          ;
          case V.Constant.MEDIA.PPT:
            return V.Editor.Object.GoogleDOC.generatePreviewWrapper(object);
            break;
          case V.Constant.MEDIA.YOUTUBE_VIDEO:
            return V.Editor.Video.Youtube.generatePreviewWrapperForYoutubeVideoUrl(object);
            break;
          case V.Constant.MEDIA.HTML5_VIDEO:
            return V.Editor.Video.HTML5.renderVideoWithURL(object, {loadSources:false, poster:V.Video.HTML5.getDefaultPosterURL(), extraClasses:["objectPreview"]});
            break;
          case V.Constant.MEDIA.HTML5_AUDIO:
            return V.Editor.Audio.HTML5.renderAudioWithURL(object, {loadSources:false, extraClasses:["objectPreview"]});
            break;
          case V.Constant.MEDIA.WEB:
            return V.Editor.Object.Web.generatePreviewWrapperForWeb(object);
            break;
          case V.Constant.MEDIA.SCORM_PACKAGE:
            return V.Editor.Object.Scorm.generatePreviewWrapperForScorm(object);
            break;
          case V.Constant.MEDIA.WEB_APP:
            return V.Editor.Object.Webapp.generatePreviewWrapper(object);
            break;
          default:
            V.Debugging.log("Unrecognized object source type");
            break
        }
        break;
      case V.Constant.WRAPPER.EMBED:
        return _genericWrapperPreview(object);
        break;
      case V.Constant.WRAPPER.OBJECT:
        return _genericWrapperPreview(object);
        break;
      case V.Constant.WRAPPER.IFRAME:
        if(objectType == V.Constant.MEDIA.SCORM_PACKAGE) {
          return V.Editor.Object.Scorm.generatePreviewWrapperForScorm(objectInfo.source)
        }else {
          if(objectType == V.Constant.MEDIA.WEB_APP) {
            return V.Editor.Object.Webapp.generatePreviewWrapper(objectInfo.source)
          }else {
            return _genericWrapperPreview(object)
          }
        }
        break;
      case V.Constant.WRAPPER.VIDEO:
        return V.Editor.Video.HTML5.renderVideoFromWrapper(object, {loadSources:false, poster:V.Video.HTML5.getDefaultPosterURL(), extraClasses:["objectPreview"]});
        break;
      case V.Constant.WRAPPER.AUDIO:
        return V.Editor.Audio.HTML5.renderAudioFromWrapper(object, {loadSources:false, extraClasses:["objectPreview"]});
        break;
      default:
        V.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
  };
  var _genericWrapperPreview = function(object) {
    var wrapperPreview = $(object);
    $(wrapperPreview).addClass("objectPreview");
    $(wrapperPreview).attr("wmode", "opaque");
    $(wrapperPreview).removeAttr("width");
    $(wrapperPreview).removeAttr("height");
    if(typeof $(wrapperPreview).attr("src") != "undefined") {
      $(wrapperPreview).attr("src", V.Utils.checkUrlProtocol($(wrapperPreview).attr("src")))
    }
    if(typeof $(wrapperPreview).attr("scrolling") != "undefined") {
      $(wrapperPreview).attr("scrolling", "auto")
    }
    return wrapperPreview
  };
  var drawObject = function(object, options) {
    if(!V.Police.validateObject(object)[0]) {
      return
    }
    options = typeof options == "undefined" ? {} : options;
    var objectInfo = V.Object.getObjectInfo(object);
    var current_area = V.Editor.getCurrentArea();
    var object_style = "";
    var zoomInStyle;
    if(options) {
      if(options.area) {
        current_area = options.area
      }
      if(options.style) {
        object_style = options.style
      }
      if(options.zoomInStyle) {
        zoomInStyle = options.zoomInStyle
      }
      if(options.forceType) {
        objectInfo.type = options.forceType
      }
    }
    switch(objectInfo.wrapper) {
      case null:
        switch(objectInfo.type) {
          case V.Constant.MEDIA.IMAGE:
            V.Editor.Image.drawImage(object);
            break;
          case V.Constant.MEDIA.FLASH:
            V.Editor.Object.Flash.drawFlashObjectWithSource(object, object_style);
            break;
          case V.Constant.MEDIA.PDF:
            options.wrapperGenerated = true;
            return drawObject(V.Editor.Object.PDF.generateWrapper(objectInfo.source), options);
          case V.Constant.MEDIA.DOC:
          ;
          case V.Constant.MEDIA.PPT:
            return drawObject(V.Editor.Object.GoogleDOC.generateWrapper(object), options);
          case V.Constant.MEDIA.YOUTUBE_VIDEO:
            return drawObject(V.Editor.Video.Youtube.generateWrapperForYoutubeVideoUrl(object), options);
          case V.Constant.MEDIA.HTML5_VIDEO:
            V.Editor.Video.HTML5.drawVideoWithUrl(object);
            break;
          case V.Constant.MEDIA.HTML5_AUDIO:
            V.Editor.Audio.HTML5.drawAudioWithUrl(object);
            break;
          case V.Constant.MEDIA.WEB:
            return drawObject(V.Editor.Object.Web.generateWrapperForWeb(object), options);
          case V.Constant.MEDIA.SCORM_PACKAGE:
            return drawObject(V.Editor.Object.Scorm.generateWrapperForScorm(object), options);
          case V.Constant.MEDIA.WEB_APP:
            return drawObject(V.Editor.Object.Webapp.generateWrapper(object), options);
          default:
            V.Debugging.log("Unrecognized object source type: " + objectInfo.type);
            break
        }
        break;
      case V.Constant.WRAPPER.EMBED:
      ;
      case V.Constant.WRAPPER.OBJECT:
      ;
      case V.Constant.WRAPPER.IFRAME:
        if([V.Constant.MEDIA.PDF].indexOf(objectInfo.type) != -1 && !options.wrapperGenerated) {
          return drawObject(objectInfo.source, options)
        }
        drawObjectWithWrapper(object, current_area, object_style, zoomInStyle);
        break;
      case V.Constant.WRAPPER.VIDEO:
        V.Editor.Video.HTML5.drawVideoWithWrapper(object);
        break;
      case V.Constant.WRAPPER.AUDIO:
        V.Editor.Audio.HTML5.drawAudioWithWrapper(object);
        break;
      default:
        V.Debugging.log("Unrecognized object wrapper: " + objectInfo.wrapper);
        break
    }
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var drawObjectWithWrapper = function(wrapper, current_area, style, zoomInStyle) {
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "object");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    wrapperDiv.setAttribute("draggable", true);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("object_wrapper");
    var wrapperTag = $(wrapper);
    $(wrapperTag).attr("id", idToResize);
    $(wrapperTag).css("pointer-events", "none");
    $(wrapperTag).attr("class", template + "_object");
    $(wrapperTag).attr("wmode", "opaque");
    if(typeof $(wrapperTag).attr("scrolling") != "undefined") {
      $(wrapperTag).attr("scrolling", "auto")
    }
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    V.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(wrapperTag);
    $("#" + idToDrag).draggable({cursor:"move"});
    _adjustWrapperOfObject(idToResize, current_area);
    V.Editor.Tools.loadToolbarForObject(wrapper);
    if(zoomInStyle) {
      $(wrapperTag).attr("style", zoomInStyle);
      V.ObjectPlayer.adjustDimensionsAfterZoom($(wrapperTag))
    }
    var objectTypeAttr = $(wrapperTag).attr("objecttype");
    if(objectTypeAttr == V.Constant.MEDIA.SCORM_PACKAGE) {
      V.Editor.Object.Scorm.afterDrawSCORM(wrapperTag)
    }else {
      if(objectTypeAttr == V.Constant.MEDIA.WEB_APP) {
        V.Editor.Object.Webapp.afterDraw(wrapperTag)
      }
    }
  };
  var showObjectSettings = function() {
    $(_hiddenLinkToInitObjectSettings).trigger("click")
  };
  var _onStartObjectSettingsFancybox = function() {
    var oSF = $("#objectSettings_fancybox");
    var area = V.Editor.getCurrentArea();
    var object = $(area).find("div.object_wrapper").children().first();
    var objectInfo = V.Object.getObjectInfo(object);
    $(oSF).find("input[type='hidden'][name='elId']").val($(area).attr("id"));
    var oSettings = {};
    var unloadObject = true;
    try {
      oSettings = JSON.parse($(area).attr("elSettings"))
    }catch(e) {
    }
    if(typeof oSettings.unloadObject != "undefined") {
      unloadObject = oSettings.unloadObject
    }
    if(objectInfo.type === V.Constant.MEDIA.FLASH) {
      unloadObject = true
    }
    var showWAPPSettings = objectInfo.type === V.Constant.MEDIA.WEB_APP;
    if(showWAPPSettings) {
      var wappAPI = oSettings.wappAPI_supported;
      var wappScore = false;
      var wappScorePoints = 0;
      if(typeof oSettings.wappAPI != "undefined") {
        wappAPI = oSettings.wappAPI
      }
      if(typeof oSettings.wappScore != "undefined") {
        wappScore = oSettings.wappScore && wappAPI
      }
      if(typeof oSettings.wappScorePoints != "undefined" && oSettings.wappScore === true) {
        wappScorePoints = oSettings.wappScorePoints
      }else {
        if(wappScore) {
          wappScorePoints = 10
        }
      }
    }
    var unloadObjectCheckbox = $(oSF).find("input[type='checkbox'][name='unloadObject']");
    $(unloadObjectCheckbox).prop("checked", unloadObject);
    if(objectInfo.type === V.Constant.MEDIA.FLASH) {
      V.Editor.Utils.enableElementSettingsField(unloadObjectCheckbox, false)
    }else {
      V.Editor.Utils.enableElementSettingsField(unloadObjectCheckbox, true)
    }
    if(showWAPPSettings) {
      $(oSF).find("div.wapp_settings").show();
      var wappAPICheckbox = $(oSF).find("input[type='checkbox'][name='wappAPI']");
      $(wappAPICheckbox).prop("checked", wappAPI);
      var wappScoreCheckbox = $(oSF).find("input[type='checkbox'][name='wappScore']");
      $(wappScoreCheckbox).prop("checked", wappScore);
      var wappScorePointsDOM = $(oSF).find("select[name='wappScorePoints']");
      $(wappScorePointsDOM).val(wappScorePoints);
      if(oSettings.wappAPI_supported !== true) {
        V.Editor.Utils.enableElementSettingsField([wappAPICheckbox, wappScoreCheckbox, wappScorePointsDOM], false)
      }else {
        V.Editor.Utils.enableElementSettingsField([wappAPICheckbox, wappScoreCheckbox], true);
        V.Editor.Utils.enableElementSettingsField(wappScorePointsDOM, wappScore)
      }
    }else {
      $(oSF).find("div.wapp_settings").hide()
    }
  };
  var onObjectSettingsDone = function() {
    var oSF = $("#objectSettings_fancybox");
    var areaId = $(oSF).find("input[type='hidden'][name='elId']").val();
    var area = $("#" + areaId);
    var object = $(area).find("div.object_wrapper").children().first();
    var objectInfo = V.Object.getObjectInfo(object);
    var oSettings = {};
    try {
      oSettings = JSON.parse($(area).attr("elsettings"))
    }catch(e) {
    }
    oSettings.unloadObject = $(oSF).find("input[type='checkbox'][name='unloadObject']").is(":checked");
    if(objectInfo.type === V.Constant.MEDIA.WEB_APP) {
      oSettings.wappAPI = $(oSF).find("input[type='checkbox'][name='wappAPI']").is(":checked");
      oSettings.wappScore = oSettings.wappAPI && $(oSF).find("input[type='checkbox'][name='wappScore']").is(":checked");
      var wappScorePointsDOM = $(oSF).find("select[name='wappScorePoints']");
      if(oSettings.wappScore && !$(wappScorePointsDOM).is(":disabled")) {
        oSettings.wappScorePoints = $(wappScorePointsDOM).val()
      }else {
        delete oSettings.wappScorePoints
      }
    }else {
      delete oSettings.wappAPI;
      delete oSettings.wappScore;
      delete oSettings.wappScorePoints
    }
    var oSSerialized = JSON.stringify(oSettings);
    $(area).attr("elSettings", oSSerialized);
    $.fancybox.close()
  };
  return{init:init, onLoadTab:onLoadTab, drawObject:drawObject, renderObjectPreview:renderObjectPreview, resizeObject:resizeObject, autofixWrapperedObjectAfterZoom:autofixWrapperedObjectAfterZoom, drawPreview:drawPreview, resetPreview:resetPreview, drawPreviewElement:drawPreviewElement, drawPreviewObject:drawPreviewObject, showObjectSettings:showObjectSettings, onObjectSettingsDone:onObjectSettingsDone}
}(VISH, jQuery);
VISH.Editor.Object.Webapp = function(V, $, undefined) {
  var init = function() {
    V.Editor.Object.Webapp.Handler.init()
  };
  var generatePreviewWrapper = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    return"<iframe class='objectPreview' objecttype='" + V.Constant.MEDIA.WEB_APP + "' src='" + url + "' wmode='opaque'></iframe>"
  };
  var generateWrapper = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    var wappId = V.Utils.getId("wapp");
    url = V.Utils.addParamToUrl(url, "wappid", wappId);
    return"<iframe objecttype='" + V.Constant.MEDIA.WEB_APP + "' src='" + url + "' wmode='opaque' wappid='" + wappId + "'></iframe>"
  };
  var afterDraw = function(iframe) {
  };
  var convertIframeToWebApp = function(iframe) {
    if($(iframe).attr("objecttype") != V.Constant.MEDIA.WEB_APP) {
      $(iframe).attr("objecttype", V.Constant.MEDIA.WEB_APP)
    }
    if(typeof $(iframe).attr("wappid") === "undefined") {
      var wappId = V.Utils.getId("wapp");
      $(iframe).attr("wappid", wappId);
      var iframeURL = $(iframe).attr("src");
      iframeURL = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(iframeURL, "wappid", wappId));
      $(iframe).attr("src", iframeURL)
    }
    var iframeZoneParent = $(iframe).parents(".vezone");
    var _settings = {};
    try {
      _settings = JSON.parse($(iframeZoneParent).attr("elSettings"))
    }catch(e) {
    }
    _settings.wappAPI_supported = true;
    $(iframeZoneParent).attr("elSettings", JSON.stringify(_settings))
  };
  return{init:init, generatePreviewWrapper:generatePreviewWrapper, generateWrapper:generateWrapper, afterDraw:afterDraw, convertIframeToWebApp:convertIframeToWebApp}
}(VISH, jQuery);
VISH.Editor.Presentation = function(V, $, undefined) {
  var init = function() {
    V.Editor.Presentation.File.init();
    V.EventsNotifier.registerCallback(V.Constant.Event.onSelectedSlides, function(params) {
      insertPresentation(params.JSON, params.acceptedSlides);
      $.fancybox.close()
    })
  };
  var _onConnect = function(origin) {
    V.IframeAPI.registerCallback("onMessage", function(VEMessage, origin) {
      var VEMessageObject = JSON.parse(VEMessage);
      if(VEMessageObject.data.VEevent === V.Constant.Event.onSelectedSlides) {
        V.EventsNotifier.notifyEvent(V.Constant.Event.onSelectedSlides, VEMessageObject.data.params, true)
      }
    })
  };
  var previewPresentation = function(presentation) {
    V.IframeAPI.init({callback:_onConnect, ve:true});
    V.Editor.Preview.preview({insertMode:true, slideNumberToPreview:1, presentationJSON:presentation})
  };
  var insertPresentation = function(presentationJSON, selectedSlideNumbers) {
    var snL = selectedSlideNumbers.length;
    if(snL < 1) {
      $.fancybox.close();
      return
    }
    presentationJSON = V.Utils.fixPresentation(presentationJSON);
    if(presentationJSON === null) {
      V.Utils.showPNotValidDialog();
      $.fancybox.close();
      return
    }
    var selectedSlides = [];
    var flashcards = [];
    var vts = [];
    for(var i = 0;i < snL;i++) {
      var slide = presentationJSON.slides[selectedSlideNumbers[i] - 1];
      var mySlide = V.Editor.Utils.replaceIdsForSlideJSON(slide);
      if(mySlide === null) {
        $.fancybox.close();
        V.Debugging.log("Not valid presentation");
        return null
      }
      switch(mySlide.type) {
        case V.Constant.FLASHCARD:
          flashcards.push(mySlide);
          break;
        case V.Constant.VTOUR:
          vts.push(mySlide);
          break;
        default:
          break
      }
      selectedSlides.push(mySlide)
    }
    presentationJSON.slides = selectedSlides;
    V.Editor.Renderer.renderPresentation(presentationJSON);
    V.Slides.updateSlides();
    V.Slides.lastSlide();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber())
    });
    V.Editor.Utils.Loader.unloadAllObjects();
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    $.fancybox.close()
  };
  var generatePresentationScaffold = function(elements, options) {
    var presentation = {};
    presentation.VEVersion = V.VERSION;
    presentation.type = V.Constant.PRESENTATION;
    presentation.theme = V.Constant.Themes.Default;
    presentation.slides = [];
    var elL = elements.length;
    for(var i = 0;i < elL;i++) {
      presentation.slides.push(_generateSlideScaffold(i + 1, elements[i], options))
    }
    return presentation
  };
  var _generateSlideScaffold = function(index, element, options) {
    var slide = {};
    var element = element || {};
    slide.id = "article" + index;
    slide.type = V.Constant.STANDARD;
    var defaultTemplate = "t10";
    if(element.template) {
      slide.template = element.template
    }else {
      if(options && options.template) {
        slide.template = options.template
      }else {
        slide.template = defaultTemplate
      }
    }
    if(element.type == V.Constant.QUIZ) {
      slide.containsQuiz = true
    }
    slide.elements = [];
    element.id = slide.id + "_zone1";
    switch(slide.template) {
      case "t2":
        element.areaid = "left";
        break;
      default:
        element.areaid = "center"
    }
    if(options && options.pdfexId) {
      element.options = element.options || {};
      element.options["vishubPdfexId"] = options.pdfexId
    }
    slide.elements.push(element);
    return slide
  };
  return{init:init, insertPresentation:insertPresentation, previewPresentation:previewPresentation, generatePresentationScaffold:generatePresentationScaffold}
}(VISH, jQuery);
VISH.Editor.Presentation.Repository = function(V, $, undefined) {
  var containerDivId = "tab_presentations_repo_content";
  var carrouselDivId = "tab_presentations_repo_content_carrousel";
  var previewDivId = "tab_presentations_repo_content_preview";
  var previewButton;
  var myInput;
  var timestampLastSearch;
  var currentPresentations = new Array;
  var selectedPres = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    });
    previewButton = $("#" + previewDivId).find("button.okButton2");
    $(previewButton).click(function() {
      if(selectedPres && selectedPres["loModel"]) {
        V.Editor.Presentation.previewPresentation(selectedPres["loModel"])
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestPresentations(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectMetadata();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId), {style:"loading_presentation_carrousel"});
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectMetadata();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    currentPresentations = new Array;
    $.each(data, function(index, pres) {
      if(typeof pres != "undefined") {
        var presId = "presentationCarrousel_" + index;
        if(typeof pres.avatar_url == "undefined") {
          pres.avatar_url = V.ImagesPath + "icons/defaultAvatar.png"
        }
        var myImg = $("<img presentationId ='" + presId + "'' src=" + pres.avatar_url + " />");
        carrouselImages.push(myImg);
        currentPresentations[presId] = pres
      }
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.width = 800;
        options.styleClass = "presentation_repository";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var presentationId = $(event.target).attr("presentationId");
    if(presentationId) {
      $(".excursionSelectedInCarrousel").removeClass("excursionSelectedInCarrousel");
      $(event.target).addClass("excursionSelectedInCarrousel");
      selectedPres = currentPresentations[presentationId];
      _renderObjectMetadata(selectedPres)
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectMetadata = function(object) {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    if(object) {
      var presAuthor = typeof object.author == "object" ? object.author.name : typeof object.author == "string" ? object.author : "";
      var table = V.Editor.Utils.generateTable({title:object.title, author:presAuthor, description:object.description, tableClass:"metadata metadata_presentation"});
      $(metadataArea).html(table);
      $(previewButton).show()
    }
  };
  var _cleanObjectMetadata = function() {
    var metadataArea = $("#" + previewDivId).find("div.content_preview_metadata");
    $(metadataArea).html("");
    $(previewButton).hide()
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Slideset = function(V, $, undefined) {
  var initialized = false;
  var currentSubslide;
  var init = function() {
    if(initialized) {
      return
    }
    V.Editor.Flashcard.init();
    V.Editor.VirtualTour.init();
    V.Editor.EVideo.init();
    initialized = true
  };
  var getCreatorModule = function(obj) {
    type = V.Slideset.getSlidesetType(obj);
    switch(type) {
      case V.Constant.FLASHCARD:
        return V.Editor.Flashcard;
        break;
      case V.Constant.VTOUR:
        return V.Editor.VirtualTour;
        break;
      case V.Constant.EVIDEO:
        return V.Editor.EVideo;
        break;
      default:
        return null
    }
  };
  var getDummy = function(slideset, options) {
    var slidesetCreator = getCreatorModule(slideset);
    if(typeof slidesetCreator != "undefined" && typeof slidesetCreator.getDummy == "function") {
      if(!options || typeof options.slidesetId != "string") {
        var slidesetId = V.Utils.getId("article")
      }else {
        var slidesetId = options.slidesetId
      }
      return slidesetCreator.getDummy(slidesetId, options)
    }
  };
  var getCurrentSubslide = function() {
    return currentSubslide
  };
  var setCurrentSubslide = function(newSubslide) {
    currentSubslide = newSubslide
  };
  var getSubslidesQuantity = function(slideset) {
    return $(slideset).children("article").length
  };
  var onEnterSlideset = function(slideset) {
    V.Editor.Slides.updateThumbnail(slideset);
    $("#bottomside").show();
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    var slidesetId = $(slideset).attr("id");
    var subslides = $("#" + slidesetId + " > article");
    if(typeof slidesetCreator.onEnterSlideset == "function") {
      slidesetCreator.onEnterSlideset(slideset)
    }
    openSlideset(slideset);
    V.Editor.Thumbnails.drawSlidesetThumbnails(subslides, function() {
    })
  };
  var onLeaveSlideset = function(slideset) {
    closeSlideset(slideset);
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }
    $("#bottomside").hide();
    $("#slideset_selected > img").attr("src", "");
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.onLeaveSlideset == "function") {
      slidesetCreator.onLeaveSlideset(slideset)
    }
  };
  var openSlideset = function(slideset) {
    _showSlideButtons(slideset);
    $("#slideset_selected_img").addClass("selectedSlidesetThumbnail");
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }
    V.Editor.Tools.loadToolsForSlide(slideset);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.loadSlideset == "function") {
      slidesetCreator.loadSlideset(slideset)
    }
  };
  var closeSlideset = function(slideset) {
    _hideSlideButtons(slideset);
    $("#slideset_selected_img").removeClass("selectedSlidesetThumbnail");
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.unloadSlideset == "function") {
      slidesetCreator.unloadSlideset(slideset)
    }
  };
  var beforeCreateSlidesetThumbnails = function() {
    var slideset = V.Slides.getCurrentSlide();
    if(V.Slideset.isSlideset(slideset)) {
      var slidesetCreator = getCreatorModule(slideset);
      if(typeof slidesetCreator.beforeCreateSlidesetThumbnails == "function") {
        slidesetCreator.beforeCreateSlidesetThumbnails(slideset)
      }
    }
  };
  var beforeRemoveSlideset = function(slideset) {
    onLeaveSlideset(slideset);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.beforeRemoveSlideset == "function") {
      slidesetCreator.beforeRemoveSlideset(slideset)
    }
  };
  var beforeRemoveSubslide = function(slideset, subslide) {
    closeSubslide(subslide);
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.beforeRemoveSubslide == "function") {
      slidesetCreator.beforeRemoveSubslide(slideset, subslide)
    }
  };
  var afterCreateSubslide = function(slideset, subslide) {
    var slidesetCreator = getCreatorModule($(slideset).attr("type"));
    if(typeof slidesetCreator.afterCreateSubslide == "function") {
      slidesetCreator.afterCreateSubslide(slideset, subslide)
    }
  };
  var openSubslideWithNumber = function(subslideNumber) {
    var slideset = V.Slides.getCurrentSlide();
    var subslides = $(slideset).find("article");
    var subslide = subslides[subslideNumber - 1];
    openSubslide(subslide)
  };
  var openSubslide = function(subslide) {
    var currentSubslide = getCurrentSubslide();
    if(currentSubslide) {
      closeSubslide(currentSubslide)
    }else {
      var slideset = $(subslide).parent();
      closeSlideset(slideset)
    }
    setCurrentSubslide(subslide);
    _showSubslide(subslide);
    V.Editor.Thumbnails.selectSubslideThumbnail($(subslide).attr("slidenumber"));
    V.Slides.triggerEnterEventById($(subslide).attr("id"))
  };
  var _showSubslide = function(subslide) {
    $(subslide).css("display", "block")
  };
  var _hideSubslide = function(subslide) {
    $(subslide).css("display", "none")
  };
  var closeSubslideWithNumber = function(subslideNumber) {
    var slideset = V.Slides.getCurrentSlide();
    var subslides = $(slideset).find("article");
    var subslide = subslides[subslideNumber - 1];
    closeSubslide(subslide)
  };
  var closeSubslide = function(subslide) {
    setCurrentSubslide(null);
    V.Editor.Thumbnails.selectSubslideThumbnail(null);
    _hideSubslide(subslide);
    V.Slides.triggerLeaveEventById($(subslide).attr("id"))
  };
  var _showSlideButtons = function(slide) {
    $(slide).find("div.delete_slide:first").show();
    $(slide).find("img.help_in_slide:first").show()
  };
  var _hideSlideButtons = function(slide) {
    $(slide).find("div.delete_slide:first").hide();
    $(slide).find("img.help_in_slide:first").hide()
  };
  var onClickOpenSlideset = function() {
    var slideset = V.Slides.getCurrentSlide();
    openSlideset(slideset)
  };
  return{init:init, getCreatorModule:getCreatorModule, getDummy:getDummy, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, openSlideset:openSlideset, closeSlideset:closeSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, beforeRemoveSlideset:beforeRemoveSlideset, beforeRemoveSubslide:beforeRemoveSubslide, afterCreateSubslide:afterCreateSubslide, getCurrentSubslide:getCurrentSubslide, openSubslideWithNumber:openSubslideWithNumber, openSubslide:openSubslide, closeSubslideWithNumber:closeSubslideWithNumber, 
  closeSubslide:closeSubslide, onClickOpenSlideset:onClickOpenSlideset, getSubslidesQuantity:getSubslidesQuantity}
}(VISH, jQuery);
VISH.Editor.VirtualTour = function(V, $, undefined) {
  var initialized = false;
  var geocoder;
  var gMlLoaded = false;
  var vts;
  var init = function() {
    if(!initialized) {
      vts = {};
      _loadEvents();
      V.Utils.Loader.loadGoogleLibrary("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places", function() {
        geocoder = new google.maps.Geocoder;
        gMlLoaded = true;
        var el = document;
        var evt = document.createEvent("Event");
        evt.initEvent("googleMapsLibraryLoadedinVE", true, true);
        el.dispatchEvent(evt)
      });
      initialized = true
    }
  };
  var _loadEvents = function() {
    $(document).on("keydown", "input.vt_search_input", function(event) {
      if(event.keyCode === 13) {
        event.preventDefault()
      }
    });
    $(document).on("click", "button.vt_search_button", function(event) {
      event.preventDefault();
      _onSearchAddress()
    })
  };
  var getDummy = function(slidesetId, options) {
    return"<article id='" + slidesetId + "' type='" + V.Constant.VTOUR + "' slidenumber='" + options.slideNumber + "'><div class='delete_slide'></div><img class='help_in_slide help_in_vt' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div class='vt_canvas'></div><div class='vt_search'><input class='vt_search_input' type='text' placeholder='" + V.I18n.getTrans("i.Searchplaces") + "'></input><button class='vt_search_button'><img class='vt_search_button_img' src='" + V.ImagesPath + 
    "icons/gsearch.png'/></button></div></article>"
  };
  var _drawMap = function(vtJSON, vtDOM) {
    if(!vtJSON) {
      vtJSON = {};
      vtJSON.center = {"lat":34, "lng":2};
      vtJSON.zoom = 2;
      vtJSON.mapType = V.Constant.VTour.DEFAULT_MAP;
      vtJSON.pois = []
    }
    var vtId = $(vtDOM).attr("id");
    if(typeof vts[vtId] == "undefined") {
      vts[vtId] = vtJSON;
      vts[vtId].markers = {}
    }
    if(vts[vtId].drawed === true) {
      return
    }
    if(!gMlLoaded) {
      $(document).on("googleMapsLibraryLoadedinVE", function() {
        _drawMap(vtJSON, vtDOM)
      });
      return
    }
    vts[vtId].drawed = true;
    V.Utils.addTempShown(vtDOM);
    var latlng = new google.maps.LatLng(vtJSON.center.lat, vtJSON.center.lng);
    var myOptions = {zoom:parseInt(vtJSON.zoom), center:latlng, streetViewControl:false, mapTypeId:vtJSON.mapType};
    var canvas = $(vtDOM).find("div.vt_canvas");
    vts[vtId].map = new google.maps.Map($(canvas)[0], myOptions);
    vts[vtId].overlay = new google.maps.OverlayView;
    vts[vtId].overlay.draw = function() {
    };
    vts[vtId].overlay.setMap(vts[vtId].map);
    _loadLabel();
    var input = $(vtDOM).find("input.vt_search_input")[0];
    var options = {};
    var autocomplete = new google.maps.places.Autocomplete(input, options);
    google.maps.event.addListener(autocomplete, "place_changed", function() {
      _onSearchAddress()
    });
    google.maps.event.addListener(vts[vtId].map, "click", function() {
      $(".vt_search_input").blur()
    });
    google.maps.event.addListenerOnce(vts[vtId].map, "idle", function() {
      $(vtJSON.pois).each(function(index, poi) {
        _addMarkerToCoordinates(poi.lat, poi.lng, poi.slide_id, index + 1, vts[vtId]);
        $(".draggable_sc_div[slide_id='" + poi.slide_id + "']").hide()
      });
      V.Utils.removeTempShown(vtDOM)
    })
  };
  function Label(opt_options) {
    this.setValues(opt_options);
    var span = this.span_ = document.createElement("span");
    $(span).addClass("poi_label");
    var div = this.div_ = document.createElement("div");
    $(div).addClass("poi_label_container");
    div.appendChild(span)
  }
  var labelsInit = false;
  function _loadLabel() {
    if(labelsInit) {
      return
    }
    Label.prototype = new google.maps.OverlayView;
    Label.prototype.onAdd = function() {
      var pane = this.getPanes().overlayImage;
      pane.appendChild(this.div_);
      var me = this;
      this.listeners_ = [google.maps.event.addListener(this, "position_changed", function() {
        me.draw()
      }), google.maps.event.addListener(this, "text_changed", function() {
        me.draw()
      })]
    };
    Label.prototype.onRemove = function() {
      this.div_.parentNode.removeChild(this.div_);
      for(var i = 0, I = this.listeners_.length;i < I;++i) {
        google.maps.event.removeListener(this.listeners_[i])
      }
    };
    Label.prototype.draw = function() {
      var projection = this.getProjection();
      var position = projection.fromLatLngToDivPixel(this.get("position"));
      var div = this.div_;
      div.style.left = position.x + "px";
      div.style.top = position.y + "px";
      div.style.display = "block";
      div.style.zIndex = "2000";
      if(typeof this.get("text") != "undefined") {
        this.span_.innerHTML = this.get("text").toString()
      }
    };
    labelsInit = true
  }
  var _onSearchAddress = function() {
    var currentVT = V.Slides.getCurrentSlide();
    var currentInput = $(currentVT).find("input.vt_search_input");
    var text = $(currentInput).val();
    if(typeof text == "string" && text != "") {
      _getAddressForText(text, function(location) {
        if(location) {
          var map = _getCurrentTour().map;
          map.setCenter(location.address);
          if(location.bounds) {
            map.fitBounds(location.bounds)
          }else {
            if(location.viewport) {
              map.fitBounds(location.viewport)
            }
          }
          $(currentInput).val("");
          $(currentInput).attr("placeholder", V.I18n.getTrans("i.Searchplaces"))
        }else {
          $(currentInput).val("");
          $(currentInput).attr("placeholder", V.I18n.getTrans("i.Noresultsfound"))
        }
      })
    }
  };
  var _getAddressForText = function(addressText, callback) {
    geocoder.geocode({"address":addressText}, function(results, status) {
      if(status === google.maps.GeocoderStatus.OK) {
        var addrLocation = results[0].geometry.location;
        var bounds = results[0].geometry.bounds;
        var viewport = results[0].geometry.viewport;
        var location = {address:addrLocation, bounds:bounds, viewport:viewport};
        if(typeof callback === "function") {
          callback(location)
        }
      }else {
        if(typeof callback === "function") {
          callback(null)
        }
      }
    })
  };
  var _addMarkerToCoordinates = function(lat, lng, slide_id, slideNumber, vtJSON) {
    return _addMarkerToPosition(new google.maps.LatLng(lat, lng), slide_id, slideNumber, vtJSON)
  };
  var _addMarkerToPosition = function(myLatlng, slide_id, slideNumber, vtJSON) {
    var vt;
    if(vtJSON) {
      vt = vtJSON
    }else {
      vt = _getCurrentTour()
    }
    var map = vt.map;
    var label = new Label({map:map});
    if(!slideNumber) {
      slideNumber = parseInt($(".draggable_sc_div[slide_id='" + slide_id + "']").attr("slidenumber"))
    }
    var pinImage = _getPinImageForSlideNumber(slideNumber);
    var marker = new google.maps.Marker({position:myLatlng, map:map, draggable:true, icon:pinImage, slide_id:slide_id, title:"(" + myLatlng.lat().toFixed(3) + "," + myLatlng.lng().toFixed(3) + ")"});
    label.bindTo("position", marker, "position");
    google.maps.event.addListener(marker, "click", function(event) {
      _onClick(marker)
    });
    if(typeof vt.markers == "undefined") {
      vt.markers = {}
    }
    vt.markers[slide_id] = marker;
    return marker
  };
  var _getPinImageForSlideNumber = function(slideNumber) {
    var pinText = String.fromCharCode(64 + parseInt(slideNumber));
    var pinImage = new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld=" + pinText + "|FF776B|000000", new google.maps.Size(25, 40), new google.maps.Point(0, 0), new google.maps.Point(10, 34));
    return pinImage
  };
  var _onClick = function(marker) {
    var vt = _getCurrentTour();
    var point = vt.overlay.getProjection().fromLatLngToContainerPixel(marker.position);
    var arrow = $(".draggable_sc_div[slide_id='" + marker.slide_id + "']");
    $(arrow).show();
    var vtDOM = V.Slides.getCurrentSlide();
    var canvas = $(vtDOM).find("div.vt_canvas");
    var xDif = ($(vtDOM).outerWidth() - $(canvas).outerWidth()) / 2;
    var yDif = ($(vtDOM).outerHeight() - $(canvas).outerHeight()) / 2;
    var vt_offset = $(vtDOM).offset();
    var top = point.y + vt_offset.top + yDif - 38;
    var left = point.x + vt_offset.left + xDif - 25;
    var parent = $(arrow).parent();
    var parent_offset = $(parent).offset();
    var newMarginTop = parent_offset.top - 20;
    var newMarginLeft = parent_offset.left + 15;
    var newTop = top - newMarginTop;
    var newLeft = left - newMarginLeft;
    $(arrow).css("position", "fixed");
    $(arrow).css("margin-top", newMarginTop + "px");
    $(arrow).css("margin-left", newMarginLeft + "px");
    $(arrow).css("top", newTop + "px");
    $(arrow).css("left", newLeft + "px");
    $(arrow).animate({top:0, left:0}, "slow", function() {
      $(arrow).css("position", "absolute");
      $(arrow).css("margin-top", "-20px");
      $(arrow).css("margin-left", "15px");
      $(arrow).attr("ddend", "scrollbar")
    });
    _removeMarker(marker)
  };
  var _onDoubleClick = function(marker) {
  };
  var _removeAllMarkers = function() {
    var markers = _getCurrentTour().markers;
    for(var key in markers) {
      _removeMarker(markers[key])
    }
  };
  var _removeMarker = function(marker) {
    marker.setMap(null);
    if(marker.label) {
      marker.label.onRemove()
    }
    var markers = _getCurrentTour().markers;
    if(typeof markers[marker.slide_id] !== "undefined") {
      delete markers[marker.slide_id]
    }
  };
  var _isPositionInViewport = function(position) {
    return _getCurrentTour().map.getBounds().contains(position)
  };
  var _getCurrentTour = function() {
    return vts[$(V.Slides.getCurrentSlide()).attr("id")]
  };
  var draw = function(slidesetJSON, scaffoldDOM) {
    _drawMap(slidesetJSON, scaffoldDOM)
  };
  var onEnterSlideset = function(vt) {
  };
  var onLeaveSlideset = function(vt) {
  };
  var loadSlideset = function(vt) {
    $("#subslides_list").find("div.draggable_sc_div[ddend='scrollbar']").show()
  };
  var unloadSlideset = function(vt) {
  };
  var beforeCreateSlidesetThumbnails = function(vt) {
    _drawPois(vt)
  };
  var beforeRemoveSlideset = function(vt) {
    var vtId = $(vt).attr("id");
    if(typeof vts[vtId] !== "undefined") {
      delete vts[vtId]
    }
  };
  var beforeRemoveSubslide = function(vt, subslide) {
    var subslideId = $(subslide).attr("id");
    var slideNumber = $(subslide).attr("slideNumber");
    var markers = _getCurrentTour().markers;
    Object.keys(markers).forEach(function(key) {
      var marker = markers[key];
      if(marker.slide_id === subslideId) {
        _removeMarker(marker)
      }else {
        var markerArrow = $(".draggable_sc_div[slide_id='" + marker.slide_id + "']");
        var markerSlideNumber = $(markerArrow).attr("slideNumber");
        if(markerSlideNumber > slideNumber) {
          $(markerArrow).attr("slideNumber", markerSlideNumber - 1);
          marker.setIcon(_getPinImageForSlideNumber(markerSlideNumber - 1))
        }
      }
    })
  };
  var _drawPois = function(vtDOM) {
    var vt = _getCurrentTour();
    if(!vt) {
      return
    }
    var markers = vt.markers;
    var subslides = $(vtDOM).find("article");
    $("#subslides_list").find("div.wrapper_barbutton").each(function(index, div) {
      var slide = subslides[index];
      if(slide) {
        var slide_id = $(slide).attr("id");
        var arrowDiv = $('<div class="draggable_sc_div" slide_id="' + slide_id + '" slideNumber="' + (index + 1) + '"" >');
        $(arrowDiv).append($('<img src="' + V.ImagesPath + 'icons/flashcard_button.png" class="fc_draggable_arrow">'));
        $(arrowDiv).append($('<p class="draggable_number">' + String.fromCharCode(64 + index + 1) + "</p>"));
        $(div).prepend(arrowDiv);
        if(typeof markers[slide_id] != "undefined") {
          $(arrowDiv).hide()
        }
      }
    });
    $("div.draggable_sc_div").draggable({start:function(event, ui) {
      var position = $(event.target).css("position");
      if(position === "fixed") {
        $(event.target).attr("ddstart", "background")
      }else {
        var current_offset = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("margin-top", current_offset.top + "px");
        $(event.target).css("margin-left", current_offset.left + "px");
        $(event.target).attr("ddstart", "scrollbar")
      }
    }, stop:function(event, ui) {
      var canvas = $(vtDOM).find("div.vt_canvas");
      var xDif = ($(vtDOM).outerWidth() - $(canvas).outerWidth()) / 2;
      var yDif = ($(vtDOM).outerHeight() - $(canvas).outerHeight()) / 2;
      var vt_offset = $(vtDOM).offset();
      var poi_offset = $(event.target).offset();
      var myX = poi_offset.left - vt_offset.left - xDif + 25;
      var myY = poi_offset.top - vt_offset.top - yDif + 34;
      var point = new google.maps.Point(myX, myY);
      var position = _getCurrentTour().overlay.getProjection().fromContainerPixelToLatLng(point);
      var insideMap = _isPositionInViewport(position);
      insideMap = insideMap && V.Editor.Slideset.getCurrentSubslide() == null;
      if(insideMap) {
        $(event.target).attr("ddend", "background");
        var newTop = $(event.target).cssNumber("margin-top") + $(event.target).cssNumber("top");
        var newLeft = $(event.target).cssNumber("margin-left") + $(event.target).cssNumber("left");
        $(event.target).css("margin-top", "0px");
        $(event.target).css("margin-left", "0px");
        $(event.target).css("top", newTop + "px");
        $(event.target).css("left", newLeft + "px");
        var slide_id = $(event.target).attr("slide_id");
        _addMarkerToPosition(position, slide_id);
        $(event.target).hide()
      }else {
        $(event.target).animate({top:0, left:0}, "slow", function() {
          $(event.target).css("position", "absolute");
          $(event.target).css("margin-top", "-20px");
          $(event.target).css("margin-left", "15px");
          $(event.target).attr("ddend", "scrollbar")
        })
      }
    }})
  };
  var getThumbnailURL = function(vt) {
    return V.ImagesPath + "templatesthumbs/tVTour.png"
  };
  var getSlideHeader = function(vtDOM) {
    var vtId = $(vtDOM).attr("id");
    var vt = vts[vtId];
    var slide = {};
    slide.id = vtId;
    slide.type = V.Constant.VTOUR;
    slide.map_service = V.Constant.VTour.SERVICES.GMaps;
    var center = vt.map.getCenter();
    slide.center = {lat:center.lat().toString(), lng:center.lng().toString()};
    slide.zoom = vt.map.getZoom().toString();
    slide.mapType = _getMapType(vt.map);
    slide.width = "100%";
    slide.height = "100%";
    var pois = [];
    for(var key in vt.markers) {
      var marker = vt.markers[key];
      var poi = {};
      poi.lat = marker.position.lat().toString();
      poi.lng = marker.position.lng().toString();
      poi.slide_id = marker.slide_id;
      pois.push(poi)
    }
    slide.pois = pois;
    slide.slides = [];
    return slide
  };
  var _getMapType = function(map) {
    if(map && map.mapTypeId) {
      return map.mapTypeId
    }else {
      return V.Constant.VTour.DEFAULT_MAP
    }
  };
  var preCopyActions = function(vtJSON, vtDOM) {
  };
  var postCopyActions = function(vtJSON, vtDOM) {
  };
  return{init:init, getDummy:getDummy, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, loadSlideset:loadSlideset, unloadSlideset:unloadSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, beforeRemoveSlideset:beforeRemoveSlideset, beforeRemoveSubslide:beforeRemoveSubslide, getSlideHeader:getSlideHeader, getThumbnailURL:getThumbnailURL, preCopyActions:preCopyActions, postCopyActions:postCopyActions}
}(VISH, jQuery);
VISH.Editor.Flashcard = function(V, $, undefined) {
  var init = function() {
  };
  var getDummy = function(slidesetId, options) {
    return"<article id='" + slidesetId + "' type='" + V.Constant.FLASHCARD + "' slidenumber='" + options.slideNumber + "'><div class='delete_slide'></div><img class='help_in_slide help_in_flashcard' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div class='change_bg_button'></div></article>"
  };
  var draw = function(slidesetJSON, scaffoldDOM) {
    if(slidesetJSON) {
      if(typeof slidesetJSON.background == "string" && slidesetJSON.background != "none") {
        onBackgroundSelected(V.Utils.getSrcFromCSS(slidesetJSON.background))
      }
      if(slidesetJSON.pois) {
        var validPois = [];
        $(slidesetJSON.pois).each(function(index, poi) {
          if(poi.x && (poi.y && (poi.x <= 100 && poi.y <= 100))) {
            validPois.push(poi)
          }
        });
        if(validPois.length > 0) {
          _savePoisJSONToDom(scaffoldDOM, validPois)
        }
      }
    }
  };
  var onEnterSlideset = function(fc) {
  };
  var onLeaveSlideset = function(fc) {
  };
  var loadSlideset = function(fc) {
    $("#subslides_list").find("div.draggable_sc_div").show()
  };
  var unloadSlideset = function(fc) {
    if(!V.Editor.Renderer.isRendering()) {
      _savePoisToDom(fc)
    }
    $("#subslides_list").find("div.draggable_sc_div[ddend='background']").hide()
  };
  var beforeCreateSlidesetThumbnails = function(fc) {
    var POIdata = _getPoisFromDoom(fc);
    _drawPois(fc, POIdata)
  };
  var _drawPois = function(fc, POIdata) {
    var pois = {};
    var fc_offset = $(fc).offset();
    for(var i = 0;i < POIdata.length;i++) {
      var myPoi = POIdata[i];
      pois[myPoi.slide_id] = {};
      pois[myPoi.slide_id].x = myPoi.x * 800 / 100 + fc_offset.left;
      pois[myPoi.slide_id].y = myPoi.y * 600 / 100 + fc_offset.top;
      pois[myPoi.slide_id].slide_id = myPoi.slide_id
    }
    var subslides = $(fc).find("article");
    $("#subslides_list").find("div.wrapper_barbutton").each(function(index, div) {
      var slide = subslides[index];
      if(slide) {
        var slide_id = $(slide).attr("id");
        var arrowDiv = $('<div class="draggable_sc_div" slide_id="' + slide_id + '" >');
        $(arrowDiv).append($('<img src="' + V.ImagesPath + 'icons/flashcard_button.png" class="fc_draggable_arrow">'));
        $(arrowDiv).append($('<p class="draggable_number">' + String.fromCharCode(64 + index + 1) + "</p>"));
        $(div).prepend(arrowDiv);
        var poi = pois[slide_id];
        if(poi) {
          $(arrowDiv).css("position", "fixed");
          $(arrowDiv).css("margin-top", "0px");
          $(arrowDiv).css("margin-left", "0px");
          $(arrowDiv).css("top", poi.y + "px");
          $(arrowDiv).css("left", poi.x + "px");
          $(arrowDiv).attr("ddstart", "scrollbar");
          $(arrowDiv).attr("ddend", "background")
        }
      }
    });
    var isBackgroundShowing = V.Editor.Slideset.getCurrentSubslide() == null;
    if(!isBackgroundShowing) {
      $("#subslides_list").find("div.draggable_sc_div[ddend='background']").hide()
    }
    $("div.draggable_sc_div").draggable({start:function(event, ui) {
      var position = $(event.target).css("position");
      if(position === "fixed") {
        $(event.target).attr("ddstart", "background")
      }else {
        var current_offset = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("margin-top", current_offset.top + "px");
        $(event.target).css("margin-left", current_offset.left + "px");
        $(event.target).attr("ddstart", "scrollbar")
      }
    }, stop:function(event, ui) {
      var current_offset = $(event.target).offset();
      var fc_offset = $(fc).offset();
      var yOk = current_offset.top > fc_offset.top - 10 && current_offset.top < fc_offset.top + $(fc).outerHeight() - 38;
      var xOk = current_offset.left > fc_offset.left - 5 && current_offset.left < fc_offset.left + $(fc).outerWidth() - 44;
      var insideBackground = yOk && xOk;
      insideBackground = insideBackground && V.Editor.Slideset.getCurrentSubslide() == null;
      if(insideBackground) {
        $(event.target).attr("ddend", "background");
        if($(event.target).attr("ddstart") === "scrollbar") {
          var newTop = $(event.target).cssNumber("margin-top") + $(event.target).cssNumber("top");
          var newLeft = $(event.target).cssNumber("margin-left") + $(event.target).cssNumber("left");
          $(event.target).css("margin-top", "0px");
          $(event.target).css("margin-left", "0px");
          $(event.target).css("top", newTop + "px");
          $(event.target).css("left", newLeft + "px")
        }else {
        }
      }else {
        if($(event.target).attr("ddstart") === "scrollbar") {
        }else {
          if($(event.target).attr("ddstart") === "background") {
            var parent = $(event.target).parent();
            var parent_offset = $(parent).offset();
            var newMarginTop = parent_offset.top - 20;
            var newMarginLeft = parent_offset.left + 15;
            var newTop = $(event.target).cssNumber("top") - newMarginTop;
            var newLeft = $(event.target).cssNumber("left") - newMarginLeft;
            $(event.target).css("margin-top", newMarginTop + "px");
            $(event.target).css("margin-left", newMarginLeft + "px");
            $(event.target).css("top", newTop + "px");
            $(event.target).css("left", newLeft + "px")
          }
        }
        $(event.target).animate({top:0, left:0}, "slow", function() {
          $(event.target).css("position", "absolute");
          $(event.target).css("margin-top", "-20px");
          $(event.target).css("margin-left", "15px");
          $(event.target).attr("ddend", "scrollbar")
        })
      }
    }})
  };
  var _savePoisToJson = function(fc) {
    var pois = [];
    var poisDOM = $("#subslides_list").find("div.draggable_sc_div[ddend='background']");
    var hasCurrentClass = $(fc).hasClass("current");
    if(!hasCurrentClass) {
      $(fc).addClass("current")
    }
    V.Utils.addTempShown([fc, poisDOM]);
    var fc_offset = $(fc).offset();
    $(poisDOM).each(function(index, poi) {
      pois[index] = {};
      pois[index].x = (100 * ($(poi).offset().left - fc_offset.left) / 800).toString();
      pois[index].y = (100 * ($(poi).offset().top - fc_offset.top) / 600).toString();
      pois[index].slide_id = $(poi).attr("slide_id")
    });
    if(!hasCurrentClass) {
      $(fc).removeClass("current")
    }
    V.Utils.removeTempShown([fc, poisDOM]);
    return pois
  };
  var _savePoisToDom = function(fc) {
    var poisJSON = _savePoisToJson(fc);
    _savePoisJSONToDom(fc, poisJSON);
    return poisJSON
  };
  var _savePoisJSONToDom = function(fc, poisJSON) {
    $(fc).attr("poisData", JSON.stringify(poisJSON))
  };
  var _getPoisFromDoom = function(fc) {
    var poisData = $(fc).attr("poisData");
    if(poisData) {
      return JSON.parse($(fc).attr("poisData"))
    }else {
      return[]
    }
  };
  var onBackgroundSelected = function(contentToAdd, fc) {
    if(!fc) {
      fc = V.Slides.getCurrentSlide()
    }
    if($(fc).attr("type") === V.Constant.FLASHCARD) {
      $(fc).css("background-image", "url(" + contentToAdd + ")");
      $(fc).attr("avatar", "url('" + contentToAdd + "')");
      $(fc).find("div.change_bg_button").hide();
      V.Editor.Slides.updateThumbnail(fc)
    }
    $.fancybox.close()
  };
  var getThumbnailURL = function(fc) {
    var avatar = $(fc).attr("avatar");
    if(avatar) {
      return V.Utils.getSrcFromCSS(avatar)
    }else {
      return getDefaultThumbnailURL()
    }
  };
  var getDefaultThumbnailURL = function() {
    return V.ImagesPath + "templatesthumbs/flashcard_template.png"
  };
  var onThumbnailLoadFail = function(fc) {
    var thumbnailURL = getDefaultThumbnailURL();
    $(fc).css("background-image", "none");
    $(fc).attr("dirtyavatar", $(fc).attr("avatar"));
    $(fc).attr("avatar", "url('" + thumbnailURL + "')");
    $(fc).find("div.change_bg_button").show();
    if(V.Slides.getCurrentSlide() == fc) {
      $("#slideset_selected > img").attr("src", thumbnailURL)
    }
    var slideThumbnail = V.Editor.Thumbnails.getThumbnailForSlide(fc);
    $(slideThumbnail).attr("src", thumbnailURL)
  };
  var getSlideHeader = function(fc) {
    var slide = {};
    slide.id = $(fc).attr("id");
    slide.type = V.Constant.FLASHCARD;
    var currentBackground = $(fc).css("background-image");
    var dirtyAvatar = $(fc).attr("dirtyavatar");
    if(currentBackground == "none" && dirtyAvatar) {
      slide.background = dirtyAvatar
    }else {
      slide.background = currentBackground
    }
    if(V.Slides.getCurrentSlide() === fc) {
      _savePoisToDom(fc)
    }
    slide.pois = _getPoisFromDoom(fc);
    slide.slides = [];
    return slide
  };
  var preCopyActions = function(fcJSON, fcDOM) {
  };
  var postCopyActions = function(fcJSON, fcDOM) {
  };
  return{init:init, getDummy:getDummy, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, loadSlideset:loadSlideset, unloadSlideset:unloadSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, getSlideHeader:getSlideHeader, onBackgroundSelected:onBackgroundSelected, getThumbnailURL:getThumbnailURL, getDefaultThumbnailURL:getDefaultThumbnailURL, onThumbnailLoadFail:onThumbnailLoadFail, preCopyActions:preCopyActions, postCopyActions:postCopyActions}
}(VISH, jQuery);
VISH.Samples = function(V, undefined) {
  var basic_samples = {"id":"1", "title":"The Iberian Lynx", "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "author":"ViSH Editor Team", "language":"en", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "tags":["Do\u00f1ana", "Lynx"], "age_range":"4 - 20", "subject":["Biology"], "educational_objectives":"Know about Iberian Lynx", "adquired_competencies":"Pupils will be smarter", "VEVersion":"0.2", "type":"presentation", 
  "theme":"theme1", "animation":"animation1", "slides":[{"id":"article1", "type":"standard", "template":"t1", "elements":[{"id":"article1_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/312.jpg", "style":"position: relative; width:117.0886075949367%; height:109.47368421052632%; top:-4.7368421052631575%; left:-2.5316455696202533%;"}, {"id":"article1_zone2", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4 vish-parent-fontundefined" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><i>by <b><span class="vish-fontundefined vish-fontHelvetica" style="color:#cb6120;undefined;">Vish</span> Editor</b> Team<b>&nbsp;</b></i></span></div>'}, 
  {"id":"article1_zone3", "areaid":"subheader"}]}, {"id":"article2", "type":"standard", "template":"t8", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6 vish-parent-fontundefined" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;"> Lynx &nbsp; &nbsp; &nbsp;</span><span class="vish-fontundefined vish-fontHelvetica" style="color:#5ea099;undefined;">Description and habitat</span></div>'}, 
  {"id":"article2_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/73.jpeg", "style":"position: relative; width:130.4%; height:106.6%; top:0.5%; left:-25.2%;"}, {"id":"article2_zone3", "type":"text", "areaid":"center", "body":'In most respects, the Iberian Lynx resembles other species of lynx, with a short tail,tufted ears and a ruff of fur beneath the chin. ...<div class="vish-parent-font7" style="font-weight: normal; "><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article2_zone4", "type":"image", "areaid":"right", "body":"http://vishub.org/pictures/313.png", "style":"position: relative; width:119.5%; height:88.6%; top:3.4%; left:-2.6%;"}]}, {"id":"article3", "type":"standard", "template":"t3", "elements":[{"id":"article3_zone1", "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article3_zone2", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/8t29CZcGAbs?wmode=opaque" frameborder="0" id="resizableunicID9" class="t3_object" wmode="opaque"></iframe>', "style":"position: relative; width:85.81661891117479%; height:100%; top:0.22321428571428573%; left:6.446991404011461%;"}]}, {"id":"article4", "type":"standard", "template":"t6", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;Lynx</span><br></div>'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.6111111111111%; height:217.9%; top:-34.97%; left:-42.13%;"}, {"id":"article4_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.1%; height:217.7%; top:-46.9%; left:-199.1%;"}, {"id":"article4_zone4", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font4 vish-parent-fontundefined" style="text-align: center; font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">During the mating season the female leaves her territory...</span><span class="vish-fontundefined vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, 
  {"id":"article5", "type":"standard", "template":"t10", "elements":[{"id":"article5_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Do%C3%B1ana_National_Park?wmode=transparent" id="resizableunicID15" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article6", "type":"standard", "template":"t12", "elements":[{"id":"article6_zone1", "areaid":"left1"}, {"id":"article6_zone2", 
  "areaid":"right1"}, {"id":"article6_zone3", "areaid":"left2"}, {"id":"article6_zone4", "type":"image", "areaid":"right2", "body":"http://vishub.org/pictures/312.jpg", "style":"position: relative; width:114.6%; height:113.8%; top:0%; left:0%;"}]}]};
  var full_samples = {"id":"4", "VEVersion":"0.2", "type":"presentation", "theme":"theme12", "animation":"animation1", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "title":"The Iberian Lynx", "author":"ViSH Editor Team", "contributors":[{"name":"Fred Griffin", "vishMetadata":{"id":5}}], "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "tags":["Do\u00f1ana", "Lynx", "Biology"], "language":"en", "context":"university", 
  "age_range":"4 - 20", "difficulty":"easy", "subject":["Art", "Astronomy", "Biology"], "TLT":"PT6H30M15S", "educational_objectives":"Know about the Iberian Lynx", "slides":[{"id":"article1", "type":"standard", "template":"t1", "elements":[{"id":"article1_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/312.jpeg", "style":"position: relative; width:117.0886075949367%; height:109.47368421052632%; top:-4.7368421052631575%; left:-2.320675105485232%;"}, {"id":"article1_zone2", 
  "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><b><i><br></i></b></span></div><div class="initTextDiv vish-parent-font4 vish-parent-fontundefined" style="text-align: right;"><span class="vish-font4 vish-fonthelvetica" style="color:undefined;undefined;"><i>by <b><span class="vish-fontundefined vish-fontHelvetica" style="color:#cb6120;undefined;">Vish</span> Editor</b> Team<b>&nbsp;</b></i></span></div>'}, 
  {"id":"article1_zone3", "areaid":"subheader"}]}, {"id":"article2", "type":"standard", "template":"t8", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6 vish-parent-fontundefined" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;"> Lynx &nbsp; &nbsp; &nbsp;</span><span class="vish-fontundefined vish-fontHelvetica" style="color:#5ea099;undefined;">Description and habitat</span></div>'}, 
  {"id":"article2_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/73.jpeg", "style":"position: relative; width:130.43478260869566%; height:106.63507109004739%; top:0%; left:-25.217391304347824%;"}, {"id":"article2_zone3", "type":"text", "areaid":"center", "body":'In most respects, the Iberian Lynx resembles other species of lynx, with a short tail,tufted ears and a ruff of fur beneath the chin. ...<div class="vish-parent-font7" style="font-weight: normal; "><span class="vish-font7 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article2_zone4", "type":"image", "areaid":"right", "body":"http://vishub.org/pictures/313.png", "style":"position: relative; width:119.56521739130434%; height:88.60759493670886%; top:2.9535864978902953%; left:-2.608695652173913%;"}]}, {"id":"article12", "template":"t3", "elements":[{"id":"article12_zone1", "type":"text", "areaid":"header", "body":"Experimento virtual"}, {"id":"article12_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="/examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash" id="resizableunicID8" class="t3_object" wmode="opaque">', 
  "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article8", "type":"flashcard", "background":"url(http://vishub.org/pictures/317.png)", "pois":[{"id":"article8_poi1", "x":"36.9", "y":"67.3", "slide_id":"article8_article1"}, {"id":"article8_poi2", "x":"55.4", "y":"68.16", "slide_id":"article8_article2"}, {"id":"article8_poi3", "x":"45.875", "y":"5.5", "slide_id":"article8_article3"}], "slides":[{"id":"article8_article1", "type":"standard", "template":"t2", "elements":[{"id":"article8_article1_zone1", 
  "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/318.jpeg", "style":"position: relative; width:110.31518624641834%; height:97.1590909090909%; top:2.0833333333333335%; left:-1.146131805157593%;"}]}, {"id":"article8_article2", "type":"standard", "template":"t2", "elements":[{"id":"article8_article2_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/327.jpeg", "style":"position: relative; width:103.15186246418338%; height:90.53030303030303%; top:3.0303030303030303%; left:-0.5730659025787965%;"}]}, 
  {"id":"article8_article3", "type":"standard", "template":"t2", "elements":[{"id":"article8_article3_zone1", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/319.jpeg", "style":"position: relative; width:119.05444126074498%; height:129.54545454545453%; top:-2.6515151515151514%; left:-3.5816618911174785%;"}]}]}, {"id":"article9", "type":"standard", "template":"t3", "elements":[{"id":"article9_zone1", "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article9_zone2", "type":"video", "areaid":"left", "poster":"https://raw.githubusercontent.com/ging/vish_editor/master/images/vicons/example_poster_image.jpg", "style":"position: relative; width:100%; height:100%; top:-3.125%; left:0.14326647564469913%;", "sources":'[{ "type": "video/webm", "src": "http://vishub.org/videos/325.webm"},{ "type": "video/mp4", "src": "http://vishub.org/videos/325.mp4"}]'}]}, {"id":"article3", "type":"standard", "template":"t3", "elements":[{"id":"article3_zone1", 
  "type":"text", "areaid":"header", "body":'<span class="vish-font6 vish-fontHelvetica" style="color: rgb(219, 150, 0); font-weight: normal; ">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">Lynx</span><div class="vish-parent-font4"><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article3_zone2", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/8t29CZcGAbs?wmode=opaque" frameborder="0" id="resizableunicID4" class="t3_object" wmode="opaque"></iframe>', "style":"position: relative; width:85.81661891117479%; height:100%; top:0%; left:6.446991404011461%;"}]}, {"id":"article4", "type":"standard", "template":"t6", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<div class="initTextDiv vish-parent-font6" style="font-weight: normal; "><span class="vish-font6 vish-fontHelvetica" style="color:#db9600;font-weight: bold;  ;">Iberian</span><span class="vish-font6 vish-fontHelvetica" style="color:undefined;font-weight: bold; ;">&nbsp;Lynx</span><br></div>'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.6111111111111%; height:217.91044776119404%; top:-34.9680170575693%; left:-42.129629629629626%;"}, {"id":"article4_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/314.jpeg", "style":"position: relative; width:373.14814814814815%; height:217.69722814498934%; top:-46.695095948827294%; left:-199.07407407407408%;"}, {"id":"article4_zone4", 
  "type":"text", "areaid":"right", "body":'<div class="vish-parent-font4 vish-parent-fontundefined" style="text-align: center; font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">During the mating season the female leaves her territory...</span><span class="vish-fontundefined vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article5", "type":"standard", "template":"t10", "elements":[{"id":"article5_zone1", "type":"object", 
  "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Do%C3%B1ana_National_Park?wmode=transparent" id="resizableunicID7" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article7", "type":"flashcard", "background":"url(http://vishub.org/pictures/320.jpeg)", "pois":[{"id":"article7_poi1", "x":"15.63", "y":"8.5", "slide_id":"article7_article1"}, {"id":"article7_poi2", "x":"77.75", "y":"11.5", "slide_id":"article7_article2"}, 
  {"id":"article7_poi3", "x":"17.125", "y":"58.83", "slide_id":"article7_article3"}], "slides":[{"id":"article7_article1", "type":"standard", "template":"t10", "elements":[{"id":"article7_article1_zone1", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/321.jpeg", "style":"position: relative; width:49.62406015037594%; height:66.22073578595318%; top:15.719063545150501%; left:24.18546365914787%;"}]}, {"id":"article7_article2", "type":"standard", "template":"t10", "elements":[{"id":"article7_article2_zone1", 
  "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/322.jpeg", "style":"position: relative; width:60.526315789473685%; height:67.3913043478261%; top:15.719063545150501%; left:20.17543859649123%;"}]}, {"id":"article7_article3", "type":"standard", "template":"t10", "elements":[{"id":"article7_article3_zone1", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/323.jpeg", "style":"position: relative; width:115.91478696741855%; height:116.05351170568562%; top:-2.842809364548495%; left:-0.7518796992481203%;"}]}]}, 
  {"id":"article6", "type":"standard", "template":"t12", "elements":[{"id":"article6_zone1", "areaid":"left1"}, {"id":"article6_zone2", "areaid":"right1"}, {"id":"article6_zone3", "areaid":"left2"}, {"id":"article6_zone4", "type":"image", "areaid":"right2", "body":"http://vishub.org/pictures/312.jpeg", "style":"position: relative; width:114.6268656716418%; height:113.83399209486166%; top:0%; left:0%;"}]}, {"id":"article13", "type":"standard", "template":"t2", "elements":[{"id":"article13_zone1", 
  "type":"snapshot", "areaid":"left", "body":'<iframe src="http://en.wikipedia.org" id="resizableunicID10" class="snapshot_content" scrolling="no" wmode="transparent"></iframe>', "style":"position: relative; width:61.46131805157593%; height:61.17424242424242%; top:40.15151515151515%; left:-15.759312320916905%;", "scrollTop":417, "scrollLeft":129}]}, {"id":"article14", "type":"VirtualTour", "map_service":"Google Maps", "center":{"lat":"41.23", "lng":"-366.3"}, "zoom":"5", "mapType":"roadmap", "width":"100%", 
  "height":"100%", "pois":[{"id":"article14_poi1", "lat":"40.24", "lng":"-3.6", "slide_id":"article14_article1"}, {"id":"article14_poi2", "lat":"41.2", "lng":"2.1", "slide_id":"article14_article2"}, {"id":"article14_poi3", "lat":"37.26", "lng":"-5.97", "slide_id":"article14_article3"}, {"id":"article14_poi4", "lat":"43.26", "lng":"-5.97", "slide_id":"article14_article4"}], "tours":[{"id":"article14_tour1", "path":["article14_poi1", "article14_poi2", "article14_poi3"]}], "slides":[{"id":"article14_article1", 
  "template":"t1", "elements":[{"id":"article14_article1_zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article14_article1_zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"article14_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article14_article2", "template":"t3", "elements":[{"id":"article14_article2_zone1", "type":"text", 
  "areaid":"header", "body":"Experimento virtual1"}, {"id":"article14_article2_zone2", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="/examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"article14_article3", "template":"t6", "elements":[{"id":"article14_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article14_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article14_article3_zone4", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article14_article3_zone5", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article14_article4", "type":"standard", "template":"t2", "elements":[{"id":"article14_article4_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]}, {"id":"article15", "type":"enrichedvideo", "video":{"type":"HTML5_VIDEO", 
  "sources":'[{ "type": "video/webm", "src": "http://vishub.org/videos/3447.webm"},{ "type": "video/mp4", "src": "http://vishub.org/videos/3447.mp4"}]', "poster":"http://vishub.org/videos/3447.png?style=170x127%23", "duration":"24.066"}, "pois":[{"id":"article15_poi1", "etime":"15.3", "slide_id":"article15_article1", "name":"Curiosity YouTube video at 15.3"}, {"id":"article15_poi2", "etime":"61.5", "slide_id":"article15_article2", "name":"Curiosity Wikipedia at 61.5"}, {"id":"article15_poi3", "etime":"120", 
  "slide_id":"article15_article3", "name":"3 at 120"}, {"id":"article15_poi4", "etime":"174", "slide_id":"article15_article4", "name":"4 at the end of the Video"}], "slides":[{"id":"article15_article1", "type":"standard", "template":"t2", "elements":[{"id":"article15_article1_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.wikipedia.com?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, 
  {"id":"article15_article2", "type":"standard", "template":"t7", "elements":[{"id":"article15_article2_zone1", "type":"image", "areaid":"header", "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, {"id":"article15_article2_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, 
  {"id":"article15_article2_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, {"id":"article15_article2_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, 
  {"id":"article15_article3", "type":"standard", "template":"t10", "elements":[{"id":"article15_article3_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article15_article4", "type":"standard", "template":"t10", "elements":[{"id":"article15_article4_zone1", "type":"object", 
  "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}, {"id":"article16", "type":"enrichedvideo", "video":{"type":"Youtube", "source":"http://www.youtube.com/embed/8t29CZcGAbs", "duration":"174"}, "pois":[{"id":"article16_poi1", "etime":"15.3", "slide_id":"article16_article1", "name":"Curiosity YouTube video at 15.3"}, 
  {"id":"article16_poi2", "etime":"62", "slide_id":"article16_article2", "name":"Alpha Particle X-Ray  at 61.5"}, {"id":"article16_poi3", "etime":"62", "slide_id":"article16_article3", "name":"Curiosity Wikipedia at 62"}, {"id":"article16_poi5", "etime":"120", "name":"No ball at 120"}, {"id":"article16_poi4", "etime":"174", "slide_id":"article16_article4", "name":"4 at the end of the Video"}], "slides":[{"id":"article16_article1", "type":"standard", "template":"t2", "elements":[{"id":"article16_article1_zone1", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.wikipedia.com?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, {"id":"article16_article2", "type":"standard", "template":"t7", "elements":[{"id":"article16_article2_zone1", "type":"image", "areaid":"header", "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, 
  {"id":"article16_article2_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article16_article2_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, 
  {"id":"article16_article2_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article16_article3", "type":"standard", "template":"t10", "elements":[{"id":"article16_article3_zone1", "type":"object", "areaid":"center", 
  "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article16_article4", "type":"standard", "template":"t10", "elements":[{"id":"article16_article4_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', 
  "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}, {"id":"article17", "type":"standard", "template":"t10", "elements":[{"id":"article17_zone1", "type":"audio", "areaid":"center", "style":"position: relative; width:100%; height:100%; top:0%; left:0%;", "sources":'[{ "type": "audio/ogg", "src": "http://demos.w3avenue.com/html5-unleashed-tips-tricks-and-techniques/demo-audio.ogg"},{ "type": "audio/mpeg", "src": "http://demos.w3avenue.com/html5-unleashed-tips-tricks-and-techniques/demo-audio.mp3"}]'}]}, 
  {"id":"article18", "type":"standard", "template":"t2", "elements":[{"id":"article18_zone1", "type":"object", "areaid":"left", "body":'<iframe objecttype="scormpackage" src="/examples/contents/scormappcode/41/vishubcode_scorm_wrapper.html?wmode=opaque" wmode="opaque" id="resizableunicID55" class="t2_object"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;", "subtype":"scormpackage"}]}, {"id":"article19", "type":"standard", "template":"t2", "elements":[{"id":"article19_zone1", 
  "type":"object", "areaid":"left", "body":'<iframe src="/examples/contents/webappcode/11/index.html" width="800" height="600" objecttype="webapp" id="resizableunicID53" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;", "subtype":"webapp"}]}]};
  var fc_sample = {"id":"3", "VEVersion":"0.2", "type":"flashcard", "title":"Curiosity Flashcard", "description":'A Flashcard about "Curiosity", the car-sized robotic rover exploring Gale Crater on Mars.', "avatar":"http://vishub.org/pictures/311.jpg", "tags":["Science", "Space", "Mars"], "age_range":"12 - 30", "subject":["Astronomy"], "language":"independent", "educational_objectives":'Know about "Curiosity", the car-sized robotic rover exploring Gale Crater on Mars.', "adquired_competencies":"Pupils will be smarter", 
  "author":"ViSH Editor Team", "slides":[{"id":"article4", "type":"flashcard", "background":"url(http://vishub.org/pictures/311.jpg)", "pois":[{"id":"article4_poi1", "x":"88.88", "y":"50.83", "slide_id":"article4_article1"}, {"id":"article4_poi2", "x":"45.5", "y":"2.5", "slide_id":"article4_article3"}, {"id":"article4_poi3", "x":"13.5", "y":"63.17", "slide_id":"article4_article4"}], "slides":[{"id":"article4_article1", "type":"standard", "template":"t2", "elements":[{"id":"article4_article1_zone1", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/P4boyXQuUIw?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, {"id":"article4_article3", "type":"standard", "template":"t7", "elements":[{"id":"article4_article3_zone1", "type":"image", "areaid":"header", "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, 
  {"id":"article4_article3_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article4_article3_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, 
  {"id":"article4_article3_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article4_article4", "type":"standard", "template":"t10", "elements":[{"id":"article4_article4_zone1", "type":"object", "areaid":"center", 
  "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}]};
  var vt_sample = {"id":"1987", "title":"Toledo Virtual Tour", "description":"Virtual Tour example with ViSH Editor", "author":"Aldo", "avatar":"http://vishub.org/assets/logos/original/excursion-05.png", "tags":["Samples", "Test", "Development", "Virtual Tour"], "age_range":"4 - 14", "subject":"Media Education", "educational_objectives":"Amazing educational Virtual Tour", "adquired_competencies":"Pupils will be smarter", "type":"VirtualTour", "theme":"theme1", "language":"en", "VEVersion":"0.4", 
  "slides":[{"id":"article5", "type":"VirtualTour", "map_service":"Google Maps", "center":{"lat":"41.23", "lng":"-366.3"}, "zoom":5, "mapType":"roadmap", "width":"100%", "height":"100%", "pois":[{"id":"article5_poi1", "lat":"40.24", "lng":"-3.6", "slide_id":"article5_article1"}, {"id":"article5_poi2", "lat":"41.2", "lng":"2.1", "slide_id":"article5_article2"}, {"id":"article5_poi3", "lat":"37.26", "lng":"-5.97", "slide_id":"article5_article3"}, {"id":"article5_poi4", "lat":"43.26", "lng":"-5.97", 
  "slide_id":"article5_article4"}], "tours":[{"id":"article5_tour1", "path":["article5_poi1", "article5_poi2", "article5_poi3"]}], "slides":[{"id":"article5_article1", "template":"t1", "elements":[{"id":"article5_article1_zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"article5_article1_zone2", "type":"text", 
  "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, {"id":"article5_article1_zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, 
  {"id":"article5_article2", "template":"t3", "elements":[{"id":"article5_article2_zone1", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, {"id":"article5_article2_zone2", "type":"object", "areaid":"left", "body":'<embed id="resizableunicID12" class="t10_object" src="http://localhost/examples/contents/swf/virtualexperiment.swf" wmode="opaque">', "style":"position: relative; width:64.53634085213032%; height:64.71571906354515%; top:15.719063545150501%; left:15.288220551378446%;"}]}, 
  {"id":"article5_article3", "template":"t6", "elements":[{"id":"article5_article3_zone1", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"article5_article3_zone2", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"article5_article3_zone4", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"article5_article3_zone5", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article5_article4", "type":"standard", "template":"t2", "elements":[{"id":"article5_article4_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]}]};
  var evideo_sample = {"VEVersion":"0.7", "type":"presentation", "title":"Enriched Video Example", "description":"First Enriched Video Example", "avatar":"http://vishub.org/pictures/311.jpg", "tags":["Science", "Quiz", "Video"], "age_range":"12 - 30", "subject":["Astronomy"], "language":"independent", "educational_objectives":"MOOCs", "adquired_competencies":"More engaged videos", "author":"ViSH Editor Team", "slides":[{"id":"article1", "type":"enrichedvideo", "video":{"type":"HTML5_VIDEO", "sources":'[{ "type": "video/webm", "src": "http://vishub.org/videos/3447.webm"},{ "type": "video/mp4", "src": "http://vishub.org/videos/3447.mp4"}]', 
  "poster":"http://vishub.org/videos/3447.png?style=170x127%23", "duration":"24.066"}, "pois":[{"id":"article1_poi1", "etime":"15.3", "slide_id":"article1_article1", "name":"Curiosity YouTube video at 15.3"}, {"id":"article1_poi2", "etime":"61.5", "slide_id":"article1_article2", "name":"Curiosity Wikipedia at 61.5"}, {"id":"article1_poi3", "etime":"120", "slide_id":"article1_article3", "name":"3 at 120"}, {"id":"article1_poi4", "etime":"174", "slide_id":"article1_article4", "name":"4 at the end of the Video"}], 
  "slides":[{"id":"article1_article1", "type":"standard", "template":"t2", "elements":[{"id":"article1_article1_zone1", "type":"object", "areaid":"left", "body":'<iframe src="http://www.wikipedia.com?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, {"id":"article1_article2", "type":"standard", "template":"t7", "elements":[{"id":"article1_article2_zone1", "type":"image", "areaid":"header", 
  "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, {"id":"article1_article2_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article1_article2_zone3", 
  "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, {"id":"article1_article2_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, 
  {"id":"article1_article3", "type":"standard", "template":"t10", "elements":[{"id":"article1_article3_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article1_article4", "type":"standard", "template":"t10", "elements":[{"id":"article1_article4_zone1", "type":"object", 
  "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}, {"id":"article2", "type":"enrichedvideo", "video":{"type":"Youtube", "source":"http://www.youtube.com/embed/8t29CZcGAbs", "duration":"174"}, "pois":[{"id":"article2_poi1", "etime":"15.3", "slide_id":"article2_article1", "name":"Curiosity YouTube video at 15.3"}, 
  {"id":"article2_poi2", "etime":"62", "slide_id":"article2_article2", "name":"Alpha Particle X-Ray  at 61.5"}, {"id":"article2_poi3", "etime":"62", "slide_id":"article2_article3", "name":"Curiosity Wikipedia at 62"}, {"id":"article2_poi5", "etime":"120", "name":"No ball at 120"}, {"id":"article2_poi4", "etime":"174", "slide_id":"article2_article4", "name":"4 at the end of the Video"}], "slides":[{"id":"article2_article1", "type":"standard", "template":"t2", "elements":[{"id":"article2_article1_zone1", 
  "type":"object", "areaid":"left", "body":'<iframe src="http://www.wikipedia.com?wmode=opaque" frameborder="0" id="resizableunicID3" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:98.7%; top:0%; left:0%;"}]}, {"id":"article2_article2", "type":"standard", "template":"t7", "elements":[{"id":"article2_article2_zone1", "type":"image", "areaid":"header", "body":"http://vishub.org/pictures/315.jpeg", "style":"position: relative; width:101.9%; height:190.4%; top:-69.2%; left:-0.1%;"}, 
  {"id":"article2_article2_zone2", "type":"text", "areaid":"left", "body":'The image shows the Alpha Particle X-Ray Spectrometer (APXS) on NASA\'s Curiosity rover, with the Martian landscape in the background.<div class="vish-parent-font5" style="font-weight: normal; "><span class="vish-font5 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}, {"id":"article2_article2_zone3", "type":"image", "areaid":"center", "body":"http://vishub.org/pictures/316.jpeg", "style":"position: relative; width:129.1%; height:110.6%; top:-5.2%; left:-10.9%;"}, 
  {"id":"article2_article2_zone4", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font4" style="font-weight: normal; "><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;">Image credit: NASA/JPL-Caltech/MSSS</span><span class="vish-font4 vish-fontHelvetica" style="color:undefined;undefined;"></span></div>'}]}, {"id":"article2_article3", "type":"standard", "template":"t10", "elements":[{"id":"article2_article3_zone1", "type":"object", "areaid":"center", 
  "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}, {"id":"article2_article4", "type":"standard", "template":"t10", "elements":[{"id":"article2_article4_zone1", "type":"object", "areaid":"center", "body":'<iframe src="http://en.wikipedia.org/wiki/Curiosity_rover?wmode=transparent" id="resizableunicID6" class="t10_object" wmode="opaque"></iframe>', 
  "style":"position: relative; width:100%; height:100%; top:0%; left:0%;"}]}]}, {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "areaid":"left"}]}, {"id":"article4", "type":"standard", "template":"t2", "elements":[{"id":"article4_zone1", "areaid":"left"}]}, {"id":"article5", "type":"standard", "template":"t2", "elements":[{"id":"article5_zone1", "areaid":"left"}]}, {"id":"article6", "type":"standard", "template":"t2", "elements":[{"id":"article6_zone1", "areaid":"left"}]}, 
  {"id":"article7", "type":"standard", "template":"t2", "elements":[{"id":"article7_zone1", "areaid":"left"}]}]};
  var quiz_samples = {"VEVersion":"0.8.7", "type":"presentation", "title":"Quiz samples", "description":"Quiz example", "avatar":"http://vishub.org/assets/logos/original/excursion-15.png", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "tags":["Quizzes", "Lynx", "Biology", "Maths"], "theme":"theme1", "animation":"animation1", "language":"independent", "age_range":"4 - 20", "subject":["Education", "Environmental Education", "Geology", "Physics"], "vishMetadata":{"url":"http://vishub.org", 
  "draft":"false", "id":"500"}, "slides":[{"id":"article2", "type":"standard", "template":"t2", "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"unlimited", "ARSEnabled":true}, "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00adWhat is the oldest ancient weapon?", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;What is the oldest ancient weapon?</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"Fu\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Fu&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00adBow", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Bow</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Chu Ko Nuh</span></span></p>\n', 
  "answer":false}, {"id":"4", "value":"\u00adWar Galley", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;War Galley</span></span></p>\n', "answer":false}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article2", "type":"quiz_simple", "template":"t2", 
  "elements":[{"id":"article2_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"unlimited", "ARSEnabled":true}, "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00adWhat is the oldest ancient weapon?", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;What is the oldest ancient weapon?</span></span></p>\n'}, "choices":[{"id":"1", "value":"Fu\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Fu&shy;</span></span></p>\n', 
  "answer":false}, {"id":"2", "value":"\u00adBow", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Bow</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Chu Ko Nuh</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00adWar Galley", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;War Galley</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":false}}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article1", "type":"standard", "template":"t2", "elements":[{"id":"article1_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"2", "ARSEnabled":true}, "quiztype":"truefalse", "selfA":true, "question":{"value":"\u00adWhat of the followings are ancient weapons?", "wysiwygValue":'<p style="text-align:left;">\n\t<span style="color:#ff0000;"><span style="font-size:10px;"><span autocolor="true">&shy;</span><span autocolor="true"><span style="font-size:24px;">What of the followings are ancient weapons?</span></span></span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24.44444465637207px;">Chu Ko Nuh</span></p>\n', "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", 
  "value":"Halberd", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Halberd</font></p>\n', "answer":true}, {"id":"4", "value":"Battleaxe", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Battleaxe</font></p>\n', "answer":true}], "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article1", "type":"quiz_simple", 
  "template":"t2", "elements":[{"id":"article1_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"2", "ARSEnabled":true}, "quiztype":"truefalse", "selfA":true, "question":{"value":"\u00adWhat of the followings are ancient weapons?", "wysiwygValue":'<p style="text-align:left;">\n\t<span style="color:#ff0000;"><span style="font-size:10px;"><span autocolor="true">&shy;</span><span autocolor="true"><span style="font-size:24px;">What of the followings are ancient weapons?</span></span></span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00adChu Ko Nuh", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24.44444465637207px;">Chu Ko Nuh</span></p>\n', "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", 
  "value":"Halberd", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Halberd</font></p>\n', "answer":true}, {"id":"4", "value":"Battleaxe", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5">Battleaxe</font></p>\n', "answer":true}]}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, 
  "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\n\nWhat are ancient weapons?\u00ad\n", "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What are ancient weapons?&shy;</span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n'}, "choices":[{"id":"1", "value":"\u00adFu", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Fu</span></span></p>\n', 
  "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", "value":"Chu Ko Nuh\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Chu Ko Nuh&shy;</span></span></p>\n', "answer":true}, {"id":"4", "value":"\u00adNuclear bomb", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Nuclear bomb</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":true}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article3", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article3_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\n\nWhat are ancient weapons?\u00ad\n", 
  "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What are ancient weapons?&shy;</span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n'}, "choices":[{"id":"1", "value":"\u00adFu", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Fu</span></span></p>\n', 
  "answer":true}, {"id":"2", "value":"\u00adGun", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Gun</span></span></p>\n', "answer":false}, {"id":"3", "value":"Chu Ko Nuh\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Chu Ko Nuh&shy;</span></span></p>\n', "answer":true}, {"id":"4", "value":"\u00adNuclear bomb", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Nuclear bomb</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":true}}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article4", "type":"standard", "template":"t8", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:18px;">Ejemplo de un Quiz enriquecido&shy;</span></span></p>\n'}, {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://farm8.staticflickr.com/7328/11049505694_7e90530bee.jpg", 
  "style":"position: relative; width:110.9704641350211%; height:121.81818181818181%; top:-0.9090909090909091%; left:-3.7776898734177213%;"}, {"id":"article4_zone3", "type":"quiz", "areaid":"center", "settings":{"nAttempts":"1", "ARSEnabled":false}, "quiztype":"multiplechoice", "selfA":true, "question":{"value":"What is the capital of Spain?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What is the capital of Spain?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"Barcelona\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Barcelona&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00adMadrid", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Madrid</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u00adLugo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Lugo</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article4", "type":"quiz_simple", "template":"t8", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"header", "body":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:18px;">Ejemplo de un Quiz enriquecido&shy;</span></span></p>\n'}, 
  {"id":"article4_zone2", "type":"image", "areaid":"left", "body":"http://farm8.staticflickr.com/7328/11049505694_7e90530bee.jpg", "style":"position: relative; width:110.9704641350211%; height:121.81818181818181%; top:-0.9090909090909091%; left:-3.7776898734177213%;"}, {"id":"article4_zone3", "type":"quiz", "areaid":"center", "settings":{"nAttempts":"1", "ARSEnabled":false}, "quiztype":"multiplechoice", "selfA":true, "question":{"value":"What is the capital of Spain?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">What is the capital of Spain?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"Barcelona\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Barcelona&shy;</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00adMadrid", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Madrid</span></span></p>\n', "answer":true}, {"id":"3", "value":"\u00adLugo", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Lugo</span></span></p>\n', 
  "answer":false}], "extras":{"multipleAnswer":false}}, {"id":"article4_zone4", "type":"image", "areaid":"right", "body":"http://farm6.staticflickr.com/5520/11018661665_67b642b119.jpg", "style":"position: relative; width:109.70464135021098%; height:140.8906882591093%; top:-17.503795546558706%; left:-9.26292194092827%;"}], "containsQuiz":true}]}}, {"id":"article4_zone4", "type":"image", "areaid":"right", "body":"http://farm6.staticflickr.com/5520/11018661665_67b642b119.jpg", "style":"position: relative; width:109.70464135021098%; height:140.8906882591093%; top:-17.503795546558706%; left:-9.26292194092827%;"}], 
  "containsQuiz":true}, {"id":"article5", "type":"standard", "template":"t5", "elements":[{"id":"article5_zone1", "areaid":"header"}, {"id":"article5_zone2", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, "quiztype":"truefalse", "selfA":true, "question":{"value":"Small quiz\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Small quiz&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"Option a\u00ad", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option a&shy;</span></span></p>\n', "answer":true}, {"id":"2", "value":"Option b\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option b&shy;</span></span></p>\n', "answer":false}, {"id":"3", "value":"Option c\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option c&shy;</span></span></p>\n', 
  "answer":false}, {"id":"4", "value":"Option d\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option d&shy;</span></span></p>\n', "answer":"?"}], "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article5", "type":"quiz_simple", "template":"t5", "elements":[{"id":"article5_zone1", 
  "areaid":"header"}, {"id":"article5_zone2", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, "quiztype":"truefalse", "selfA":true, "question":{"value":"Small quiz\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Small quiz&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"Option a\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option a&shy;</span></span></p>\n', 
  "answer":true}, {"id":"2", "value":"Option b\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option b&shy;</span></span></p>\n', "answer":false}, {"id":"3", "value":"Option c\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option c&shy;</span></span></p>\n', "answer":false}, {"id":"4", "value":"Option d\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">Option d&shy;</span></span></p>\n', 
  "answer":"?"}]}, {"id":"article5_zone3", "areaid":"right"}], "containsQuiz":true}]}}, {"id":"article5_zone3", "areaid":"right"}], "containsQuiz":true}, {"id":"article6", "type":"standard", "template":"t18", "elements":[{"id":"article6_zone1", "areaid":"header"}, {"id":"article6_zone2", "type":"quiz", "areaid":"center", "settings":{"nAttempts":"3", "ARSEnabled":true}, "quiztype":"sorting", "selfA":true, "question":{"value":"Ordena los siguientes eventos de m\u00e1s moderno (1) a m\u00e1s antiguo.\u00ad\n\u00ad", 
  "wysiwygValue":'<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 38px; text-align: center;">Ordena los siguientes eventos de m&aacute;s moderno (1) a m&aacute;s antiguo.&shy;</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"Mundial Brasil (2014\u00ad)\n\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 24px;">Mundial Brasil (2014&shy;)</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n', 
  "answer":1}, {"id":"2", "value":"Comienzo Segunda Guerra Mundial (1939)\n\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 24px; color: rgb(34, 34, 34);">Comienzo Segunda Guerra Mundial (1939)</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n', "answer":2}, {"id":"3", "value":"\u00adDescubrimiento de Am\u00e9rica (1492)", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24px;">Descubrimiento de Am&eacute;rica (1492)</span></p>\n', 
  "answer":3}], "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article6", "type":"quiz_simple", "template":"t18", "elements":[{"id":"article6_zone1", "areaid":"header"}, {"id":"article6_zone2", "type":"quiz", "areaid":"center", "settings":{"nAttempts":"3", "ARSEnabled":true}, "quiztype":"sorting", "selfA":true, "question":{"value":"Ordena los siguientes eventos de m\u00e1s moderno (1) a m\u00e1s antiguo.\u00ad\n\u00ad", 
  "wysiwygValue":'<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 38px; text-align: center;">Ordena los siguientes eventos de m&aacute;s moderno (1) a m&aacute;s antiguo.&shy;</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"Mundial Brasil (2014\u00ad)\n\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 24px;">Mundial Brasil (2014&shy;)</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n', 
  "answer":1}, {"id":"2", "value":"Comienzo Segunda Guerra Mundial (1939)\n\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size: 24px; color: rgb(34, 34, 34);">Comienzo Segunda Guerra Mundial (1939)</span></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n', "answer":2}, {"id":"3", "value":"\u00adDescubrimiento de Am\u00e9rica (1492)", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span><span style="color: rgb(0, 0, 0); font-size: 24px;">Descubrimiento de Am&eacute;rica (1492)</span></p>\n', 
  "answer":3}]}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article7", "type":"standard", "template":"t2", "elements":[{"id":"article7_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"3", "ARSEnabled":true}, "quiztype":"openAnswer", "selfA":true, "question":{"value":"\u00bfCuanto vale 2+2?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&iquest;Cuanto vale 2+2?&shy;</span></span></p>\n'}, 
  "answer":{"value":"4\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">4&shy;</span></span></p>\n'}, "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article7", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article7_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"3", 
  "ARSEnabled":true}, "quiztype":"openAnswer", "selfA":true, "question":{"value":"\u00bfCuanto vale 2+2?\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&iquest;Cuanto vale 2+2?&shy;</span></span></p>\n'}, "answer":{"value":"4\u00ad", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">4&shy;</span></span></p>\n'}}], "containsQuiz":true}]}}], "containsQuiz":true}, 
  {"id":"article8", "type":"standard", "template":"t2", "elements":[{"id":"article8_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, "quiztype":"openAnswer", "selfA":false, "question":{"value":"\nEscribe todo lo que sepas sobre la II Guerra Mundial.", "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span style="font-size:24px;"><font color="#000000">Escribe todo lo que sepas sobre la II Guerra Mundial.</font></span></p>\n'}, 
  "answer":{"value":"La Segunda Guerra Mundial fue un conflicto militar global que se desarroll\u00f3 entre 1939 y 1945. En \u00e9l se vieron implicadas la mayor parte de las naciones del mundo, incluidas todas las grandes potencias, agrupadas en dos alianzas militares enfrentadas: los Aliados y las Potencias del Eje. Fue la mayor contienda b\u00e9lica de laHistoria, con m\u00e1s de cien millones de militares movilizados y un estado de \u00abguerra total\u00bb en que los grandes contendientes destinaron toda su capacidad econ\u00f3mica, militar y cient\u00edfica al servicio del esfuerzo b\u00e9lico, borrando la distinci\u00f3n entre recursos civiles y militares. Marcada por hechos de enorme significaci\u00f3n que incluyeron la muerte masiva de civiles, el Holocausto y el uso, por primera y \u00fanica vez, de armas nucleares en un conflicto militar, la Segunda Guerra Mundial fue el conflicto m\u00e1s mort\u00edfero en la historia de la humanidad,1 con un resultado final de entre 50 y 70 millones de v\u00edctimas.\n\u00ad", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">La&nbsp;</span><b style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">Segunda Guerra Mundial</b><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;fue un&nbsp;</span><a href="http://es.wikipedia.org/wiki/Guerra" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Guerra">conflicto militar</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;global que se desarroll&oacute; entre&nbsp;</span><a href="http://es.wikipedia.org/wiki/1939" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="1939">1939</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y&nbsp;</span><a href="http://es.wikipedia.org/wiki/1945" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="1945">1945</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">. En &eacute;l se vieron implicadas la&nbsp;</span><a href="http://es.wikipedia.org/wiki/Anexo:Participantes_en_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Anexo:Participantes en la Segunda Guerra Mundial">mayor parte de las naciones del mundo</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, incluidas todas las&nbsp;</span><a href="http://es.wikipedia.org/wiki/Potencia_mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Potencia mundial">grandes potencias</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, agrupadas en dos alianzas militares enfrentadas: los&nbsp;</span><a href="http://es.wikipedia.org/wiki/Aliados_de_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Aliados de la Segunda Guerra Mundial">Aliados</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y las&nbsp;</span><a href="http://es.wikipedia.org/wiki/Potencias_del_Eje_en_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Potencias del Eje en la Segunda Guerra Mundial">Potencias del Eje</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">. Fue la mayor contienda b&eacute;lica de la</span><a href="http://es.wikipedia.org/wiki/Historia_universal" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Historia universal">Historia</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, con m&aacute;s de cien millones de&nbsp;</span><a href="http://es.wikipedia.org/wiki/Militar" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Militar">militares</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;movilizados y un estado de &laquo;</span><a href="http://es.wikipedia.org/wiki/Guerra_total" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Guerra total">guerra total</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&raquo; en que los grandes contendientes destinaron toda su capacidad econ&oacute;mica, militar y cient&iacute;fica al servicio del esfuerzo b&eacute;lico, borrando la distinci&oacute;n entre recursos civiles y militares. Marcada por hechos de enorme significaci&oacute;n que incluyeron la muerte masiva de civiles, el&nbsp;</span><a href="http://es.wikipedia.org/wiki/Holocausto" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Holocausto">Holocausto</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y el uso, por primera y &uacute;nica vez, de&nbsp;</span><a href="http://es.wikipedia.org/wiki/Arma_nuclear" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Arma nuclear">armas nucleares</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;en un conflicto militar, la Segunda Guerra Mundial fue el conflicto m&aacute;s mort&iacute;fero en la historia de la humanidad,</span><sup class="reference" id="cite_ref-1" style="line-height: 1em; unicode-bidi: -webkit-isolate; color: rgb(37, 37, 37); font-family: sans-serif; background-color: rgb(255, 255, 255);"><a href="http://es.wikipedia.org/wiki/Segunda_Guerra_Mundial#cite_note-1" style="color: rgb(11, 0, 128); white-space: nowrap; background: none;">1</a></sup><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;con un resultado final de entre&nbsp;</span><a href="http://es.wikipedia.org/wiki/Anexo:V%C3%ADctimas_de_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Anexo:V\u00edctimas de la Segunda Guerra Mundial">50 y 70 millones de v&iacute;ctimas</a><font color="#252525" face="sans-serif"><span style="font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">.</span></font></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n'}, 
  "quiz_simple_json":{"title":"Quiz samples", "description":"Quiz example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "theme":"theme1", "slides":[{"id":"article8", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article8_zone1", "type":"quiz", "areaid":"left", "settings":{"nAttempts":"1", "ARSEnabled":true}, "quiztype":"openAnswer", "selfA":false, "question":{"value":"\nEscribe todo lo que sepas sobre la II Guerra Mundial.", "wysiwygValue":'<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span style="font-size:24px;"><font color="#000000">Escribe todo lo que sepas sobre la II Guerra Mundial.</font></span></p>\n'}, 
  "answer":{"value":"La Segunda Guerra Mundial fue un conflicto militar global que se desarroll\u00f3 entre 1939 y 1945. En \u00e9l se vieron implicadas la mayor parte de las naciones del mundo, incluidas todas las grandes potencias, agrupadas en dos alianzas militares enfrentadas: los Aliados y las Potencias del Eje. Fue la mayor contienda b\u00e9lica de laHistoria, con m\u00e1s de cien millones de militares movilizados y un estado de \u00abguerra total\u00bb en que los grandes contendientes destinaron toda su capacidad econ\u00f3mica, militar y cient\u00edfica al servicio del esfuerzo b\u00e9lico, borrando la distinci\u00f3n entre recursos civiles y militares. Marcada por hechos de enorme significaci\u00f3n que incluyeron la muerte masiva de civiles, el Holocausto y el uso, por primera y \u00fanica vez, de armas nucleares en un conflicto militar, la Segunda Guerra Mundial fue el conflicto m\u00e1s mort\u00edfero en la historia de la humanidad,1 con un resultado final de entre 50 y 70 millones de v\u00edctimas.\n\u00ad", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">La&nbsp;</span><b style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">Segunda Guerra Mundial</b><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;fue un&nbsp;</span><a href="http://es.wikipedia.org/wiki/Guerra" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Guerra">conflicto militar</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;global que se desarroll&oacute; entre&nbsp;</span><a href="http://es.wikipedia.org/wiki/1939" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="1939">1939</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y&nbsp;</span><a href="http://es.wikipedia.org/wiki/1945" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="1945">1945</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">. En &eacute;l se vieron implicadas la&nbsp;</span><a href="http://es.wikipedia.org/wiki/Anexo:Participantes_en_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Anexo:Participantes en la Segunda Guerra Mundial">mayor parte de las naciones del mundo</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, incluidas todas las&nbsp;</span><a href="http://es.wikipedia.org/wiki/Potencia_mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Potencia mundial">grandes potencias</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, agrupadas en dos alianzas militares enfrentadas: los&nbsp;</span><a href="http://es.wikipedia.org/wiki/Aliados_de_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Aliados de la Segunda Guerra Mundial">Aliados</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y las&nbsp;</span><a href="http://es.wikipedia.org/wiki/Potencias_del_Eje_en_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Potencias del Eje en la Segunda Guerra Mundial">Potencias del Eje</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">. Fue la mayor contienda b&eacute;lica de la</span><a href="http://es.wikipedia.org/wiki/Historia_universal" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Historia universal">Historia</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">, con m&aacute;s de cien millones de&nbsp;</span><a href="http://es.wikipedia.org/wiki/Militar" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Militar">militares</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;movilizados y un estado de &laquo;</span><a href="http://es.wikipedia.org/wiki/Guerra_total" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Guerra total">guerra total</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&raquo; en que los grandes contendientes destinaron toda su capacidad econ&oacute;mica, militar y cient&iacute;fica al servicio del esfuerzo b&eacute;lico, borrando la distinci&oacute;n entre recursos civiles y militares. Marcada por hechos de enorme significaci&oacute;n que incluyeron la muerte masiva de civiles, el&nbsp;</span><a href="http://es.wikipedia.org/wiki/Holocausto" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Holocausto">Holocausto</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;y el uso, por primera y &uacute;nica vez, de&nbsp;</span><a href="http://es.wikipedia.org/wiki/Arma_nuclear" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Arma nuclear">armas nucleares</a><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;en un conflicto militar, la Segunda Guerra Mundial fue el conflicto m&aacute;s mort&iacute;fero en la historia de la humanidad,</span><sup class="reference" id="cite_ref-1" style="line-height: 1em; unicode-bidi: -webkit-isolate; color: rgb(37, 37, 37); font-family: sans-serif; background-color: rgb(255, 255, 255);"><a href="http://es.wikipedia.org/wiki/Segunda_Guerra_Mundial#cite_note-1" style="color: rgb(11, 0, 128); white-space: nowrap; background: none;">1</a></sup><span style="color: rgb(37, 37, 37); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">&nbsp;con un resultado final de entre&nbsp;</span><a href="http://es.wikipedia.org/wiki/Anexo:V%C3%ADctimas_de_la_Segunda_Guerra_Mundial" style="color: rgb(11, 0, 128); font-family: sans-serif; font-size: 14px; line-height: 22.399999618530273px; background: none rgb(255, 255, 255);" title="Anexo:V\u00edctimas de la Segunda Guerra Mundial">50 y 70 millones de v&iacute;ctimas</a><font color="#252525" face="sans-serif"><span style="font-size: 14px; line-height: 22.399999618530273px; background-color: rgb(255, 255, 255);">.</span></font></span></p>\n<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;</span></span></p>\n'}}], 
  "containsQuiz":true}]}}], "containsQuiz":true}]};
  var text_samples = {"VEVersion":"0.3", "id":"4", "type":"presentation", "title":"The Iberian Lynx", "description":"The Iberian Lynx.\nAmazing presentation with images, videos and objects, generated by ViSH Editor.", "avatar":"http://vishub.org/assets/logos/original/excursion-10.png", "tags":["Do\u00c3\u00b1ana", "Lynx", "Biology"], "theme":"theme1", "age_range":"4 - 20", "subject":["Biology"], "language":"en", "educational_objectives":"Know about Iberian Lynx", "adquired_competencies":"Pupils will be smarter", 
  "author":"", "slides":[{"id":"article1", "type":"standard", "template":"t2", "elements":[{"id":"article1_zone1", "type":"text", "areaid":"left", "body":'<p>\n\taaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p>\n<p>\n\tbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb</p>\n<p>\n\t<span style="font-size:10px;">10cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;">16ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd</span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;">26eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</span></span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;"><span style="font-size:48px;">48ffffffffffffffffffffffffffffffffffffffffffffffff</span></span></span></span></p>\n<p>\n\t<span style="font-size: 10px;"><span style="font-size:16px;"><span style="font-size:26px;"><span style="font-size:48px;"><span style="font-size:72px;">72ggggggggggggggg</span></span></span></span></span></p>\n<p>\n\t&nbsp;</p>\n'}]}, 
  {"id":"article2", "type":"standard", "template":"t2", "elements":[{"id":"article2_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align: center;">\n\t<span style="color:#ff0000;"><span style="font-size:48px;"><span style="font-family:trebuchet ms,helvetica,sans-serif;">Hello World</span></span></span></p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t&nbsp;</p>\n<p style="text-align: center;">\n\t<span style="color: rgb(255, 0, 0); font-family: \'trebuchet ms\', helvetica, sans-serif; font-size: 48px;">Hello World</span></p>\n'}]}, 
  {"id":"article3", "type":"standard", "template":"t2", "elements":[{"id":"article3_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;">&shy;<span style="font-size:20px;">1</span></span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">2</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">3</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">4</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">5</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">6</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">7</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">8</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">9</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">10</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">11</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">12</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">13</span></p>\n<p style="text-align:left;">\n\t<span style="font-size:20px;">14</span></p>\n'}]}, 
  {"id":"article4", "type":"standard", "template":"t1", "elements":[{"id":"article4_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;"><a href="http://delanada" target="_blank">http://delanada</a>&shy;</span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n'}, {"id":"article4_zone2", "areaid":"header"}, {"id":"article4_zone3", "type":"text", "areaid":"subheader", "body":'<p style="text-align:left;">\n\t<span style="font-size:18px;">&shy;asdadsad</span></p>\n'}]}, 
  {"id":"article5", "type":"standard", "template":"t2", "elements":[{"id":"article5_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t<span style="font-size:36px;">exponentes<sup>2</sup></span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<span style="font-size:22px;"><span style="font-size:36px;">exponentesb<sub>345</sub>asdadsadasd</span></span></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<u><span style="font-size:22px;"><span style="font-size:36px;">Subrayado</span></span></u></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<em><span style="font-size:22px;"><span style="font-size:36px;">Cursiva</span></span></em></p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t<strong><span style="font-size:22px;"><span style="font-size:36px;">Negrita</span></span></strong></p>\n'}]}, 
  {"id":"article6", "type":"standard", "template":"t2", "elements":[{"id":"article6_zone1", "type":"text", "areaid":"left", "body":'<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<p style="text-align:left;">\n\t&nbsp;</p>\n<table align="center" border="1" cellpadding="1" cellspacing="1" style="width: 500px;" summary="Fin de ejemplo de tabla">\n\t<caption>\n\t\t<span style="font-size:24px;">Ejemplo de Tabla</span></caption>\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<span style="color:#ffff00;"><span style="font-size:36px;"><span style="font-family:comic sans ms,cursive;"><span style="background-color:#000000;">Esto es un</span></span></span></span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">ejemplo de&nbsp;</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">una tabla</span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">con el</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">nuevo</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">wysiwyg</span></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px">Pues </span><font size="5">a ver si</font></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">redimensiona</span></td>\n\t\t\t<td>\n\t\t\t\t<span style="font-size:24px;">bien</span></td>\n\t\t</tr>\n\t</tbody>\n</table>\n<p style="text-align:left;">\n\t<span style="font-size:36px;">&shy;</span></p>\n'}]}]};
  var VE01_samples = {"id":"2", "type":"presentation", "title":"Chess: The Art of Learning", "description":"Samples of VE v01. The Art of Learning, a journey in the pursuit of excellence.\nAmazing presentation with images, videos and 3d objects, generated by ViSH Editor.", "avatar":"http://static.betazeta.com/www.veoverde.com/wp-content/uploads/2011/07/fotos-gatos.jpg", "tags":["Samples", "Test", "Development"], "author":"ViSH Editor Team", "theme":"theme1", "age_range":"4 - 14", "subject":["Art", 
  "Astronomy"], "language":"en", "educational_objectives":"bla bla bla 3", "adquired_competencies":"pupils will be smarter", "slides":[{"id":"article1", "template":"t1", "elements":[{"id":"zone1", "type":"image", "areaid":"left", "body":"http://blogs.20minutos.es/cronicaverde/files/parque_nacional_donana_lince_iberico.jpg", "style":"position: relative; width:97.82608695652173%; height:80.10752688172043%; top:0%; left:0%;"}, {"id":"zone2", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6" style="text-align: center; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="font-family: helvetica;"><span style="font-weight: bold;">Chess</span>: The Art of Learning</span></span><br></span></div>'}, 
  {"id":"zone3", "type":"text", "areaid":"subheader", "body":'<div class="vish-parent-font3 vish-parent-font4" style="text-align: right; font-weight: normal; "><span class="vish-font3 vish-fontarial"><span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="font-style: italic; font-family: helvetica;">by Aldo Gordillo&nbsp; </span></span><br></span></div>'}]}, {"id":"article2", "template":"t3", "elements":[{"id":"325", "type":"text", "areaid":"header", "body":"Experimento virtual1"}, 
  {"id":"7335", "type":"object", "areaid":"left", "body":'<embed width="99%" height="99%" src="/examples/contents/swf/virtualexperiment.swf" type="application/x-shockwave-flash"></embed>'}]}, {"id":"articlearticle4", "template":"t6", "elements":[{"id":"zone6", "type":"text", "areaid":"header", "body":'<div class="vish-parent-font3 vish-parent-font6 vish-parent-font4" style="font-weight: normal; "><span class="vish-font3 vish-fontHelvetica" style=""><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(219, 150, 0);">Iberian</span></span><span class="vish-font6 vish-fontHelvetica" style="undefined;"> </span><span class="vish-font6 vish-fontHelvetica" style="undefined;"><span style="color: rgb(32, 24, 21);">Lynx</span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="vish-font4 vish-fontHelvetica" style="undefined;"><span style="color: rgb(113, 113, 117);">Reproduction</span></span><br></span></div>'}, 
  {"id":"zone7", "type":"image", "areaid":"left", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "hyperlink":"http://www.google.es", "style":"position: relative; width:380.95238095238096%; height:218.69565217391303%; top:-36.231884541718856%; left:-58.201090494791664%;"}, {"id":"zone8", "type":"image", "areaid":"center", "body":"http://i13.photobucket.com/albums/a288/inkslinger0611/drawings/Iberian.jpg", "style":"position: relative; width:357.14285714285717%; height:205.2173913043478%; top:-45.41062894074813%; left:-193.12174479166666%;"}, 
  {"id":"zone9", "type":"text", "areaid":"right", "body":'<div class="vish-parent-font2" style="text-align: center; font-weight: normal; "><span class="vish-font2 vish-fontHelvetica" style="">During the mating season the female leaves her territory in search of a male. The typical gestation period is about two months; the cubs are born between March and September, with a peak of births in March and April. A litter consists of two or three (rarely one, four or five) kittens weighing between 200 and 250 grams (7.1 and 8.8 oz).The kittens become independent at seven to 10 months old, but remain with the mother until around 20 months old. Survival of the young depends heavily on the availability of prey species. In the wild, both males and females reach sexual maturity at one year old, though in practice they rarely breed until a territory becomes vacant; one female was known not to breed until five years old when its mother died.</span></div>'}]}, 
  {"id":"article_5", "type":"standard", "template":"t2", "elements":[{"id":"zone11", "type":"object", "areaid":"left", "body":'<iframe src="http://www.youtube.com/embed/VAEp2gT-2a8?wmode=opaque" frameborder="0" id="resizableunicID_7" class="t2_object" wmode="opaque"></iframe>', "style":"position: relative; width:99.9390243902439%; height:99.6774193548387%; top:2.225806451612903%; left:2.3536585365853657%;"}]}]};
  var mooc_samples = {"VEVersion":"0.8.5", "type":"presentation", "title":"Modulo 1: Introduccion a Internet, el Web, la nube, HTML5 y CSS", "description":"Modulo 1 del MOOC Desarrollo de Aplicaciones Web en HTML5 y para moviles Firefox OS. Accesible a traves de https://www.miriadax.net/web/firefox-os .", "avatar":"http://www.adwe.es/wp-content/uploads/2013/07/FirefoxOS.2.png", "author":{"name":"Aldo", "vishMetadata":{"id":20}}, "tags":["MOOC", "HTML5", "CSS", "Web"], "theme":"theme1", "animation":"animation1", 
  "language":"independent", "age_range":"14 - 30", "subject":["Software Engineering", "Technology", "Telecommunications"], "educational_objectives":"El alumno obtendra una introduccion a Internet, el Web, la nube, HTML5 y CSS.", "vishMetadata":{"draft":"false", "id":"785"}, "slides":[{"id":"article1", "type":"enrichedvideo", "video":{"type":"HTML5_VIDEO", "sources":'[{ "type": "video/webm", "src": "http://vishub.org/videos/3366.webm"},{ "type": "video/mp4", "src": "http://vishub.org/videos/3366.mp4"}]', 
  "poster":"http://vishub.org/videos/3366.png?style=170x127%23", "duration":799.16}, "pois":[{"id":"article1_poi1", "etime":"120", "slide_id":"article1_article1", "name":"Tecnologias de la Web"}, {"id":"article1_poi2", "etime":"630", "slide_id":"article1_article2", "name":"Operaciones principales de HTTP"}, {"id":"article1_poi3", "etime":"791", "slide_id":"article1_article3", "name":"Test de autoevaluacion"}], "slides":[{"id":"article1_article1", "type":"standard", "template":"t8", "elements":[{"id":"article1_article1_zone1", 
  "areaid":"header"}, {"id":"article1_article1_zone2", "type":"image", "areaid":"left", "body":"http://www.derwentsidehomes.co.uk/UserFiles/Image/3D%20Characters/Question.jpg", "style":"position: relative; width:71.30801687763713%; height:100%; top:0%; left:10.126582278481013%;"}, {"id":"article1_article1_zone3", "type":"quiz", "areaid":"center", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00c2\u00bfPara qu\u00c3\u00a9 se utiliza el CSS?\u00c2\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t<span style="font-size:36px;"><span autocolor="true" style="color:#000">&iquest;Para qu&eacute; se utiliza el&nbsp;<strong>CSS</strong>?&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00e2\u20ac\u2039\u00c2\u00adEs el lenguaje de programacion de aplicaciones de cliente.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Es el lenguaje de programaci&oacute;n de aplicaciones de cliente.</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00e2\u20ac\u2039\u00c2\u00adDefine la estructura de la informacion de una pagina web.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Define la estructura de la informaci&oacute;n de una p&aacute;gina web.</span></span></p>\n', 
  "answer":false}, {"id":"3", "value":"\u00e2\u20ac\u2039\u00c2\u00adDefine el estilo de visualizacion de una pagina Web en el navegador.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Define el estilo de visualizaci&oacute;n de una p&aacute;gina Web en el navegador.</span></span></p>\n', "answer":true}], "extras":{"multipleAnswer":false}, "quiz_simple_json":{"title":"Enriched Video Example", "description":"First Enriched Video Example", 
  "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "slides":[{"id":"article4", "type":"quiz_simple", "template":"t8", "elements":[{"id":"article1_article1_zone1", "areaid":"header"}, {"id":"article1_article1_zone2", "type":"image", "areaid":"left", "body":"http://www.derwentsidehomes.co.uk/UserFiles/Image/3D%20Characters/Question.jpg", "style":"position: relative; width:71.30801687763713%; height:100%; top:0%; left:10.126582278481013%;"}, {"id":"article1_article1_zone3", 
  "type":"quiz", "areaid":"center", "quiztype":"multiplechoice", "selfA":true, "question":{"value":"\u00c2\u00bfPara qu\u00c3\u00a9 se utiliza el CSS?\u00c2\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t<span style="font-size:36px;"><span autocolor="true" style="color:#000">&iquest;Para qu&eacute; se utiliza el&nbsp;<strong>CSS</strong>?&shy;</span></span></p>\n'}, "choices":[{"id":"1", "value":"\u00e2\u20ac\u2039\u00c2\u00adEs el lenguaje de programacion de aplicaciones de cliente.", 
  "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Es el lenguaje de programaci&oacute;n de aplicaciones de cliente.</span></span></p>\n', "answer":false}, {"id":"2", "value":"\u00e2\u20ac\u2039\u00c2\u00adDefine la estructura de la informacion de una pagina web.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Define la estructura de la informaci&oacute;n de una p&aacute;gina web.</span></span></p>\n', 
  "answer":false}, {"id":"3", "value":"\u00e2\u20ac\u2039\u00c2\u00adDefine el estilo de visualizacion de una pagina Web en el navegador.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Define el estilo de visualizaci&oacute;n de una p&aacute;gina Web en el navegador.</span></span></p>\n', "answer":true}], "extras":{"multipleAnswer":false}}, {"id":"article1_article1zone4", "areaid":"right"}], "containsQuiz":true}]}}, {"id":"article1_article1zone4", 
  "areaid":"right"}], "containsQuiz":true}, {"id":"article1_article2", "type":"standard", "template":"t2", "elements":[{"id":"article1_article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"truefalse", "selfA":true, "question":{"value":"Indica cuales de las siguientes afirmaciones son verdaderas o falsas.\u00c2\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Indica cuales de las siguientes afirmaciones son </span></span><span style="color:#008000;"><span autocolor="true"><span style="font-size:38px;">verdaderas</span></span></span><span autocolor="true"><span style="font-size:38px;"> o <span style="color:#b22222;">falsas</span>.&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00c2\u00adGET es un comando para traer paginas Web a un cliente para su visualizacion.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>GET</strong> es un comando para traer p&aacute;ginas Web a un cliente para su visualizaci&oacute;n.</span></span></p>\n', "answer":true}, {"id":"2", "value":"\u00c2\u00adPOST es un comando para editar recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;"><strong>&shy;POST</strong> es un comando para editar recursos en un servidor.</span></span></p>\n', 
  "answer":false}, {"id":"3", "value":"\u00c2\u00adPUT es un comando para crear recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>PUT</strong> es un comando para crear recursos en un servidor.</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00c2\u00adDELETE es un comando para borrar recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>DELETE</strong> es un comando para borrar recursos en un servidor.</span></span></p>\n', 
  "answer":true}], "quiz_simple_json":{"title":"Enriched Video Example", "description":"First Enriched Video Example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "slides":[{"id":"article5", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article1_article2_zone1", "type":"quiz", "areaid":"center", "quiztype":"truefalse", "selfA":true, "question":{"value":"Indica cuales de las siguientes afirmaciones son verdaderas o falsas.\u00c2\u00ad", "wysiwygValue":'<p style="text-align: center;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">Indica cuales de las siguientes afirmaciones son </span></span><span style="color:#008000;"><span autocolor="true"><span style="font-size:38px;">verdaderas</span></span></span><span autocolor="true"><span style="font-size:38px;"> o <span style="color:#b22222;">falsas</span>.&shy;</span></span></p>\n'}, 
  "choices":[{"id":"1", "value":"\u00c2\u00adGET es un comando para traer paginas Web a un cliente para su visualizacion.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>GET</strong> es un comando para traer p&aacute;ginas Web a un cliente para su visualizaci&oacute;n.</span></span></p>\n', "answer":true}, {"id":"2", "value":"\u00c2\u00adPOST es un comando para editar recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;"><strong>&shy;POST</strong> es un comando para editar recursos en un servidor.</span></span></p>\n', 
  "answer":false}, {"id":"3", "value":"\u00c2\u00adPUT es un comando para crear recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>PUT</strong> es un comando para crear recursos en un servidor.</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00c2\u00adDELETE es un comando para borrar recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>DELETE</strong> es un comando para borrar recursos en un servidor.</span></span></p>\n', 
  "answer":true}]}], "containsQuiz":true}]}}], "containsQuiz":true}, {"id":"article1_article3", "type":"standard", "template":"t2", "elements":[{"id":"article1_article3_zone1", "type":"quiz", "areaid":"left", "quiztype":"truefalse", "selfA":true, "question":{"value":"Test de autoevaluacion.Indica cuales de las siguientes afirmaciones son verdaderas o falsas.", "wysiwygValue":'<p style="text-align: center;">\n\t<span style="font-size:28px;"><font color="#000000">Test de autoevaluaci&oacute;n.</font></span></p>\n<p style="text-align:left;">\n\t<span style="font-size:28px;"><font color="#000000">Indica cuales de las siguientes afirmaciones son </font><span style="color:#008000;">verdaderas</span><font color="#000000"> o </font><span style="color:#b22222;">falsas</span><font color="#000000">.</font></span></p>\n'}, 
  "choices":[{"id":"1", "value":"HTTP permite procesar remotamente recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5"><strong>HTTP</strong> permite procesar remotamente recursos en un servidor.</font></p>\n', "answer":true}, {"id":"2", "value":"\u00c2\u00adUna URL identifica sin ambiguedad un recurso en Internet.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Una </span></span><strong><span style="color:#000000;"><span autocolor="true"><span style="font-size:24px;">URL</span></span></span></strong><span autocolor="true" style="color:#000"><span style="font-size:24px;"> identifica sin ambiguedad un recurso en Internet.</span></span></p>\n', 
  "answer":true}, {"id":"3", "value":"\u00c2\u00adJavaScript es igual al lenguaje de programacion Java.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>JavaScript</strong> es igual al lenguaje de programaci&oacute;n Java.</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00c2\u00adHTML define la estructura de la informacion de una pagina web.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>HTML</strong> define la estructura de la informaci&oacute;n de una p&aacute;gina web.</span></span></p>\n', 
  "answer":true}], "quiz_simple_json":{"title":"Enriched Video Example", "description":"First Enriched Video Example", "author":{"name":"agordillo", "vishMetadata":{"id":"24"}}, "type":"quiz_simple", "slides":[{"id":"article6", "type":"quiz_simple", "template":"t2", "elements":[{"id":"article1_article3_zone1", "type":"quiz", "areaid":"left", "quiztype":"truefalse", "selfA":true, "question":{"value":"Test de autoevaluacion.Indica cuales de las siguientes afirmaciones son verdaderas o falsas.", "wysiwygValue":'<p style="text-align: center;">\n\t<span style="font-size:28px;"><font color="#000000">Test de autoevaluaci&oacute;n.</font></span></p>\n<p style="text-align:left;">\n\t<span style="font-size:28px;"><font color="#000000">Indica cuales de las siguientes afirmaciones son </font><span style="color:#008000;">verdaderas</span><font color="#000000"> o </font><span style="color:#b22222;">falsas</span><font color="#000000">.</font></span></p>\n'}, 
  "choices":[{"id":"1", "value":"HTTP permite procesar remotamente recursos en un servidor.", "wysiwygValue":'<p style="text-align:left;">\n\t<font color="#000000" size="5"><strong>HTTP</strong> permite procesar remotamente recursos en un servidor.</font></p>\n', "answer":true}, {"id":"2", "value":"\u00c2\u00adUna URL identifica sin ambiguedad un recurso en Internet.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;Una </span></span><strong><span style="color:#000000;"><span autocolor="true"><span style="font-size:24px;">URL</span></span></span></strong><span autocolor="true" style="color:#000"><span style="font-size:24px;"> identifica sin ambiguedad un recurso en Internet.</span></span></p>\n', 
  "answer":true}, {"id":"3", "value":"\u00c2\u00adJavaScript es igual al lenguaje de programacion Java.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>JavaScript</strong> es igual al lenguaje de programaci&oacute;n Java.</span></span></p>\n', "answer":false}, {"id":"4", "value":"\u00c2\u00adHTML define la estructura de la informacion de una pagina web.", "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:24px;">&shy;<strong>HTML</strong> define la estructura de la informaci&oacute;n de una p&aacute;gina web.</span></span></p>\n', 
  "answer":true}]}], "containsQuiz":true}]}}], "containsQuiz":true}]}]};
  var webAPPVEAPIexample = {"VEVersion":"0.9.3", "type":"presentation", "title":"Quiz samples", "description":"Quiz example", "avatar":"http://vishub.org/assets/logos/original/excursion-15.png", "author":{"name":"agordillo", "vishMetadata":{"id":"20"}}, "tags":["e-Learning", "Game-based Learning"], "license":{"name":"Creative Commons Reconocimiento-NoComercial", "key":"cc-by-nc"}, "theme":"theme1", "animation":"animation1", "language":"independent", "age_range":"4 - 20", "subject":["Education", "Environmental Education", 
  "Geology", "Physics"], "allow_clone":"true", "allow_comment":"true", "allow_download":"true", "allow_following_rte":"true", "vishMetadata":{"url":"http://vishub.org", "draft":"false", "id":"500"}, "slides":[{"id":"article9", "type":"standard", "template":"t10", "elements":[{"id":"article9_zone1", "type":"object", "areaid":"center", "settings":{"wappAPI_supported":true}, "body":'<iframe src="http://localhost/examples/WAPP_API/webapp.html?wmode=opaque&amp;wappid=wapp2" wmode="opaque" id="resizableunicID36" class="t10_object" objecttype="webapp" wappid="wapp2"></iframe>', 
  "style":"position: relative; width:100%; height:100%; top:0%; left:0%;", "subtype":"webapp"}]}]};
  var SCORMexample = {"author":"Aldo", "description":"Uploaded by Aldo via ViSH Editor", "id":48, "src":"/examples/contents/scormappcode/41/vishubcode_scorm_wrapper.html", "title":"AncientWeapons.zip", "type":"scormpackage"};
  var Webappexample = {"author":"Aldo", "description":"Uploaded by Aldo via ViSH Editor", "id":52, "src":"/examples/contents/webappcode/11/index.html", "title":"HelloWorld.zip", "type":"webapp"};
  return{basic_samples:basic_samples, full_samples:full_samples, fc_sample:fc_sample, vt_sample:vt_sample, evideo_sample:evideo_sample, quiz_samples:quiz_samples, text_samples:text_samples, VE01_samples:VE01_samples, mooc_samples:mooc_samples, webAPPVEAPIexample:webAPPVEAPIexample, SCORMexample:SCORMexample, Webappexample:Webappexample}
}(VISH);
VISH.Slides = function(V, $, undefined) {
  var slideEls;
  var curSlideIndex;
  var SLIDE_CLASSES = ["far-past", "past", "current", "next", "far-next"];
  var curSubSlideId = null;
  var init = function() {
  };
  var updateSlides = function() {
    setSlides($("section.slides > article"));
    _updateSlideClasses();
    if(!V.Editing) {
    }
  };
  var _updateSlideClasses = function() {
    if(V.Status.getIsUniqMode()) {
      $("section.slides > article").removeClass("current");
      updateSlideClass(curSlideIndex + 1, "current");
      return
    }
    for(var i = 0;i < slideEls.length;i++) {
      switch(i) {
        case curSlideIndex - 2:
          updateSlideClass(i + 1, "far-past");
          break;
        case curSlideIndex - 1:
          updateSlideClass(i + 1, "past");
          break;
        case curSlideIndex:
          updateSlideClass(i + 1, "current");
          break;
        case curSlideIndex + 1:
          updateSlideClass(i + 1, "next");
          break;
        case curSlideIndex + 2:
          updateSlideClass(i + 1, "far-next");
          break;
        default:
          updateSlideClass(i + 1);
          break
      }
    }
  };
  var updateSlideClass = function(slideNumber, className) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    if(className) {
      $(el).addClass(className)
    }
    var sCL = SLIDE_CLASSES.length;
    for(var i = 0;i < sCL;i++) {
      var sCLClass = SLIDE_CLASSES[i];
      if(className != sCLClass) {
        $(el).removeClass(sCLClass)
      }
    }
  };
  var getSlides = function() {
    return slideEls
  };
  var setSlides = function(newSlideEls) {
    slideEls = newSlideEls;
    $.each(slideEls, function(index, value) {
      $(value).attr("slidenumber", index + 1)
    })
  };
  var getCurrentSlide = function() {
    return slideEls[curSlideIndex]
  };
  var getCurrentSubslide = function() {
    if(V.Editing) {
      return V.Editor.Slideset.getCurrentSubslide()
    }
    if(curSubSlideId === null) {
      return null
    }else {
      return $("#" + curSubSlideId)
    }
  };
  var getTargetSlide = function() {
    var cSubslide = getCurrentSubslide();
    if(typeof cSubslide == "undefined" || cSubslide === null) {
      return getCurrentSlide()
    }else {
      return cSubslide
    }
  };
  var getCurrentSlideNumber = function() {
    return curSlideIndex + 1
  };
  var getCurrentSubslideNumber = function() {
    var cSubslide = getCurrentSubslide();
    if(typeof cSubslide == "undefined" || cSubslide === null) {
      return undefined
    }
    var cSubslideNumber = $(cSubslide).attr("slidenumber");
    if(typeof cSubslideNumber == "string") {
      try {
        return parseInt(cSubslideNumber)
      }catch(err) {
        return undefined
      }
    }
  };
  var getTargetSlideNumber = function() {
    var cSubslide = getCurrentSubslide();
    if(typeof cSubslide == "undefined" || cSubslide === null) {
      return getCurrentSubslideNumber()
    }else {
      return getCurrentSlideNumber()
    }
  };
  var setCurrentSlideNumber = function(currentSlideNumber) {
    _setCurrentSlideIndex(currentSlideNumber - 1)
  };
  var _setCurrentSlideIndex = function(newCurSlideIndex) {
    curSlideIndex = newCurSlideIndex
  };
  var getSlideWithNumber = function(slideNumber) {
    var no = slideNumber - 1;
    if(no < 0 || no >= slideEls.length) {
      return null
    }else {
      return slideEls[no]
    }
  };
  var getSubslideWithNumber = function(slideset, subslideNumber) {
    return $(slideset).children("article[slidenumber='" + subslideNumber + "']")
  };
  var getNumberOfSlide = function(slide) {
    if(slideEls) {
      var result = 0;
      $.each(slideEls, function(index, value) {
        if($(value).attr("id") == $(slide).attr("id")) {
          result = index + 1;
          return
        }
      });
      return result
    }else {
      return 0
    }
  };
  var getSlidesQuantity = function() {
    return $("section.slides > article").length
  };
  var getSlideType = function(slideEl) {
    if(slideEl && slideEl.tagName === "ARTICLE") {
      return $(slideEl).attr("type")
    }else {
      if(typeof slideEl == "object" && (slideEl.length === 1 && slideEl[0].tagName === "ARTICLE")) {
        return $(slideEl).attr("type")
      }else {
        if(typeof slideEl == "object" && typeof slideEl.type == "string") {
          return slideEl.type
        }else {
          return null
        }
      }
    }
  };
  var isCurrentFirstSlide = function() {
    return curSlideIndex === 0
  };
  var isCurrentLastSlide = function() {
    return curSlideIndex === slideEls.length - 1
  };
  var updateCurrentSlideFromHash = function() {
    var slideNo = V.Utils.getSlideNumberFromHash();
    if(slideNo) {
      setCurrentSlideNumber(slideNo)
    }else {
      setCurrentSlideNumber(1)
    }
  };
  var triggerEnterEvent = function(slideNumber) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    triggerEnterEventById(el.id)
  };
  var triggerLeaveEvent = function(slideNumber) {
    var el = getSlideWithNumber(slideNumber);
    if(!el) {
      return
    }
    triggerLeaveEventById(el.id)
  };
  var triggerEnterEventById = function(slide_id) {
    var el = $("#" + slide_id)[0];
    if(typeof el == "undefined") {
      return
    }
    if(document.createEvent) {
      var evt = document.createEvent("Event");
      evt.initEvent("slideenter", true, true);
      el.dispatchEvent(evt)
    }else {
      if(document.createEventObject) {
        var evt = document.createEventObject();
        el.fireEvent("onslideenter", evt)
      }
    }
  };
  var triggerLeaveEventById = function(slide_id) {
    var el = $("#" + slide_id)[0];
    if(typeof el == "undefined") {
      return
    }
    if(document.createEvent) {
      var evt = document.createEvent("Event");
      evt.initEvent("slideleave", true, true);
      el.dispatchEvent(evt)
    }else {
      if(document.createEventObject) {
        var evt = document.createEventObject();
        el.fireEvent("onslideleave", evt)
      }
    }
  };
  var forwardOneSlide = function(event) {
    moveSlides(1)
  };
  var backwardOneSlide = function() {
    moveSlides(-1)
  };
  var moveSlides = function(n) {
    if(!V.Editing && isCurrentLastSlide()) {
      if(n > 0) {
        V.Recommendations.showFancybox();
        return
      }else {
        if(n < 0 && V.Recommendations.isRecVisible()) {
          V.Recommendations.hideFancybox();
          return
        }
      }
    }
    var no = curSlideIndex + n + 1;
    no = Math.min(Math.max(1, no), slideEls.length);
    goToSlide(no)
  };
  var goToSlide = function(no, triggeredByUser) {
    if(no === getCurrentSlideNumber() || (no > slideEls.length || no <= 0)) {
      return
    }
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && (V.Status.isPreventDefaultMode() && V.Messenger)) {
      var params = {};
      params.slideNumber = no;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onGoToSlide, params);
      return
    }
    if(!V.Editing && $.fancybox) {
      $.fancybox.close()
    }
    _goToSlide(no);
    if(!V.Editing) {
      V.Viewer.updateSlideCounter()
    }
    var params = {};
    params.slideNumber = no;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onGoToSlide, params, triggeredByUser)
  };
  var _goToSlide = function(no) {
    var nextSlideIndex = no - 1;
    if(nextSlideIndex < slideEls.length && nextSlideIndex >= 0) {
      triggerLeaveEvent(curSlideIndex + 1);
      _setCurrentSlideIndex(nextSlideIndex);
      updateSlides();
      triggerEnterEvent(curSlideIndex + 1)
    }
  };
  var lastSlide = function() {
    goToSlide(slideEls.length)
  };
  var onClickSlideLink = function(event) {
    event.preventDefault();
    event.stopPropagation();
    try {
      var slideNumber = parseInt($(this).attr("href").split("#slide")[1]);
      goToSlide(slideNumber)
    }catch(e) {
    }
  };
  var isSubslide = function(slide) {
    var parent = $(slide).parent()[0];
    if(parent) {
      return parent.tagName === "ARTICLE"
    }else {
      return false
    }
  };
  var openSubslide = function(slide_id, triggeredByUser) {
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && (V.Status.isPreventDefaultMode() && V.Messenger)) {
      var params = new Object;
      params.slideId = slide_id;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onSubslideOpen, params);
      return
    }
    _onOpenSubslide(slide_id);
    $("#" + slide_id).removeClass("hide_in_smartcard");
    $("#" + slide_id).addClass("show_in_smartcard");
    triggerEnterEventById(slide_id);
    var params = new Object;
    params.slideId = slide_id;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onSubslideOpen, params, triggeredByUser)
  };
  var closeSubslide = function(slide_id, triggeredByUser) {
    triggeredByUser = !(triggeredByUser === false);
    if(triggeredByUser && (V.Status.isPreventDefaultMode() && V.Messenger)) {
      var params = new Object;
      params.slideId = slide_id;
      V.Messenger.notifyEventByMessage(V.Constant.Event.onSubslideClosed, params);
      return
    }
    _onCloseSubslide(slide_id);
    $("#" + slide_id).removeClass("show_in_smartcard");
    $("#" + slide_id).addClass("hide_in_smartcard");
    triggerLeaveEventById(slide_id);
    var params = new Object;
    params.slideId = slide_id;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onSubslideClosed, params, triggeredByUser)
  };
  var _onOpenSubslide = function(subSlideId) {
    curSubSlideId = subSlideId;
    $("#closeButton").hide()
  };
  var _onCloseSubslide = function() {
    curSubSlideId = null;
    if(V.Status.getDevice().mobile) {
      setTimeout(function() {
        V.ViewerAdapter.decideIfCloseButton();
        V.ViewerAdapter.decideIfPageSwitcher()
      }, 800)
    }else {
      V.ViewerAdapter.decideIfPageSwitcher()
    }
  };
  return{init:init, updateSlides:updateSlides, updateCurrentSlideFromHash:updateCurrentSlideFromHash, getSlides:getSlides, setSlides:setSlides, getCurrentSlide:getCurrentSlide, getCurrentSubslide:getCurrentSubslide, getTargetSlide:getTargetSlide, getCurrentSlideNumber:getCurrentSlideNumber, getCurrentSubslideNumber:getCurrentSubslideNumber, getTargetSlideNumber:getTargetSlideNumber, setCurrentSlideNumber:setCurrentSlideNumber, getSlideWithNumber:getSlideWithNumber, getSubslideWithNumber:getSubslideWithNumber, 
  getNumberOfSlide:getNumberOfSlide, getSlidesQuantity:getSlidesQuantity, getSlideType:getSlideType, isCurrentFirstSlide:isCurrentFirstSlide, isCurrentLastSlide:isCurrentLastSlide, moveSlides:moveSlides, forwardOneSlide:forwardOneSlide, backwardOneSlide:backwardOneSlide, goToSlide:goToSlide, lastSlide:lastSlide, onClickSlideLink:onClickSlideLink, isSubslide:isSubslide, openSubslide:openSubslide, closeSubslide:closeSubslide, triggerEnterEvent:triggerEnterEvent, triggerEnterEventById:triggerEnterEventById, 
  triggerLeaveEvent:triggerLeaveEvent, triggerLeaveEventById:triggerLeaveEventById}
}(VISH, jQuery);
VISH.Events = function(V, $, undefined) {
  var _bindedViewerEventListeners = false;
  var _mobile;
  var init = function() {
    _mobile = !V.Status.getDevice().desktop;
    if(_mobile) {
      V.Events.Mobile.init()
    }
    bindViewerEventListeners()
  };
  var bindViewerEventListeners = function() {
    if(_bindedViewerEventListeners) {
      return
    }
    $("article").live("slideenter", V.Viewer.onSlideEnterViewer);
    $("article").live("slideleave", V.Viewer.onSlideLeaveViewer);
    _addTutorialEvents();
    $(document).bind("keydown", _handleBodyKeyDown);
    $(document).on("click", "#page-switcher-start", function() {
      V.Slides.backwardOneSlide()
    });
    $(document).on("click", "#page-switcher-end", function() {
      V.Slides.forwardOneSlide()
    });
    $(document).on("keypress", "#slide-counter-input", function(e) {
      if(e.which == 13) {
        V.Slides.goToSlide($("#slide-counter-input").val());
        $("#slide-counter-input").blur()
      }
    });
    $(document).on("click", "#closeButton", function(event) {
      event.stopPropagation();
      event.preventDefault();
      var comeBackUrl = V.Viewer.getOptions()["comeBackUrl"];
      if(comeBackUrl) {
        window.top.location.href = V.Viewer.getOptions()["comeBackUrl"]
      }else {
        if(V.Status.isExternalDomain() && V.Status.getDevice().features.history) {
          history.back()
        }
      }
    });
    $(document).on("click", "#back_arrow", function(event) {
      V.Slides.backwardOneSlide()
    });
    $(document).on("click", "#forward_arrow", function(event) {
      V.Slides.forwardOneSlide()
    });
    if(!_mobile) {
      $(document).on("click", ".close_subslide", V.Slideset.onCloseSubslideClicked)
    }
    $(document).on("click", "section.slides article > div a[href^='#slide']:not(.ui-slider-handle)", V.Slides.onClickSlideLink);
    $(document).on("click", "a.recommendedItemLinkBlank", function(event) {
      V.EventsNotifier.notifyEvent(V.Constant.Event.onAcceptRecommendation, {"id":$(this).attr("ex_id")}, true)
    });
    $(document).on("click", "#evaluate_presentation", function(event) {
      V.Recommendations.onClickEvaluateButton(event)
    });
    V.Flashcard.loadEvents();
    $(window).focus(function() {
      V.Status.setWindowFocus(true)
    }).blur(function() {
      V.Status.setWindowFocus(false)
    });
    var multipleOnResize = undefined;
    window.onresize = function() {
      if(typeof multipleOnResize == "undefined") {
        multipleOnResize = false;
        setTimeout(function() {
          if(!multipleOnResize) {
            multipleOnResize = undefined;
            _onResizeActions()
          }else {
            multipleOnResize = undefined;
            window.onresize()
          }
        }, 600)
      }else {
        multipleOnResize = true
      }
    };
    window.onbeforeunload = function() {
      V.EventsNotifier.notifyEvent(V.Constant.Event.exit)
    };
    if(_mobile) {
      V.Events.Mobile.bindViewerMobileEventListeners()
    }
    _bindedViewerEventListeners = true
  };
  var _onResizeActions = function() {
    var fsParams = V.FullScreen.getFSParams();
    if(typeof fsParams.currentFSElement == "undefined") {
      if(typeof fsParams.lastFSElement != "undefined" && (fsParams.lastFSElement != fsParams.fsElementTarget && new Date - fsParams.lastFSTimestamp < 1E3)) {
        if($("body").is(":-webkit-full-screen-ancestor")) {
          if(fsParams.lastFSElement.tagName === "IFRAME") {
            $(fsParams.lastFSElement).attr("src", $(fsParams.lastFSElement).attr("src"))
          }
        }
      }
    }else {
      if(typeof fsParams.currentFSElement != "undefined" && fsParams.currentFSElement != fsParams.fsElementTarget) {
        return
      }
    }
    V.Status.refreshDeviceAfterResize();
    var currentDevice = V.Status.getDevice();
    V.EventsNotifier.notifyEvent(V.Constant.Event.onViewportResize, {screen:currentDevice.screen, viewport:currentDevice.viewport});
    V.ViewerAdapter.updateInterface()
  };
  var _addTutorialEvents = function() {
    $(document).on("click", "#tab_quiz_session_help", function() {
      V.Tour.startTourWithId("quiz_session_help", "bottom")
    });
    $(document).on("click", "#tab_quiz_stats_help", function() {
      V.Tour.startTourWithId("quiz_session_help", "bottom")
    });
    $(document).on("click", "#help_addslides_selection", function() {
      V.Tour.startTourWithId("addslides_help", "bottom")
    })
  };
  var _handleBodyKeyDown = function(event) {
    switch(event.keyCode) {
      case 34:
      ;
      case 38:
      ;
      case 39:
        V.Slides.forwardOneSlide();
        event.preventDefault();
        break;
      case 33:
      ;
      case 37:
      ;
      case 40:
        V.Slides.backwardOneSlide();
        event.preventDefault();
        break
    }
    V.TrackingSystem.registerAction("keydown", {"keyCode":event.keyCode})
  };
  var unbindViewerEventListeners = function() {
    if(!_bindedViewerEventListeners) {
      return
    }
    $(document).unbind("keydown", _handleBodyKeyDown);
    $(document).off("click", "#page-switcher-start");
    $(document).off("click", "#page-switcher-end");
    $(document).off("click", "#back_arrow");
    $(document).off("click", "#forward_arrow");
    $(document).off("click", "#closeButton");
    $(document).off("click", ".close_subslide");
    V.Flashcard.unloadEvents();
    if(_mobile) {
      V.Events.Mobile.unbindViewerMobileEventListeners()
    }
    _bindedViewerEventListeners = false
  };
  return{init:init, bindViewerEventListeners:bindViewerEventListeners, unbindViewerEventListeners:unbindViewerEventListeners}
}(VISH, jQuery);
VISH.Flashcard = function(V, $, undefined) {
  var initialized = false;
  var flashcards;
  var pois;
  var FPS = 20;
  var init = function() {
    if(!initialized) {
      initialized = true;
      flashcards = {};
      pois = {}
    }
  };
  var loadEvents = function() {
    var device = V.Status.getDevice();
    var isIphoneAndSafari = device.iPhone && device.browser.name === V.Constant.SAFARI;
    if(isIphoneAndSafari) {
      V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onSimpleClick, _onSimpleClickEvent)
    }else {
      $(document).on("click", ".fc_poi", _onFlashcardPoiClicked)
    }
  };
  var _onSimpleClickEvent = function(params) {
    var event = params.event;
    var target = event.target;
    if($(target).hasClass("fc_poi")) {
      event.preventDefault();
      var poiId = target.id;
      _onFlashcardPoiSelected(poiId)
    }
  };
  var unloadEvents = function() {
    var device = V.Status.getDevice();
    var isIphoneAndSafari = device.iPhone && device.browser.name === V.Constant.SAFARI;
    if(isIphoneAndSafari) {
      V.EventsNotifier.unRegisterCallback(V.Constant.Event.Touchable.onSimpleClick, _onSimpleClickEvent)
    }else {
      $(document).off("click", ".fc_poi")
    }
  };
  var draw = function(flashcardJSON) {
    $("#" + flashcardJSON.id).css("background-image", flashcardJSON.background);
    for(index in flashcardJSON.pois) {
      var poi = flashcardJSON.pois[index];
      _addArrow(flashcardJSON.id, poi)
    }
  };
  var _addArrow = function(fcId, poi) {
    if(!poi || (!poi.x || (!poi.y || (poi.x > 100 || poi.y > 100)))) {
      return
    }
    var flashcard_div = $("#" + fcId);
    var poiId = V.Utils.getId(fcId + "_poi");
    var div_to_add = "<div class='fc_poi' id='" + poiId + "' style='position:absolute;left:" + poi.x + "%;top:" + poi.y + "%'></div>";
    flashcard_div.append(div_to_add);
    if(typeof flashcards[fcId] === "undefined") {
      flashcards[fcId] = new Object;
      flashcards[fcId].arrows = []
    }
    var arrow = new Object;
    arrow.id = poiId;
    arrow.slide_id = poi.slide_id;
    arrow.x = poi.x;
    arrow.y = poi.y;
    flashcards[fcId].arrows.push(arrow);
    pois[arrow.id] = arrow
  };
  var onEnterSlideset = function(slideset) {
    _startAnimation($(slideset).attr("id"))
  };
  var onLeaveSlideset = function(slideset) {
    _stopAnimation($(slideset).attr("id"))
  };
  var _startAnimation = function(slideId) {
    if(typeof flashcards !== "undefined" && (typeof flashcards[slideId] !== "undefined" && typeof flashcards[slideId].timer == "undefined")) {
      flashcards[slideId].timer = setInterval(function() {
        _animateArrows(slideId)
      }, 1E3 / FPS)
    }
  };
  var _animateArrows = function(slideId) {
    if(!slideId || typeof flashcards[slideId] == "undefined") {
      return
    }
    var cacheBackgroundPosX = undefined;
    $(flashcards[slideId].arrows).each(function(index, value) {
      var arrowDOM = $("#" + value.id);
      if(typeof cacheBackgroundPosX == "undefined") {
        var backgroundPosX = $(arrowDOM).cssNumber("background-position-x") + 5;
        if(backgroundPosX == 5) {
          backgroundPosX = V.Utils.getBackgroundPosition(arrowDOM).x + 5
        }
        if(backgroundPosX > 95) {
          backgroundPosX = 0
        }
        cacheBackgroundPosX = backgroundPosX
      }
      $(arrowDOM).css("background-position", cacheBackgroundPosX + "%" + " center")
    })
  };
  var _stopAnimation = function(slideId) {
    if(typeof flashcards !== "undefined" && (typeof flashcards[slideId] !== "undefined" && typeof flashcards[slideId].timer !== "undefined")) {
      clearTimeout(flashcards[slideId].timer);
      flashcards[slideId].timer = undefined
    }
  };
  var _onFlashcardPoiClicked = function(event) {
    _onFlashcardPoiSelected($(event.target).attr("id"))
  };
  var _onFlashcardPoiSelected = function(poiId) {
    if(typeof pois != "undefined" && typeof pois[poiId] != "undefined") {
      var poiJSON = pois[poiId];
      if(typeof poiJSON != "undefined") {
        V.Slides.openSubslide(poiJSON.slide_id, true)
      }
    }
  };
  var afterSetupSize = function(increase, increaseW) {
    var fcArrowIncrease;
    if(increase >= 1) {
      fcArrowIncrease = V.ViewerAdapter.getPonderatedIncrease(increase, 0.1)
    }else {
      fcArrowIncrease = V.ViewerAdapter.getPonderatedIncrease(increase, 0.8)
    }
    for(var fckey in flashcards) {
      var fc = flashcards[fckey];
      var arrows = fc.arrows;
      $(arrows).each(function(index, arrow) {
        var orgX = arrow.x * 8;
        var newWidth = 50 * fcArrowIncrease;
        var newLeft = increase * orgX + 25 * (increase - fcArrowIncrease);
        var orgY = arrow.y * 6;
        var newHeight = 40 * fcArrowIncrease;
        var newTop = increase * orgY + 40 * 0.8 * (increase - fcArrowIncrease);
        var arrowDom = $("#" + arrow.id);
        $(arrowDom).css("left", newLeft + "px");
        $(arrowDom).width(newWidth + "px");
        $(arrowDom).css("top", newTop + "px");
        $(arrowDom).height(newHeight + "px")
      })
    }
  };
  return{init:init, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, afterSetupSize:afterSetupSize, loadEvents:loadEvents, unloadEvents:unloadEvents}
}(VISH, jQuery);
VISH.Quiz = function(V, $, undefined) {
  var quizMode;
  var quizzes = {};
  var quizChoicesIds = {};
  var currentQuizDOM;
  var currentQuizSession;
  var currentPolling;
  var quizSessionId;
  var initBeforeRender = function(presentation) {
    if(presentation.type === V.Constant.QUIZ_SIMPLE) {
      quizMode = V.Constant.QZ_MODE.RT;
      if(V.Utils.getOptions().quizSessionId) {
        quizSessionId = V.Utils.getOptions().quizSessionId
      }
    }else {
      quizMode = V.Constant.QZ_MODE.SELFA
    }
  };
  var init = function() {
    $("#quizSessionNameInput").vewatermark(V.I18n.getTrans("i.QuizSessionName"));
    V.Quiz.API.init(V.Configuration.getConfiguration().ARS_API);
    V.Quiz.MC.init();
    V.Quiz.TF.init();
    V.Quiz.Sorting.init();
    V.Quiz.Open.init();
    V.QuizCharts.init(V.I18n.getLanguage());
    _loadEvents()
  };
  var _loadEvents = function() {
    $(document).on("click", ".quizAnswerButton", _onAnswerQuiz);
    $(document).on("click", ".quizStartButton", _onStartQuiz);
    $(document).on("click", ".quizStopButton", _onStopQuiz);
    $("a#addQuizSessionFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":"0%", "height":"0%", "padding":0, "autoScale":true, "onStart":function(data) {
      loadTab("tab_quiz_session");
      $("#fancybox-close").height(0);
      $("#fancybox-close").css("padding", 0)
    }, "onComplete":function(data) {
      setTimeout(function() {
        V.ViewerAdapter.updateFancyboxAfterSetupSize();
        if(currentQuizSession && currentQuizSession.url) {
          _loadQr(currentQuizSession.url)
        }
      }, 300)
    }, "onClosed":function() {
      _stopPolling()
    }})
  };
  var render = function(elJSON, template) {
    var quizModule = _getQuizModule(elJSON.quiztype);
    if(quizModule) {
      var zoneId = elJSON["id"];
      var quizId = V.Utils.getId("quiz");
      elJSON["quizId"] = quizId;
      elJSON = _changeQuizChoicesIds(elJSON);
      quizzes[quizId] = elJSON;
      var quizDOM = quizModule.render(elJSON, template);
      return"<div id='" + zoneId + "' class='quizWrapper " + template + "_" + elJSON["areaid"] + " " + template + "_quiz" + "'>" + quizDOM + "</div>"
    }
  };
  var renderButtons = function(quizJSON) {
    var selfA = quizJSON.selfA;
    var ARSEnabled = false;
    if(typeof quizJSON.settings == "object") {
      if(quizJSON.settings.ARSEnabled === true || quizJSON.settings.ARSEnabled === "true") {
        ARSEnabled = true
      }
    }
    var quizButtons = $("<div class='quizButtons'></div>");
    if(quizMode === V.Constant.QZ_MODE.SELFA && (ARSEnabled == true && (V.User.isLogged() && !V.Utils.getOptions().preview))) {
      var startButton = $("<input type='button' class='buttonQuiz quizStartButton' value='" + V.I18n.getTrans("i.QuizLaunch") + "'/>");
      $(quizButtons).append(startButton)
    }
    if(selfA || quizJSON.quiztype === V.Constant.QZ_TYPE.OPEN || quizMode === V.Constant.QZ_MODE.RT) {
      var answerButton = $("<input type='button' class='buttonQuiz quizAnswerButton' value='" + V.I18n.getTrans("i.QuizButtonAnswer") + "'/>");
      $(quizButtons).append(answerButton)
    }
    return quizButtons
  };
  var enableAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).removeAttr("disabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).removeAttr("quizStatus");
    $(answerButton).attr("value", V.I18n.getTrans("i.QuizButtonAnswer"))
  };
  var retryAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).removeAttr("disabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "retry");
    $(answerButton).attr("value", V.I18n.getTrans("i.QuizRetry"))
  };
  var continueAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).removeAttr("disabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "continue");
    $(answerButton).attr("value", V.I18n.getTrans("i.QuizButtonContinue"))
  };
  var _loadingAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).attr("disabled", "disabled");
    $(answerButton).addClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "loading")
  };
  var disableAnswerButton = function(quiz) {
    var answerButton = $(quiz).find("input.quizAnswerButton");
    $(answerButton).attr("disabled", "disabled");
    $(answerButton).addClass("quizAnswerButtonDisabled");
    $(answerButton).removeClass("quizStartButtonLoading");
    $(answerButton).attr("quizStatus", "disabled")
  };
  var _onAnswerQuiz = function(event) {
    var quizDOM = $("div.quizContainer").has(event.target);
    var quizModule = _getQuizModule($(quizDOM).attr("type"));
    if(quizModule) {
      if(quizMode === V.Constant.QZ_MODE.SELFA) {
        _onAnswerSAQuiz(quizDOM, quizModule)
      }else {
        _answerRTQuiz(quizDOM, quizModule)
      }
    }
  };
  _onAnswerSAQuiz = function(quizDOM, quizModule) {
    var quizStatus = $(quizDOM).find(".quizAnswerButton").attr("quizstatus");
    if(quizStatus === "retry") {
      V.TrackingSystem.registerAction("retryQuiz");
      quizModule.onRetryQuiz(quizDOM)
    }else {
      if(quizStatus === "continue") {
        var slideDOM = V.Slides.getTargetSlide();
        if(V.Slides.isSubslide(slideDOM) && $(slideDOM).parent().attr("type") === V.Constant.EVIDEO) {
          var closeButtonId = "close" + $(slideDOM).attr("id");
          $("#" + closeButtonId).trigger("click")
        }
      }else {
        var _canRetry = false;
        var _afterAnswerAction = "disable";
        var slideDOM = V.Slides.getTargetSlide();
        if(V.Slides.isSubslide(slideDOM) && $(slideDOM).parent().attr("type") === V.Constant.EVIDEO) {
          _afterAnswerAction = "continue"
        }
        var quizId = $(quizDOM).attr("id");
        var quizJSON = quizzes[quizId];
        var nAttempts = 1;
        if(typeof quizJSON.settings == "object") {
          var settingsNAttempts = quizJSON.settings.nAttempts;
          if(typeof settingsNAttempts != "undefined") {
            if(settingsNAttempts === "unlimited") {
              nAttempts = settingsNAttempts
            }else {
              nAttempts = parseInt(settingsNAttempts)
            }
          }
        }
        if(typeof quizzes[quizId] != "undefined") {
          if(typeof quizzes[quizId].cnAttempts != "undefined") {
            nAttempts = quizzes[quizId].cnAttempts
          }else {
            if(typeof quizzes[quizId].nAttempts != "undefined") {
              nAttempts = quizzes[quizId].nAttempts
            }
          }
        }
        if(nAttempts > 1 || nAttempts === "unlimited") {
          _canRetry = true
        }
        if(nAttempts != "unlimited") {
          quizzes[quizId].cnAttempts = nAttempts - 1
        }
        quizModule.onAnswerQuiz(quizDOM, {afterAnswerAction:_afterAnswerAction, canRetry:_canRetry})
      }
    }
  };
  var _answerRTQuiz = function(quizDOM, quizModule) {
    if(!quizSessionId) {
      return
    }
    var report = quizModule.getReport(quizDOM);
    if(report.empty === true) {
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizEmptyAnswerAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    quizModule.disableQuiz(quizDOM);
    _loadingAnswerButton(quizDOM);
    var answers = report.answers;
    V.Quiz.API.sendAnwers(answers, quizSessionId, function(data) {
      disableAnswerButton(quizDOM);
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizSubmittedAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options)
    }, function(error) {
      disableAnswerButton(quizDOM);
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizNotSubmittedAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options)
    })
  };
  var _onStartQuiz = function(event) {
    var startButton = $(event.target);
    var quizDOM = $("div.quizContainer").has(startButton);
    switch($(startButton).attr("quizStatus")) {
      case "running":
        V.TrackingSystem.registerAction("ARSoptions");
        $("#fancybox-close").hide();
        $("a#addQuizSessionFancybox").trigger("click");
        break;
      case "loading":
        break;
      case "stop":
      ;
      default:
        V.TrackingSystem.registerAction("launchARS");
        _startNewQuizSession(quizDOM);
        break
    }
  };
  var _startNewQuizSession = function(quizDOM) {
    if(currentQuizSession) {
      var options = {};
      options.width = "80%";
      options.text = V.I18n.getTrans("i.QuizMultipleLaunchAlert");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    _loadingLaunchButton(quizDOM);
    var quizJSON = _getQuizSimpleJSONForQuiz(quizDOM);
    V.Quiz.API.startQuizSession(quizDOM, quizJSON, _onQuizSessionReceived, _onQuizSessionReceivedError)
  };
  var _onQuizSessionReceived = function(quizDOM, quizSession) {
    currentQuizDOM = quizDOM;
    currentQuizSession = quizSession;
    _runningLaunchButton(quizDOM);
    $("a#addQuizSessionFancybox").trigger("click")
  };
  var _onQuizSessionReceivedError = function(quizDOM, error) {
    _enableLaunchButton(quizDOM);
    var options = {};
    options.width = "80%";
    options.text = V.I18n.getTrans("i.QuizCreateSessionError");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options);
    return
  };
  var _onStopQuiz = function(event) {
    var options = {};
    options.width = "80%";
    options.text = V.I18n.getTrans("i.QuizSaveConfirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.extraclass = "quizSession_button_cancel";
    button1.callback = function() {
      V.TrackingSystem.registerAction("cancel_saveARS");
      _onCloseQuizSession("cancel")
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.No");
    button2.extraclass = "quizSession_button_no";
    button2.callback = function() {
      V.TrackingSystem.registerAction("no_saveARS");
      _onCloseQuizSession("no")
    };
    options.buttons.push(button2);
    var button3 = {};
    button3.text = V.I18n.getTrans("i.Yes");
    button3.extraclass = "quizSession_button_yes";
    button3.callback = function() {
      V.TrackingSystem.registerAction("saveARS");
      _onCloseQuizSession("yes")
    };
    options.buttons.push(button3);
    var input = document.createElement("input");
    $(input).attr("id", "quizSessionNameInput");
    $(input).attr("title", V.I18n.getTrans("i.tooltip.QSInput"));
    $(input).addClass("quizSessionNameInput");
    $(input).vewatermark(V.I18n.getTrans("i.QuizSessionName"));
    options.middlerow = $(input);
    options.middlerowExtraClass = "mr_quizSession";
    options.buttonsWrapperClass = "forceCenter";
    V.TrackingSystem.registerAction("stopARS");
    V.Utils.showDialog(options)
  };
  var _onCloseQuizSession = function(saving) {
    var name = undefined;
    switch(saving) {
      case "yes":
        $(".quizSessionNameInput").each(function(index, pn) {
          if($(pn).is(":visible")) {
            name = $(pn).val()
          }
        });
        $(".quizSession_button_yes").addClass("quizStartButtonLoading");
        _closeQuizSession(name);
        break;
      case "no":
        $(".quizSession_button_no").addClass("quizStartButtonLoading");
        _deleteQuizSession();
        break;
      case "cancel":
      ;
      default:
        $.fancybox.close();
        break
    }
  };
  var _closeQuizSession = function(name) {
    V.Quiz.API.closeQuizSession(currentQuizSession.id, name, function(data) {
      _afterCloseQuizSession()
    }, function() {
      _afterCloseQuizSession()
    })
  };
  var _afterCloseQuizSession = function() {
    $.fancybox.close();
    $(".quizSession_button_no").removeClass("quizStartButtonLoading");
    $(".quizSession_button_yes").removeClass("quizStartButtonLoading");
    _enableLaunchButton(currentQuizDOM);
    currentQuizDOM = null;
    currentQuizSession = null;
    _cleanResults()
  };
  var _deleteQuizSession = function() {
    V.Quiz.API.deleteQuizSession(currentQuizSession.id);
    _afterCloseQuizSession()
  };
  var _getQuizSimpleJSONForQuiz = function(quizDOM) {
    var quizId = $(quizDOM).attr("id");
    return quizzes[quizId].quiz_simple_json
  };
  var _enableLaunchButton = function(quiz) {
    var startButton = $(quiz).find("input.quizStartButton");
    $(startButton).removeAttr("disabled");
    $(startButton).removeClass("quizStartButtonLoading");
    $(startButton).removeAttr("quizStatus");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizLaunch"))
  };
  var _loadingLaunchButton = function(quizDOM) {
    var startButton = $(quizDOM).find("input.quizStartButton");
    $(startButton).attr("disabled", "disabled");
    $(startButton).addClass("quizStartButtonLoading");
    $(startButton).attr("quizStatus", "loading");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizLaunch"))
  };
  var _runningLaunchButton = function(quiz) {
    var startButton = $(quiz).find("input.quizStartButton");
    $(startButton).removeAttr("disabled");
    $(startButton).removeClass("quizStartButtonLoading");
    $(startButton).attr("quizStatus", "running");
    $(startButton).attr("value", V.I18n.getTrans("i.QuizButtonOptions"))
  };
  var loadTab = function(tab_id) {
    $(".fancy_viewer_tab_content").hide();
    $("#" + tab_id + "_content").show();
    $(".fancy_viewer_tab").removeClass("fancy_selected");
    $("#" + tab_id).addClass("fancy_selected");
    $(".help_in_fancybox_viewer").hide();
    $("#" + tab_id + "_help").show();
    switch(tab_id) {
      case "tab_quiz_session":
        _loadQuizSession();
        break;
      case "tab_quiz_stats":
        _loadStats();
        break;
      default:
        break
    }
    return false
  };
  var _loadQuizSession = function() {
    if(!currentQuizSession) {
      return
    }
    var myA = $("#tab_quiz_session_url_link");
    $(myA).attr("href", currentQuizSession.url);
    $(myA).html("<p id='tab_quiz_session_url'>" + currentQuizSession.url + "</p>");
    var sharingText = $(currentQuizDOM).find(".mc_question_wrapper_viewer").text().trim();
    var twitter = $("#tab_quiz_session_share_twitter");
    $(twitter).attr("href", "https://twitter.com/share?url=" + currentQuizSession.url + "&text=" + sharingText + "");
    var facebook = $("#tab_quiz_session_share_facebook");
    var facebookUrl = "http://www.facebook.com/sharer.php?s=100&p[url]=" + currentQuizSession.url + "&p[title]=" + sharingText;
    $(facebook).attr("href", facebookUrl);
    var gPlus = $("#tab_quiz_session_share_gPlus");
    $(gPlus).attr("href", "https://plus.google.com/share?url=" + currentQuizSession.url)
  };
  var _loadStats = function() {
    V.Quiz.API.getResults(currentQuizSession.id, function(results) {
      _drawResults(results);
      _startPolling()
    })
  };
  var _loadQr = function(url) {
    if(typeof url != "string") {
      return
    }
    var container = $(".quizQr");
    $(container).html("");
    var tabQuizSessionContent = $("#tab_quiz_session_content");
    V.Utils.addTempShown([tabQuizSessionContent, container]);
    var height = $(container).height();
    V.Utils.removeTempShown([tabQuizSessionContent, container]);
    var width = height;
    var qrOptions = {render:"canvas", width:width, height:height, color:"#000", bgColor:"#fff", text:url.toString()};
    $(container).qrcode(qrOptions);
    var overlayHeight = $("#qr_overlay").height();
    var qrOptions = {render:"canvas", width:overlayHeight, height:overlayHeight, color:"#000", bgColor:"#fff", text:url.toString()};
    $("#qr_overlay").qrcode(qrOptions);
    var qrDOMFancybox = $(container).find("canvas");
    $(qrDOMFancybox).click(function() {
      $("#qr_overlay").show()
    });
    $("#qr_overlay").click(function() {
      $("#qr_overlay").hide()
    })
  };
  var _openQrOverlay = function(qr) {
    $("#qr_overlay").show()
  };
  var _updateQrSizeOnOverlay = function() {
    var qr = $("#qr_overlay").find("canvas");
    var qrSize = Math.min($("#qr_overlay").width(), $("#qr_overlay").height());
    $(qr).width(qrSize);
    $(qr).height(qrSize)
  };
  var _closeQrOverlay = function() {
    $("#qr_overlay").hide()
  };
  var _startPolling = function() {
    _stopPolling();
    currentPolling = setInterval(function() {
      if(!currentQuizSession) {
        _stopPolling();
        return
      }
      V.Quiz.API.getResults(currentQuizSession.id, function(results) {
        _drawResults(results)
      })
    }, 2500)
  };
  var _stopPolling = function() {
    if(currentPolling) {
      clearInterval(currentPolling)
    }
  };
  var _drawResults = function(results) {
    if(currentQuizSession) {
      if(typeof currentQuizSession.lastDrawedResults != "undefined" && results.length === currentQuizSession.lastDrawedResults.length) {
        return
      }
      if(results.length === 0) {
        return
      }
    }else {
      return
    }
    var options = {};
    if(typeof currentQuizSession.firstDrawed == "undefined") {
      currentQuizSession.firstDrawed = false;
      options.animation = true;
      options.callback = function() {
        currentQuizSession.firstDrawed = true
      }
    }else {
      if(currentQuizSession.firstDrawed == false) {
        return
      }
    }
    currentQuizSession.lastDrawedResults = results;
    _cleanResults();
    var canvas = $("#quiz_chart");
    var desiredWidth = $("#fancybox-content").width();
    var desiredHeight = $("#fancybox-content").height() * 0.8;
    $(canvas).width(desiredWidth);
    $(canvas).height(desiredHeight);
    $(canvas).attr("width", desiredWidth);
    $(canvas).attr("height", desiredHeight);
    $(canvas).show();
    var quizJSON = _getQuizSimpleJSONForQuiz(currentQuizDOM);
    V.QuizCharts.drawQuizChart(canvas, quizJSON, results, options)
  };
  var _cleanResults = function() {
    var canvas = $("#quiz_chart");
    $(canvas).parent().find("div.openQuizAnswersListWrapper").remove();
    var ctx = $(canvas).get(0).getContext("2d");
    ctx.clearRect(0, 0, $(canvas).width(), $(canvas).height());
    $(canvas).hide()
  };
  var getQuiz = function(quizId) {
    return quizzes[quizId]
  };
  var getQuizChoiceOriginalId = function(newQuizChoiceId) {
    return quizChoicesIds[newQuizChoiceId]
  };
  var _getQuizModule = function(quiz_type) {
    switch(quiz_type) {
      case V.Constant.QZ_TYPE.OPEN:
        return V.Quiz.Open;
        break;
      case V.Constant.QZ_TYPE.MCHOICE:
        return V.Quiz.MC;
        break;
      case V.Constant.QZ_TYPE.TF:
        return V.Quiz.TF;
        break;
      case V.Constant.QZ_TYPE.SORTING:
        return V.Quiz.Sorting;
        break;
      default:
        return null;
        break
    }
  };
  var _changeQuizChoicesIds = function(quizJSON) {
    $(quizJSON.choices).each(function(index, choice) {
      var newChoiceId = _generateRandomQuizChoiceId();
      quizChoicesIds[newChoiceId] = quizJSON.choices[index].id;
      quizJSON.choices[index].id = newChoiceId
    });
    return quizJSON
  };
  var _usedQuizChoicesIds = [];
  var _generateRandomQuizChoiceId = function() {
    var randomInteger;
    while(typeof randomInteger == "undefined" || _usedQuizChoicesIds.indexOf(randomInteger) != -1) {
      randomInteger = Math.round(Math.random() * Math.pow(10, 16))
    }
    _usedQuizChoicesIds.push(randomInteger);
    return randomInteger
  };
  var updateCheckbox = function(checkbox, check) {
    if(typeof check == "boolean") {
      check = check.toString()
    }
    var imagePathRoot = V.ImagesPath + "quiz/checkbox";
    switch(check) {
      case "true":
        $(checkbox).attr("check", "true");
        $(checkbox).attr("src", imagePathRoot + "_checked.png");
        break;
      case "false":
        $(checkbox).attr("check", "false");
        $(checkbox).attr("src", imagePathRoot + "_wrong.png");
        break;
      case "none":
      ;
      default:
        $(checkbox).attr("check", "none");
        $(checkbox).attr("src", imagePathRoot + ".png");
        break
    }
  };
  var aftersetupSize = function(increase) {
    setTimeout(function() {
      if(currentQuizSession && currentQuizSession.url) {
        _loadQr(currentQuizSession.url);
        _updateQrSizeOnOverlay()
      }
    }, 500)
  };
  return{initBeforeRender:initBeforeRender, init:init, render:render, renderButtons:renderButtons, getQuiz:getQuiz, getQuizChoiceOriginalId:getQuizChoiceOriginalId, updateCheckbox:updateCheckbox, enableAnswerButton:enableAnswerButton, retryAnswerButton:retryAnswerButton, continueAnswerButton:continueAnswerButton, disableAnswerButton:disableAnswerButton, loadTab:loadTab, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Quiz.API = function(V, $, undefined) {
  var ARS_API_RootURL;
  var init = function(ARS_API) {
    if(typeof ARS_API == "object" && typeof ARS_API.rootURL == "string") {
      ARS_API_RootURL = V.Utils.checkUrlProtocol(ARS_API.rootURL)
    }
    if(V.Debugging.isDevelopping()) {
      V.Quiz.API.Development.init(ARS_API)
    }
  };
  var startQuizSession = function(quizDOM, quizJSON, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      return V.Quiz.API.Development.startQuizSession(quizDOM, quizJSON, successCallback, failCallback)
    }
    var send_type = "POST";
    var params = {"quiz":JSON.stringify(quizJSON), "authenticity_token":V.User.getToken()};
    $.ajax({type:send_type, url:ARS_API_RootURL, data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(quizDOM, data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(quizDOM, error)
      }
    }})
  };
  var closeQuizSession = function(quizSessionId, name, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      return V.Quiz.API.Development.closeQuizSession(quizSessionId, name, successCallback, failCallback)
    }
    var send_type = "GET";
    var params = {"id":quizSessionId, "authenticity_token":V.User.getToken()};
    if(typeof name == "string" && name.trim() != "") {
      params["name"] = name
    }
    $.ajax({type:send_type, url:ARS_API_RootURL + quizSessionId + "/close", data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(error)
      }
    }})
  };
  var deleteQuizSession = function(quizSessionId, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      return V.Quiz.API.Development.deleteQuizSession(quizSessionId, successCallback, failCallback)
    }
    var send_type = "GET";
    var params = {"id":quizSessionId, "authenticity_token":V.User.getToken()};
    $.ajax({type:send_type, url:ARS_API_RootURL + quizSessionId + "/delete", data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(error)
      }
    }})
  };
  var getResults = function(quizSessionId, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      return V.Quiz.API.Development.getResults(quizSessionId, successCallback, failCallback)
    }
    var send_type = "GET";
    var params = {"id":quizSessionId};
    if(V.User.isLogged()) {
      params["authenticity_token"] = V.User.getToken()
    }
    $.ajax({type:send_type, url:ARS_API_RootURL + quizSessionId + "/results.json", data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(error)
      }
    }})
  };
  var sendAnwers = function(answers, quizSessionId, successCallback, failCallback) {
    if(V.Debugging.isDevelopping()) {
      return V.Quiz.API.Development.sendAnwers(answers, quizSessionId, successCallback, failCallback)
    }
    var send_type = "POST";
    var params = {"id":quizSessionId, "answers":JSON.stringify(answers)};
    if(V.User.isLogged()) {
      params["authenticity_token"] = V.User.getToken()
    }
    $.ajax({type:send_type, url:ARS_API_RootURL + quizSessionId + "/answer", data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(error)
      }
    }})
  };
  return{init:init, startQuizSession:startQuizSession, closeQuizSession:closeQuizSession, deleteQuizSession:deleteQuizSession, getResults:getResults, sendAnwers:sendAnwers}
}(VISH, jQuery);
VISH.Editor.Tools = function(V, $, undefined) {
  var toolbarEventsLoaded = false;
  var INCREASE_SIZE = 1.05;
  var init = function() {
    cleanToolbar();
    var presentationType = V.Editor.getPresentationType();
    if(presentationType !== V.Constant.PRESENTATION) {
      disableToolbar();
      return
    }
    if(V.StudentMode === true) {
      var draft = V.Utils.getOptions().draft;
      var notified = V.Utils.getOptions().notified;
      var publish_button = $("#toolbar_publish_wrapper");
      if(draft && notified) {
        publish_button.addClass("menu_item_disabled");
        publish_button.children("p").html(V.I18n.getTrans("i.notified_teacher"));
        publish_button.find("i").removeClass().addClass("icon-button icon-bell-alt")
      }else {
        if(draft) {
          publish_button.children("p").html(V.I18n.getTrans("i.notify_teacher"));
          publish_button.find("i").removeClass().addClass("icon-button icon-bell-alt");
          $("#toolbar_publish").attr("action", "notifyTeacher")
        }else {
          publish_button.addClass("menu_item_disabled");
          publish_button.children("p").html(V.I18n.getTrans("i.Published"));
          publish_button.find("i").removeClass().addClass("icon-button icon-cloud-upload")
        }
      }
    }
    if(!toolbarEventsLoaded) {
      $.each($("#toolbar_wrapper a.tool_action, div.tool_action"), function(index, toolbarButton) {
        $(toolbarButton).on("click", function(event) {
          if(typeof V.Editor.Tools[$(toolbarButton).attr("action")] == "function") {
            if(!$(toolbarButton).find(".toolbar_presentation_wrapper").hasClass("toolbar_presentation_wrapper_disabled")) {
              V.Editor.Tools[$(toolbarButton).attr("action")](this)
            }
          }
          return false
        })
      });
      $(document).on("keydown", ".tools_input_addUrl", _addUrlOnKeyDown);
      toolbarEventsLoaded = true
    }
    V.Editor.Tools.Menu.init()
  };
  var cleanToolbar = function() {
    var cSlide = V.Slides.getCurrentSlide();
    if(typeof cSlide != "undefined") {
      loadToolsForSlide(cSlide)
    }
  };
  var enableToolbar = function() {
    $("#toolbar_wrapper").show()
  };
  var disableToolbar = function() {
    $("#toolbar_wrapper").hide()
  };
  var loadToolsForSlide = function(slide) {
    _cleanPresentationToolbar();
    var type = $(slide).attr("type");
    $(".toolbar_presentation_wrapper_slideTools:not(.toolbar_" + type + ")").hide();
    $(".toolbar_presentation_wrapper_slideTools.toolbar_" + type).show();
    $(".toolbar_presentation_wrapper_slideTools.toolbar_" + type).children().css("visibility", "visible");
    switch(type) {
      case V.Constant.STANDARD:
        $("#toolbar_background").find(".toolbar_presentation_wrapper").addClass("toolbar_presentation_wrapper_disabled");
        break;
      case V.Constant.FLASHCARD:
        break;
      case V.Constant.VTOUR:
        $("#toolbar_background_wrapper").children().css("visibility", "hidden");
        break;
      default:
        return
    }
  };
  var _cleanPresentationToolbar = function() {
    $(".toolbar_presentation_wrapper_slideTools").removeClass("toolbar_presentation_wrapper_disabled");
    cleanZoneTools()
  };
  var changePublishButtonStatus = function(status) {
    switch(status) {
      case "publish":
        _enablePublishButton();
        break;
      case "publishing":
        _enablePublishingButton();
        break;
      case "unpublish":
        _enableUnpublishButton();
        break;
      case "unpublishing":
        _enableUnpublishingButton();
        break;
      case "disabled":
        _disablePublishButton();
        break;
      default:
        return
    }
  };
  var _enablePublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish_wrapper").removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish_wrapper").removeClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-90");
    $(icon).addClass("icon-rotate-270");
    $("#toolbar_publish").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publish"));
    $("#toolbar_publish").attr("action", "publish");
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().removeClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publish"));
    $(menuItem).attr("action", "onPublishButtonClicked")
  };
  var _enablePublishingButton = function() {
    $("#waiting_overlay").show();
    $("#toolbar_publish_wrapper").addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish_wrapper").addClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-90");
    $(icon).addClass("icon-rotate-270");
    $("#toolbar_publish").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publishing"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publishing"))
  };
  var _enableUnpublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish_wrapper").removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish_wrapper").removeClass("toolbar_presentation_wrapper_disabled");
    var icon = $("#toolbar_publish").find("i.icon-download-alt");
    $(icon).removeClass("icon-rotate-270");
    $(icon).addClass("icon-rotate-90");
    $("#toolbar_publish").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Unpublish"));
    $("#toolbar_publish").attr("action", "unpublish");
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().removeClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Unpublish"));
    $(menuItem).attr("action", "onUnpublishButtonClicked")
  };
  var _enableUnpublishingButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish_wrapper").addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_publish_wrapper").addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Unpublishing"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Unpublishing"))
  };
  var _disablePublishButton = function() {
    $("#waiting_overlay").hide();
    $("#toolbar_publish_wrapper").removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_publish_wrapper").addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_publish").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Publish"));
    var menuItem = $(".menu_option.menu_action.publishMenuOption");
    $(menuItem).parent().addClass("menu_item_disabled");
    $(menuItem).find("span").html(V.I18n.getTrans("i.Publish"))
  };
  var dirtyModeTimeout;
  var saveButtonStatus = "enabled";
  var changeSaveButtonStatus = function(status) {
    switch(status) {
      case "enabled":
        _enableSaveButton();
        break;
      case "loading":
        _loadingSaveButton();
        break;
      case "disabled":
        _disableSaveButton();
        break;
      default:
        return
    }
  };
  var _enableSaveButton = function() {
    if(saveButtonStatus === "enabled") {
      return
    }
    saveButtonStatus = "enabled";
    _stopDirtyTimeout();
    $("#toolbar_save").find(".toolbar_presentation_wrapper").removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").find(".toolbar_presentation_wrapper").removeClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Save"));
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().removeClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Save"))
  };
  var _loadingSaveButton = function() {
    if(saveButtonStatus === "loading") {
      return
    }
    saveButtonStatus = "loading";
    $("#toolbar_save").find(".toolbar_presentation_wrapper").addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").find(".toolbar_presentation_wrapper").addClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Saving"));
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Saving"))
  };
  var _disableSaveButton = function() {
    if(saveButtonStatus === "disabled") {
      return
    }
    saveButtonStatus = "disabled";
    $("#toolbar_save").find(".toolbar_presentation_wrapper").removeClass("toolbar_presentation_wrapper_loading");
    $("#toolbar_save").find(".toolbar_presentation_wrapper").addClass("toolbar_presentation_wrapper_disabled");
    $("#toolbar_save").find("p.toolbar_presentation_title").html(V.I18n.getTrans("i.Saved"));
    _stopDirtyTimeout();
    dirtyModeTimeout = setTimeout(function() {
      changeSaveButtonStatus("enabled")
    }, 5E3);
    $(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled");
    $(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(V.I18n.getTrans("i.Saved"))
  };
  var _stopDirtyTimeout = function() {
    if(typeof dirtyModeTimeout != "undefined") {
      clearTimeout(dirtyModeTimeout)
    }
  };
  var loadToolsForZone = function(zone) {
    cleanZoneTool(V.Editor.getLastArea());
    var type = $(zone).attr("type");
    switch(type) {
      case "text":
        _loadToolbarForElement(type);
        break;
      case "image":
        _loadToolbarForElement(type);
        break;
      case "video":
        _loadToolbarForElement(type);
        break;
      case "object":
        var object = $(zone).find(".object_wrapper").children()[0];
        loadToolbarForObject(object);
        break;
      case "snapshot":
        _loadToolbarForElement("snapshot");
        break;
      case "quiz":
        _loadToolbarForElement("quiz");
        break;
      case undefined:
        $(zone).find(".menuselect_hide").show();
        hideZoneToolTip($(zone).find(".zone_tooltip"));
        return;
      default:
        break
    }
    $(zone).find(".delete_content").show()
  };
  var addTooltipsToSlide = function(slide) {
    var zones = $(slide).find("div.vezone");
    for(var i = 0;i < zones.length;i++) {
      addTooltipToZone(zones[i])
    }
  };
  var addTooltipToZone = function(zone, hidden) {
    var style = "";
    var visible = "true";
    if(hidden === true) {
      style = "style='display:none'";
      visible = "false"
    }
    var tooltip = "<span class='zone_tooltip' visible='" + visible + "' " + style + " >" + V.I18n.getTrans("i.ZoneTooltip") + "</span>";
    $(zone).append(tooltip);
    tooltip = $(zone).find(".zone_tooltip");
    if(hidden === true) {
      hideZoneToolTip(tooltip)
    }else {
      showZoneToolTip(tooltip)
    }
  };
  var showZoneToolTip = function(tooltip) {
    var zone = $("div").has(tooltip);
    $(tooltip).show();
    $(tooltip).attr("visible", "true");
    $(zone).attr("tooltip", "true");
    if($(tooltip).css("margin-top") === "0px") {
      _setTooltipMargins(tooltip)
    }
  };
  var _setTooltipMargins = function(tooltip) {
    var zone = $("div").has(tooltip);
    var slide = $("article").has(zone);
    V.Utils.addTempShown([slide, zone, tooltip]);
    var zoneHeight = $(zone).height();
    var spanHeight = $(tooltip).height();
    var marginTop = (zoneHeight - spanHeight) / 2;
    V.Utils.removeTempShown([slide, zone, tooltip]);
    $(tooltip).css("margin-top", marginTop + "px")
  };
  var setAllTooltipMargins = function(callback) {
    $("span.zone_tooltip").each(function(index, tooltip) {
      _setTooltipMargins(tooltip)
    });
    if(typeof callback == "function") {
      callback(true)
    }
  };
  var hideZoneToolTip = function(tooltip) {
    var zone = $("div").has(tooltip);
    $(tooltip).hide();
    $(tooltip).attr("visible", "false");
    $(zone).attr("tooltip", "false")
  };
  var cleanZoneTools = function() {
    $(".menuselect_hide").hide();
    $(".delete_content").hide();
    _cleanElementToolbar()
  };
  var cleanZoneTool = function(zone) {
    _cleanElementToolbar();
    var tooltip = $(zone).find(".zone_tooltip");
    if(V.Editor.isZoneEmpty(zone)) {
      $(zone).find(".menuselect_hide").remove();
      $(zone).removeClass("zoneUnselected").removeClass("zoneSelected").addClass("editable");
      showZoneToolTip(tooltip)
    }else {
      $(zone).find(".menuselect_hide").hide();
      $(zone).find(".delete_content").hide();
      hideZoneToolTip(tooltip)
    }
  };
  var _loadToolbarForElement = function(type) {
    _cleanElementToolbar();
    var toolbarClass = "toolbar_" + type;
    $("#toolbar_element").children().hide();
    $("#toolbar_element").find("." + toolbarClass).css("display", "inline-block");
    if(type == "quiz") {
      document.getElementById("toolbar_settings_wrapper").style.top = "-8px"
    }else {
      document.getElementById("toolbar_settings_wrapper").style.top = "-4px"
    }
  };
  var loadToolbarForObject = function(object) {
    var objectInfo = V.Object.getObjectInfo(object);
    switch(objectInfo.type) {
      case V.Constant.MEDIA.WEB:
      ;
      case V.Constant.MEDIA.WEB_APP:
        _loadToolbarForElement(V.Constant.MEDIA.WEB);
        break;
      default:
        _loadToolbarForElement("object");
        break
    }
  };
  var _cleanElementToolbar = function() {
    $("#toolbar_element").children().hide()
  };
  var exit = function() {
    V.Editor.Tools.Menu.exit()
  };
  var displaySettings = function() {
    V.Editor.Settings.displaySettings()
  };
  var save = function() {
    V.Editor.Tools.Menu.onSaveButtonClicked()
  };
  var publish = function() {
    V.Editor.Tools.Menu.onPublishButtonClicked()
  };
  var unpublish = function() {
    V.Editor.Tools.Menu.onUnpublishButtonClicked()
  };
  var preview = function() {
    V.Editor.Preview.preview()
  };
  var selectTheme = function() {
    $("#hidden_button_to_launch_theme_fancybox").trigger("click")
  };
  var selectAnimation = function() {
    $("#hidden_button_to_launch_animation_fancybox").trigger("click")
  };
  var changeBackground = function() {
    $("#hidden_button_to_change_slide_background").trigger("click")
  };
  var changeVideo = function() {
    V.Editor.EVideo.onChangeVideo()
  };
  var notifyTeacher = function() {
    V.Editor.Tools.Menu.onSaveButtonClicked();
    V.Editor.Tools.Menu.notifyTeacherClicked()
  };
  var zoomMore = function() {
    _changeZoom("+")
  };
  var zoomLess = function() {
    _changeZoom("-")
  };
  var resizeMore = function() {
    _resize("+")
  };
  var resizeLess = function() {
    _resize("-")
  };
  var _resize = function(action) {
    var object, objectInfo, resizeFactor;
    var area = V.Editor.getCurrentArea();
    var type = $(area).attr("type");
    if(action == "+") {
      resizeFactor = INCREASE_SIZE
    }else {
      resizeFactor = 1 / INCREASE_SIZE
    }
    switch(type) {
      case "snapshot":
        var snapshot_wrapper = area.children(":first");
        var proportion = $(snapshot_wrapper).height() / $(snapshot_wrapper).width();
        var originalWidth = $(snapshot_wrapper).width();
        snapshot_wrapper.width(originalWidth * resizeFactor);
        snapshot_wrapper.height(originalWidth * resizeFactor * proportion);
        break;
      case "object":
        var parent = area.children(":first");
        object = parent.children(":first");
        objectInfo = V.Object.getObjectInfo(object);
        var newWidth, newHeight;
        var aspectRatio = parent.width() / parent.height();
        var originalHeight = object.height();
        var originalWidth = object.width();
        var parentoriginalHeight = parent.height();
        var parentoriginalWidth = parent.width();
        $(parent).width(parentoriginalWidth * resizeFactor);
        $(parent).height(parentoriginalHeight * resizeFactor);
        var styleZoom = V.Utils.getZoomFromStyle($(object).attr("style"));
        if(styleZoom != 1) {
          newWidth = newWidth / styleZoom;
          newHeight = Math.round(newWidth / aspectRatio);
          newWidth = Math.round(newWidth)
        }else {
          newHeight = parentoriginalHeight * resizeFactor;
          newWidth = parentoriginalWidth * resizeFactor
        }
        $(object).width(newWidth);
        $(object).height(newHeight);
        break;
      case "image":
        object = $(area).find("img");
        var originalHeight = object.height();
        var originalWidth = object.width();
        object.width(originalWidth * resizeFactor);
        object.height(originalHeight * resizeFactor);
        break;
      case "video":
        object = $(area).find("video");
        var originalHeight = object.height();
        var originalWidth = object.width();
        object.width(originalWidth * resizeFactor);
        object.height(originalHeight * resizeFactor);
        break;
      default:
        break
    }
  };
  var _changeZoom = function(action) {
    var object, objectInfo, zoom;
    var area = V.Editor.getCurrentArea();
    var type = $(area).attr("type");
    switch(type) {
      case "object":
        var parent = area.children(":first");
        object = parent.children(":first");
        objectInfo = V.Object.getObjectInfo(object);
        if([V.Constant.MEDIA.WEB, V.Constant.MEDIA.WEB_APP].indexOf(objectInfo.type) != -1) {
          var iframe = $(area).find("iframe");
          zoom = V.Utils.getZoomFromStyle($(iframe).attr("style"));
          if(action == "+") {
            zoom = zoom + 0.1
          }else {
            zoom = zoom - 0.1
          }
          $(iframe).attr("style", V.Editor.Utils.addZoomToStyle($(iframe).attr("style"), zoom));
          V.Editor.Object.autofixWrapperedObjectAfterZoom(iframe, zoom)
        }
        break;
      default:
        break
    }
  };
  var addLink = function() {
    $.fancybox($("#tools_addUrl").html(), {"autoDimensions":false, "scrolling":"no", "width":800, "height":215, "showCloseButton":true, "padding":0, "onStart":function() {
    }, "onComplete":function() {
      var area = V.Editor.getCurrentArea();
      var hyperlink = $(area).attr("hyperlink");
      if(hyperlink) {
        $(".tools_input_addUrl").val(hyperlink);
        $(".removeUrlButton").show()
      }else {
        $(".removeUrlButton").hide()
      }
    }, "onClosed":function() {
      $(".removeUrlButton").hide()
    }})
  };
  var _addUrlOnKeyDown = function(event) {
    switch(event.keyCode) {
      case 13:
        addUrl();
        break;
      default:
        break
    }
  };
  var addUrl = function() {
    var url;
    $(".tools_input_addUrl").each(function(index, input) {
      if($($(input).parent().parent()).attr("id") !== "tools_addUrl") {
        url = $(input).val()
      }
    });
    if(url) {
      url = V.Editor.Utils.autocompleteUrls(url);
      var area = V.Editor.getCurrentArea();
      switch($(area).attr("type")) {
        case "image":
          $(area).attr("hyperlink", url);
          break;
        default:
          break
      }
    }
    $.fancybox.close()
  };
  var removeUrl = function() {
    var area = V.Editor.getCurrentArea();
    $(area).removeAttr("hyperlink");
    $.fancybox.close()
  };
  var showSettings = function(event) {
    switch($(V.Editor.getCurrentArea()).attr("type")) {
      case V.Constant.QUIZ:
        V.Editor.Quiz.showQuizSettings();
        break;
      case V.Constant.OBJECT:
        V.Editor.Object.showObjectSettings();
        break;
      default:
        break
    }
  };
  return{init:init, loadToolsForSlide:loadToolsForSlide, loadToolsForZone:loadToolsForZone, loadToolbarForObject:loadToolbarForObject, cleanZoneTools:cleanZoneTools, cleanZoneTool:cleanZoneTool, cleanToolbar:cleanToolbar, enableToolbar:enableToolbar, disableToolbar:disableToolbar, addLink:addLink, addUrl:addUrl, removeUrl:removeUrl, resizeMore:resizeMore, resizeLess:resizeLess, zoomMore:zoomMore, zoomLess:zoomLess, save:save, displaySettings:displaySettings, publish:publish, unpublish:unpublish, 
  notifyTeacher:notifyTeacher, preview:preview, selectTheme:selectTheme, selectAnimation:selectAnimation, changeBackground:changeBackground, changeVideo:changeVideo, addTooltipsToSlide:addTooltipsToSlide, addTooltipToZone:addTooltipToZone, showZoneToolTip:showZoneToolTip, hideZoneToolTip:hideZoneToolTip, setAllTooltipMargins:setAllTooltipMargins, changePublishButtonStatus:changePublishButtonStatus, changeSaveButtonStatus:changeSaveButtonStatus, showSettings:showSettings, exit:exit}
}(VISH, jQuery);
VISH.Addons = function(V, undefined) {
  var init = function(addons) {
    if(typeof addons === "object") {
      for(var i = 0;i < addons.length;i++) {
        var targeted = V.Editing && addons[i].target === V.Constant.Edit || (!V.Editing && addons[i].target === V.Constant.Viewer || addons[i].target === V.Constant.AnyMode);
        if(targeted) {
          if(typeof V.Addons[addons[i].id] !== "undefined" && typeof V.Addons[addons[i].id].init === "function") {
            V.Addons[addons[i].id].init(addons[i].config)
          }
        }
      }
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.Video = function(V, $, undefined) {
  var _enableCustomPlayer;
  var init = function() {
    var options = V.Utils.getOptions();
    if(options && options.videoCustomPlayer === true) {
      _enableCustomPlayer = true;
      V.Video.CustomPlayer.init()
    }else {
      _enableCustomPlayer = false
    }
    V.Video.HTML5.init(_enableCustomPlayer);
    V.Video.Youtube.init(_enableCustomPlayer)
  };
  var playVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        V.Video.HTML5.playVideo(videoId, currentTime, triggeredByUser);
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        V.Video.Youtube.playVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var pauseVideo = function(videoId, currentTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        V.Video.HTML5.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        V.Video.Youtube.pauseVideo(videoId, currentTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var seekVideo = function(videoId, seekTime, triggeredByUser) {
    switch(getTypeVideoWithId(videoId)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        V.Video.HTML5.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        V.Video.Youtube.seekVideo(videoId, seekTime, triggeredByUser);
        break;
      default:
        break
    }
  };
  var getTypeVideoWithId = function(videoId) {
    return getTypeVideo(document.getElementById(videoId))
  };
  var getTypeVideo = function(video) {
    if(typeof $(video)[0] == "undefined") {
      return V.Constant.UNKNOWN
    }
    var tagName = $(video)[0].tagName;
    if(tagName === "VIDEO") {
      return V.Constant.MEDIA.HTML5_VIDEO
    }else {
      if(tagName === "OBJECT" || tagName === "IFRAME") {
        return V.Constant.MEDIA.YOUTUBE_VIDEO
      }
    }
    return V.Constant.UNKNOWN
  };
  var play = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video)[0].play();
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoId = $(video).attr("id");
        var ytplayer = V.Video.Youtube.getYouTubePlayer(videoId);
        if(!V.Status.getDevice().desktop) {
          var ytStatus = ytplayer.getPlayerState();
          if(ytStatus === -1 || ytStatus === 5) {
            var options = {};
            options.width = "80%";
            options.text = V.I18n.getTrans("i.YouTubePlayAlert");
            var button1 = {};
            button1.text = V.I18n.getTrans("i.Ok");
            button1.callback = function() {
              $.fancybox.close()
            };
            options.buttons = [button1];
            V.Utils.showDialog(options);
            return
          }
        }
        ytplayer.playVideo();
        break;
      default:
        break
    }
  };
  var pause = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video)[0].pause();
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoId = $(video).attr("id");
        var ytplayer = V.Video.Youtube.getYouTubePlayer(videoId);
        ytplayer.pauseVideo();
        break;
      default:
        break
    }
  };
  var seekTo = function(video, seekTime) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video)[0].currentTime = seekTime;
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoId = $(video).attr("id");
        var ytplayer = V.Video.Youtube.getYouTubePlayer(videoId);
        var ytStatus = ytplayer.getPlayerState();
        ytplayer.seekTo(seekTime);
        switch(ytStatus) {
          case -1:
            ytplayer.pauseVideo();
            break;
          case 0:
          ;
          case 1:
          ;
          case 2:
            break;
          default:
            ytplayer.addEventListener("onStateChange", function(event) {
              ytplayer.removeEventListener("onStateChange");
              if(event.data === -1) {
                ytplayer.pauseVideo()
              }
            });
            break
        }
        if(typeof youtubePlayerTimeUpdate[videoId] != "undefined" && typeof youtubePlayerTimeUpdate[videoId].timer == "undefined") {
          youtubePlayerTimeUpdate[videoId].timeUpdateCallback(video, seekTime)
        }
        break;
      default:
        break
    }
  };
  var setVolume = function(video, volume) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video)[0].volume = volume / 100;
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        V.Video.Youtube.getYouTubePlayer($(video).attr("id")).setVolume(volume);
        break;
      default:
        break
    }
  };
  var onVideoReady = function(video, successCallback, failCallback) {
    if(typeof successCallback != "function") {
      return
    }
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video).on("loadeddata", function(event) {
          var video = event.target;
          if(video.readyState == 4 || video.readyState == 3) {
            successCallback(video)
          }else {
            if(typeof failCallback == "function") {
              failCallback(video)
            }
          }
        });
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        break;
      default:
        break
    }
  };
  var youtubePlayerTimeUpdate = {};
  var onTimeUpdate = function(video, timeUpdateCallback) {
    if(typeof timeUpdateCallback != "function") {
      return
    }
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        $(video).on("timeupdate", function() {
          var cTime = video.currentTime;
          timeUpdateCallback(video, cTime)
        });
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoId = $(video).attr("id");
        var ytplayer = V.Video.Youtube.getYouTubePlayer(videoId);
        if(typeof youtubePlayerTimeUpdate[videoId] == "undefined") {
          youtubePlayerTimeUpdate[videoId] = {};
          youtubePlayerTimeUpdate[videoId].timeUpdateCallback = timeUpdateCallback;
          if(_getVEStatusFromYouTubeStatus(ytplayer.getPlayerState()).playing === true) {
            youtubePlayerTimeUpdate[videoId].timer = _createYouTubeTimer(video, ytplayer, timeUpdateCallback)
          }
        }
        break;
      default:
        break
    }
  };
  var _createYouTubeTimer = function(video, ytplayer, timeUpdateCallback) {
    return setInterval(function() {
      var cTime = ytplayer.getCurrentTime();
      timeUpdateCallback(video, cTime)
    }, 200)
  };
  var onStatusChange = function(video, statusCallback) {
    if(typeof statusCallback != "function") {
      return
    }
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        video.addEventListener("play", function() {
          statusCallback(video, V.Constant.EVideo.Status.Playing)
        }, false);
        video.addEventListener("pause", function() {
          statusCallback(video, V.Constant.EVideo.Status.Paused)
        }, false);
        $(video).on("timeupdate", function() {
          var cTime = $(video)[0].currentTime;
          var duration = $(video)[0].duration;
          if(cTime == duration) {
            $(video).trigger("pause");
            statusCallback(video, V.Constant.EVideo.Status.Ended)
          }
        });
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoId = $(video).attr("id");
        var ytplayer = V.Video.Youtube.getYouTubePlayer(videoId);
        ytplayer.addEventListener("onStateChange", function(event) {
          var newState = event.data;
          switch(newState) {
            case -1:
              break;
            case 0:
              break;
            case 1:
              if(typeof youtubePlayerTimeUpdate[videoId] != "undefined" && typeof youtubePlayerTimeUpdate[videoId].timer == "undefined") {
                youtubePlayerTimeUpdate[videoId].timer = _createYouTubeTimer(video, ytplayer, youtubePlayerTimeUpdate[videoId].timeUpdateCallback)
              }
              break;
            case 2:
              if(typeof youtubePlayerTimeUpdate[videoId] != "undefined" && typeof youtubePlayerTimeUpdate[videoId].timer != "undefined") {
                clearTimeout(youtubePlayerTimeUpdate[videoId].timer);
                youtubePlayerTimeUpdate[videoId].timer = undefined
              }
              break;
            case 3:
              break;
            case 4:
              break;
            case 5:
              break;
            default:
              break
          }
          var vStatus = _getVEStatusFromYouTubeStatus(newState);
          statusCallback(video, vStatus)
        });
        break;
      default:
        break
    }
  };
  var getStatus = function(video) {
    var vStatus;
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        if(video.paused == false) {
          vStatus = V.Constant.EVideo.Status.Playing
        }else {
          vStatus = V.Constant.EVideo.Status.Paused
        }
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var ytplayer = V.Video.Youtube.getYouTubePlayer($(video).attr("id"));
        var ytStatus = ytplayer.getPlayerState();
        vStatus = _getVEStatusFromYouTubeStatus(ytStatus);
        break;
      default:
        break
    }
    return vStatus
  };
  var _getVEStatusFromYouTubeStatus = function(ytStatus) {
    switch(ytStatus) {
      case -1:
        return V.Constant.EVideo.Status.Paused;
      case 0:
        return V.Constant.EVideo.Status.Ended;
      case 1:
        return V.Constant.EVideo.Status.Playing;
      case 2:
        return V.Constant.EVideo.Status.Paused;
      case 3:
        return V.Constant.EVideo.Status.Paused;
      case 4:
        return V.Constant.EVideo.Status.Paused;
      case 5:
        return V.Constant.EVideo.Status.Paused;
      default:
        return V.Constant.EVideo.Status.Paused
    }
  };
  var getDuration = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        return $(video)[0].duration;
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return V.Video.Youtube.getYouTubePlayer($(video).attr("id")).getDuration();
        break;
      default:
        break
    }
  };
  var getCurrentTime = function(video) {
    switch(getTypeVideo(video)) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        return video.currentTime;
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return V.Video.Youtube.getYouTubePlayer($(video).attr("id")).getCurrentTime();
        break;
      default:
        break
    }
  };
  return{init:init, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, getTypeVideoWithId:getTypeVideoWithId, getTypeVideo:getTypeVideo, play:play, pause:pause, seekTo:seekTo, setVolume:setVolume, onVideoReady:onVideoReady, onTimeUpdate:onTimeUpdate, onStatusChange:onStatusChange, getDuration:getDuration, getCurrentTime:getCurrentTime, getStatus:getStatus}
}(VISH, jQuery);
VISH.Audio = function(V, $, undefined) {
  var init = function() {
    V.Audio.HTML5.init()
  };
  return{init:init}
}(VISH, jQuery);
VISH.Messenger = function(V, undefined) {
  var init = function() {
    V.EventsNotifier.registerCallback(V.Constant.Event.onGoToSlide, function(params) {
      notifyEventByMessage(V.Constant.Event.onGoToSlide, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPlayVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onPlayVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPauseVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onPauseVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSeekVideo, function(params) {
      notifyEventByMessage(V.Constant.Event.onSeekVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideOpen, function(params) {
      notifyEventByMessage(V.Constant.Event.onSubslideOpen, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideClosed, function(params) {
      notifyEventByMessage(V.Constant.Event.onSubslideClosed, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onVEFocusChange, function(params) {
      notifyEventByMessage(V.Constant.Event.onVEFocusChange, params)
    })
  };
  var notifyEventByMessage = function(event, params) {
    if(params.triggeredByUser === false) {
      return
    }
    var VEMessage = V.Messenger.VE.createVEMessage(event, params);
    V.EventsNotifier.notifyEvent(V.Constant.Event.onSendIframeMessage, VEMessage, true)
  };
  return{init:init, notifyEventByMessage:notifyEventByMessage}
}(VISH);
VISH.Editor.Quiz = function(V, $, undefined) {
  var _hiddenLinkToInitQuizSettings;
  var init = function() {
    V.Editor.Quiz.MC.init();
    V.Editor.Quiz.TF.init();
    V.Editor.Quiz.Sorting.init();
    V.Editor.Quiz.Open.init();
    _hiddenLinkToInitQuizSettings = $('<a href="#quizSettings_fancybox" style="display:none"></a>');
    $(_hiddenLinkToInitQuizSettings).fancybox({"autoDimensions":false, "height":420, "width":400, "scrolling":"no", "showCloseButton":false, "padding":0, "onStart":function(data) {
      var qSF = $("#quizSettings_fancybox");
      var quiz = V.Editor.getCurrentArea();
      var quizType = $(quiz).attr("quiztype");
      var quizModule = _getQuizModule(quizType);
      $(qSF).find("input[type='hidden'][name='elId']").val($(quiz).attr("id"));
      var qSettings = $(quiz).attr("elSettings");
      var nAttempts = 1;
      var quizScore = 10;
      var shuffleChoices = false;
      var disableShuffleChoices = false;
      var ARSEnabled = false;
      if(typeof qSettings == "string") {
        try {
          qSettings = JSON.parse(qSettings);
          if(typeof qSettings.nAttempts != "undefined") {
            nAttempts = qSettings.nAttempts
          }
          if(typeof qSettings.quizScore != "undefined") {
            quizScore = qSettings.quizScore
          }
          if(qSettings.ARSEnabled === true) {
            ARSEnabled = true
          }
          if(qSettings.shuffleChoices === true) {
            shuffleChoices = true
          }
        }catch(e) {
        }
      }
      switch(quizType) {
        case V.Constant.QZ_TYPE.OPEN:
          shuffleChoices = false;
          disableShuffleChoices = true;
          break;
        case V.Constant.QZ_TYPE.MCHOICE:
          break;
        case V.Constant.QZ_TYPE.TF:
          break;
        case V.Constant.QZ_TYPE.SORTING:
          shuffleChoices = true;
          disableShuffleChoices = true;
          break;
        default:
          break
      }
      var isSelfAssessment = false;
      if(quizModule && typeof quizModule.isSelfAssessment == "function") {
        isSelfAssessment = quizModule.isSelfAssessment(quiz)
      }
      var nAttemptsDOM = $(qSF).find("#quizSettings_nAttempts");
      if(!isSelfAssessment) {
        $(nAttemptsDOM).prop("disabled", true);
        $(nAttemptsDOM).parent().addClass("disableSettingsField");
        $(nAttemptsDOM).val(1)
      }else {
        $(nAttemptsDOM).prop("disabled", false);
        $(nAttemptsDOM).parent().removeClass("disableSettingsField");
        $(nAttemptsDOM).val(nAttempts)
      }
      var quizScoreDOM = $(qSF).find("select[name='quizScorePoints']");
      if(!isSelfAssessment) {
        $(quizScoreDOM).prop("disabled", true);
        $(quizScoreDOM).parent().addClass("disableSettingsField");
        $(quizScoreDOM).val(0)
      }else {
        $(quizScoreDOM).prop("disabled", false);
        $(quizScoreDOM).parent().removeClass("disableSettingsField");
        $(quizScoreDOM).val(quizScore)
      }
      var shuffleChoicesCheckbox = $(qSF).find("input[type='checkbox'][name='shuffleChoices']");
      $(shuffleChoicesCheckbox).prop("checked", shuffleChoices);
      if(disableShuffleChoices) {
        $(shuffleChoicesCheckbox).parent().addClass("disableSettingsField");
        $(shuffleChoicesCheckbox).attr("disabled", "disabled")
      }else {
        $(shuffleChoicesCheckbox).parent().removeClass("disableSettingsField");
        $(shuffleChoicesCheckbox).removeAttr("disabled")
      }
      var ARSEnabledCheckbox = $(qSF).find("input[type='checkbox'][name='enableARS']");
      $(ARSEnabledCheckbox).prop("checked", ARSEnabled)
    }, "onComplete":function(data) {
    }, "onClosed":function(data) {
    }})
  };
  var onQuizSettingsDone = function() {
    var qSF = $("#quizSettings_fancybox");
    var qSettings = {};
    var nAttemptsDOM = $(qSF).find("#quizSettings_nAttempts");
    if(!$(nAttemptsDOM).is(":disabled")) {
      qSettings.nAttempts = $(nAttemptsDOM).val()
    }
    var quizScoreDOM = $(qSF).find("select[name='quizScorePoints']");
    if(!$(quizScoreDOM).is(":disabled")) {
      qSettings.quizScore = $(quizScoreDOM).val()
    }
    qSettings.shuffleChoices = $(qSF).find("input[type='checkbox'][name='shuffleChoices']").is(":checked");
    qSettings.ARSEnabled = $(qSF).find("input[type='checkbox'][name='enableARS']").is(":checked");
    var quizId = $(qSF).find("input[type='hidden'][name='elId']").val();
    var quiz = $("#" + quizId);
    var qSSerialized = JSON.stringify(qSettings);
    $(quiz).attr("elSettings", qSSerialized);
    $.fancybox.close()
  };
  var _getQuizModule = function(quiz_type) {
    switch(quiz_type) {
      case V.Constant.QZ_TYPE.OPEN:
        return V.Editor.Quiz.Open;
        break;
      case V.Constant.QZ_TYPE.MCHOICE:
        return V.Editor.Quiz.MC;
        break;
      case V.Constant.QZ_TYPE.TF:
        return V.Editor.Quiz.TF;
        break;
      case V.Constant.QZ_TYPE.SORTING:
        return V.Editor.Quiz.Sorting;
        break;
      default:
        return null;
        break
    }
  };
  var add = function(quizType, area) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    if(_getQuizModule(quizType)) {
      _getQuizModule(quizType).add(current_area)
    }
    $.fancybox.close()
  };
  var save = function(area) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    var quizType = $(area).attr("quiztype");
    if(_getQuizModule(quizType)) {
      return _getQuizModule(quizType).save(current_area)
    }
  };
  var draw = function(area, quiz) {
    if(_getQuizModule(quiz.quiztype)) {
      _getQuizModule(quiz.quiztype).draw(area, quiz)
    }
  };
  var showQuizSettings = function() {
    $(_hiddenLinkToInitQuizSettings).trigger("click")
  };
  var _exportTo = function(format, successCallback, failCallback) {
    var cJSONQuiz = _getCurrentJSONQuiz();
    if(typeof cJSONQuiz == "undefined") {
      if(typeof failCallback == "function") {
        failCallback()
      }
      return
    }
    V.Editor.API.uploadTmpJSON(cJSONQuiz, format, successCallback, failCallback)
  };
  var onExportTo = function(format) {
    $.fancybox.close();
    _exportTo(format, function() {
    }, function() {
      setTimeout(function() {
        var options = {};
        options.width = 600;
        options.height = 185;
        if(format == "QTI") {
          options.text = V.I18n.getTrans("i.exportQuizToQTIerrorNotification")
        }else {
          if(format == "MoodleXML") {
            options.text = V.I18n.getTrans("i.exportQuizToMoodleXMLerrorNotification")
          }
        }
        var button1 = {};
        button1.text = V.I18n.getTrans("i.Ok");
        button1.callback = function() {
          $.fancybox.close()
        };
        options.buttons = [button1];
        V.Utils.showDialog(options)
      }, 600)
    })
  };
  var _getCurrentJSONQuiz = function() {
    var quizJSON = undefined;
    var presentation = V.Editor.savePresentation();
    var cslide = V.Slides.getCurrentSlide();
    if(typeof cslide == "object") {
      var cslideId = $(cslide).attr("id");
      $.each(presentation.slides, function(index, value) {
        if(value.id == cslideId && value.containsQuiz == true) {
          $.each(value.elements, function(index, elVal) {
            if(elVal.type == "quiz") {
              quizJSON = elVal
            }
          })
        }
      })
    }
    return quizJSON
  };
  var afterCopyQuiz = function(quizDOM) {
    var quizType = $(quizDOM).attr("quiztype");
    var quizModule = _getQuizModule(quizType);
    if(quizModule && typeof quizModule.afterCopyQuiz == "function") {
      return quizModule.afterCopyQuiz(quizDOM)
    }
  };
  return{init:init, add:add, save:save, draw:draw, onExportTo:onExportTo, showQuizSettings:showQuizSettings, onQuizSettingsDone:onQuizSettingsDone, afterCopyQuiz:afterCopyQuiz}
}(VISH, jQuery);
VISH.TrackingSystem = function(V, $, undefined) {
  var _enabled = false;
  var _timeReference;
  var _currentTimeReference;
  var _lo;
  var _user;
  var _device;
  var _environment;
  var _user_agent;
  var _referrer;
  var _chronology;
  var _rs;
  var _rTrse;
  var _app_id;
  var _apiKey;
  var _apiUrl;
  var _validGenericTrackedActions = ["click", "keydown"];
  var init = function(animation, callback) {
    _timeReference = (new Date).getTime();
    _currentTimeReference = _timeReference;
    _apiKey = V.Configuration.getConfiguration().TrackingSystemAPIKEY;
    _apiUrl = V.Configuration.getConfiguration().TrackingSystemAPIURL;
    _rTrse = V.Utils.getOptions().TrackingSystemRelatedEntryId;
    if(typeof _apiKey == "undefined" || (typeof _apiUrl == "undefined" || V.Status.isPreview())) {
      _enabled = false;
      return
    }else {
      _enabled = true
    }
    _apiUrl = V.Utils.checkUrlProtocol(_apiUrl);
    if(!V.Editing) {
      _app_id = "ViSH Viewer"
    }else {
      _app_id = "ViSH Editor"
    }
    _lo = new LO;
    if(V.User.isLogged()) {
      _user = new User
    }
    _device = V.Status.getDevice();
    _user_agent = _device.userAgent;
    _rs = new RS;
    _environment = {};
    var sessionOptions = V.Viewer.getOptions();
    if(typeof sessionOptions == "object") {
      _environment.name = V.Status.getEnvironmentName();
      _environment.lang = sessionOptions.lang;
      _environment.scorm = V.Status.isScorm();
      _environment.isExternalDomain = V.Status.isExternalDomain();
      _environment.isEmbed = V.Status.isEmbed();
      _environment.developping = sessionOptions.developping;
      _referrer = sessionOptions.referrer
    }
    _chronology = [];
    _chronology.push(new ChronologyEntry(V.Slides.getCurrentSlideNumber()));
    V.EventsNotifier.registerCallback(V.Constant.Event.onGoToSlide, function(params) {
      _cTime = (new Date).getTime();
      if(typeof _chronology[_chronology.length - 1] != "undefined") {
        _chronology[_chronology.length - 1].duration = _getTimeDiff(_cTime, _currentTimeReference)
      }
      _currentTimeReference = _cTime;
      setTimeout(function() {
        _chronology.push(new ChronologyEntry(V.Slides.getCurrentSlideNumber()))
      }, 10)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideOpen, function(params) {
      registerAction(V.Constant.Event.onSubslideOpen, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideClosed, function(params) {
      registerAction(V.Constant.Event.onSubslideClosed, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPlayVideo, function(params) {
      registerAction(V.Constant.Event.onPlayVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPauseVideo, function(params) {
      registerAction(V.Constant.Event.onPauseVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSeekVideo, function(params) {
      registerAction(V.Constant.Event.onSeekVideo, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPlayAudio, function(params) {
      registerAction(V.Constant.Event.onPlayAudio, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onPauseAudio, function(params) {
      registerAction(V.Constant.Event.onPauseAudio, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onSeekAudio, function(params) {
      registerAction(V.Constant.Event.onSeekAudio, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onAnswerQuiz, function(params) {
      registerAction(V.Constant.Event.onAnswerQuiz, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onShowRecommendations, function(params) {
      _rs.shown = true;
      _rs.tdata = V.Recommendations.getData();
      registerAction(V.Constant.Event.onShowRecommendations, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onHideRecommendations, function(params) {
      if(typeof _rs.accepted == "undefined") {
        _rs.accepted = false
      }
      registerAction(V.Constant.Event.onHideRecommendations, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onAcceptRecommendation, function(params) {
      if(typeof _rs.accepted == "undefined" || _rs.accepted === false) {
        _rs.accepted = params.id
      }
      registerAction(V.Constant.Event.onAcceptRecommendation, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onEvaluate, function(params) {
      registerAction(V.Constant.Event.onEvaluate, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onEvaluateCompletion, function(params) {
      registerAction(V.Constant.Event.onEvaluateCompletion, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.exit, function() {
      _cTime = (new Date).getTime();
      if(typeof _chronology[_chronology.length - 1] != "undefined") {
        _chronology[_chronology.length - 1].duration = _getTimeDiff(_cTime, _currentTimeReference)
      }
      registerAction(V.Constant.Event.exit);
      sendTrackingObject()
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onViewportResize, function(params) {
      registerAction(V.Constant.Event.onViewportResize, params)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onTrackedAction, function(data) {
      if(_validGenericTrackedActions.indexOf(data.action) !== -1) {
        registerAction(data.action, data.params)
      }
    });
    $(document).bind("click", function(event) {
      var params = {};
      params["x"] = event.clientX;
      params["y"] = event.clientY;
      if(event.target) {
        if(event.target.tagName) {
          params["tagName"] = event.target.tagName
        }
        if(event.target.id) {
          params["id"] = event.target.id
        }
      }
      registerAction("click", params)
    })
  };
  var registerAction = function(id, params) {
    if(_enabled && typeof _chronology[_chronology.length - 1] != "undefined") {
      _chronology[_chronology.length - 1].actions.push(new Action(id, params))
    }
  };
  var sendTrackingObject = function() {
    if(!_enabled) {
      return
    }
    var data = _composeTrackingObject();
    if(V.User.isLogged() && typeof V.User.getToken() != "undefined") {
      data["authenticity_token"] = V.User.getToken()
    }
    if(typeof _user != "undefined" && typeof _user.id != "undefined") {
      data["actor_id"] = _user.id
    }
    if(typeof _referrer != "undefined") {
      data["referrer"] = _referrer
    }
    if(typeof _rTrse != "undefined") {
      data["tracking_system_entry_id"] = _rTrse
    }
    $.ajax({type:"POST", url:_apiUrl, data:data, async:false})
  };
  var _composeTrackingObject = function() {
    return{"app_id":_app_id, "app_key":_apiKey, "user_agent":_user_agent, "data":_composeData()}
  };
  var _composeData = function() {
    var data = {};
    data["lo"] = _lo;
    if(typeof _user != "undefined") {
      data["user"] = _user
    }
    data["device"] = _device;
    data["environment"] = _environment;
    data["chronology"] = _chronology;
    data["rs"] = _rs;
    data["duration"] = getAbsoluteTime();
    return data
  };
  var getAbsoluteTime = function() {
    return _getTimeDiff((new Date).getTime(), _timeReference)
  };
  var getRelativeTime = function() {
    return _getTimeDiff((new Date).getTime(), _currentTimeReference)
  };
  var _getTimeDiff = function(t1, t2) {
    return+((t1 - t2) / 1E3).toFixed(2)
  };
  var getChronology = function() {
    return _chronology
  };
  var LO = function() {
    var current_presentation = V.Viewer.getCurrentPresentation();
    if(typeof current_presentation == "object") {
      this.content = current_presentation;
      if(typeof current_presentation.vishMetadata == "object") {
        this.id = current_presentation.vishMetadata.id
      }
    }
  };
  var User = function() {
    var current_user = V.User.getUser();
    if(typeof current_user == "object") {
      this.id = current_user.id
    }
  };
  var ChronologyEntry = function(slideNumber) {
    this.slideNumber = slideNumber;
    this.actions = [];
    this.t = getAbsoluteTime()
  };
  var Action = function(id, params) {
    this.id = id;
    this.t = getAbsoluteTime();
    if(typeof params != "undefined") {
      this.params = params
    }
  };
  var RS = function() {
    this.shown = false;
    this.accepted = undefined;
    this.tdata = {}
  };
  return{init:init, registerAction:registerAction, getAbsoluteTime:getAbsoluteTime, getRelativeTime:getRelativeTime, getChronology:getChronology, _composeTrackingObject:_composeTrackingObject, sendTrackingObject:sendTrackingObject}
}(VISH, jQuery);
VISH.ProgressTracking = function(V, $, undefined) {
  var SCORE_THRESHOLD = 0.5;
  var _initialized = false;
  var objectives = {};
  var minRequiredTime = 10;
  var hasScore = false;
  var init = function() {
    if(_initialized) {
      return
    }
    _initialized = true;
    _createObjectives();
    minRequiredTime = _getMinRequiredTime();
    setTimeout(function() {
      objectives["lo_spent_time"].completed = true;
      objectives["lo_spent_time"].progress = 1;
      V.EventsNotifier.notifyEvent(V.Constant.Event.onProgressObjectiveUpdated, objectives["lo_spent_time"], false)
    }, minRequiredTime * 1E3);
    V.EventsNotifier.registerCallback(V.Constant.Event.onAnswerQuiz, function(params) {
      if(typeof params != "object") {
        return
      }
      if(typeof params.score == "number") {
        params.score = params.score / 100
      }
      _onNewObjectiveScore(params.quizId, params.score)
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.onNewObjectiveScore, function(params) {
      if(typeof params != "object") {
        return
      }
      _onNewObjectiveScore(params.objectiveId, params.score)
    })
  };
  var _onNewObjectiveScore = function(objectiveId, scaledScore) {
    if(typeof objectiveId == "undefined" || objectives[objectiveId] == "undefined") {
      return
    }
    objectives[objectiveId].progress = 1;
    objectives[objectiveId].completed = true;
    if(typeof scaledScore == "number") {
      objectives[objectiveId].score = scaledScore;
      if(objectives[objectiveId].score >= SCORE_THRESHOLD) {
        objectives[objectiveId].success = true
      }else {
        objectives[objectiveId].success = false
      }
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onProgressObjectiveUpdated, objectives[objectiveId], false)
  };
  var _getMinRequiredTime = function() {
    var _minRequiredTime = minRequiredTime;
    var currentPresentation = V.Viewer.getCurrentPresentation();
    if(typeof currentPresentation.TLT != "undefined") {
      var TLT = V.Utils.iso8601Parser.getDurationFromISO(currentPresentation.TLT);
      if(typeof TLT == "number" && TLT > 0) {
        _minRequiredTime = 0.5 * TLT
      }
    }
    return _minRequiredTime
  };
  var getProgressMeasure = function() {
    if(objectives["lo_spent_time"].progress < 1) {
      objectives["lo_spent_time"].progress = Math.min(1, V.TrackingSystem.getAbsoluteTime() / minRequiredTime)
    }
    var overallProgressMeasure = 0;
    Object.keys(objectives).forEach(function(key) {
      overallProgressMeasure += objectives[key].progress * objectives[key].completion_weight
    });
    return+overallProgressMeasure.toFixed(6)
  };
  var getScore = function() {
    var overallScore = 0;
    Object.keys(objectives).forEach(function(key) {
      if(typeof objectives[key].score == "number") {
        overallScore += objectives[key].score * objectives[key].score_weight
      }
    });
    return+overallScore.toFixed(6)
  };
  var getHasScore = function() {
    return hasScore
  };
  var getObjectives = function() {
    return objectives
  };
  var _createObjectives = function() {
    var presentation = V.Viewer.getCurrentPresentation();
    var slidesL = presentation.slides.length;
    for(var i = 0;i < slidesL;i++) {
      var slide = presentation.slides[i];
      if(!V.Slideset.isSlideset(slide)) {
        _createObjectiveForStandardSlide(slide)
      }
      if(typeof slide.slides == "object") {
        var subslidesL = slide.slides.length;
        for(var k = 0;k < subslidesL;k++) {
          var subslide = slide.slides[k];
          _createObjectiveForStandardSlide(subslide)
        }
      }
    }
    var timeObjective = new Objective("lo_spent_time");
    if(hasScore) {
      timeObjective.completion_weight = 0.5
    }else {
      timeObjective.completion_weight = 1
    }
    objectives[timeObjective.id] = timeObjective;
    var objectivesKeys = Object.keys(objectives);
    var nObjectives = objectivesKeys.length;
    if(nObjectives > 1) {
      var defaultCompletionWeight = (1 - timeObjective.completion_weight) / (nObjectives - 1);
      var scoreWeightSum = 0;
      objectivesKeys.forEach(function(key) {
        if(typeof objectives[key].completion_weight == "undefined") {
          objectives[key].completion_weight = defaultCompletionWeight
        }
        if(typeof objectives[key].score_weight == "number") {
          scoreWeightSum += objectives[key].score_weight
        }
      });
      if(scoreWeightSum > 0) {
        objectivesKeys.forEach(function(key) {
          if(typeof objectives[key].score_weight == "number") {
            objectives[key].score_weight = objectives[key].score_weight / scoreWeightSum
          }
        })
      }
    }
  };
  var _createObjectiveForStandardSlide = function(slideJSON) {
    var slideElementsL = slideJSON.elements.length;
    for(var j = 0;j < slideElementsL;j++) {
      var element = slideJSON.elements[j];
      switch(element.type) {
        case V.Constant.QUIZ:
          _createObjectiveForQuiz(element);
          break;
        case V.Constant.OBJECT:
          if(typeof element.settings == "object" && element.settings.wappAPI === true) {
            _createObjectiveForWAPP(element)
          }
          break;
        default:
          return
      }
    }
  };
  var _createObjectiveForQuiz = function(quizJSON) {
    if(quizJSON.selfA === true) {
      hasScore = true;
      var scoreWeight = 10;
      if(typeof quizJSON.settings == "object" && typeof quizJSON.settings.quizScore != "undefined") {
        scoreWeight = parseInt(quizJSON.settings.quizScore)
      }
      var quizObjective = new Objective(quizJSON.quizId, undefined, scoreWeight);
      objectives[quizObjective.id] = quizObjective
    }
  };
  var _createObjectiveForWAPP = function(wappJSON) {
    if(typeof wappJSON.settings != "object" || wappJSON.settings.wappAPI !== true) {
      return
    }
    if(wappJSON.settings.wappScore === true) {
      hasScore = true;
      var scoreWeight = 10;
      if(typeof wappJSON.settings.wappScorePoints != "undefined") {
        scoreWeight = parseInt(wappJSON.settings.wappScorePoints)
      }
      var wappId = $(wappJSON.body).attr("wappid");
      if(typeof wappId != "string") {
        return
      }
      var wappObjective = new Objective(wappId, undefined, scoreWeight);
      objectives[wappObjective.id] = wappObjective
    }
  };
  var Objective = function(id, completion_weight, score_weight, description) {
    this.id = id;
    this.seq_id = _getObjectiveId();
    this.completed = false;
    this.progress = 0;
    this.score = undefined;
    this.success = undefined;
    if(typeof completion_weight == "number") {
      this.completion_weight = completion_weight
    }
    if(typeof score_weight == "number") {
      this.score_weight = score_weight
    }
    if(typeof description == "string") {
      this.description = description
    }
  };
  var lastObjectiveId = -1;
  var _getObjectiveId = function() {
    lastObjectiveId += 1;
    return lastObjectiveId
  };
  return{init:init, getProgressMeasure:getProgressMeasure, getScore:getScore, getHasScore:getHasScore, getObjectives:getObjectives}
}(VISH, jQuery);
VISH.SCORM = function(V, $, undefined) {
  var _API;
  var init = function() {
  };
  var initAfterRender = function() {
    if(V.Utils.getOptions().scorm == true) {
      V.SCORM.API.init()
    }
  };
  var renderSCORMFromJSON = function(scormJSON, options) {
    var style = scormJSON["style"] ? scormJSON["style"] : "";
    var body = scormJSON["body"];
    var scormBody = $(body);
    $(scormBody).attr("objecttype", V.Constant.MEDIA.SCORM_PACKAGE);
    $(scormBody).attr("src", V.Utils.checkUrlProtocol($(scormBody).attr("src")));
    scormBody = V.Utils.getOuterHTML(scormBody);
    var zoomInStyle = scormJSON["zoomInStyle"] ? scormJSON["zoomInStyle"] : "";
    var classes = "objectelement";
    if(options) {
      if(options.extraClasses) {
        classes = classes + " " + options.extraClasses
      }
    }
    return"<div id='" + scormJSON["id"] + "' class='" + classes + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper='" + scormBody + "'>" + "" + "</div>"
  };
  return{init:init, initAfterRender:initAfterRender, renderSCORMFromJSON:renderSCORMFromJSON}
}(VISH, jQuery);
/*
 Copyright (c) 2009-2014, Cybercussion Interactive LLC
 As of 3.0.0 this code is under a Creative Commons Attribution-ShareAlike 4.0 International License.
 @requires JQuery
 @version 3.1.0
 @param options {Object} override default values
 @constructor
*/
VISH.SCORM.API = function(V, $, undefined) {
  var scorm;
  var _connected;
  var COMPLETION_THRESHOLD = 0;
  var COMPLETION_ATTEMPT_THRESHOLD = 0;
  var SCORE_THRESHOLD = 0.5;
  var hasScore = false;
  var init = function() {
    scorm = new SCORM_API({debug:V.Utils.getOptions().developping === true, windowDebug:false, exit_type:""});
    _connected = scorm.initialize();
    scorm.debug("Connected: " + _connected, 4);
    if(!isConnected()) {
      return
    }
    V.ProgressTracking.init();
    var learnerName = scorm.getvalue("cmi.learner_name");
    var learnerId = scorm.getvalue("cmi.learner_id");
    var myUser = V.User.getUser();
    if(typeof myUser == "object") {
      if(_isValidAPIResponse(learnerName)) {
        myUser.name = learnerName
      }
      if(_isValidAPIResponse(learnerId)) {
        myUser.id = learnerId
      }
      V.User.setUser(myUser)
    }
    _updateProgressMeasure(0);
    hasScore = V.ProgressTracking.getHasScore();
    if(hasScore) {
      scorm.setvalue("cmi.score.min", (0).toString());
      scorm.setvalue("cmi.score.max", (100).toString());
      _updateScore(0)
    }
    V.EventsNotifier.registerCallback(V.Constant.Event.onProgressObjectiveUpdated, function(objective) {
      var updateProgress = typeof objective.progress != "undefined";
      var updateScore = typeof objective.score != "undefined";
      if(updateProgress) {
        _updateProgressMeasure(V.ProgressTracking.getProgressMeasure())
      }
      if(updateScore) {
        _updateScore(V.ProgressTracking.getScore())
      }
      if(updateProgress || updateScore) {
        scorm.commit()
      }
    });
    V.EventsNotifier.registerCallback(V.Constant.Event.exit, function() {
      _updateProgressMeasure(V.ProgressTracking.getProgressMeasure());
      scorm.terminate()
    })
  };
  var _updateProgressMeasure = function(progressMeasure) {
    if(typeof progressMeasure == "number") {
      scorm.setvalue("cmi.progress_measure", progressMeasure.toString());
      _updateCompletionStatus(progressMeasure)
    }
  };
  var _updateCompletionStatus = function(progressMeasure) {
    if(typeof progressMeasure != "number") {
      progressMeasure = 0
    }
    var completionStatus;
    if(progressMeasure >= COMPLETION_THRESHOLD) {
      completionStatus = "completed"
    }else {
      if(progressMeasure >= COMPLETION_ATTEMPT_THRESHOLD) {
        completionStatus = "incomplete"
      }else {
        completionStatus = "not attempted"
      }
    }
    scorm.setvalue("cmi.completion_status", completionStatus)
  };
  var _updateScore = function(score) {
    if(typeof score == "number") {
      score = Math.max(0, Math.min(1, score));
      scorm.setvalue("cmi.score.scaled", score.toString());
      scorm.setvalue("cmi.score.raw", (score * 100).toString());
      _updateSuccessStatus(score)
    }
  };
  var _updateSuccessStatus = function(score) {
    var successStatus;
    if(typeof score != "number") {
      successStatus = "unknown"
    }else {
      if(score >= SCORE_THRESHOLD) {
        successStatus = "passed"
      }else {
        successStatus = "failed"
      }
    }
    scorm.setvalue("cmi.success_status", successStatus)
  };
  var _isValidAPIResponse = function(string) {
    if(typeof string == "string" && (string.trim() != "" && string != "false")) {
      return true
    }else {
      return false
    }
  };
  var getAPIInstance = function() {
    if(isConnected()) {
      return scorm
    }else {
      return undefined
    }
  };
  var getLMSAPIInstance = function() {
    if(isConnected() && (scorm && (scorm.API && scorm.API.path))) {
      return scorm.API.path
    }else {
      return undefined
    }
  };
  var isConnected = function() {
    if(!_connected || _connected === "false") {
      return false
    }
    return true
  };
  function SCORM_API(options) {
    var defaults = {version:"3.1.1", createDate:"04/05/2011 08:56AM", modifiedDate:"07/16/2014 09:40AM", debug:false, windowDebug:false, isActive:false, throw_alerts:false, prefix:"SCORM_API", exit_type:"suspend", success_status:"unknown", use_standalone:true, standalone:false, completion_status:"unknown", time_type:"GMT", cmi:null}, settings = $.extend(defaults, options), isError = 0, error = {0:"No Error", 404:"Not Found", 405:"Prevented on a read only resource"}, API = {connection:false, version:"none", 
    mode:"", path:false, data:{completion_status:settings.completion_status, success_status:settings.success_status, exit_type:settings.exit_type}, isActive:settings.isActive}, self = this;
    settings.error = error;
    settings.startDate = {};
    function debug(msg, lvl) {
      if(settings) {
        msg = settings.prefix + ": " + msg;
        if(settings.debug) {
          if(settings.windowDebug == true) {
            windowDebug(msg, lvl)
          }else {
            _debug(msg, lvl)
          }
        }
        if(lvl < 3 && settings.throw_alerts) {
          alert(msg)
        }
      }
      return false
    }
    function _debug(msg, lvl) {
      if(!window.console) {
        window.console = {};
        window.console.info = noconsole;
        window.console.log = noconsole;
        window.console.warn = noconsole;
        window.console.error = noconsole;
        window.console.trace = noconsole
      }
      switch(lvl) {
        case 1:
          console.error(msg);
          break;
        case 2:
          console.warn(msg);
          break;
        case 4:
          console.info(msg);
          break;
        case 3:
          console.log(msg);
          break;
        default:
          console.log(msg);
          return false
      }
      return true
    }
    function noconsole(msg, lvl) {
      $(self).triggerHandler({"type":"debug", "msg":msg, "lvl":lvl})
    }
    var aryDebug = new Array;
    var strDebug = "";
    var winDebug;
    function windowDebug(strInfo, lvl) {
      var isDebugWindowShown = false;
      if(!winDebug || winDebug.closed) {
        isDebugWindowShown = ShowDebugWindow()
      }else {
        isDebugWindowShown = true
      }
      if(isDebugWindowShown == false) {
        settings.windowDebug = false;
        debug("Window debug has been blocked", 1);
        debug("Debugging messages will be displayed in the console", 2);
        debug(strInfo, lvl);
        return false
      }
      var strLine;
      strLine = aryDebug.length + 1 + ": " + strInfo;
      aryDebug[aryDebug.length] = strLine;
      if(winDebug && !winDebug.closed) {
        winDebug.document.write(strLine + "<br>\n")
      }
      return true
    }
    function ShowDebugWindow() {
      if(winDebug && !winDebug.closed) {
        winDebug.close()
      }
      winDebug = window.open("", "Debug", "width=600,height=300,resizable,scrollbars");
      if(typeof winDebug == "undefined") {
        return false
      }
      winDebug.document.write(aryDebug.join("<br>\n"));
      winDebug.document.close();
      winDebug.focus();
      return true
    }
    function findAPI(win) {
      var attempts = 0, limit = 500;
      while(!win.API && !win.API_1484_11 && (win.parent && (win.parent !== win && attempts <= limit))) {
        attempts += 1;
        win = win.parent
      }
      if(win.API_1484_11) {
        API.version = "2004";
        API.path = win.API_1484_11
      }else {
        if(win.API) {
          API.version = "1.2";
          API.path = win.API
        }else {
          return false
        }
      }
      return true
    }
    function centisecsToISODuration(n, bPrecise) {
      var str = "P", nCs = Math.max(n, 0), nY = 0, nM = 0, nD = 0, nH, nMin;
      nCs = Math.round(nCs);
      if(bPrecise === true) {
        nD = Math.floor(nCs / 864E4)
      }else {
        nY = Math.floor(nCs / 315576E4);
        nCs -= nY * 315576E4;
        nM = Math.floor(nCs / 26298E4);
        nCs -= nM * 26298E4;
        nD = Math.floor(nCs / 864E4)
      }
      nCs -= nD * 864E4;
      nH = Math.floor(nCs / 36E4);
      nCs -= nH * 36E4;
      nMin = Math.floor(nCs / 6E3);
      nCs -= nMin * 6E3;
      if(nY > 0) {
        str += nY + "Y"
      }
      if(nM > 0) {
        str += nM + "M"
      }
      if(nD > 0) {
        str += nD + "D"
      }
      if(nH > 0 || (nMin > 0 || nCs > 0)) {
        str += "T";
        if(nH > 0) {
          str += nH + "H"
        }
        if(nMin > 0) {
          str += nMin + "M"
        }
        if(nCs > 0) {
          str += nCs / 100 + "S"
        }
      }
      if(str === "P") {
        str = "PT0H0M0S"
      }
      return str
    }
    function ISODurationToCentisec(str) {
      var aV = [0, 0, 0, 0, 0, 0], bErr = !!(str.indexOf("P") !== 0), bTFound = false, aT = ["Y", "M", "D", "H", "M", "S"], p = 0, i = 0, len;
      if(!bErr) {
        str = str.substr(1);
        len = aT.length;
        i = 0;
        while(i < len) {
          if(str.indexOf("T") === 0) {
            str = str.substr(1);
            i = Math.max(i, 3);
            bTFound = true
          }
          p = str.indexOf(aT[i]);
          if(p > -1) {
            if(i === 1 && (str.indexOf("T") > -1 && str.indexOf("T") < p)) {
              continue
            }
            if(aT[i] === "S") {
              aV[i] = parseFloat(str.substr(0, p))
            }else {
              aV[i] = parseInt(str.substr(0, p), 10)
            }
            if(isNaN(aV[i])) {
              bErr = true;
              break
            }
            if(i > 2 && !bTFound) {
              bErr = true;
              break
            }
            str = str.substr(p + 1)
          }
          i += 1
        }
        bErr = !!(!bErr && len !== 0)
      }
      if(bErr) {
        return 0
      }
      return aV[0] * 315576E4 + aV[1] * 26298E4 + aV[2] * 864E4 + aV[3] * 36E4 + aV[4] * 6E3 + Math.round(aV[5] * 100)
    }
    function padTime(n) {
      return n < 10 ? "0" + n : n
    }
    function isoDateToStringUTC(d) {
      return d.getUTCFullYear() + "-" + padTime(d.getUTCMonth() + 1) + "-" + padTime(d.getUTCDate()) + "T" + padTime(d.getUTCHours()) + ":" + padTime(d.getUTCMinutes()) + ":" + padTime(d.getUTCSeconds()) + "." + Math.round(d.getUTCMilliseconds() / 1E3 % 1E3) + "Z"
    }
    function isoDateToString(d) {
      var offset = d.getTimezoneOffset() > 0 ? "-" : "+";
      return d.getFullYear() + "-" + padTime(d.getMonth() + 1) + "-" + padTime(d.getDate()) + "T" + padTime(d.getHours()) + ":" + padTime(d.getMinutes()) + ":" + padTime(d.getSeconds()) + "." + Math.round(d.getMilliseconds() / 1E3 % 1E3) + offset + padTime(d.getTimezoneOffset() / 60) + ":00"
    }
    function isoStringToDate(str) {
      var MM = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], d, uoffset, offset = 0, mil = 0, dd;
      switch(settings.time_type) {
        case "UTC":
          d = str.replace(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))(|Z)/, function($0, $Year, $Month, $Day, $Hour, $Min, $Sec) {
            return MM[$Month - 1] + " " + $Day + ", " + $Year + " " + $Hour + ":" + $Min + ":" + $Sec
          });
          dd = new Date.UTC(d);
          return dd;
        case "GMT":
          d = str.replace(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))([\+|\-]\d+:\d+)/, function($0, $Year, $Month, $Day, $Hour, $Min, $Sec, $Ms, $Offset) {
            offset = parseInt($Offset.substring(1, $Offset.length), 10) * 60 * 60 * 60;
            mil = $Ms;
            return MM[$Month - 1] + " " + $Day + ", " + $Year + " " + $Hour + ":" + $Min + ":" + $Sec
          });
          dd = new Date(d);
          uoffset = dd.getTimezoneOffset() * 60 * 60;
          if(uoffset !== offset) {
            dd = new Date(dd.getTime() + offset + uoffset);
            dd.setMilliseconds(mil)
          }
          return dd;
        default:
          d = str.replace(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/, function($0, $Year, $Month, $Day, $Hour, $Min, $Sec) {
            return MM[$Month - 1] + " " + $Day + ", " + $Year + " " + $Hour + ":" + $Min + ":" + $Sec
          });
          dd = new Date(d);
          return dd
      }
    }
    function centisecsToSCORM12Duration(n) {
      var str, nH, nCs, nM, nS;
      n = Math.round(n);
      nH = Math.floor(n / 36E4);
      nCs = n - nH * 36E4;
      nM = Math.floor(nCs / 6E3);
      nCs = nCs - nM * 6E3;
      nS = Math.floor(nCs / 100);
      nCs = nCs - nS * 100;
      str = "0000" + nH + ":";
      str = str.substr(str.length - 5, 5);
      if(nM < 10) {
        str += "0"
      }
      str += nM + ":";
      if(nS < 10) {
        str += "0"
      }
      str += nS;
      if(nCs > 0) {
        str += ".";
        if(nCs < 10) {
          str += "0"
        }
        str += nCs
      }
      return str
    }
    function makeBoolean(str) {
      if(str === undefined) {
        debug("makeBoolean was given empty string, converting to false", 2);
        return false
      }
      if(str === true || str === false) {
        return Boolean(str)
      }
      switch(str.toLowerCase()) {
        case "true":
        ;
        case "yes":
        ;
        case "1":
          return true;
        case "false":
        ;
        case "no":
        ;
        case "0":
        ;
        case null:
          return false;
        default:
          return Boolean(str)
      }
    }
    function triggerWarning(n) {
      debug(error[n], 2);
      return true
    }
    function triggerException(msg) {
      $(self).triggerHandler({"type":"exception", "error":msg})
    }
    function getLastErrorCode() {
      var lms = API.path, code = 0;
      if(lms) {
        switch(API.version) {
          case "1.2":
            code = parseInt(lms.LMSGetLastError(), 10);
            break;
          case "2004":
            code = parseInt(lms.GetLastError(), 10);
            break;
          default:
            break
        }
      }
      return code
    }
    function getLastErrorMessage(n) {
      var lms = API.path, result = "No LMS Connectivity";
      if(lms) {
        switch(API.version) {
          case "1.2":
            result = lms.LMSGetErrorString(n.toString());
            break;
          case "2004":
            result = lms.GetErrorString(n.toString());
            break;
          default:
            break
        }
      }
      return String(result)
    }
    function getDiagnostic(n) {
      var lms = API.path, result = "No LMS Connectivity";
      if(lms) {
        switch(API.version) {
          case "1.2":
            result = lms.LMSGetDiagnostic(n.toString());
            break;
          case "2004":
            result = lms.GetDiagnostic(n.toString());
            break;
          default:
            break
        }
      }
      return String(result)
    }
    this.getvalue = function(n) {
      var v = null, lms = API.path, ec = 0, m = "", d = "", nn = null, ig = false;
      if(API.isActive) {
        switch(API.version) {
          case "1.2":
            switch(n) {
              case "cmi.comments_from_lms._count":
              ;
              case "cmi.comments_from_learner._count":
                ig = true;
                break;
              case "cmi.credit":
                nn = "cmi.core.credit";
                break;
              case "cmi.location":
                nn = "cmi.core.lesson_location";
                break;
              case "cmi.learner_name":
                nn = "cmi.core.student_name";
                break;
              case "cmi.learner_id":
                nn = "cmi.core.student_id";
                break;
              case "cmi.completion_threshold":
                ig = true;
                break;
              case "cmi.progress_measure":
                ig = true;
                break;
              case "cmi.entry":
                nn = "cmi.core.entry";
                break;
              case "cmi.mode":
                nn = "cmi.core.lesson_mode";
                break;
              case "cmi.exit":
                nn = "cmi.core.exit";
                break;
              case "cmi.score.raw":
                nn = "cmi.core.score.raw";
                break;
              case "cmi.score.min":
                nn = "cmi.core.score.min";
                break;
              case "cmi.score.max":
                nn = "cmi.core.score.max";
                break;
              case "cmi.scaled_passing_score":
                nn = "cmi.student_data.mastery_score";
                break;
              case "cmi.max_time_allowed":
                nn = "cmi.student_data.max_time_allowed";
                break;
              case "cmi.time_limit_action":
                nn = "cmi.student_data.time_limit_action";
                break;
              case "cmi.learner_preferences.audio_level":
                nn = "cmi.student_preferences.audio";
                break;
              case "cmi.learner_preferences.delivery_speed":
                nn = "cmi.student_preferences.speed";
                break;
              case "cmi.learner_preferences.language":
                nn = "cmi.student_preferences.language";
                break;
              case "cmi.learner_preferences.audio_captioning":
                nn = "cmi.student_preferences.text";
                break;
              case "cmi.success_status":
              ;
              case "cmi.completion_status":
                nn = "cmi.core.lesson_status";
                break;
              case "cmi.session_time":
                nn = "cmi.core.session_time";
                break;
              case "cmi.suspend_data":
                nn = n;
                break;
              default:
                nn = n;
                break
            }
            if(ig) {
              return"false"
            }
            v = lms.LMSGetValue(nn);
            break;
          case "2004":
            v = lms.GetValue(n);
            break;
          default:
            break
        }
        ec = getLastErrorCode();
        m = getLastErrorMessage(ec);
        d = getDiagnostic(ec);
        $(self).triggerHandler({"type":"getvalue", "n":n, "v":v, "error":{"code":ec, "message":m, "diagnostic":d}});
        if(ec === 0 || ec === 403) {
          if(v === "undefined" || (v === null || v === "null")) {
            v = ""
          }
          return String(v)
        }
        debug("Error\nError Code: " + ec + "\nError Message: " + m + "\nDiagnostic: " + d, 1);
        return"false"
      }
      debug(n + " Get Aborted, connection not initialized! " + API.isActive, 2);
      return"false"
    };
    this.setvalue = function(n, v) {
      var s = "false", lms = API.path, ec = 0, m = "", d = "", nn = null, ig = false;
      if(API.isActive) {
        switch(API.version) {
          case "1.2":
            API.mode = API.mode === "" ? lms.LMSGetValue("cmi.core.lesson_mode") : API.mode;
            if(API.mode === "normal") {
              switch(n) {
                case "cmi.location":
                  if(v.length > 255) {
                    debug("Warning, your bookmark is over the limit!!", 2)
                  }
                  nn = "cmi.core.lesson_location";
                  break;
                case "cmi.progress_measure":
                  ig = true;
                  break;
                case "cmi.mode":
                  nn = "cmi.core.lesson_mode";
                  break;
                case "cmi.exit":
                  nn = "cmi.core.exit";
                  API.exit_type = v;
                  break;
                case "cmi.score.raw":
                  nn = "cmi.core.score.raw";
                  break;
                case "cmi.score.min":
                  nn = "cmi.core.score.min";
                  break;
                case "cmi.score.max":
                  nn = "cmi.core.score.max";
                  break;
                case "cmi.score.scaled":
                  ig = true;
                  break;
                case "cmi.success_status":
                  if(API.data.completion_status == "completed" && v != "passed") {
                    return"false"
                  }
                ;
                case "cmi.completion_status":
                  if(API.data.completion_status == "passed") {
                    return"false"
                  }
                  nn = "cmi.core.lesson_status";
                  API.data.completion_status = v;
                  break;
                case "cmi.scaled_passing_score":
                  nn = "cmi.student_data.mastery_score";
                  break;
                case "cmi.learner_preferences.audio_level":
                  nn = "cmi.student_preferences.audio";
                  break;
                case "cmi.learner_preferences.delivery_speed":
                  nn = "cmi.student_preferences.speed";
                  break;
                case "cmi.learner_preferences.language":
                  nn = "cmi.student_preferences.language";
                  break;
                case "cmi.learner_preferences.audio_captioning":
                  nn = "cmi.student_preferences.text";
                  break;
                case "cmi.session_time":
                  nn = "cmi.core.session_time";
                  break;
                case "cmi.total_time":
                  nn = "cmi.core.total_time";
                  break;
                case "cmi.suspend_data":
                  if(v.length > 4096) {
                    debug("Warning, your suspend data is over the limit!!", 2)
                  }
                  nn = n;
                  break;
                default:
                  nn = n;
                  break
              }
              if(ig) {
                return"false"
              }
              debug("SCORM 1.2 LMS SetValue with n: " + nn + " and v: " + v, 3);
              s = lms.LMSSetValue(nn, v)
            }else {
              debug("Warning, you are not in normal mode.  Ignoring 'set' requests.", 2);
              return"false"
            }
            break;
          case "2004":
            API.mode = API.mode === "" ? lms.GetValue("cmi.mode") : API.mode;
            if(API.mode === "normal") {
              switch(n) {
                case "cmi.location":
                  if(v.length > 1E3) {
                    debug("Warning, your bookmark is over the limit!!", 2)
                  }
                  break;
                case "cmi.completion_status":
                  API.data.completion_status = v;
                  break;
                case "cmi.success_status":
                  API.data.success_status = v;
                  break;
                case "cmi.exit":
                  API.data.exit_type = v;
                  break;
                case "suspend_data":
                  if(v.length > 64E3) {
                    debug("Warning, your suspend data is over the limit!!", 2)
                  }
                  break;
                default:
                  break
              }
              debug("SCORM 2004 LMS SetValue with n: " + n + " and v: " + v, 3);
              s = lms.SetValue(n, v)
            }else {
              debug("Warning, you are not in normal mode.  Ignoring 'set' requests.", 2);
              return"false"
            }
            break;
          default:
            break
        }
        ec = getLastErrorCode();
        m = getLastErrorMessage(ec);
        d = getDiagnostic(ec);
        $(self).triggerHandler({"type":"setvalue", "n":n, "v":v, "error":{"code":ec, "message":m, "diagnostic":d}});
        if(ec === 0 || ec === 403) {
          return s
        }
        debug("Error\nError Code: " + ec + "\nError Message: " + getLastErrorMessage(ec) + " for " + n + "\nDiagnostic: " + getDiagnostic(ec), 1);
        return s
      }
      debug(n + " Set Aborted, connection not initialized! Locate where you called it after you Terminated.", 2);
      return"false"
    };
    this.commit = function() {
      var s = "false", lms = API.path, ec = 0, session_secs, saveDate = new Date;
      if(API.isActive) {
        session_secs = (saveDate.getTime() - settings.startDate.getTime()) / 1E3;
        debug("Committing data", 3);
        switch(API.version) {
          case "1.2":
            self.setvalue("cmi.core.session_time", centisecsToSCORM12Duration(session_secs * 100));
            s = lms.LMSCommit("");
            break;
          case "2004":
            self.setvalue("cmi.session_time", centisecsToISODuration(session_secs * 100, true));
            s = lms.Commit("");
            break;
          default:
            break
        }
        ec = getLastErrorCode();
        if(ec === 0) {
          return s
        }
        debug("Error\nError Code: " + ec + "\nError Message: " + getLastErrorMessage(ec) + " for Commit.\nDiagnostic: " + getDiagnostic(ec), 1);
        return"false"
      }
      debug("Commit Aborted, connection not initialized!", 2);
      return"false"
    };
    this.initialize = function() {
      debug("Initialize Called. \n\tversion: " + settings.version + "\n\tModified: " + settings.modifiedDate, 3);
      var s = false, lms = API.path, ec = 0;
      if(!API.isActive) {
        if(lms) {
          switch(API.version) {
            case "1.2":
              s = makeBoolean(lms.LMSInitialize(""));
              break;
            case "2004":
              s = makeBoolean(lms.Initialize(""));
              break;
            default:
              break
          }
          ec = getLastErrorCode();
          if(s && ec === 0) {
            API.isActive = true;
            API.data.completion_status = self.getvalue("cmi.completion_status");
            settings.startDate = new Date;
            debug("SCO is initialized.", 3);
            switch(API.data.completion_status) {
              case "not attempted":
              ;
              case "unknown":
                self.setvalue("cmi.completion_status", "incomplete");
                break;
              default:
                if(API.data.completion_status === "") {
                  triggerException("LMS compatibility issue, Please notify a administrator.  Completion Status is empty.")
                }
                break
            }
            return"true"
          }
          debug("Error\nError Code: " + ec + "\nError Message: " + getLastErrorMessage(ec) + " for Initialize.\nDiagnostic: " + getDiagnostic(ec), 1)
        }else {
          debug("Aborted, LMS could not be located!.", 2)
        }
      }else {
        debug("Aborted, connection already initialized!.", 2)
      }
      return"false"
    };
    this.terminate = function() {
      var s = false, lms = API.path, ec = 0;
      debug("Terminating " + API.isActive + " " + lms, 4);
      if(API.isActive) {
        if(lms) {
          debug("completion_status = " + API.data.completion_status + "|| success_status = " + API.data.success_status, 3);
          self.commit();
          switch(API.version) {
            case "1.2":
              s = lms.LMSFinish("");
              break;
            case "2004":
              s = lms.Terminate("");
              break;
            default:
              break
          }
          if(makeBoolean(s)) {
            debug("Terminated.", 3);
            API.isActive = false
          }else {
            ec = getLastErrorCode();
            debug("Error\nError Code: " + ec + "\nError Message: " + getLastErrorMessage(ec) + " for Commit.\nDiagnostic: " + getDiagnostic(ec), 1)
          }
        }else {
          debug("Lost connection to LMS", 2)
        }
      }else {
        debug("Terminate Aborted, connection not initialized!", 2)
      }
      return s
    };
    this.getObjectiveByID = function(id) {
      var count = self.getvalue("cmi.objectives._count"), i, tID;
      scorm.debug("Set Objective - Begin search, Objective count is " + count, 4);
      if(count === "" || (count === "false" || count === "-1")) {
        return"false"
      }
      count = parseInt(count, 10) - 1;
      i = count;
      while(i >= 0) {
        tID = self.getvalue("cmi.objectives." + i + ".id");
        if(id === tID) {
          scorm.debug("Objective ID Match on " + i, 4);
          return i
        }
        i -= 1
      }
      return"false"
    };
    this.getInteractionByID = function(id) {
      var count = self.getvalue("cmi.interactions._count"), i, tID;
      if(count === "" || (count === "false" || count === "-1")) {
        return"false"
      }
      count = parseInt(count, 10) - 1;
      scorm.debug("Getting interactions from count " + count, 4);
      i = count;
      while(i >= 0) {
        tID = this.getvalue("cmi.interactions." + i + ".id");
        if(id === tID) {
          scorm.debug("Interaction By ID Returning " + i);
          return i
        }
        i -= 1
      }
      return"false"
    };
    this.getInteractionObjectiveByID = function(n, id) {
      var count = self.getvalue("cmi.interactions." + n + ".objectives._count"), i, tID;
      if(count === "" || count === "false") {
        return"0"
      }
      count = parseInt(count, 10) - 1;
      scorm.debug("Getting interaction objectives from count " + count, 4);
      i = count;
      while(i >= 0) {
        tID = self.getvalue("cmi.interactions." + n + ".objectives." + i + ".id");
        if(id === tID) {
          scorm.debug("Interaction Objective By ID Returning " + i);
          return i
        }
        i -= 1
      }
      return"false"
    };
    this.getInteractionCorrectResponsesByPattern = function(n, pattern) {
      var count = self.getvalue("cmi.interactions." + n + ".correct_responses._count"), i, p;
      if(count === "" || count === "false") {
        scorm.debug("Correct Responses pattern was empty or false", 4);
        return"0"
      }
      count = parseInt(count, 10) - 1;
      scorm.debug("Getting interaction correct responses from count " + count, 4);
      i = count;
      while(i >= 0) {
        p = self.getvalue("cmi.interactions." + n + ".correct_responses." + i + ".pattern");
        if(pattern === p) {
          scorm.debug("Interaction Correct Responses By Pattern Returning " + i);
          return"match"
        }
        i -= 1
      }
      return"false"
    };
    this.init = function() {
      var win;
      try {
        win = window.parent;
        if(win && win !== window) {
          findAPI(window.parent)
        }
      }catch(e) {
        debug(e, 1)
      }
      if(!API.path) {
        try {
          win = window.top.opener;
          findAPI(win)
        }catch(ee) {
          debug(ee, 1)
        }
      }
      if(API.path) {
        API.connection = true;
        return true
      }
      debug("I was unable to locate an API for communication", 2);
      if(settings.use_standalone) {
        debug("If you included Local_API_1484_11 I'll mimic the LMS.  If not, all SCORM calls will fail.", 4);
        settings.standalone = true;
        API.version = "2004";
        API.path = typeof Local_API_1484_11 === "function" ? new Local_API_1484_11({cmi:settings.cmi}) : null;
        $(API.path).on("StoreData", function(e) {
          $(self).triggerHandler({type:"StoreData", runtimedata:e.runtimedata})
        });
        return true
      }
      return false
    };
    this.getLastError = function(n) {
      return error[n]
    };
    this.isLMSConnected = function() {
      return API.connection
    };
    this.set = function(n, v) {
      switch(n) {
        case "version":
        ;
        case "createDate":
        ;
        case "modifiedDate":
        ;
        case "prefix":
          triggerWarning(405);
          return false;
        case "isActive":
          API.isActive = v;
          settings[n] = v;
          break;
        case "startDate":
          settings[n] = new Date(v);
          break;
        default:
          settings[n] = v;
          break
      }
      return isError !== 0
    };
    this.get = function(n) {
      if(settings[n] === undefined) {
        triggerWarning(404);
        return false
      }
      return settings[n]
    };
    this.centisecsToSCORM12Duration = centisecsToSCORM12Duration;
    this.centisecsToISODuration = centisecsToISODuration;
    this.ISODurationToCentisec = ISODurationToCentisec;
    this.isoDateToStringUTC = isoDateToStringUTC;
    this.isoDateToString = isoDateToString;
    this.isoStringToDate = isoStringToDate;
    this.makeBoolean = makeBoolean;
    this.debug = debug;
    this.settings = settings;
    this.API = API;
    this.init()
  }
  return{init:init, getAPIInstance:getAPIInstance, getLMSAPIInstance:getLMSAPIInstance, isConnected:isConnected}
}(VISH, jQuery);
VISH.Editor.Events = function(V, $, undefined) {
  var _bindedEditorEventListeners = false;
  var _confirmOnExit;
  var _isCtrlKeyPressed = false;
  var _mobile;
  var init = function() {
    _mobile = !V.Status.getDevice().desktop;
    if(_mobile) {
      V.Editor.Events.Mobile.init()
    }
    bindEditorEventListeners()
  };
  var bindEditorEventListeners = function() {
    if(!_bindedEditorEventListeners) {
      $(document).on("click", "#addSlideButton", V.Editor.Tools.Menu.insertSlide);
      $(document).on("click", "#addSlideButtonOnSubslides", V.Editor.Tools.Menu.insertSubslide);
      $(document).on("click", "#importButton", function() {
        var firstEnabledId = $("#tab_pdfex,#tab_efile,#tab_presentations_repo").not(".disabled").attr("id");
        switch(firstEnabledId) {
          case "tab_pdfex":
            return V.Editor.Tools.Menu.insertPDFex();
          case "tab_efile":
            return V.Editor.Tools.Menu.insertEFile();
          case "tab_epackage":
            return V.Editor.Tools.Menu.insertPackage();
          case "tab_presentations_repo":
            return V.Editor.Tools.Menu.insertPresentation();
          default:
            return V.Editor.Tools.Menu.insertSlide();
            break
        }
      });
      $(document).on("click", "#slideset_selected_img", V.Editor.Slideset.onClickOpenSlideset);
      $(document).on("click", "#presentation_details_preview_thumbnail", V.Editor.Settings.onChangeThumbnailClicked);
      $(document).on("hover", "#presentation_details_preview_thumbnail", function(event) {
        var thumbnail = $("#presentation_details_preview_thumbnail_img");
        if($(thumbnail).hasClass("addThumbnailPlus")) {
          return
        }
        if(event.type === "mouseenter") {
          $("#editthumb").slideDown()
        }else {
          $("#editthumb").slideUp()
        }
      });
      $(document).on("keyup", "#presentation_details_input_title", V.Editor.Settings.onKeyUpOnTitle);
      $(document).on("keyup", "#presentation_details_preview_addtitle_textarea", V.Editor.Settings.onKeyUpOnPreviewTitle);
      $(document).on("click", "#metadata_clasification_button", V.Editor.Settings.onMetadataButtonClicked);
      $(document).on("click", "#done_in_metadata", V.Editor.Settings.onDoneMetadataButtonClicked);
      $(document).on("click", ".js_tabs_asettings", V.Editor.Settings.advancedTabs);
      $(document).on("click", "#catalog_button", V.Editor.Settings.onCatalogButtonClicked);
      $(document).on("click", "#catalog_done_button", V.Editor.Settings.onDoneCatalogButtonClicked);
      $(document).on("change", "#attachment_file", V.Editor.Settings.onChangeAttachmentFile);
      $(document).on("click", "#upload_file_attachment", V.Editor.Settings.onUploadAttachmentFile);
      $(document).on("click", "#fill_details_later_button", function(event) {
        event.preventDefault();
        $("#catalog_content").hide();
        $.fancybox.close()
      });
      $(document).on("change", "#tlt_hours, #tlt_minutes, #tlt_seconds", V.Editor.Settings.onTLTchange);
      $(document).on("keyup", "#tlt_hours, #tlt_minutes, #tlt_seconds", V.Editor.Settings.onTLTchange);
      $(document).on("click", "#save_presentation_details", V.Editor.Settings.onSavePresentationDetailsButtonClicked);
      $(document).on("click", "div.templatethumb", V.Editor.onSlideThumbClicked);
      $(document).on("click", "div.stthumb", V.Editor.onSlideThumbClicked);
      $(document).on("click", "#animation_fancybox div.slidethumb", V.Editor.onAnimationThumbClicked);
      $(document).on("click", ".stthumb_wrapper p", V.Editor.onSlideThumbClicked);
      $(document).on("click", ".editable", V.Editor.onEditableClicked);
      $(document).on("click", ".selectable", V.Editor.onSelectableClicked);
      $(document).on("click", ':not(".selectable"):not(".preventNoselectable")', V.Editor.onNoSelectableClicked);
      $(document).on("click", ".delete_content", V.Editor.onDeleteItemClicked);
      $(document).on("click", ".delete_slide", V.Editor.onDeleteSlideClicked);
      $(document).on("click", "#animation_fancybox div[animation]", V.Editor.Animations.onAnimationSelected);
      $(document).on("click", "#theme_fancybox img[theme]", V.Editor.Themes.Presentation.onThemeSelected);
      $(document).on("click", ".change_bg_button", V.Editor.Tools.changeBackground);
      $(document).bind("keydown", handleBodyKeyDown);
      $(document).bind("keyup", handleBodyKeyUp);
      $("article").live("slideenter", V.Editor.onSlideEnterEditor);
      $("article").live("slideleave", V.Editor.onSlideLeaveEditor);
      $(document).on("click", "#waiting_overlay", function(event) {
        event.stopPropagation();
        event.preventDefault()
      });
      $(window).focus(function() {
        V.Status.setWindowFocus(true)
      }).blur(function() {
        V.Status.setWindowFocus(false)
      });
      var multipleOnResize = undefined;
      window.onresize = function() {
        if(typeof multipleOnResize == "undefined") {
          multipleOnResize = false;
          setTimeout(function() {
            if(!multipleOnResize) {
              multipleOnResize = undefined;
              V.Status.refreshDeviceAfterResize();
              var currentDevice = V.Status.getDevice();
              V.EventsNotifier.notifyEvent(V.Constant.Event.onViewportResize, {screen:currentDevice.screen, viewport:currentDevice.viewport});
              V.Editor.ViewerAdapter.updateInterface()
            }else {
              multipleOnResize = undefined;
              window.onresize()
            }
          }, 600)
        }else {
          multipleOnResize = true
        }
      };
      _addTutorialEvents();
      $("a#addSlideFancybox").fancybox({"autoDimensions":false, "scrolling":"no", "width":800, "height":740, "padding":0, "onStart":function(data) {
        var slidesAddMode = V.Editor.getContentAddMode();
        if(slidesAddMode === V.Constant.NONE) {
          V.Editor.setContentAddMode(V.Constant.STANDARD)
        }
        if(slidesAddMode === V.Constant.SLIDESET) {
          $("#tab_pdfex").parent().hide();
          $("#tab_presentations_repo").parent().hide();
          $("#tab_json_file").parent().hide();
          $(".tab_slides_smartcards").hide()
        }
        var clickedZoneId = $(data).attr("zone");
        V.Editor.setCurrentArea($("#" + clickedZoneId));
        V.Editor.Utils.loadTab("tab_slides")
      }, "onClosed":function(data) {
        $(".tab_slides_smartcards").show();
        $("#tab_pdfex").parent().show();
        $("#tab_presentations_repo").parent().show();
        $("#tab_json_file").parent().show();
        V.Editor.setContentAddMode(V.Constant.NONE)
      }});
      $("#hidden_button_to_launch_theme_fancybox").fancybox({"autoDimensions":false, "width":600, "scrolling":"no", "height":400, "padding":0});
      $("#hidden_button_to_launch_animation_fancybox").fancybox({"autoDimensions":false, "width":600, "scrolling":"no", "height":400, "padding":0});
      $("#fancyLoad").fancybox({"type":"inline", "autoDimensions":false, "scrolling":"no", "autoScale":true, "width":"100%", "height":"100%", "padding":0, "margin":0, "overlayOpacity":0, "overlayColor":"#fff", "showCloseButton":false, "onComplete":function(data) {
        V.Utils.Loader.prepareFancyboxForFullLoading()
      }, "onClosed":function(data) {
      }});
      $("#hidden_button_to_change_slide_background").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.FLASHCARD);
        V.Editor.Utils.loadTab("tab_pic_from_url")
      }, "onClosed":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.NONE)
      }});
      $("#hidden_button_to_uploadThumbnail").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
        V.Editor.Image.setAddContentMode(V.Constant.THUMBNAIL);
        var firstEnabledId = $("#tab_pic_upload,#tab_pic_thumbnails").not(".disabled").attr("id");
        switch(firstEnabledId) {
          case "tab_pic_upload":
            V.Editor.Utils.loadTab("tab_pic_upload");
            break;
          case "tab_pic_thumbnails":
            V.Editor.Utils.loadTab("tab_pic_thumbnails");
            break;
          default:
            $("#tab_pic_from_url").show();
            V.Editor.Utils.loadTab("tab_pic_from_url");
            break
        }
      }, "onClosed":function(data) {
        if(V.Editor.Image.getAddContentMode() === V.Constant.THUMBNAIL) {
          setTimeout(function() {
            V.Editor.Settings.displaySettings()
          }, 100)
        }
        V.Editor.Image.setAddContentMode(V.Constant.NONE)
      }});
      $(document).on("click", "#quizSettingsDone", V.Editor.Quiz.onQuizSettingsDone);
      $(document).on("click", "#exportQuizToIMSQTI", function() {
        V.Editor.Quiz.onExportTo("QTI")
      });
      $(document).on("click", "#exportQuizToMoodleXML", function() {
        V.Editor.Quiz.onExportTo("MoodleXML")
      });
      $(document).on("click", "#objectSettingsDone", V.Editor.Object.onObjectSettingsDone);
      window.onbeforeunload = _exitConfirmation;
      _confirmOnExit = true;
      $(window.document).on("click", function(ev) {
        if(V.Status.getDevice().browser.name === V.Constant.IE) {
          if(ev.target && $(ev.target).is(":input")) {
            return
          }
        }
        window.focus()
      });
      if(_mobile) {
        V.Editor.Events.Mobile.bindEditorMobileEventListeners()
      }
      _bindedEditorEventListeners = true
    }
  };
  var _addTutorialEvents = function() {
    $(document).on("click", "#help_right", function() {
      V.Tour.startTourWithId("menubar_help", "top")
    });
    $(document).on("click", ".help_in_sslide", function() {
      V.Tour.startTourWithId("sslide_help", "bottom")
    });
    $(document).on("click", ".help_in_flashcard", function() {
      V.Tour.startTourWithId("fc_help", "top")
    });
    $(document).on("click", ".help_in_vt", function() {
      V.Tour.startTourWithId("vt_help", "top")
    });
    $(document).on("click", ".help_in_evideo", function() {
      V.Tour.startTourWithId("evideo_help", "top")
    });
    $(document).on("click", "#tab_slides_help", function() {
      V.Tour.startTourWithId("help_template_selection_help", "bottom")
    });
    $(document).on("click", "#tab_pdfex_help", function() {
      V.Tour.startTourWithId("help_pdfex_help", "bottom")
    });
    $(document).on("click", "#tab_epackage_help", function() {
      V.Tour.startTourWithId("help_epackage_help", "bottom")
    });
    $(document).on("click", "#tab_efile_help", function() {
      V.Tour.startTourWithId("help_efile_help", "bottom")
    });
    $(document).on("click", "#tab_presentations_repo_help", function() {
      V.Tour.startTourWithId("help_pres_selection_help", "bottom")
    });
    $(document).on("click", "#tab_presentations_lre_help", function() {
      V.Tour.startTourWithId("tab_presentations_lre_help", "bottom")
    });
    $(document).on("click", "#help_themes_selection", function() {
      V.Tour.startTourWithId("themes_help", "bottom")
    });
    $(document).on("click", "#help_animation_selection", function() {
      V.Tour.startTourWithId("animation_help", "bottom")
    });
    $(document).on("click", "#help_in_settings", function() {
      V.Tour.startTourWithId("help_in_settings_help", "bottom")
    });
    $(document).on("click", "#help_metadata_selection", function() {
      V.Tour.startTourWithId("help_metadata_selection_help", "bottom")
    });
    $(document).on("click", "#help-metadata-options-tab", function() {
      V.Tour.startTourWithId("help_metadata_selection_help", "bottom")
    });
    $(document).on("click", "#help-publication-tab", function() {
      V.Tour.startTourWithId("help_publication_selection_help", "bottom")
    });
    $(document).on("click", "#help-rte-tab", function() {
      V.Tour.startTourWithId("help_rte_selection_help", "bottom")
    });
    $(document).on("click", "#tab_pic_from_url_help", function() {
      V.Tour.startTourWithId("images_fancy_tabs_id_help", "top")
    });
    $(document).on("click", "#tab_pic_upload_help", function() {
      V.Tour.startTourWithId("upload_picture_form_help", "top")
    });
    $(document).on("click", "#tab_pic_repo_help", function() {
      V.Tour.startTourWithId("search_picture_help", "bottom")
    });
    $(document).on("click", "#tab_pic_flikr_help", function() {
      V.Tour.startTourWithId("search_flickr_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_pic_europeana_help", function() {
      V.Tour.startTourWithId("search_europeana_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_pic_lre_help", function() {
      V.Tour.startTourWithId("search_lre_fancy_help", "bottom")
    });
    $(document).on("click", "#tab_object_from_web_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_snapshot_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_from_url_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_upload_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_repo_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_object_lre_help", function() {
      V.Tour.startTourWithId("object_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_from_url_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_repo_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_video_youtube_help", function() {
      V.Tour.startTourWithId("video_fancy_tabs_main_help", "top")
    });
    $(document).on("click", "#tab_quizzes_help", function() {
      V.Tour.startTourWithId("quiz_help", "bottom")
    });
    $(document).on("click", "#tab_live_resource_help", function() {
      V.Tour.startTourWithId("tab_live_resource_id", "bottom")
    })
  };
  var addZoneThumbsEvents = function(container) {
    $(container).find("a.addpicture").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Image.setAddContentMode(V.Constant.NONE);
      V.Editor.Utils.loadTab("tab_pic_from_url")
    }});
    $(container).find("a.addobject").fancybox({"autoDimensions":false, "width":800, "height":600, "scrolling":"no", "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_object_from_web")
    }});
    $(container).find("a.addvideo").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab(V.Editor.Video.getDefaultTab())
    }});
    $(container).find("a.addQuiz").fancybox({"autoDimensions":false, "width":800, "scrolling":"no", "height":600, "padding":0, "onStart":function(data) {
      var clickedZoneId = $(data).attr("zone");
      V.Editor.setCurrentArea($("#" + clickedZoneId));
      V.Editor.Utils.loadTab("tab_quizzes")
    }})
  };
  var handleBodyKeyDown = function(event) {
    switch(event.keyCode) {
      case 39:
        if(V.Editor.Slides.isSlideFocused()) {
          if(V.Editor.Slideset.isSlideset(V.Slides.getCurrentSlide())) {
            V.Editor.Slides.forwardOneSubslide()
          }
          event.preventDefault()
        }
        break;
      case 40:
        if(V.Editor.Slides.isSlideFocused()) {
          if(!_isCtrlKeyPressed) {
            V.Slides.forwardOneSlide()
          }else {
            V.Slides.moveSlides(10)
          }
          event.preventDefault()
        }
        break;
      case 37:
        if(V.Editor.Slides.isSlideFocused()) {
          if(V.Editor.Slideset.isSlideset(V.Slides.getCurrentSlide())) {
            V.Editor.Slides.backwardOneSubslide()
          }
          event.preventDefault()
        }
        break;
      case 38:
        if(V.Editor.Slides.isSlideFocused()) {
          if(!_isCtrlKeyPressed) {
            V.Slides.backwardOneSlide()
          }else {
            V.Slides.moveSlides(-10)
          }
          event.preventDefault()
        }
        break;
      case 17:
        _isCtrlKeyPressed = true;
        break;
      case 67:
        if(V.Editor.Slides.isSlideFocused()) {
          if(_isCtrlKeyPressed) {
            if(V.Slides.getCurrentSlideNumber()) {
              V.Editor.Clipboard.copy(V.Slides.getCurrentSlide(), V.Constant.Clipboard.Slide)
            }
          }
        }
        break;
      case 86:
        if(V.Editor.Slides.isSlideFocused()) {
          if(_isCtrlKeyPressed) {
            V.Editor.Clipboard.paste()
          }
        }
        break;
      case 46:
        if(V.Editor.Slides.isSlideFocused()) {
          V.Editor.Slides.removeSlideKeyboard()
        }
        break
    }
  };
  var handleBodyKeyUp = function(event) {
    switch(event.keyCode) {
      case 17:
        _isCtrlKeyPressed = false;
        break
    }
  };
  var _exitConfirmation = function() {
    V.EventsNotifier.notifyEvent(V.Constant.Event.exit);
    if(_confirmOnExit) {
      if(V.Editor.hasPresentationChanged()) {
        var confirmationMsg = V.I18n.getTrans("i.exitConfirmation");
        return confirmationMsg
      }
    }
  };
  var allowExitWithoutConfirmation = function() {
    _confirmOnExit = false
  };
  var unbindEditorEventListeners = function() {
    if(_bindedEditorEventListeners) {
      $(document).unbind("keydown", handleBodyKeyDown);
      $(document).unbind("keyup", handleBodyKeyUp);
      $(window.document).off("click", function() {
        window.focus()
      });
      if(_mobile) {
        V.Editor.Events.Mobile.unbindEditorMobileEventListeners()
      }
      _bindedEditorEventListeners = false
    }
  };
  return{init:init, bindEditorEventListeners:bindEditorEventListeners, unbindEditorEventListeners:unbindEditorEventListeners, addZoneThumbsEvents:addZoneThumbsEvents, allowExitWithoutConfirmation:allowExitWithoutConfirmation}
}(VISH, jQuery);
VISH.Editor.Themes = function(V, $, undefined) {
  var _initialized = false;
  var init = function() {
    if(_initialized === true) {
      return
    }
    V.Editor.Themes.Presentation.init();
    _initialized = true
  };
  return{init:init}
}(VISH, jQuery);
VISH.Animations = function(V, $, undefined) {
  var loadAnimation = function(animation, callback) {
    if(V.Status.getDevice().mobile) {
      animation = V.Constant.Animations.Default
    }
    if(!animation) {
      animation = V.Constant.Animations.Default
    }
    _unloadAllAnimations();
    V.Utils.Loader.loadCSS("animations/" + animation + ".css", callback)
  };
  var _unloadAllAnimations = function() {
    var animation_pattern = "(^" + V.StylesheetsPath + "animations/)";
    $("head").find("link[type='text/css']").each(function(index, link) {
      var href = $(link).attr("href");
      if(href) {
        if(href.match(animation_pattern) !== null) {
          $(link).remove()
        }
      }
    })
  };
  return{loadAnimation:loadAnimation}
}(VISH, jQuery);
VISH.AppletPlayer = function() {
  var loadApplet = function(element) {
    $.each(element.children(".appletelement"), function(index, value) {
      var toAppend = "<applet code='" + $(value).attr("code") + "' width='" + $(value).attr("width") + "' height='" + $(value).attr("height") + "' archive='" + $(value).attr("archive") + "'>" + $(value).attr("params") + "</applet>";
      $(value).html(toAppend)
    })
  };
  var unloadApplet = function(element) {
    $(".appletelement applet").remove()
  };
  return{loadApplet:loadApplet, unloadApplet:unloadApplet}
}(VISH, jQuery);
VISH.Audio.HTML5 = function(V, $, undefined) {
  var init = function() {
  };
  var renderAudioFromJSON = function(audioJSON, options) {
    var renderOptions = options || {};
    if(typeof renderOptions.id == "undefined") {
      renderOptions.id = typeof audioJSON != "undefined" && audioJSON["id"] ? audioJSON["id"] : V.Utils.getId()
    }
    if(typeof renderOptions.controls == "undefined") {
      renderOptions.controls = audioJSON["controls"]
    }
    renderOptions.style = audioJSON["style"];
    renderOptions.autoplay = audioJSON["autoplay"];
    renderOptions.loop = audioJSON["loop"];
    return renderAudioFromSources(getSourcesFromJSON(audioJSON), renderOptions)
  };
  var renderAudioFromSources = function(sources, options) {
    var audio = $("<audio></audio>");
    $(audio).attr("preload", "metadata");
    $(audio).addClass("veaudioelement");
    if(options && options.extraAttrs) {
      for(var key in options.extraAttrs) {
        $(audio).attr(key, options.extraAttrs[key])
      }
    }
    if(options) {
      if(options["id"]) {
        $(audio).attr("id", options["id"])
      }
      if(typeof options.onAudioReady == "string") {
        try {
          var onAudioReadySplit = options.onAudioReady.split(".");
          var onAudioReadyFunction = window[onAudioReadySplit[0]];
          for(var k = 1;k < onAudioReadySplit.length;k++) {
            onAudioReadyFunction = onAudioReadyFunction[onAudioReadySplit[k]]
          }
          if(typeof onAudioReadyFunction == "function") {
            $(audio).attr("onloadeddata", options.onAudioReady + "(this)")
          }
        }catch(e) {
        }
      }
      if(options["extraClasses"]) {
        var extraClassesLength = options["extraClasses"].length;
        for(var i = 0;i < extraClassesLength;i++) {
          $(audio).addClass(options["extraClasses"][i])
        }
      }
      if(options.controls !== false) {
        $(audio).attr("controls", "controls")
      }
      if(typeof options.autoplay != "undefined") {
        $(audio).attr("autoplayonslideenter", options.autoplay)
      }
      if(options["loop"] === true) {
        $(audio).attr("loop", "loop")
      }
      if(options["style"]) {
        $(audio).attr("style", options["style"])
      }
    }
    if(typeof $(audio).attr("onloadeddata") == "undefined") {
      $(audio).attr("onloadeddata", "VISH.Audio.HTML5.onAudioReady(this)")
    }
    audio = V.Utils.getOuterHTML(audio);
    audio = audio.split("</audio>")[0];
    if(!options || options.loadSources !== false) {
      $.each(sources, function(index, source) {
        if(typeof source.src == "string") {
          var sourceSrc = source.src;
          if(typeof options != "undefined" && options.timestamp === true) {
            sourceSrc = V.Utils.addParamToUrl(sourceSrc, "timestamp", "" + (new Date).getTime())
          }
          var mimeType = source.mimeType ? "type='" + source.mimeType + "' " : "";
          audio = audio + "<source src='" + sourceSrc + "' " + mimeType + ">"
        }
      });
      if(sources.length > 0) {
        audio = audio + "<p>Your browser does not support HTML5 audio.</p>"
      }
    }
    audio = audio + "</audio>";
    return audio
  };
  var addSourcesToAudioTag = function(sources, audioTag, options) {
    var options = options || {};
    $.each(sources, function(index, source) {
      if(typeof source.src == "string") {
        var sourceSrc = source.src;
        if(options.timestamp === true) {
          sourceSrc = V.Utils.addParamToUrl(sourceSrc, "timestamp", "" + (new Date).getTime())
        }
        var mimeType = source.mimeType ? "type='" + source.mimeType + "' " : "";
        $(audioTag).append("<source src='" + sourceSrc + "' " + mimeType + ">")
      }
    });
    if(sources.length > 0) {
      $(audioTag).append("<p>Your browser does not support HTML5 audio.</p>")
    }
  };
  var onAudioReady = function(audio) {
    if(typeof audio != "undefined" && (audio.readyState == 4 || audio.readyState == 3)) {
      $(audio).attr("loaded", "true")
    }
  };
  var getSources = function(audioDOM) {
    if(typeof audioDOM == "string") {
      var sources = V.Video.HTML5.getSources(audioDOM);
      return sources.map(function(source) {
        return{"src":source.src, "mimeType":getAudioMimeType(source.src)}
      })
    }
    try {
      return $(audioDOM).find("source").map(function() {
        return{"src":this.src, "mimeType":getAudioMimeType(this.src)}
      })
    }catch(e) {
      return[]
    }
    return[]
  };
  var getSourcesFromJSON = function(audioJSON) {
    return V.Video.HTML5.getSourcesFromJSON(audioJSON)
  };
  var getAudioMimeType = function(url) {
    var source = V.Object.getObjectInfo(url).source;
    var extension = source.split(".").pop().split("?")[0];
    var mimeType;
    switch(extension) {
      case "ogg":
        mimeType = "ogg";
        break;
      case "mp3":
        mimeType = "mpeg";
        break;
      case "wav":
        mimeType = "wav";
        break;
      default:
        mimeType = extension;
        break
    }
    return"audio/" + mimeType
  };
  return{init:init, renderAudioFromJSON:renderAudioFromJSON, renderAudioFromSources:renderAudioFromSources, addSourcesToAudioTag:addSourcesToAudioTag, onAudioReady:onAudioReady, getSources:getSources, getSourcesFromJSON:getSourcesFromJSON, getAudioMimeType:getAudioMimeType}
}(VISH, jQuery);
VISH.Configuration = function(V, $, undefined) {
  var configuration;
  var init = function(VEconfiguration) {
    configuration = VEconfiguration;
    _applyConfiguration()
  };
  var _applyConfiguration = function() {
    V.ImagesPath = configuration["ImagesPath"];
    V.StylesheetsPath = configuration["StylesheetsPath"];
    V.UploadPresentationPath = configuration["uploadPresentationPath"];
    V.PreviewPresentationPath = configuration["previewPresentationPath"];
    V.UploadImagePath = configuration["uploadImagePath"];
    V.UploadObjectPath = configuration["uploadObjectPath"];
    V.UploadPDF2PPath = configuration["uploadPDF2PPath"];
    V.UploadEPackagesPath = configuration["uploadEPackagesPath"];
    V.EnableFileImportation = !(configuration["enableFileImportation"] === false);
    V.LREPath = V.Utils.checkUrlProtocol(configuration["LRE_path"]);
    V.ViSHInstances = [];
    if(configuration["ViSH_instances"] instanceof Array) {
      for(var i = 0;i < configuration["ViSH_instances"].length;i++) {
        V.ViSHInstances.push(V.Utils.checkUrlProtocol(configuration["ViSH_instances"][i]))
      }
    }
    V.ThumbnailsPath = configuration["thumbnailsPath"];
    V.TagsPath = configuration["tagsPath"];
    V.UploadJSONPath = configuration["uploadJSONPath"];
    V.UploadAttachmentPath = configuration["uploadAttachmentPath"];
    V.NotifyTeacherPath = configuration["notifyTeacherPath"];
    V.StudentMode = configuration["userMode"] === "student";
    if(typeof V.UploadImagePath == "undefined") {
      $("#tab_pic_upload").css("display", "none").addClass("disabled")
    }
    if(typeof V.UploadObjectPath == "undefined") {
      $("#tab_object_upload").css("display", "none").addClass("disabled")
    }
    if(typeof V.UploadPDF2PPath == "undefined" || typeof V.PreviewPresentationPath == "undefined") {
      $("#tab_pdfex").css("display", "none").addClass("disabled");
      $("#menu a[action='insertPDFex']").hide().addClass("disabled_config")
    }
    if(typeof V.UploadEPackagesPath == "undefined" || typeof V.PreviewPresentationPath == "undefined") {
      $("#tab_epackage").css("display", "none").addClass("disabled");
      $("#menu a[action='insertPackage']").hide().addClass("disabled_config")
    }
    if(typeof V.UploadAttachmentPath == "undefined") {
      $("#attachment_in_presentation_details").css("display", "none").addClass("disabled")
    }
    if(V.EnableFileImportation === false || typeof V.PreviewPresentationPath == "undefined") {
      $("#tab_efile").css("display", "none").addClass("disabled");
      $("#menu a[action='insertEFile']").hide().addClass("disabled_config")
    }
    if(configuration["ViSH"] !== true || (typeof configuration["ViSH_instances"] != "object" || configuration["ViSH_instances"].length < 1)) {
      $("#tab_pic_repo").css("display", "none").addClass("disabled");
      $("#tab_object_repo").css("display", "none").addClass("disabled");
      $("#tab_video_repo").css("display", "none").addClass("disabled");
      $("#tab_presentations_repo").css("display", "none").addClass("disabled");
      $("#menu a[action='insertPresentation']").hide().addClass("disabled_config")
    }
    if(configuration["Flickr"] !== true) {
      $("#tab_pic_flickr").css("display", "none").addClass("disabled")
    }
    if(configuration["Youtube"] !== true || typeof configuration["YoutubeAPIKEY"] != "string") {
      $("#tab_video_youtube").css("display", "none").addClass("disabled")
    }
    if(configuration["SoundCloud"] !== true || typeof configuration["SoundCloudAPIKEY"] != "string") {
      $("#tab_audio_soundcloud").css("display", "none").addClass("disabled")
    }
    if(configuration["LRE"] !== true || typeof configuration["LRE_path"] != "string") {
      $("#tab_pic_lre").css("display", "none").addClass("disabled");
      $("#tab_object_lre").css("display", "none").addClass("disabled")
    }
    if(configuration["Europeana"] !== true || typeof configuration["EuropeanaAPIKEY"] != "string") {
      $("#tab_pic_europeana").css("display", "none").addClass("disabled")
    }
    if(typeof V.PreviewPresentationPath == "undefined") {
      $("#toolbar_preview").hide().addClass("disabled");
      $("#menu a[action='preview']").hide().addClass("disabled_config");
      $("#menu a[action='insertPresentation']").hide().addClass("disabled_config")
    }
    if(typeof V.ThumbnailsPath == "undefined") {
      $("#tab_pic_thumbnails").css("display", "none").addClass("disabled")
    }
    if(typeof V.UploadJSONPath == "undefined") {
      $("#vemenu_export").hide().addClass("disabled_config");
      $("#advanced_tabs a[tab='rte-tab']").hide().addClass("disabled")
    }
    var tagsSettings = {maxLength:20, maxTags:8, triggerKeys:["enter", "space", "comma", "tab"]};
    if(typeof configuration.tagsSettings == "object") {
      if(!typeof configuration.tagsSettings.maxLength == "number") {
        configuration.tagsSettings.maxLength = tagsSettings.maxLength
      }
      if(!typeof configuration.tagsSettings.maxTags == "number") {
        configuration.tagsSettings.maxTags = tagsSettings.maxTags
      }
      if(!(configuration.tagsSettings.triggerKeys instanceof Array)) {
        configuration.tagsSettings.triggerKeys = tagsSettings.triggerKeys
      }
    }else {
      configuration.tagsSettings = tagsSettings
    }
    if(typeof configuration["publishPermissions"] != "object") {
      configuration["publishPermissions"] = []
    }
    if(configuration["publishPermissions"].indexOf("Comment") == -1) {
      $("#allow_comment").parent("p").hide().addClass("disabled")
    }
    if(configuration["publishPermissions"].indexOf("Download") == -1) {
      $("#allow_download").parent("p").hide().addClass("disabled")
    }
    if(configuration["publishPermissions"].indexOf("Clone") == -1) {
      $("#allow_clone").parent("p").hide().addClass("disabled")
    }
    if($("#publication_content p").not(".disabled").length === 0) {
      $("#advanced_tabs a[tab='publication-tab']").hide().addClass("disabled")
    }
    if(typeof configuration["catalog"] != "object" || configuration["catalog"].length < 1) {
      $("#catalog_button").hide().addClass("disabled")
    }
    $("#menu li").each(function(index, li) {
      if($(li).find("a[action]").not(".disabled_config").length < 1) {
        $(li).hide().addClass("disabled_config")
      }
    })
  };
  var getConfiguration = function() {
    return configuration
  };
  return{init:init, getConfiguration:getConfiguration}
}(VISH, jQuery);
VISH.Debugging = function(V, $, undefined) {
  var developping = false;
  var settings;
  var presentationOptions;
  var init = function(options) {
    if(options && typeof options["developping"] == "boolean") {
      developping = options["developping"];
      if(developping) {
        presentationOptions = options;
        if(options["developmentSettings"]) {
          settings = options["developmentSettings"]
        }
      }
    }else {
      developping = false;
      settings = null
    }
  };
  var log = function(text) {
    if(window.console && window.console.log && developping) {
      console.log(text)
    }
  };
  var shuffleJson = function(json) {
    return _shuffle(json)
  };
  var _shuffle = function(o) {
    for(var j, x, i = o.length;i;j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x) {
    }
    return o
  };
  var enableDevelopingMode = function() {
    developping = true
  };
  var disableDevelopingMode = function() {
    developping = false
  };
  var isDevelopping = function() {
    return developping
  };
  var getActionInit = function() {
    if(settings) {
      return settings.actionInit
    }else {
      return"nothing"
    }
  };
  var getPresentationSamples = function() {
    if(settings && settings.samples) {
      return settings.samples
    }else {
      log("VISH.Debugging Error: Please specify development settings");
      return null
    }
  };
  var getRandomToken = function(length) {
    var _token = "";
    if(typeof length != "number") {
      length = 6
    }
    length = Math.max(length, 1);
    for(var i = 0;i < length;i++) {
      _token += parseInt(Math.random() * 10)
    }
    return parseInt(_token)
  };
  return{init:init, log:log, shuffleJson:shuffleJson, enableDevelopingMode:enableDevelopingMode, disableDevelopingMode:disableDevelopingMode, isDevelopping:isDevelopping, getActionInit:getActionInit, getPresentationSamples:getPresentationSamples, getRandomToken:getRandomToken}
}(VISH, jQuery);
VISH.EVideo = function(V, $, undefined) {
  var eVideos;
  var _seeking = false;
  var _blockTimeUpdate = false;
  var _displayVol = true;
  var _lastVideoEndedCall;
  var MIN_TIME_BETWEEN_TOGGLE_INDEX = 1600;
  var VOL_INITIAL = 100;
  var _lastVolumeValue = VOL_INITIAL;
  var initialized = false;
  var RANGE = 0.3;
  var BOTTOM_RANGE = RANGE / 2;
  var TOP_RANGE = RANGE;
  var RANGE_BETWEEN_BALLS = BOTTOM_RANGE + 2 * TOP_RANGE;
  var SEEK_WAIT = 700;
  var init = function() {
    if(!initialized) {
      initialized = true;
      eVideos = new Array;
      _loadEvents()
    }
  };
  var _loadEvents = function() {
    if(V.Status.getDevice().desktop) {
      $(document).on("click", ".evideoPlayButtonWrapper", onClickToggleVideo)
    }else {
      V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onSimpleClick, function(params) {
        var target = params.event.target;
        if($(target).hasClass("evideoPlayButtonWrapper") || $(target).hasClass("evideoPlayButton")) {
          onClickToggleVideo(params.event)
        }
      })
    }
    $(document).on("click", ".evideoToggleIndex.maximized:not(.disabled), .evideoIndexSide.maximized:not(.disabled)", _minimizeIndex);
    $(document).on("click", ".evideoToggleIndex.minimized:not(.disabled), .evideoIndexSide.minimized:not(.disabled)", _maximizeIndex);
    $(document).on("click", ".evideoChapters li", _onClickChapter);
    $(document).on("click", "div.ballWrapper div.ballImg", _onClickBall);
    $(document).on("click", "div.ballWrapper div.ballLine", _onClickBallLine);
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideClosed, function(params) {
      var subslideId = params.slideId;
      var slideset = $($("#" + subslideId).parent());
      if($(slideset).attr("type") == V.Constant.EVIDEO) {
        var eVideoId = $(slideset).attr("id");
        _onCloseBall(eVideoId)
      }
    })
  };
  var loadEventsForControls = function(videoBox) {
    var controls = $(videoBox).find(".evideoControls");
    var posSlider = $(controls).find(".evideoProgressBarSlider");
    $(posSlider).slider({orientation:"horizontal", range:"min", min:0, max:100, value:0, step:0.1, slide:function(event, ui) {
    }, start:function(event, ui) {
      _seeking = true;
      _displayVol = false
    }, stop:function(event, ui) {
      var video = getVideoFromVideoBox(videoBox);
      _updateProgressBar(video, ui.value);
      setTimeout(function() {
        _seeking = false
      }, SEEK_WAIT);
      setTimeout(function() {
        _displayVol = true
      }, 100)
    }, create:function(event, ui) {
    }});
    var volSlider = $(controls).find(".evideoVolSlider");
    $(volSlider).slider({orientation:"vertical", range:"min", min:0, max:100, value:VOL_INITIAL, slide:function(event, ui) {
      var video = getVideoFromVideoBox($(".evideoBox").has(event.target));
      _onVolumeChange(video, ui.value)
    }});
    var hoverTimeout;
    var volButton = $(controls).find(".evideoVolButtonWrapper");
    $(volButton).hover(function(event) {
      if(_displayVol) {
        hoverTimeout = setTimeout(function() {
          var sliderWrapper = $(".evideoControls").has(event.target).find(".evideoVolSliderWrapper");
          $(sliderWrapper).show()
        }, 150)
      }
    }, function(event) {
      clearTimeout(hoverTimeout);
      var sliderWrapper = $(".evideoControls").has(event.target).find(".evideoVolSliderWrapper");
      $(sliderWrapper).hide()
    })
  };
  var _prepareJSON = function(eVideoJSON) {
    eVideoJSON.balls = [];
    if(eVideoJSON.pois) {
      $(eVideoJSON.pois).each(function(index, value) {
        eVideoJSON.balls.push(value)
      });
      eVideoJSON.balls = eVideoJSON.balls.filter(function(ball) {
        return typeof ball.etime != "undefined" && (!isNaN(parseFloat(ball.etime)) && parseFloat(ball.etime) >= 0)
      }).map(function(ball) {
        ball.etime = parseFloat(ball.etime);
        ball.eVideoId = eVideoJSON.id;
        return ball
      }).sort(function(A, B) {
        return A.etime > B.etime
      })
    }
    return eVideoJSON
  };
  var draw = function(eVideoJSON) {
    var eVideoId = eVideoJSON.id;
    var slidesetDOM = $("#" + eVideoId);
    eVideoJSON = _prepareJSON(eVideoJSON);
    eVideos[eVideoId] = eVideoJSON;
    var videoBox = renderVideoBoxDummy();
    $(slidesetDOM).append(videoBox);
    loadEventsForControls(videoBox);
    var indexBox = renderIndexBoxDummy();
    $(slidesetDOM).append(indexBox);
    _renderVideo(eVideoId)
  };
  var renderVideoBoxDummy = function() {
    var videoBox = $("<div class='evideoBox'></div>");
    var videoHeader = $("<div class='evideoHeader' style='display:none'><div class='evideoTime'><span class='evideoCurTime'>00:00</span><span class='evideoTimeSlash'>/</span><span class='evideoDuration'>00:00</span></div></div>");
    var videoBody = $("<div class = 'evideoBody'></div>");
    var footer = $("<div class='evideoFooter' style='display:none'></div>");
    var controls = $("<div class='evideoControls'>");
    var playButton = $("<div class='evideoControlButtonWrapper evideoPlayButtonWrapper'><img class='evideoControlButton evideoPlayButton' src='" + V.ImagesPath + "customPlayer/eVideoPlay.png'></img></div>");
    var volButton = $("<div class='evideoControlButtonWrapper evideoVolButtonWrapper'><img class='evideoControlButton evideoVolButton' src='" + V.ImagesPath + "customPlayer/eVideoSound.png'></img></div>");
    $(volButton).append("<div class='evideoVolSliderWrapper'><div class='evideoVolSlider'></div></div>");
    var progressBarWrapper = $("<div class='evideoProgressBarWrapper'></div>");
    var progressBar = $("<div class='evideoProgressBarSliderWrapper'><div class='evideoProgressBarSlider'></div></div>");
    $(progressBarWrapper).append(progressBar);
    $(controls).append(playButton);
    $(controls).append(volButton);
    $(controls).append(progressBarWrapper);
    $(footer).append(controls);
    $(videoBox).append(videoHeader);
    $(videoBox).append(videoBody);
    $(videoBox).append(footer);
    return videoBox
  };
  var renderIndexBoxDummy = function() {
    var indexBox = $("<div class='evideoIndexBox'></div>");
    var indexSide = $("<div class='evideoIndexSide maximized disabled'><div class='evideoToggleIndex maximized disabled'></div></div>");
    var indexBody = $("<div class='evideoIndexBody'><ul class='evideoChapters'></ul></div>");
    $(indexBox).append(indexBody);
    $(indexBox).append(indexSide);
    return indexBox
  };
  var _renderVideo = function(eVideoId) {
    var eVideoJSON = eVideos[eVideoId];
    if(typeof eVideoJSON != "object" || (typeof eVideoJSON.video != "object" || !haveSources(eVideoJSON))) {
      return
    }
    var videoBody = $("#" + eVideoId).find(".evideoBody");
    $(videoBody).attr("videoType", eVideoJSON.video.type);
    var loadingContainer = $("<div class='loadingEVideoContainer'></div>");
    $(videoBody).append(loadingContainer);
    $(videoBody).addClass("loadingEVideoContainerWrapper");
    V.Utils.Loader.startLoadingInContainer(loadingContainer);
    switch(eVideoJSON.video.type) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        var extraAttrs = {"videoType":eVideoJSON.video.type, "eVideoId":eVideoJSON.id};
        var video = $(V.Video.HTML5.renderVideoFromJSON(eVideoJSON.video, {onVideoReady:"VISH.EVideo.onHTML5VideoReady", loadSources:false, controls:false, poster:false, extraClasses:["temp_hidden"], extraAttrs:extraAttrs}));
        $(videoBody).append(video);
        V.Video.HTML5.addSourcesToVideoTag(V.Video.HTML5.getSourcesFromJSON(eVideoJSON.video), video, {timestamp:true});
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var videoWrapper = $(V.Video.Youtube.renderVideoFromJSON(eVideoJSON.video));
        $(videoBody).attr("source", $(videoWrapper).attr("source"));
        $(videoBody).attr("ytcontainerid", $(videoWrapper).attr("ytcontainerid"));
        V.Video.Youtube.loadYoutubeObject($(videoBody), {controls:false, onReadyCallback:function(event) {
          var iframe = event.target.getIframe();
          var video = $("#" + iframe.id);
          $(video).attr("videoType", eVideoJSON.video.type);
          $(video).attr("eVideoId", eVideoJSON.id);
          _onVideoReady(video)
        }});
        break;
      default:
        return
    }
  };
  var onHTML5VideoReady = function(video) {
    if(typeof video != "undefined" && (video.readyState == 4 || video.readyState == 3)) {
      _onVideoReady(video)
    }
  };
  var _onVideoReady = function(video) {
    var videoBody = $(video).parent();
    var videoBox = $(videoBody).parent();
    var eVideoDOM = $(videoBox).parent();
    var eVideoId = $(eVideoDOM).attr("id");
    var videoHeader = $(videoBox).find(".evideoHeader");
    var videoFooter = $(videoBox).find(".evideoFooter");
    var videoType = $(video).attr("videotype");
    var loadingContainer = $(videoBody).find(".loadingEVideoContainer");
    $(loadingContainer).remove();
    $(videoBody).removeClass("loadingEVideoContainerWrapper");
    var durationDOM = $(videoHeader).find(".evideoDuration");
    var videoDuration = V.Video.getDuration(video);
    if(videoDuration === 0) {
      videoDuration = parseFloat(eVideos[eVideoId].video.duration)
    }
    var formatedDuration = V.Utils.fomatTimeForMPlayer(videoDuration);
    $(durationDOM).html(formatedDuration);
    var significativeNumbers = formatedDuration.split(":").join("").length;
    $(video).attr("sN", significativeNumbers);
    V.Utils.addTempShown(eVideoDOM);
    $(video).removeClass("temp_hidden");
    $(video).attr("loaded", "true");
    fitVideoInVideoBox(videoBox);
    $(videoHeader).show();
    $(videoFooter).show();
    V.Video.onTimeUpdate(video, onTimeUpdate);
    V.Video.onStatusChange(video, onStatusChange);
    eVideos[eVideoId].balls = eVideos[eVideoId].balls.filter(function(ball) {
      return ball.etime <= videoDuration
    });
    if(videoType == V.Constant.MEDIA.YOUTUBE_VIDEO) {
      var youtubeDuration = videoDuration - 1;
      eVideos[eVideoId].balls = eVideos[eVideoId].balls.map(function(ball) {
        if(ball.etime > youtubeDuration) {
          ball.etime = youtubeDuration
        }
        return ball
      })
    }
    eVideos[eVideoId].prevBalls = [];
    _updateNextBall(video, 0);
    renderIndex(eVideoDOM, eVideos[eVideoId]);
    _renderBalls(eVideoDOM, eVideos[eVideoId]);
    _linkChaptersAndBalls(eVideoDOM, eVideos[eVideoId]);
    if(videoType == V.Constant.MEDIA.YOUTUBE_VIDEO) {
      onTimeUpdate(video, 0)
    }
    V.Utils.removeTempShown(eVideoDOM)
  };
  var fitVideoInVideoBox = function(videoBox) {
    var video = getVideoFromVideoBox(videoBox);
    if(typeof video == "undefined" || $(video).attr("loaded") != "true") {
      return
    }
    var eVideoBody = $(videoBox).find(".evideoBody");
    $(eVideoBody).css("height", "85%");
    $(video).css("max-height", "none");
    $(video).css("max-width", "none");
    switch($(video).attr("videoType")) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        V.Utils.fitChildInParent(video);
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        break;
      default:
        break
    }
    var videoHeight = $(video).height();
    var videoBody = $(video).parent();
    $(videoBody).height(videoHeight);
    var videoHeader = $(videoBox).find(".evideoHeader");
    var videoFooter = $(videoBox).find(".evideoFooter");
    var videoHeight = $(video).height();
    var videoWidth = $(video).width();
    V.Utils.addTempShown([videoHeader, videoFooter]);
    var totalVideoBoxHeight = $(videoHeader).height() + videoHeight + $(videoFooter).height();
    V.Utils.removeTempShown([videoHeader, videoFooter]);
    $(videoHeader).css("margin-top", "0px");
    var freeHeight = $(videoBox).height() - totalVideoBoxHeight;
    $(videoHeader).css("margin-top", freeHeight / 2 + "px");
    $(videoHeader).width(videoWidth);
    $(videoFooter).width(videoWidth);
    $(video).css("max-height", "100%");
    $(video).css("max-width", "100%")
  };
  var renderIndex = function(eVideoDOM, eVideoJSON) {
    var indexBody = $(eVideoDOM).find(".evideoIndexBox");
    var eVideoChapters = $(indexBody).find(".evideoChapters");
    $(eVideoJSON.balls).each(function(index, ball) {
      var item = document.createElement("li");
      $(item).attr("ballid", ball.id);
      $(item).attr("etime", ball.etime);
      if(typeof ball.name != "string") {
        var video = getVideoFromVideoBox($(eVideoDOM).find(".evideoBox"));
        ball.name = "" + V.Utils.fomatTimeForMPlayer(ball.etime, parseInt($(video).attr("sN")))
      }
      $(item).html("<span class='eVideoIndexEntryNumber'>" + (index + 1) + ". " + "</span><span class='eVideoIndexEntryBody'>" + ball.name + "</span>");
      $(eVideoChapters).append(item)
    });
    var indexSide = $(indexBody).find(".evideoIndexSide");
    var toggleIndexButton = $(indexSide).find(".evideoToggleIndex");
    $(indexSide).removeClass("disabled");
    $(toggleIndexButton).removeClass("disabled");
    if(!V.Editing) {
      $(eVideoChapters).find("li").hover(function(event) {
        var representedBallId = $(event.target).attr("representedBallId");
        var target = typeof representedBallId == "string" ? event.target : $(event.target).parent();
        representedBallId = $(target).attr("representedBallId");
        var ballWrapper = $(eVideoDOM).find(".ballWrapper[ballid='" + representedBallId + "']");
        $(".ballWrapper").removeClass("selected");
        $(ballWrapper).addClass("selected")
      }, function(event) {
        var representedBallId = $(event.target).attr("representedBallId");
        var target = typeof representedBallId == "string" ? event.target : $(event.target).parent();
        representedBallId = $(target).attr("representedBallId");
        var ballWrapper = $(eVideoDOM).find(".ballWrapper[ballid='" + representedBallId + "']");
        $(ballWrapper).removeClass("selected")
      })
    }
  };
  var onTimeUpdate = function(video, currentTime) {
    _updateCurrentTime(video, currentTime);
    if(!V.Editing) {
      var nextBall = _getJSONFromVideo(video).nextBall;
      if(typeof nextBall != "undefined") {
        var tDiff = currentTime - nextBall.etime;
        if(-BOTTOM_RANGE < tDiff && tDiff < TOP_RANGE) {
          _triggerBall(nextBall, video)
        }
      }
    }
  };
  var onStatusChange = function(video, status) {
    if(status === V.Constant.EVideo.Status.Ended) {
      _onVideoEnded(video)
    }else {
      _updatePlayButton(video, status)
    }
  };
  var _onVideoEnded = function(video) {
    var dN = Date.now();
    if(typeof _lastVideoEndedCall != "undefined") {
      var diff = dN - _lastVideoEndedCall;
      if(diff < 500) {
        return
      }
    }
    _lastVideoEndedCall = dN;
    _updateCurrentTime(video, V.Video.getDuration(video));
    _beforeSeek(video, 0)
  };
  var _onVolumeChange = function(video, volume) {
    if(volume >= 50 && _lastVolumeValue < 50) {
      _updateVolumeImg(video, volume)
    }else {
      if(volume < 50 && (volume > 0 && (_lastVolumeValue > 50 || _lastVolumeValue == 0))) {
        _updateVolumeImg(video, volume)
      }else {
        _updateVolumeImg(video, volume)
      }
    }
    _lastVolumeValue = volume;
    V.Video.setVolume(video, volume)
  };
  var _updateVolumeImg = function(video, volume) {
    var videoBox = getVideoBoxFromVideo(video);
    var volButton = $(videoBox).find(".evideoControlButton.evideoVolButton");
    if(volume >= 50) {
      $(volButton).attr("src", V.ImagesPath + "customPlayer/eVideoSound.png")
    }else {
      if(volume < 50 && volume > 0) {
        $(volButton).attr("src", V.ImagesPath + "customPlayer/eVideoSoundLow.png")
      }else {
        $(volButton).attr("src", V.ImagesPath + "customPlayer/eVideoSoundMute.png")
      }
    }
  };
  var onEnterSlideset = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var videoDOM = getVideoFromVideoBox(videoBox);
    var eVideoJSON = eVideos[eVideoId];
    V.Utils.removeTempShown(eVideoDOM);
    switch(eVideoJSON.estatusBeforeLeave) {
      case V.Constant.EVideo.Status.Playing:
        V.Video.play(videoDOM);
        break;
      case V.Constant.EVideo.Status.Paused:
      ;
      case V.Constant.EVideo.Status.Ended:
        var videoBody = $(videoBox).find(".evideoBody");
        if($(videoBody).attr("videotype") == V.Constant.MEDIA.HTML5_VIDEO) {
          var posSlider = $(videoBox).find(".evideoProgressBarSlider");
          $(posSlider).css("opacity", 0.9);
          setTimeout(function() {
            $(posSlider).css("opacity", 1)
          }, 500)
        }
        break;
      default:
        break
    }
  };
  var onLeaveSlideset = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var videoDOM = getVideoFromVideoBox(videoBox);
    var eVideoJSON = eVideos[eVideoId];
    V.Utils.addTempShown(eVideoDOM);
    eVideoJSON.estatusBeforeLeave = V.Video.getStatus(videoDOM);
    switch(eVideoJSON.estatusBeforeLeave) {
      case V.Constant.EVideo.Status.Playing:
        V.Video.pause(videoDOM);
        break;
      case V.Constant.EVideo.Status.Paused:
      ;
      case V.Constant.EVideo.Status.Ended:
      ;
      default:
        break
    }
  };
  var onClickToggleVideo = function(event) {
    var videoBox = $(".evideoBox").has(event.target);
    var video = getVideoFromVideoBox(videoBox);
    _togglePlay(video)
  };
  var _togglePlay = function(video) {
    var vStatus = V.Video.getStatus(video);
    if(vStatus == V.Constant.EVideo.Status.Playing) {
      V.Video.pause(video)
    }else {
      V.Video.play(video)
    }
  };
  var _updateProgressBar = function(video, value) {
    var duration = V.Video.getDuration(video);
    var timeToSeek = duration * value / 100;
    _beforeSeek(video, timeToSeek);
    V.Video.seekTo(video, timeToSeek)
  };
  var _onClickChapter = function(event) {
    var chapter = event.target;
    if(event.target.tagName != "LI") {
      chapter = $(event.target).parent()
    }
    var chapterTime = parseFloat($(chapter).attr("etime"));
    var eVideoIndexBox = $(".evideoIndexBox").has(chapter);
    var videoBox = $(eVideoIndexBox).parent().find(".evideoBox");
    var video = getVideoFromVideoBox(videoBox);
    var options;
    var ballId = $(chapter).attr("ballid");
    var ball = getBallOfEVideo(_getJSONFromVideo(video), ballId);
    if(typeof ball.slide_id != "undefined") {
      options = {"nextBallId":ballId}
    }
    _onChapterSelected(video, chapterTime, options)
  };
  var _onClickBall = function(event) {
    var ballDOM = event.target;
    var ballTime = parseFloat($(ballDOM).attr("ballTime"));
    var videoBox = $(".evideoBox").has(ballDOM);
    var video = getVideoFromVideoBox(videoBox);
    _onChapterSelected(video, ballTime)
  };
  var _onClickBallLine = function(event) {
    var ballLine = event.target;
    var ballTime = parseFloat($(ballLine).attr("ballTime"));
    var videoBox = $(".evideoBox").has(ballLine);
    var video = getVideoFromVideoBox(videoBox);
    _onChapterSelected(video, ballTime)
  };
  var _onChapterSelected = function(video, chapterTime, options) {
    var timeToSeek = chapterTime;
    var duration = V.Video.getDuration(video);
    if(timeToSeek <= duration) {
      _beforeSeek(video, timeToSeek, options);
      V.Video.seekTo(video, timeToSeek);
      onTimeUpdate(video, timeToSeek);
      _blockTimeUpdate = true;
      setTimeout(function() {
        _blockTimeUpdate = false
      }, SEEK_WAIT)
    }
  };
  var _beforeSeek = function(videoDOM, timeToSeek, options) {
    if(!V.Editing) {
      _resetBallParams(videoDOM);
      _updateNextBall(videoDOM, timeToSeek, options)
    }
  };
  var _updateCurrentTime = function(video, currentTime) {
    if(_blockTimeUpdate) {
      return
    }
    var videoBox = getVideoBoxFromVideo(video);
    var currentTime = typeof currentTime != "undefined" ? currentTime : V.Video.getCurrentTime(video);
    if(!_seeking) {
      var progressBar = $(videoBox).find("div.evideoProgressBarSlider");
      var percentage = 100 * currentTime / V.Video.getDuration(video);
      $(progressBar).slider("value", percentage)
    }
    var currentTimeField = $(videoBox).find(".evideoCurTime");
    $(currentTimeField).html(V.Utils.fomatTimeForMPlayer(currentTime, parseInt($(video).attr("sN"))))
  };
  var _updatePlayButton = function(video, vStatus) {
    var videoBox = getVideoBoxFromVideo(video);
    var eVideoPlayButton = $(videoBox).find(".evideoPlayButton");
    if(vStatus == V.Constant.EVideo.Status.Playing) {
      $(eVideoPlayButton).attr("src", V.ImagesPath + "customPlayer/eVideoPause.png")
    }else {
      $(eVideoPlayButton).attr("src", V.ImagesPath + "customPlayer/eVideoPlay.png")
    }
  };
  var _minimizeIndex = function(event) {
    event.stopPropagation();
    if(V.Utils.delayFunction("toggleIndexCall", function() {
      _minimizeIndex(event)
    }, MIN_TIME_BETWEEN_TOGGLE_INDEX)) {
      return
    }
    var eVideoIndexBox = $(".evideoIndexBox").has(event.target);
    var indexBody = $(eVideoIndexBox).find(".evideoIndexBody");
    $(eVideoIndexBox).find(".evideoChapters li").hide();
    var animationId = V.Utils.getId("animation");
    $(eVideoIndexBox).animate({width:"5%"}, 1E3, function() {
      V.Utils.checkAnimationsFinish(animationId, 2, _onFinishMinimizeIndex, eVideoIndexBox)
    });
    var indexBodyWidth = $(eVideoIndexBox).width() * 0.05;
    $(indexBody).animate({width:indexBodyWidth + ""}, 1E3, function() {
      V.Utils.checkAnimationsFinish(animationId, 2, _onFinishMinimizeIndex, eVideoIndexBox)
    })
  };
  var _onFinishMinimizeIndex = function(eVideoIndexBox) {
    var eVideoBox = $(eVideoIndexBox).parent().find(".evideoBox");
    $(eVideoBox).css("width", "93%");
    _updateIndexButtonUI(eVideoIndexBox, false);
    _redimensionateVideoAfterIndex(eVideoBox)
  };
  var _maximizeIndex = function(event) {
    event.stopPropagation();
    if(V.Utils.delayFunction("toggleIndexCall", function() {
      _maximizeIndex(event)
    }, MIN_TIME_BETWEEN_TOGGLE_INDEX)) {
      return
    }
    var eVideoIndexBox = $(".evideoIndexBox").has(event.target);
    var indexBody = $(eVideoIndexBox).find(".evideoIndexBody");
    var animationId = V.Utils.getId("animation");
    $(eVideoIndexBox).animate({width:"28%"}, 1E3, function() {
      V.Utils.checkAnimationsFinish(animationId, 2, _onFinishMaximizeIndex, eVideoIndexBox)
    });
    $(indexBody).animate({width:"78%"}, 1E3, function() {
      V.Utils.checkAnimationsFinish(animationId, 2, _onFinishMaximizeIndex, eVideoIndexBox)
    })
  };
  var _onFinishMaximizeIndex = function(eVideoIndexBox) {
    var eVideoBox = $(eVideoIndexBox).parent().find(".evideoBox");
    $(eVideoBox).css("width", "70%");
    $(eVideoIndexBox).find(".evideoChapters li").show();
    _updateIndexButtonUI(eVideoIndexBox, true);
    _redimensionateVideoAfterIndex(eVideoBox)
  };
  var _updateIndexButtonUI = function(eVideoIndexBox, maximized) {
    var eVideoIndexSide = $(eVideoIndexBox).find(".evideoIndexSide");
    var button = $(eVideoIndexSide).find(".evideoToggleIndex");
    if(maximized === true) {
      $(eVideoIndexSide).removeClass("minimized").addClass("maximized");
      $(button).removeClass("minimized").addClass("maximized")
    }else {
      $(eVideoIndexSide).removeClass("maximized").addClass("minimized");
      $(button).removeClass("maximized").addClass("minimized")
    }
  };
  var _redimensionateVideoAfterIndex = function(videoBox) {
    fitVideoInVideoBox(videoBox)
  };
  var _fixForWrongProgressBarRendering = function(videoBox) {
    var progressBar = $(videoBox).find("div.evideoProgressBarSlider");
    $(progressBar).css("overflow", "hidden");
    var progressBarMarker = $(progressBar).find(".ui-slider-handle");
    $(progressBarMarker).css("height", "122%");
    $(progressBarMarker).css("margin-top", "0%");
    var eVideoVolSlider = $(videoBox).find(".evideoVolSlider");
    $(eVideoVolSlider).css("overflow", "hidden");
    var eVideoVolSliderMarker = $(eVideoVolSlider).find(".ui-slider-handle");
    $(eVideoVolSliderMarker).css("width", "125%");
    $(eVideoVolSliderMarker).css("left", "-20%")
  };
  var afterSetupSize = function(increase, increaseW) {
    var eVideosDOM = $("section.slides > article[type='enrichedvideo'");
    $(eVideosDOM).each(function(index, eVideoDOM) {
      resizeEVideoAfterSetupSize(eVideoDOM, increase, increaseW)
    })
  };
  var resizeEVideoAfterSetupSize = function(eVideoDOM, increase, increaseW) {
    var isEVideoVisible = $(eVideoDOM).css("display") != "none";
    if(!isEVideoVisible) {
      V.Utils.addTempShown(eVideoDOM)
    }
    var videoBox = $(eVideoDOM).find(".evideoBox");
    fitVideoInVideoBox(videoBox);
    var videoIndexBox = $(eVideoDOM).find(".evideoIndexBox");
    var indexBody = $(videoIndexBox).find(".evideoIndexBody");
    var indexSide = $(videoIndexBox).find(".evideoIndexSide");
    var button = $(videoIndexBox).find(".evideoToggleIndex");
    var buttonDimensions = V.ViewerAdapter.getDimensionsForResizedButton(increase, 18, 0.75);
    $(button).width(buttonDimensions.width);
    $(button).height(buttonDimensions.height);
    $(button).css("top", ($(indexSide).height() - $(button).height()) / 2 + "px");
    var indexSideWidth = $(indexSide).width() - ($(indexBody).width() + $(indexBody).cssNumber("padding-right"));
    $(button).css("left", Math.max(0, (indexSideWidth - $(button).width()) / 2.5) + "px");
    var videoFooter = $(videoBox).find(".evideoFooter");
    $(videoBox).find(".ballWrapper").height($(videoFooter).height());
    if(!isEVideoVisible) {
      V.Utils.removeTempShown(eVideoDOM)
    }
  };
  var _renderBalls = function(eVideoDOM, eVideoJSON) {
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var progressBarWrapper = $(videoBox).find("div.evideoProgressBarWrapper");
    var videoDOM = getVideoFromVideoBox(videoBox);
    var duration = V.Video.getDuration(videoDOM);
    if(duration === 0) {
      var eVideoId = $(eVideoDOM).attr("id");
      duration = parseFloat(eVideos[eVideoId].video.duration)
    }
    _lastLeft = undefined;
    $(eVideoJSON.balls).each(function(value, ball) {
      _drawBall(ball, progressBarWrapper, duration)
    });
    var videoFooter = $(videoBox).find(".evideoFooter");
    $(videoBox).find(".ballWrapper").height($(videoFooter).height());
    $(progressBarWrapper).find(".ballWrapper").hover(function(event) {
      var target = $(event.target).hasClass("ballWrapper") ? event.target : $(event.target).parent();
      var ballId = $(target).attr("ballId");
      var chapter = $(eVideoDOM).find("ul.evideoChapters li[representedballid='" + ballId + "']");
      $(".ul.evideoChapters li").removeClass("hover");
      $(chapter).addClass("hover")
    }, function(event) {
      var target = $(event.target).hasClass("ballWrapper") ? event.target : $(event.target).parent();
      var ballId = $(target).attr("ballId");
      var chapter = $(eVideoDOM).find("ul.evideoChapters li[representedballid='" + ballId + "']");
      $(chapter).removeClass("hover")
    })
  };
  var _lastLeft;
  var _lastDrawedBallWrapper;
  var _drawBall = function(ball, progressBarWrapper, duration) {
    var left = ball.etime * 100 / duration;
    if(typeof ball.slide_id != "undefined") {
      if(typeof _lastLeft != "undefined") {
        if(left - _lastLeft < RANGE_BETWEEN_BALLS) {
          if(typeof _lastDrawedBallWrapper != "undefined") {
            $(_lastDrawedBallWrapper).attr("ballGroup", "true");
            var rBalls;
            try {
              rBalls = JSON.parse($(_lastDrawedBallWrapper).attr("rBalls"))
            }catch(e) {
            }
            if(typeof rBalls == "undefined") {
              rBalls = []
            }
            rBalls.push(ball.id);
            $(_lastDrawedBallWrapper).attr("rBalls", JSON.stringify(rBalls))
          }
          return
        }
      }
      _lastLeft = left
    }
    var ballWrapper = $("<div class='ballWrapper' ballid='" + ball.id + "' ballTime='" + ball.etime + "'><div class='ballLine' ballTime='" + ball.etime + "'></div></div>");
    if(typeof ball.slide_id != "undefined") {
      $(ballWrapper).attr("slide_id", ball.slide_id);
      $(ballWrapper).append("<div class='ballImg' ballTime='" + ball.etime + "'></div>")
    }
    $(ballWrapper).css("left", left + "%");
    $(progressBarWrapper).append(ballWrapper);
    _lastDrawedBallWrapper = ballWrapper
  };
  var _linkChaptersAndBalls = function(eVideoDOM, eVideoJSON) {
    var indexBody = $(eVideoDOM).find(".evideoIndexBox");
    var eVideoChapters = $(indexBody).find(".evideoChapters li");
    $(eVideoChapters).each(function(index, li) {
      var ballId = $(li).attr("ballId");
      var ballWrapper = $(eVideoDOM).find(".ballWrapper[ballid='" + ballId + "']");
      if(ballWrapper.length == 0) {
        var groupBallsWrapper = $(eVideoDOM).find(".ballWrapper[ballgroup='true']");
        $(groupBallsWrapper).each(function(value, gBall) {
          var rBalls;
          try {
            rBalls = JSON.parse($(gBall).attr("rBalls"))
          }catch(e) {
          }
          if(typeof rBalls == "object") {
            if(rBalls.indexOf(ballId) != -1) {
              ballWrapper = gBall;
              return false
            }
          }
        })
      }
      var representedBallId = $(ballWrapper).attr("ballid");
      if(typeof representedBallId == "string") {
        $(li).attr("representedBallId", representedBallId)
      }
    })
  };
  var _updateNextBall = function(videoDOM, cTime) {
    if(typeof cTime != "number") {
      return
    }
    var eVideoId = $(videoDOM).attr("evideoid");
    if(typeof eVideos[eVideoId].nextBall != "undefined") {
      eVideos[eVideoId].prevBalls.push(eVideos[eVideoId].nextBall)
    }
    var nextBall = undefined;
    var lookForNextBallId = options && options.nextBallId;
    $(eVideos[eVideoId].balls).each(function(index, ball) {
      if(lookForNextBallId) {
        if(ball.id === options.nextBallId && typeof ball.slide_id != "undefined") {
          nextBall = ball;
          return false
        }
      }else {
        if(typeof ball.slide_id != "undefined" && (ball.etime >= cTime && eVideos[eVideoId].prevBalls.indexOf(ball) == -1)) {
          nextBall = ball;
          return false
        }
      }
    });
    eVideos[eVideoId].nextBall = nextBall
  };
  var _triggerBall = function(ball, videoDOM) {
    if(typeof eVideos[ball.eVideoId].displayedBall != "undefined") {
      return
    }
    var currentStatus = V.Video.getStatus(videoDOM);
    if(currentStatus == V.Constant.EVideo.Status.Playing) {
      V.Video.pause(videoDOM)
    }
    eVideos[ball.eVideoId].estatusBeforeTriggerBall = currentStatus;
    _displayBall(ball, videoDOM)
  };
  var _displayBall = function(ball, videoDOM) {
    eVideos[ball.eVideoId].displayedBall = ball;
    setTimeout(function() {
      var videoBox = getVideoBoxFromVideo(videoDOM);
      var subslideDOM = $("#" + ball.slide_id);
      if($(subslideDOM).hasClass("show_in_smartcard")) {
        $(videoBox).addClass("temp_hidden_soft")
      }
    }, 1500);
    V.Slides.openSubslide(ball.slide_id)
  };
  var _onCloseBall = function(eVideoId) {
    var eVideoJSON = eVideos[eVideoId];
    var videoBox = $("#" + eVideoId).find(".evideoBox");
    $(videoBox).removeClass("temp_hidden_soft");
    var videoDOM = getVideoFromVideoBox(videoBox);
    var cTime = V.Video.getCurrentTime(videoDOM);
    var prevBall = jQuery.extend({}, eVideoJSON.displayedBall);
    _updateNextBall(videoDOM, prevBall.etime);
    eVideoJSON.displayedBall = undefined;
    var nextBall = eVideos[eVideoId].nextBall;
    var showNextBall = false;
    if(nextBall) {
      if(nextBall.etime - prevBall.etime < RANGE_BETWEEN_BALLS) {
        showNextBall = true
      }
    }
    if(showNextBall === true) {
      _displayBall(nextBall, videoDOM);
      return
    }
    var videoStatus = V.Video.getStatus(videoDOM);
    if(eVideoJSON.estatusBeforeTriggerBall === V.Constant.EVideo.Status.Playing) {
      if(videoStatus == V.Constant.EVideo.Status.Paused) {
        V.Video.play(videoDOM)
      }
    }
    if(videoStatus == V.Constant.EVideo.Status.Ended) {
      _beforeSeek(videoDOM, 0)
    }
  };
  var _resetBallParams = function(videoDOM) {
    var eVideoId = $(videoDOM).attr("evideoid");
    eVideos[eVideoId].displayedBall = undefined;
    eVideos[eVideoId].nextBall = undefined;
    eVideos[eVideoId].prevBalls = []
  };
  var getVideoFromVideoBox = function(videoBox) {
    return $(videoBox).find(".evideoBody").children().not(".loadingEVideoContainer")[0]
  };
  var getVideoBoxFromVideo = function(video) {
    return $(".evideoBox").has(video)
  };
  var _getJSONFromVideo = function(video) {
    return eVideos[$(video).attr("evideoid")]
  };
  var getBallOfEVideo = function(eVideoJSON, ballId) {
    var bL = eVideoJSON.balls.length;
    for(var i = 0;i < bL;i++) {
      var ball = eVideoJSON.balls[i];
      if(ball.id == ballId) {
        return ball
      }
    }
    return undefined
  };
  var haveSources = function(eVideoJSON) {
    if(typeof eVideoJSON == "undefined" || typeof eVideoJSON.video == "undefined") {
      return false
    }
    switch(eVideoJSON.video.type) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        return typeof eVideoJSON.video.sources != "undefined";
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return typeof eVideoJSON.video.source != "undefined";
      default:
        return false
    }
  };
  return{init:init, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, renderVideoBoxDummy:renderVideoBoxDummy, renderIndexBoxDummy:renderIndexBoxDummy, fitVideoInVideoBox:fitVideoInVideoBox, renderIndex:renderIndex, loadEventsForControls:loadEventsForControls, onClickToggleVideo:onClickToggleVideo, onStatusChange:onStatusChange, onTimeUpdate:onTimeUpdate, getVideoFromVideoBox:getVideoFromVideoBox, getVideoBoxFromVideo:getVideoBoxFromVideo, getBallOfEVideo:getBallOfEVideo, 
  haveSources:haveSources, onHTML5VideoReady:onHTML5VideoReady, afterSetupSize:afterSetupSize}
}(VISH, jQuery);
VISH.Editor.API = function(V, $, undefined) {
  var init = function() {
    queriesCounter = 0;
    queriesData = [];
    searchId = -1;
    sessionSearchs = {}
  };
  var QUERY_TIMEOUT = 2E4;
  var queriesCounter;
  var queriesData;
  var searchId;
  var sessionSearchs;
  var _search = function(types, searchTerms, successCallback, failCallback) {
    var settings = {};
    settings.n = 20;
    settings.entities_type = types;
    settings.qualityThreshold = 0;
    var query = _buildQuery(searchTerms, settings);
    var instances = V.ViSHInstances;
    var instancesL = instances.length;
    searchId = _getSearchId();
    sessionSearchs[searchId] = {};
    queriesCounter = 0;
    queriesData = [];
    for(var i = 0;i < instancesL;i++) {
      var instanceDomain = instances[i];
      sessionSearchs[searchId][instanceDomain] = {completed:false};
      _searchInViSHInstance(searchId, instanceDomain, query, function(data) {
        if(typeof data.searchId == "undefined" || data.searchId != searchId) {
          return
        }
        queriesCounter += 1;
        if(data.success === true && (typeof data.response != "undefined" && (typeof data.response.results != "undefined" && typeof data.instanceDomain != "undefined"))) {
          queryResults = [];
          $(data.response.results).each(function(index, result) {
            result.instance = data.instanceDomain;
            result.sorting_weight = typeof result.weights != "undefined" && typeof result.weights.sorting_weight == "number" ? result.weights.sorting_weight : 0;
            queryResults.push(result)
          });
          queriesData = queriesData.concat(queryResults)
        }
        if(queriesCounter === instancesL) {
          if(instancesL > 1) {
            queriesData = queriesData.sort(function(a, b) {
              return b.sorting_weight - a.sorting_weight
            })
          }
          if(typeof successCallback == "function") {
            successCallback(queriesData)
          }
        }
      })
    }
  };
  var _buildQuery = function(searchTerms, settings) {
    searchTerms = typeof searchTerms == "string" ? searchTerms : "";
    var query = "/apis/search?n=" + settings.n + "&q=" + searchTerms + "&type=" + settings.entities_type;
    if(settings.sort_by) {
      query += "&sort_by=" + settings.sort_by
    }
    if(settings.startDate) {
      query += "&startDate=" + settings.startDate
    }
    if(settings.endDate) {
      query += "&endDate=" + settings.endDate
    }
    if(settings.language) {
      query += "&language=" + settings.language
    }
    if(settings.qualityThreshold) {
      query += "&qualityThreshold=" + settings.qualityThreshold
    }
    return query
  };
  var _searchInViSHInstance = function(searchId, domain, query, callback) {
    var ViSHSearchAPIURL = domain + query;
    ViSHSearchAPIURL = ViSHSearchAPIURL.replace("//apis", "/apis");
    $.ajax({type:"GET", url:ViSHSearchAPIURL, success:function(data) {
      if(sessionSearchs[searchId][domain].completed == false) {
        sessionSearchs[searchId][domain].completed = true;
        callback({success:true, searchId:searchId, instanceDomain:domain, response:data})
      }
    }, error:function(error) {
      if(sessionSearchs[searchId][domain].completed == false) {
        sessionSearchs[searchId][domain].completed = true;
        callback({success:false, searchId:searchId, instanceDomain:domain})
      }
      V.Debugging.log("Error connecting with the ViSH API of " + domain)
    }});
    setTimeout(function() {
      if(sessionSearchs[searchId][domain].completed == false) {
        sessionSearchs[searchId][domain].completed = true;
        callback({success:false, searchId:searchId})
      }
    }, QUERY_TIMEOUT)
  };
  var _searchId = 0;
  var _getSearchId = function() {
    _searchId += 1;
    return _searchId
  };
  var requestImages = function(searchTerms, successCallback, failCallback) {
    _search(["Picture"], searchTerms, successCallback, failCallback)
  };
  var requestVideos = function(searchTerms, successCallback, failCallback) {
    _search(["Video"], searchTerms, successCallback, failCallback)
  };
  var requestObjects = function(searchTerms, successCallback, failCallback) {
    _search(["Link", "Scormfile", "Webapp", "Video", "Audio", "Swf"], searchTerms, successCallback, failCallback)
  };
  var requestPresentations = function(searchTerms, successCallback, failCallback) {
    _search(["Excursion"], searchTerms, successCallback, failCallback)
  };
  var requestTags = function(successCallback, failCallback) {
    if(typeof V.TagsPath != "string") {
      if(typeof failCallback == "function") {
        failCallback()
      }
      return
    }
    $.ajax({type:"GET", url:V.TagsPath, dataType:"html", success:function(response) {
      if(typeof successCallback == "function") {
        var tagsJSON = JSON.parse(response);
        var tags = [];
        if(tagsJSON.length > 0) {
          $.each(tagsJSON, function(index, tagJSON) {
            tags.push(tagJSON.name)
          })
        }
        successCallback(tags)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var requestThumbnails = function(successCallback, failCallback) {
    if(typeof V.ThumbnailsPath != "string") {
      if(typeof failCallback == "function") {
        failCallback()
      }
      return
    }
    $.ajax({type:"GET", url:V.ThumbnailsPath, dataType:"json", success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback(xhr, ajaxOptions, thrownError)
      }
    }})
  };
  var uploadTmpJSON = function(json, responseFormat, successCallback, failCallback) {
    if(typeof V.UploadJSONPath != "string") {
      if(typeof failCallback == "function") {
        failCallback()
      }
      return
    }
    responseFormat = typeof responseFormat == "string" ? responseFormat : "json";
    $.ajax({type:"POST", url:V.UploadJSONPath, dataType:"json", data:{"authenticity_token":V.User.getToken(), "json":JSON.stringify(json), "responseFormat":responseFormat}, success:function(data) {
      if(data && data.url) {
        if(data.xml) {
          var element = document.createElement("a");
          element.setAttribute("href", "data:application/xml;charset=utf-8," + encodeURIComponent(data.xml));
          element.setAttribute("download", data.filename);
          element.style.display = "none";
          document.body.appendChild(element);
          element.click();
          document.body.removeChild(element)
        }else {
          _downloadFile(data.url)
        }
        if(typeof successCallback == "function") {
          successCallback()
        }
      }else {
        if(typeof failCallback == "function") {
          failCallback()
        }
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback(xhr, ajaxOptions, thrownError)
      }
    }})
  };
  var _downloadFile = function(fileURL) {
    var iframe = $("#hiddenIframeForAjaxDownloads");
    $(iframe).attr("src", fileURL)
  };
  return{init:init, requestPresentations:requestPresentations, requestVideos:requestVideos, requestImages:requestImages, requestObjects:requestObjects, requestTags:requestTags, requestThumbnails:requestThumbnails, uploadTmpJSON:uploadTmpJSON}
}(VISH, jQuery);
VISH.Editor.Animations = function(V, $, undefined) {
  var initialized = false;
  var currentAnimation;
  var animation = {};
  var init = function() {
    if(!initialized) {
      animation["animation1"] = {number:"1", filename:"animation1"};
      animation["animation2"] = {number:"2", filename:"animation2"};
      animation["animation3"] = {number:"3", filename:"animation3"};
      animation["animation4"] = {number:"4", filename:"animation4"};
      animation["animation5"] = {number:"5", filename:"animation5"};
      animation["animation6"] = {number:"6", filename:"animation6"};
      animation["animation7"] = {number:"7", filename:"animation7"};
      animation["animation8"] = {number:"8", filename:"animation8"};
      animation["animation9"] = {number:"9", filename:"animation9"};
      animation["animation10"] = {number:"10", filename:"animation10"};
      animation["animation11"] = {number:"11", filename:"animation11"};
      animation["animation12"] = {number:"12", filename:"animation12"}
    }
    setCurrentAnimation(VISH.Constant.Animations.Default)
  };
  var onAnimationSelected = function(event) {
    event.preventDefault();
    var animationNumber = $(event.currentTarget).attr("animation");
    selectAnimation(animationNumber);
    V.Editor.Settings.selectAnimation(animation[animationNumber].number)
  };
  var selectAnimation = function(animation) {
    currentAnimation = animation
  };
  var getCurrentAnimation = function() {
    if(currentAnimation) {
      return animation[currentAnimation]
    }else {
      return animation[VISH.Constant.Animations.Default]
    }
  };
  var setCurrentAnimation = function(the_animation) {
    if(the_animation != undefined) {
      currentAnimation = the_animation;
      V.Editor.Settings.selectAnimation(animation[the_animation].number)
    }
  };
  return{init:init, onAnimationSelected:onAnimationSelected, selectAnimation:selectAnimation, getCurrentAnimation:getCurrentAnimation, setCurrentAnimation:setCurrentAnimation}
}(VISH, jQuery);
VISH.Editor.Audio.HTML5 = function(V, $, undefined) {
  var init = function() {
  };
  var drawAudioWithWrapper = function(audioTag) {
    var sources = V.Audio.HTML5.getSources(audioTag);
    if(sources.length > 0) {
      var options = {};
      options.timestamp = true;
      drawAudio(sources, options)
    }
  };
  var drawAudioWithUrl = function(url) {
    var options = {};
    options.timestamp = true;
    drawAudio([{src:url}], options)
  };
  var drawAudio = function(sources, options, area, style) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    current_area.attr("type", "audio");
    var autoplay = false;
    if(options) {
      if(options["autoplay"]) {
        autoplay = options["autoplay"]
      }
    }
    var template = V.Editor.getTemplate(area);
    var nextAudioId = V.Utils.getId();
    var idToDragAndResize = "draggable" + nextAudioId;
    var audioTag = document.createElement("audio");
    audioTag.setAttribute("id", idToDragAndResize);
    audioTag.setAttribute("draggable", true);
    audioTag.setAttribute("class", template + "_audio");
    audioTag.setAttribute("title", "Click to drag");
    audioTag.setAttribute("controls", "controls");
    audioTag.setAttribute("preload", "metadata");
    audioTag.setAttribute("autoplayonslideenter", autoplay);
    if(style) {
      audioTag.setAttribute("style", style)
    }
    $(current_area).html("");
    $(current_area).append(audioTag);
    V.Audio.HTML5.addSourcesToAudioTag(sources, audioTag, {timestamp:true});
    V.Editor.addDeleteButton($(current_area));
    $("#" + idToDragAndResize).draggable({cursor:"move"});
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var renderAudioFromWrapper = function(audioTag, options) {
    var sources = V.Audio.HTML5.getSources(audioTag);
    if(sources.length > 0) {
      var options = options || {};
      return V.Audio.HTML5.renderAudioFromSources(sources, options)
    }
  };
  var renderAudioWithURL = function(url, options) {
    return V.Audio.HTML5.renderAudioFromSources([{src:url}], options)
  };
  return{init:init, drawAudioWithWrapper:drawAudioWithWrapper, drawAudioWithUrl:drawAudioWithUrl, drawAudio:drawAudio, renderAudioFromWrapper:renderAudioFromWrapper, renderAudioWithURL:renderAudioWithURL}
}(VISH, jQuery);
VISH.Editor.Audio.Soundcloud = function(V, $, undefined) {
  var containerDivId = "tab_audio_soundcloud_content";
  var carrouselDivId = "tab_audio_soundcloud_content_carrousel";
  var previewDivId = "tab_audio_soundcloud_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentAudios = new Array;
  var selectedAudio = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInSoundcloud(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanAudioPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanAudioPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInSoundcloud = function(text) {
    var urlSoundCloud = "https://api.soundcloud.com/tracks";
    urlSoundCloud = V.Utils.checkUrlProtocol(urlSoundCloud);
    $.getJSON(urlSoundCloud, {client_id:V.Configuration.getConfiguration()["SoundCloudAPIKEY"], q:text, format:"json"}, function(data) {
      _onDataReceived(data)
    }).error(function() {
      _onAPIError()
    })
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentAudios = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(i, item) {
      var audio = item.uri;
      var title = item.title;
      var author = item.user.username;
      var subtitle = item.description;
      var audioId = item.id;
      currentAudios[audioId] = new Object;
      currentAudios[audioId].id = audioId;
      currentAudios[audioId].title = title;
      currentAudios[audioId].author = author;
      currentAudios[audioId].subtitle = subtitle;
      var image_url;
      if(typeof item.artwork_url != "undefined" && item.artwork_url != null) {
        image_url = item.artwork_url
      }else {
        image_url = V.ImagesPath + "carrousel/audio.png"
      }
      var myImg = $("<img audioId='" + audioId + "' src='" + image_url + "' title='" + title + "'/>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(title)
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorSoundCloudConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var addSelectedAudio = function() {
    if(selectedAudio != null) {
      V.Editor.Object.drawObject(_generateWrapper(selectedAudio.id));
      $.fancybox.close()
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var audioId = $(event.target).attr("audioId");
    var renderedPreviewAudio = _generatePreviewWrapper(audioId);
    _renderAudioPreview(renderedPreviewAudio, currentAudios[audioId]);
    selectedAudio = currentAudios[audioId]
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderAudioPreview = function(renderedIframe, audio) {
    var audioArea = $("#" + previewDivId).find("#tab_audio_soundcloud_content_preview_audio");
    var metadataArea = $("#" + previewDivId).find("#tab_audio_soundcloud_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(audioArea).html("");
    $(metadataArea).html("");
    if(renderedIframe && audio) {
      $(audioArea).append(renderedIframe);
      var table = V.Editor.Utils.generateTable({title:audio.title, author:audio.author, description:audio.subtitle});
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanAudioPreview = function() {
    var audioArea = $("#" + previewDivId).find("#tab_audio_soundcloud_content_preview_audio");
    var metadataArea = $("#" + previewDivId).find("#tab_audio_soundcloud_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(audioArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var _generateWrapper = function(audioId) {
    var url = "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/" + audioId;
    url = V.Utils.addParamToUrl(url, "wmode", "opaque");
    var wrapper = "<iframe src='" + url + "' frameborder='0'></iframe>";
    return wrapper
  };
  var _generatePreviewWrapper = function(audioId) {
    var url = "https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/" + audioId;
    url = V.Utils.addParamToUrl(url, "wmode", "opaque");
    var wrapper = "<iframe class='objectPreview' src='" + url + "' frameborder='0'></iframe>";
    return wrapper
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedAudio:addSelectedAudio}
}(VISH, jQuery);
VISH.Editor.Carrousel = function(V, $, undefined) {
  var createCarrousel = function(containerId, options) {
    if(!containerId) {
      return
    }
    var rows = 1;
    var rowItems = 5;
    var scrollItems = null;
    var styleClass = "";
    var titleClass = "";
    var callback = null;
    var width = 650;
    var startAtLastElement = false;
    var pagination = true;
    var sortable = false;
    var afterCreateCarruselFunction = null;
    if(options) {
      if(options["rows"]) {
        rows = options["rows"]
      }
      if(options["rowItems"]) {
        rowItems = options["rowItems"]
      }
      if(options["scrollItems"]) {
        scrollItems = options["scrollItems"]
      }
      if(options["styleClass"]) {
        styleClass = options["styleClass"]
      }
      if(options["titleClass"]) {
        titleClass = options["titleClass"]
      }
      if(options["callback"]) {
        callback = options["callback"]
      }
      if(options["width"]) {
        width = options["width"]
      }
      if(options["startAtLastElement"]) {
        startAtLastElement = options["startAtLastElement"]
      }
      if(typeof options["pagination"] == "boolean") {
        pagination = options["pagination"]
      }
      if(typeof options["sortable"] == "boolean") {
        sortable = options["sortable"]
      }
      if(options["afterCreateCarruselFunction"]) {
        afterCreateCarruselFunction = options["afterCreateCarruselFunction"]
      }
    }
    var multipleRow = rows > 1;
    var carrouselClass = "";
    if(styleClass) {
      carrouselClass = "_" + styleClass
    }
    if(!scrollItems) {
      scrollItems = rowItems
    }
    if(multipleRow) {
      var rowClass = "multiple_row" + carrouselClass
    }else {
      var rowClass = "single_row" + carrouselClass
    }
    var wrapperDiv = $("#" + containerId);
    wrapperDiv.attr("class", "image_carousel image_carousel_" + rowClass);
    wrapperDiv.removeAttr("id");
    var mainDiv = document.createElement("div");
    $(mainDiv).html($(wrapperDiv).html());
    $(wrapperDiv).html("");
    mainDiv.setAttribute("id", containerId);
    var clearFix = document.createElement("div");
    clearFix.setAttribute("class", "clearfix");
    var button_prev = document.createElement("a");
    var button_next = document.createElement("a");
    button_prev.setAttribute("class", "prev");
    button_next.setAttribute("class", "next");
    $(button_prev).addClass("prev_" + rowClass);
    $(button_next).addClass("next_" + rowClass);
    button_prev.setAttribute("href", "#");
    button_next.setAttribute("href", "#");
    button_prev.setAttribute("id", "carrousel_prev" + containerId);
    button_next.setAttribute("id", "carrousel_next" + containerId);
    $(button_prev).html("<span>prev</span>");
    $(button_next).html("<span>next</span>");
    $(wrapperDiv).append(clearFix);
    $(wrapperDiv).append(button_prev);
    $(wrapperDiv).append(button_next);
    if(pagination) {
      var paginationDiv = document.createElement("div");
      paginationDiv.setAttribute("class", "pagination pagination_" + rowClass);
      paginationDiv.setAttribute("id", "carrousel_pag" + containerId);
      $(wrapperDiv).append(paginationDiv)
    }
    $(mainDiv).children().addClass("carrousel_element_" + rowClass);
    $(mainDiv).children().each(function(index, value) {
      $(value).children().addClass("carrousel_element_" + rowClass)
    });
    if(callback && typeof callback == "function") {
      $(mainDiv).children().click(function(event) {
        callback(event)
      })
    }
    if(multipleRow) {
      _applyMultipleRows(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width, afterCreateCarruselFunction)
    }else {
      $(wrapperDiv).prepend(mainDiv);
      if(startAtLastElement) {
        var start = $(mainDiv).children().length - rowItems + 1
      }else {
        var start = 0
      }
      _setMainCarrousel(containerId, containerId, rows, [], rowItems, scrollItems, width, start, function() {
        if(pagination) {
          _forceShowPagination(containerId)
        }
        if(sortable) {
          $("#" + containerId).sortable()
        }
        if(typeof afterCreateCarruselFunction === "function") {
          afterCreateCarruselFunction()
        }
      })
    }
    return
  };
  var _applyMultipleRows = function(containerId, wrapperDiv, mainDiv, rows, rowItems, scrollItems, rowClass, width, afterCreateCarruselFunction) {
    var synchronizeIds = [];
    var createdRows = 0;
    var i;
    for(i = 0;i < rows;i++) {
      window[mainDiv.id + "_row" + i] = document.createElement("div");
      window[mainDiv.id + "_row" + i].setAttribute("id", mainDiv.id + "_row" + i);
      window[mainDiv.id + "_row" + i].setAttribute("class", "carrousel_wrapper_" + rowClass);
      if(i != 0) {
        synchronizeIds.push(mainDiv.id + "_row" + i)
      }
    }
    $(mainDiv).children().each(function(index, value) {
      $(window[mainDiv.id + "_row" + index % rows]).append(value)
    });
    for(i = rows - 1;i >= 0;i--) {
      $(wrapperDiv).prepend(window[mainDiv.id + "_row" + i]);
      if(i == 0) {
        var newContainerId = mainDiv.id + "_row" + i;
        _setMainCarrousel(newContainerId, containerId, rows, synchronizeIds, rowItems, scrollItems, width, null, function() {
          createdRows++;
          _afterCreateRow(createdRows, rows, afterCreateCarruselFunction)
        })
      }else {
        _setRowCarrousel(mainDiv.id + "_row" + i, rowItems, scrollItems, width, function() {
          createdRows++;
          _afterCreateRow(createdRows, rows, afterCreateCarruselFunction)
        })
      }
    }
  };
  var _afterCreateRow = function(createdRows, rows, afterCreateCarruselFunction) {
    if(createdRows === rows && typeof afterCreateCarruselFunction == "function") {
      afterCreateCarruselFunction()
    }
  };
  var _setRowCarrousel = function(id, rowItems, scrollItems, width, afterCreateCarruselFunction) {
    $("#" + id).carouFredSel({auto:false, circular:false, infinite:false, width:width, scroll:{items:scrollItems, fx:"scroll", duration:1E3, timeoutDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}}, onCreate:afterCreateCarruselFunction})
  };
  var _setMainCarrousel = function(id, widgetsId, rows, synchronizeIds, rowItems, scrollItems, width, start, afterCreateCarruselFunction) {
    if(!start) {
      start = 0
    }
    $("#" + id).carouFredSel({circular:false, infinite:false, auto:false, width:width, scroll:{items:scrollItems, duration:1E3, timeoutDuration:2E3}, items:{visible:{min:rowItems, max:rowItems}, start:start}, prev:{button:"#carrousel_prev" + widgetsId}, next:{button:"#carrousel_next" + widgetsId}, pagination:"#carrousel_pag" + widgetsId, onCreate:afterCreateCarruselFunction});
    if(synchronizeIds) {
      var syncString = "";
      $(synchronizeIds).each(function(index, value) {
        if(index != 0) {
          syncString = syncString + ", "
        }
        syncString = syncString + "#" + value
      });
      $("#" + id).trigger("configuration", ["synchronise", syncString])
    }
    $("#" + id).attr("rows", rows)
  };
  var cleanCarrousel = function(containerId) {
    $("#" + containerId).html("");
    var containderIdForMultiRow = containerId + "_row0";
    if($("#" + containderIdForMultiRow).attr("rows")) {
      var rows = $("#" + containderIdForMultiRow).attr("rows");
      var i;
      for(i = 0;i < rows;i++) {
        _cleanOneRowCarrousel(containerId + "_row" + i)
      }
      $("#" + containderIdForMultiRow).attr("id", containerId)
    }else {
      _cleanOneRowCarrousel(containerId)
    }
  };
  var _cleanOneRowCarrousel = function(containerId) {
    var carrouselWrapper = $("#" + containerId).parent().parent();
    if($(carrouselWrapper).hasClass("image_carousel")) {
      $(carrouselWrapper).removeClass();
      $(carrouselWrapper).html("");
      $(carrouselWrapper).attr("id", containerId)
    }
  };
  var _forceShowPagination = function(containerId) {
    var parent = $("#" + containerId).parent().parent();
    if($(parent).hasClass("image_carousel")) {
      $(parent).find(".pagination").attr("style", "")
    }
  };
  var goToElement = function(carrouselDivId, element) {
    if($(element).is("IMG")) {
      element = $(element).parent()
    }
    $("#" + carrouselDivId).trigger("slideTo", element)
  };
  var advanceCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("next", no)
  };
  var backCarrousel = function(carrouselDivId, no) {
    $("#" + carrouselDivId).trigger("prev", no)
  };
  var insertElement = function(carrouselDivId, element, posc) {
    $("#" + carrouselDivId).trigger("insertItem", [element, posc])
  };
  return{createCarrousel:createCarrousel, cleanCarrousel:cleanCarrousel, goToElement:goToElement, advanceCarrousel:advanceCarrousel, backCarrousel:backCarrousel, insertElement:insertElement}
}(VISH, jQuery);
VISH.Editor.Clipboard = function(V, $, undefined) {
  var stack;
  var _lastTimestamp;
  var init = function() {
    stack = [null, null, null]
  };
  var copy = function(element, type) {
    if(element) {
      var params = {};
      switch(type) {
        case V.Constant.Clipboard.Slide:
          var slideType = V.Slides.getSlideType(element);
          switch(slideType) {
            case V.Constant.STANDARD:
              params.textAreas = V.Editor.Slides.copyTextAreasOfSlide(element);
              break;
            case V.Constant.FLASHCARD:
            ;
            case V.Constant.VTOUR:
              break;
            default:
              break
          }
          break;
        default:
          return
      }
      stack[0] = V.Utils.getOuterHTML($(element).clone()[0]);
      stack[1] = type;
      stack[2] = params;
      if(V.Status.getDevice().features.localStorage) {
        localStorage.setItem(V.Constant.Clipboard.LocalStorageStack, JSON.stringify(stack))
      }
    }
  };
  var paste = function() {
    if(_lastTimestamp) {
      var elapsed = (new Date).getTime() - _lastTimestamp;
      if(elapsed < 500) {
        return
      }
    }
    _lastTimestamp = (new Date).getTime();
    if(V.Status.getDevice().features.localStorage) {
      var storedStack = localStorage.getItem(V.Constant.Clipboard.LocalStorageStack);
      if(storedStack !== null) {
        var myStack = JSON.parse(storedStack)
      }
    }
    if(!myStack) {
      myStack = stack
    }
    if(!myStack[0]) {
      return
    }else {
      myStack[0] = $(myStack[0])[0]
    }
    switch(myStack[1]) {
      case V.Constant.Clipboard.Slide:
        var slideToCopy = $(myStack[0]).clone()[0];
        if(V.Slideset.isSlideset(slideToCopy)) {
          return
        }
        var options = {};
        if(myStack[2]) {
          if(myStack[2].textAreas) {
            options.textAreas = myStack[2].textAreas
          }
          if(myStack[2].JSON) {
            options.JSON = myStack[2].JSON
          }
        }
        V.Editor.Slides.copySlide(slideToCopy, options);
        break;
      default:
        break
    }
  };
  return{init:init, copy:copy, paste:paste}
}(VISH, jQuery);
VISH.Editor.Dummies = function(V, undefined) {
  var dummies = [];
  var init = function() {
    dummies = ["<article id='article_id_to_change' type='standard' template='t1'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' \t size='large'        class='t1_left editable vezone selectable'></div><div id='div_id_to_change' areaid='header' size='small' class='t1_header editable vezone selectable'></div><div id='div_id_to_change' areaid='subheader' size='extra_small' class='t1_subheader editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t2'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' \t size='large'        class='t2_left editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t3'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t3_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='large'  class='t3_left editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t4'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t4_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='large'  class='t4_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='right'   size='small'      class='t4_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t5'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t5_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='large'  class='t5_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='right'   size='large'      class='t5_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t6'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t6_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='medium' class='t6_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='center'  size='medium'     class='t6_center editable vezone selectable'></div>   <div id='div_id_to_change' areaid='right'      size='medium'    class='t6_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t7'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t7_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='medium' class='t7_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='center'  size='large'      class='t7_center editable vezone selectable'></div>   <div id='div_id_to_change' areaid='subheader'  size='small'     class='t7_subheader editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t8'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t8_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='small'  class='t8_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='center'  size='large'      class='t8_center editable vezone selectable'></div>   <div id='div_id_to_change' areaid='right'      size='small'     class='t8_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t9'  slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t9_header editable vezone selectable'></div>   <div id='div_id_to_change' areaid='left'    size='medium' class='t9_left editable vezone selectable'></div>     <div id='div_id_to_change' areaid='center'  size='medium'     class='t9_center editable vezone selectable'></div>   <div id='div_id_to_change' areaid='right'      size='medium'    class='t9_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t10' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='center'  size='large'        class='t10_center editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t11' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='center1' size='medium'       class='t11_center1 editable vezone selectable'></div> <div id='div_id_to_change' areaid='center2' size='medium' class='t11_center2 editable vezone selectable'></div> <div id='div_id_to_change' areaid='center3' size='medium'      class='t11_center3 editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t12' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left1'   size='medium'       class='t12_left1 editable vezone selectable'></div>   <div id='div_id_to_change' areaid='right1'  size='medium' class='t12_right1 editable vezone selectable'></div>  <div id='div_id_to_change' areaid='left2'   size='medium'      class='t12_left2 editable vezone selectable'></div>   <div id='div_id_to_change' areaid='right2'     size='medium'    class='t12_right2 editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t13' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t13_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='circle'  size='medium' class='t13_circle editable vezone selectable'></div>  <div id='div_id_to_change' areaid='left'    size='large'       class='t13_left editable vezone selectable'></div>    <div id='div_id_to_change' areaid='right'      size='medium'    class='t13_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t14' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='circle1' size='small'        class='t14_circle1 editable vezone selectable'></div> <div id='div_id_to_change' areaid='right1'  size='medium' class='t14_right1 editable vezone selectable'></div>  <div id='div_id_to_change' areaid='circle2' size='small'       class='t14_circle2 editable vezone selectable'></div> <div id='div_id_to_change' areaid='right2'     size='medium'    class='t14_right2 editable vezone selectable'></div> <div id='div_id_to_change' areaid='circle3' size='small' class='t14_circle3 editable vezone selectable'></div><div id='div_id_to_change' areaid='right3' size='medium' class='t14_right3 editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t15' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='left' \t size='medium'       class='t15_left editable vezone selectable'></div>    <div id='div_id_to_change' areaid='center'  size='medium' class='t15_center editable vezone selectable'></div>  <div id='div_id_to_change' areaid='right'   size='medium'      class='t15_right editable vezone selectable'></div>   <div id='div_id_to_change' areaid='center2'    size='large'     class='t15_center2 editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t16' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t16_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='left'    size='medium' class='t16_left editable vezone selectable'></div>    <div id='div_id_to_change' areaid='right'   size='large'       class='t16_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t17' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t17_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='left'    size='large'  class='t17_left editable vezone selectable'></div>    <div id='div_id_to_change' areaid='right'   size='medium'      class='t17_right editable vezone selectable'></div></article>", 
    "<article id='article_id_to_change' type='standard' template='t18' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='extra_small'  class='t18_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='center'  size='large'  class='t18_center editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t19' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='extra_small'  class='t19_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='center'  size='large'  class='t19_center editable vezone selectable'></div>  <div id='div_id_to_change' areaid='bottom'  size='extra_small' class='t19_bottom editable vezone selectable'></div></article>", "<article id='article_id_to_change' type='standard' template='t20' slidenumber='slidenumber_to_change'><div class='delete_slide'></div><img class='help_in_slide help_in_sslide' src='" + 
    V.ImagesPath + "vicons/helptutorial_circle_blank.png'/><div id='div_id_to_change' areaid='header'  size='small'        class='t20_header editable vezone selectable'></div>  <div id='div_id_to_change' areaid='left'    size='large'  class='t20_left editable vezone selectable'></div>    <div id='div_id_to_change' areaid='right1'  size='small'       class='t20_right1 editable vezone selectable'></div>  <div id='div_id_to_change' areaid='right2'     size='small'     class='t20_right2 editable vezone selectable'></div></article>"]
  };
  var getDummy = function(slideType, options) {
    var isSlideset = V.Slideset.isSlideset(slideType);
    if(isSlideset) {
      return V.Editor.Slideset.getDummy(slideType, options)
    }else {
      if(slideType == V.Constant.STANDARD) {
        if(options && options.subslide) {
          return _getDummyForSubslide(slideType, options)
        }else {
          return _getDummyForStandardSlide(slideType, options)
        }
      }
    }
  };
  var _getDummyForStandardSlide = function(slideType, options) {
    var dummy = dummies[parseInt(options.template, 10) - 1];
    return _replaceIds(dummy, options.slideNumber)
  };
  var _getDummyForSubslide = function(slideType, options) {
    var dummy = dummies[parseInt(options.template, 10) - 1];
    var slidesetId = $(options.slideset).attr("id");
    var subslideId = V.Utils.getId(slidesetId + "_article");
    var slideNumber = $(options.slideset).find("article").length + 1;
    return _replaceIds(dummy, slideNumber, subslideId)
  };
  var getScaffoldForSlide = function(slide, options) {
    var slideType = V.Slides.getSlideType(slide);
    var isSlideset = V.Slideset.isSlideset(slideType);
    if(isSlideset) {
      var dummy = V.Editor.Slideset.getDummy(slideType, options);
      if(dummy) {
        return _removeEditable(_replaceIds(dummy, options.slideNumber, slide.id))
      }
    }else {
      if(slideType == V.Constant.STANDARD) {
        return _getScaffoldForStandardSlide(slide, options)
      }
    }
  };
  var _getScaffoldForStandardSlide = function(slide, options) {
    var zoneIds = [];
    for(el in slide.elements) {
      zoneIds.push(slide.elements[el].id)
    }
    var dummy = dummies[parseInt(options.template, 10) - 1];
    return _removeEditable(_replaceIds(dummy, options.slideNumber, slide.id, zoneIds))
  };
  var _replaceIds = function(dummy, slideNumber, articleId, zoneIds) {
    var newDummy = dummy;
    var nextZoneId = 0;
    if(!articleId) {
      articleId = V.Utils.getId("article")
    }else {
      V.Utils.registerId(articleId)
    }
    if(newDummy.indexOf("article_id_to_change") != -1) {
      newDummy = newDummy.replace("article_id_to_change", articleId)
    }
    if(newDummy.indexOf("slidenumber_to_change") != -1) {
      newDummy = newDummy.replace("slidenumber_to_change", slideNumber)
    }
    while(newDummy.indexOf("div_id_to_change") != -1) {
      if(zoneIds) {
        var newZoneId = zoneIds[nextZoneId];
        nextZoneId++;
        V.Utils.registerId(newZoneId)
      }else {
        var newZoneId = V.Utils.getId(articleId + "_zone")
      }
      newDummy = newDummy.replace("div_id_to_change", newZoneId)
    }
    return newDummy
  };
  var _removeEditable = function(dummy) {
    return dummy.replace(/editable /g, "")
  };
  return{init:init, getDummy:getDummy, getScaffoldForSlide:getScaffoldForSlide}
}(VISH);
VISH.Editor.EPackage = function(V, $, undefined) {
  var uploadDivId = "tab_epackage_content";
  var init = function() {
    var tagList = $("#" + uploadDivId + " .tagList");
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='document[file]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='document[title]']").val(filterFilePath);
      _resetUploadFields();
      $(tagList).parent().show();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_package_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='document[file]']").val())[0]) {
        event.preventDefault()
      }else {
        var description = "Uploaded by " + V.User.getName() + " via ViSH Editor";
        $("#" + uploadDivId + " input[name='document[description]']").val(description);
        $("#" + uploadDivId + " input[name='document[owner_id]']").val(V.User.getId());
        $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
        $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadEPackagesPath);
        var tagList = $("#" + uploadDivId + " .tagList");
        $("#" + uploadDivId + " input[name='document[tag_list]']").val(V.Editor.Utils.convertToTagsArray($(tagList).tagit("tags")));
        $(tagList).parent().hide();
        $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      _processResponse(xhr.responseText);
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, error:function(error) {
      V.Debugging.log("Upload error");
      V.Debugging.log(error);
      V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.ePackageError1"))
    }})
  };
  var onLoadTab = function() {
    var tagList = $("#" + uploadDivId + " .tagList");
    $(tagList).parent().hide();
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='document[file]']").val("");
    _resetUploadFields();
    V.Editor.API.requestTags(_onTagsReceived)
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%");
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList)[0].children.length !== 0) {
      $(tagList).tagit("reset")
    }
  };
  var _onTagsReceived = function(data) {
    var tagList = $("#" + uploadDivId + " .tagList");
    if($(tagList).children().length == 0) {
      var config = V.Configuration.getConfiguration();
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:config.tagsSettings.maxLength, maxTags:config.tagsSettings.maxTags, triggerKeys:config.tagsSettings.triggerKeys, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var _processResponse = function(response) {
    try {
      var jsonResponse = JSON.parse(response);
      if(jsonResponse.src) {
        if(V.Police.validateObject(jsonResponse.src)[0]) {
          var presentation = _generatePresentationWithEPackage(jsonResponse);
          V.Editor.Presentation.previewPresentation(presentation);
          return
        }
      }
    }catch(e) {
    }
    V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.ePackageError1"))
  };
  var _generatePresentationWithEPackage = function(ePackage) {
    var element = {};
    element.type = "object";
    element.body = '<iframe src="' + ePackage.src + '" objecttype="' + ePackage.type + '"></iframe>';
    element.style = "position: relative; width:100%; height:100%; top:0%; left:0%;";
    var elements = [element];
    var options = {template:"t10"};
    return V.Editor.Presentation.generatePresentationScaffold(elements, options)
  };
  return{init:init, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.EVideo = function(V, $, undefined) {
  var initialized = false;
  var eVideos;
  var balls;
  var hiddenLinkToAddVideos;
  var hiddenLinkToAddChapters;
  var _cChapter;
  var TIME_DELTA = 1E-4;
  var init = function() {
    if(!initialized) {
      eVideos = {};
      balls = {};
      _loadEvents();
      initialized = true
    }
  };
  var _loadEvents = function() {
    hiddenLinkToAddVideos = $('<a href="#video_fancybox" style="display:none"></a>');
    $(hiddenLinkToAddVideos).fancybox({"autoDimensions":false, "width":800, "height":600, "scrolling":"no", "padding":0, "onStart":function(data) {
      V.Editor.Video.setAddContentMode(V.Constant.EVIDEO);
      V.Editor.Utils.loadTab(V.Editor.Video.getDefaultTab())
    }, "onClosed":function(data) {
      V.Editor.Video.setAddContentMode(V.Constant.NONE)
    }});
    $(document).on("click", "div.change_evideo_button", function() {
      onChangeVideo()
    });
    $(document.body).append(hiddenLinkToAddVideos);
    hiddenLinkToAddChapters = $('<a href="#chapters_fancybox" style="display:none"></a>');
    $(hiddenLinkToAddChapters).fancybox({"autoDimensions":false, "height":330, "width":400, "scrolling":"no", "showCloseButton":false, "padding":0, "onStart":function(data) {
      var currentVideo = _getCurrentVideo();
      if(currentVideo) {
        $("#eVideoChaptersTextArea").val("");
        $("#eVideoChaptersBall_wrapper").hide();
        var videoDuration = V.Video.getDuration(currentVideo);
        var formatedDuration = V.Utils.fomatTimeForMPlayer(videoDuration);
        var significativeNumbers = parseInt($(V.Slides.getCurrentSlide()).attr("sN"));
        if(videoDuration) {
          $("#eVideochapters_duration_value").val(formatedDuration);
          $("#eVideochapters_duration_value").attr("duration", videoDuration);
          $("#eVideochapters_duration_value").attr("sN", significativeNumbers);
          if(videoDuration < 60 * 60) {
            _disableTimeInput($("#eVideochapters_hours"))
          }else {
            _enableTimeInput($("#eVideochapters_hours"))
          }
          if(videoDuration < 60) {
            _disableTimeInput($("#eVideochapters_minutes"))
          }else {
            _enableTimeInput($("#eVideochapters_minutes"))
          }
          _enableTimeInput($("#eVideochapters_seconds"));
          _onChapterTimeChange()
        }
        var chapter = _getCurrentChapter();
        if(typeof chapter != "undefined") {
          var titleName = chapter.name;
          if(typeof titleName == "string") {
            $("#eVideoChaptersTextArea").val(titleName)
          }
          var ball = balls[chapter.ballId];
          if(typeof ball != "undefined" && typeof ball.letter == "string") {
            $("#eVideoChaptersBall_wrapper").find("span").html(VISH.I18n.getTrans("i.ItemAndBall", {letter:"<span class='letterInChapterDialog'>" + ball.letter + "</span>"}));
            $("#eVideoChaptersBall_wrapper").show()
          }
          var cTime = chapter.etime;
          if(isNaN(cTime)) {
            cTime = 0
          }
          var durationsPerUnit = V.Utils.iso8601Parser.getDurationFromISOPerUnit("PT" + cTime + "S", true);
          $("#eVideochapters_hours").val(durationsPerUnit[4]);
          $("#eVideochapters_minutes").val(durationsPerUnit[5]);
          $("#eVideochapters_seconds").val(durationsPerUnit[6]);
          _onChapterTimeChange()
        }
      }
    }, "onComplete":function(data) {
    }, "onClosed":function(data) {
      $("ul.evideoChapters li").removeClass("selected");
      _cChapter = undefined
    }});
    $(document).on("click", "button.evideoAddChapterButton:not(.addSlideButtonDisabled)", function() {
      $("ul.evideoChapters li").removeClass("selected");
      $(hiddenLinkToAddChapters).trigger("click")
    });
    $(document).on("click", ".evideoPlayButtonWrapper", V.EVideo.onClickToggleVideo);
    $(document).on("click", "div.eVideoChapterActions i.icon-edit", _onEditChapter);
    $(document).on("click", "div.eVideoChapterActions i.icon-trash", _onRemoveChapter);
    $(document).on("click", "div.eVideoChapterActions i.icon-arrow-down", _onDownChapter);
    $(document).on("click", "div.eVideoChapterActions i.icon-arrow-up", _onUpChapter);
    $(document).on("click", "div.eVideoChapterInfo", _onClickChapterInfo);
    $(document).on("keyup", "#eVideochapters_hours, #eVideochapters_minutes, #eVideochapters_seconds", _onChapterTimeChange);
    $(document).on("change", "#eVideochapters_hours, #eVideochapters_minutes, #eVideochapters_seconds", _onChapterTimeChange);
    $(document).on("click", '#eVideoChaptersButtons_wrapper a[buttonaction="Add"]', _onAddChapter);
    $(document).on("click", '#eVideoChaptersButtons_wrapper a[buttonaction="Cancel"]', _onCancelAddChapter)
  };
  var onChangeVideo = function() {
    var eVideoDOM = V.Slides.getCurrentSlide();
    if(!_isVideoCreated(eVideoDOM)) {
      _onChangeVideo(eVideoDOM)
    }else {
      var options = {};
      options.width = 600;
      options.height = 135;
      options.notificationIconSrc = getThumbnailURL();
      options.notificationIconClass = "notificationIconDelete";
      options.text = V.I18n.getTrans("i.eVideoChangeNotification");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.no");
      button1.callback = function() {
        $.fancybox.close()
      };
      var button2 = {};
      button2.text = V.I18n.getTrans("i.yes");
      button2.callback = function() {
        _onChangeVideo(eVideoDOM)
      };
      options.buttons = [button1, button2];
      V.Utils.showDialog(options)
    }
  };
  var _onChangeVideo = function(eVideoDOM) {
    V.Editor.setCurrentContainer($(eVideoDOM).find(".evideoBody"));
    $(hiddenLinkToAddVideos).trigger("click")
  };
  var getDummy = function(slidesetId, options) {
    var videoBox = V.EVideo.renderVideoBoxDummy();
    $(videoBox).attr("id", V.Utils.getId(slidesetId + "_videoBox"));
    var eVideoBody = $(videoBox).find(".evideoBody");
    $(eVideoBody).css("margin-top", "7.5%");
    $(eVideoBody).html('<div class="change_evideo_button"></div>');
    var indexBox = V.EVideo.renderIndexBoxDummy();
    $(indexBox).find(".evideoIndexSide").html("");
    var eVideoIndexBody = $(indexBox).find(".evideoIndexBody");
    var eVideoIndexBodyActions = $("<div class='evideoIndexBodyActions'></div>");
    $(eVideoIndexBodyActions).html('<button type="button" class="btn btn-small slidesScrollbarButton evideoAddChapterButton addSlideButtonDisabled"><i class="icon-plus"></i><span>' + V.I18n.getTrans("i.AddTimestampLink") + "</span></button>");
    $(eVideoIndexBody).prepend(eVideoIndexBodyActions);
    return"<article id='" + slidesetId + "' type='" + V.Constant.EVIDEO + "' slidenumber='" + options.slideNumber + "'><div class='delete_slide'></div><img class='help_in_slide help_in_evideo' src='" + V.ImagesPath + "vicons/helptutorial_circle_blank.png'/>" + V.Utils.getOuterHTML(videoBox) + V.Utils.getOuterHTML(indexBox) + "</article>"
  };
  var _drawEVideo = function(eVideoJSON, eVideoDOM, videoToRender) {
    if(!eVideoJSON) {
      eVideoJSON = {};
      eVideoJSON.pois = []
    }
    var eVideoId = $(eVideoDOM).attr("id");
    if(typeof eVideos[eVideoId] == "undefined") {
      eVideos[eVideoId] = eVideoJSON;
      eVideos[eVideoId].id = eVideoId;
      eVideos[eVideoId].balls = [];
      $(eVideos[eVideoId].pois).each(function(index, poi) {
        eVideos[eVideoId].balls.push(poi)
      });
      eVideos[eVideoId].balls = eVideos[eVideoId].balls.filter(function(ball) {
        return typeof ball.etime != "undefined" && (!isNaN(parseFloat(ball.etime)) && parseFloat(ball.etime) >= 0)
      }).map(function(ball) {
        ball.letter = _getLetterForBall(eVideos[eVideoId], ball);
        ball.etime = parseFloat(ball.etime);
        ball.eVideoId = eVideoId;
        return ball
      }).sort(function(A, B) {
        return A.etime > B.etime
      })
    }
    _updateBallsArray(eVideoId);
    if(eVideos[eVideoId].drawed === true) {
      return
    }
    eVideos[eVideoId].drawed = true;
    if(typeof videoToRender != "undefined") {
      $(eVideoDOM).find(".evideoBody").html("")
    }
    var eVideoObject = typeof videoToRender != "undefined" ? videoToRender : _getEVideoObjectFromJSON(eVideos[eVideoId]);
    if(typeof eVideoObject != "undefined") {
      _renderVideo(eVideoObject, eVideoDOM)
    }
  };
  var _getLetterForBall = function(eVideoJSON, ball) {
    var letter = undefined;
    if(typeof ball.slide_id == "undefined") {
      return letter
    }
    var slideId = ball.slide_id;
    $(eVideoJSON.slides).each(function(index, slide) {
      if(slide.id === slideId) {
        letter = String.fromCharCode(64 + parseInt(index + 1));
        return false
      }
    });
    return letter
  };
  var _getEVideoObjectFromJSON = function(eVideoJSON) {
    var videoJSON = eVideoJSON.video;
    if(typeof videoJSON == "undefined") {
      return undefined
    }
    switch(videoJSON.type) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        var options = {};
        var videoTag = V.Video.HTML5.renderVideoFromSources(V.Video.HTML5.getSourcesFromJSON(videoJSON), options);
        return videoTag;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        return videoJSON.source;
      default:
        return undefined
    }
  };
  var onVideoSelected = function(contentToAdd, eVideoDOM) {
    if(!eVideoDOM) {
      eVideoDOM = V.Slides.getCurrentSlide()
    }
    if($(eVideoDOM).attr("type") === V.Constant.EVIDEO) {
      if(_isVideoCreated(eVideoDOM)) {
        var eVideoId = $(eVideoDOM).attr("id");
        _removeAllBalls(eVideoDOM);
        eVideos[eVideoId].drawed = false;
        eVideos[eVideoId].pois = [];
        eVideos[eVideoId].video = undefined;
        _drawEVideo(undefined, eVideoDOM, contentToAdd)
      }else {
        _renderVideo(contentToAdd, eVideoDOM)
      }
    }
    $.fancybox.close()
  };
  var _renderVideo = function(videoObj, eVideoDOM) {
    $(eVideoDOM).find("div.change_evideo_button").remove();
    $(eVideoDOM).find("div.evideoBody").css("margin-top", "0px");
    var videoBody = $(eVideoDOM).find(".evideoBody");
    var loadingContainer = $("<div class='loadingEVideoContainer'></div>");
    $(videoBody).append(loadingContainer);
    $(videoBody).addClass("loadingEVideoContainerWrapper");
    V.Utils.Loader.startLoadingInContainer(loadingContainer);
    var videoBody = $(eVideoDOM).find(".evideoBody");
    var eVideoId = $(eVideoDOM).attr("id");
    var objectInfo = V.Object.getObjectInfo(videoObj);
    switch(objectInfo.type) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        var sources = typeof objectInfo.source == "object" ? objectInfo.source : [{src:objectInfo.source}];
        var options = {};
        options.controls = false;
        options.poster = false;
        options.onVideoReady = "VISH.Editor.EVideo.onHTML5VideoReady";
        options.extraAttrs = {"videoType":V.Constant.MEDIA.HTML5_VIDEO, "eVideoId":eVideoId};
        options.loadSources = false;
        var video = $(V.Video.HTML5.renderVideoFromSources(sources, options));
        $(videoBody).append(video);
        V.Video.HTML5.addSourcesToVideoTag(sources, video, {timestamp:true});
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        var source = objectInfo.source;
        var videoWrapper = $(V.Video.Youtube.renderVideoFromSource(source));
        $(videoBody).attr("source", $(videoWrapper).attr("source"));
        $(videoBody).attr("ytcontainerid", $(videoWrapper).attr("ytcontainerid"));
        V.Utils.addTempShown(eVideoDOM);
        V.Video.Youtube.loadYoutubeObject($(videoBody), {controls:false, onReadyCallback:function(event) {
          V.Utils.removeTempShown(eVideoDOM);
          var iframe = event.target.getIframe();
          var video = $("#" + iframe.id);
          $(video).attr("videoType", V.Constant.MEDIA.YOUTUBE_VIDEO);
          $(video).attr("eVideoId", eVideoId);
          _onVideoReady(video)
        }, onPlayerError:function() {
          V.Utils.removeTempShown(eVideoDOM)
        }});
        break;
      default:
        return
    }
  };
  var onHTML5VideoReady = function(video) {
    if(typeof video != "undefined" && (video.readyState == 4 || video.readyState == 3)) {
      _onVideoReady(video)
    }
  };
  var _onVideoReady = function(video) {
    var videoBody = $(video).parent();
    var videoBox = $(videoBody).parent();
    var eVideoDOM = $(videoBox).parent();
    if($(eVideoDOM).length === 0) {
      var t_eVideoId = $(video).attr("evideoid");
      var t_eVideoDOM = $("#" + t_eVideoId);
      var t_videoBox = $(t_eVideoDOM).find(".evideoBox");
      var t_video = V.EVideo.getVideoFromVideoBox(t_videoBox);
      if($(t_video).attr("loaded") != "true") {
        setTimeout(function() {
          _onVideoReady(video)
        }, 500)
      }
      return
    }
    $(video).attr("loaded", "true");
    var eVideoId = $(eVideoDOM).attr("id");
    var videoHeader = $(videoBox).find(".evideoHeader");
    var videoFooter = $(videoBox).find(".evideoFooter");
    var videoType = $(video).attr("videotype");
    var loadingContainer = $(videoBody).find(".loadingEVideoContainer");
    $(loadingContainer).remove();
    $(videoBody).removeClass("loadingEVideoContainerWrapper");
    V.Utils.addTempShown(eVideoDOM);
    var durationDOM = $(videoHeader).find(".evideoDuration");
    var videoDuration = V.Video.getDuration(video);
    var formatedDuration = V.Utils.fomatTimeForMPlayer(videoDuration);
    $(durationDOM).html(formatedDuration);
    var significativeNumbers = formatedDuration.split(":").join("").length;
    $(video).attr("sN", significativeNumbers);
    $(eVideoDOM).attr("sN", significativeNumbers);
    V.EVideo.fitVideoInVideoBox(videoBox);
    $(videoHeader).show();
    $(videoFooter).show();
    eVideos[eVideoId].balls = eVideos[eVideoId].balls.filter(function(ball) {
      return ball.etime <= videoDuration
    });
    _updateBallsArray(eVideoId);
    $(eVideoDOM).find(".evideoAddChapterButton").removeClass("addSlideButtonDisabled");
    V.EVideo.loadEventsForControls(videoBox);
    V.Video.onTimeUpdate(video, V.EVideo.onTimeUpdate);
    V.Video.onStatusChange(video, V.EVideo.onStatusChange);
    _renderIndex(eVideoDOM, eVideos[eVideoId]);
    _renderBalls(eVideoDOM, eVideos[eVideoId]);
    if(videoType == V.Constant.MEDIA.YOUTUBE_VIDEO) {
      V.EVideo.onTimeUpdate(video, 0)
    }
    V.Utils.removeTempShown(eVideoDOM)
  };
  var _renderIndex = function(eVideoDOM, eVideoJSON) {
    var indexBody = $(eVideoDOM).find(".evideoIndexBox");
    var eVideoChapters = $(indexBody).find(".evideoChapters");
    $(eVideoChapters).html("");
    V.EVideo.renderIndex(eVideoDOM, eVideoJSON);
    var chapterList = $(eVideoDOM).find(".evideoChapters li");
    $(chapterList).each(function(value, li) {
      var infoDiv = $("<div class='eVideoChapterInfo'></div>");
      $(infoDiv).html($(li).html());
      var actionDiv = $("<div class='eVideoChapterActions'></div>");
      var editButton = $('<p title="edit"><i class="icon-button icon-edit"></i></p>');
      var removeButton = $('<p class="icon-trash-container" title="remove"><i class="icon-button icon-trash"></i></p>');
      $(actionDiv).prepend(removeButton);
      $(actionDiv).prepend(editButton);
      var prevChapter = chapterList[value - 1];
      var nextChapter = chapterList[value + 1];
      var arrowUp = typeof prevChapter != "undefined" && Math.round($(prevChapter).attr("etime")) == Math.round($(li).attr("etime"));
      var arrowDown = typeof nextChapter != "undefined" && Math.round($(nextChapter).attr("etime")) == Math.round($(li).attr("etime"));
      var arrows = arrowUp || arrowDown;
      if(arrows) {
        var arrows = $('<p class="icon-arrows-container"></p>');
        if(arrowUp) {
          $(arrows).append('<i title="move up" class="icon-button icon-arrow-up"></i>')
        }
        if(arrowDown) {
          $(arrows).append('<i title="move down" class="icon-button icon-arrow-down"></i>')
        }
        $(actionDiv).append(arrows)
      }
      $(li).html("");
      $(li).append(infoDiv);
      $(li).append(actionDiv);
      var ballId = $(li).attr("ballid");
      $(li).attr("id", ballId);
      var ballLetter = balls[ballId].letter;
      $(li).find(".eVideoIndexEntryNumber").html(value + 1 + " [" + V.Utils.fomatTimeForMPlayer(balls[ballId].etime, parseInt($(eVideoDOM).attr("sN"))) + "]" + (typeof ballLetter == "string" ? " (" + ballLetter + ") " : "") + ". ");
      if(arrows) {
        $(li).find("div.eVideoChapterInfo").css("min-height", "60px")
      }
    })
  };
  var _updateBalls = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    _reOrderBalls(eVideoDOM, eVideos[eVideoId]);
    _renderBalls(eVideoDOM, eVideos[eVideoId])
  };
  var _reOrderBalls = function(eVideoDOM, eVideoJSON) {
    eVideos[eVideoJSON.id].balls.sort(function(A, B) {
      return A.etime > B.etime
    }).map(function(ball) {
      ball.letter = _getLetterForBall(eVideos[eVideoJSON.id], ball);
      return ball
    });
    _renderIndex(eVideoDOM, eVideos[eVideoJSON.id])
  };
  var _renderBalls = function(eVideoDOM, eVideoJSON) {
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var videoDOM = V.EVideo.getVideoFromVideoBox(videoBox);
    var duration = V.Video.getDuration(videoDOM);
    $(eVideoJSON.balls).each(function(index, ball) {
      if(ball.drawed != true) {
        ball.drawed = false
      }
    });
    $(eVideoJSON.balls).each(function(index, ball) {
      if(ball.drawed != true) {
        _drawBall(eVideoDOM, eVideoJSON, ball, duration)
      }else {
        _updateBall(eVideoDOM, eVideoJSON, ball, duration)
      }
    });
    var videoFooter = $(videoBox).find(".evideoFooter");
    $(videoBox).find(".ballSlider .ui-slider-handle").height($(videoFooter).height())
  };
  var _drawBall = function(eVideoDOM, eVideoJSON, ball, duration) {
    if(ball.etime > duration) {
      return
    }
    var left = ball.etime * 100 / duration;
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var eVideoControls = $(videoBox).find("div.evideoControls");
    var ballSliderWrapper = $("<div ballid='" + ball.id + "' class='ballSliderWrapper'><div class='ballSlider'></div></div>");
    $(eVideoControls).find(".evideoProgressBarSliderWrapper").append(ballSliderWrapper);
    var ballSlider = $(ballSliderWrapper).find(".ballSlider");
    $(ballSlider).slider({orientation:"horizontal", range:"min", min:0, max:100, value:left, step:0.1, slide:function(event, ui) {
      var ballTimeSpan = $(event.target).find("span.ballTimeSpan");
      var newTime = parseFloat($(ballTimeSpan).attr("videoduration")) * ui.value / 100;
      $(ballTimeSpan).html(V.Utils.fomatTimeForMPlayer(newTime))
    }, change:function(event, ui) {
      var ballTimeSpan = $(event.target).find("span.ballTimeSpan");
      var newTime = parseFloat($(ballTimeSpan).attr("videoduration")) * ui.value / 100;
      $(ballTimeSpan).html(V.Utils.fomatTimeForMPlayer(newTime))
    }, start:function(event, ui) {
      var ballId = $(event.target).find("span.ballTimeSpan").attr("ballid");
      var selectedChapter = $(eVideoDOM).find("ul.evideoChapters").find("li[ballid='" + ballId + "']");
      $(selectedChapter).addClass("active");
      _bringBallToFront(balls[ballId])
    }, stop:function(event, ui) {
      var ballTimeSpan = $(event.target).find("span.ballTimeSpan");
      var newTime = parseFloat($(ballTimeSpan).attr("videoduration")) * ui.value / 100;
      var ballId = $(ballTimeSpan).attr("ballid");
      var ball = balls[ballId];
      ball.etime = newTime;
      var selectedChapter = $(eVideoDOM).find("ul.evideoChapters").find("li[ballid='" + ballId + "']");
      $(selectedChapter).removeClass("active");
      _reOrderBalls(eVideoDOM, eVideos[ball.eVideoId])
    }, create:function(event, ui) {
      var ballWrapper = $("<div class='ballWrapper' layer='1' ballid='" + ball.id + "'><div class='ballLine'></div></div>");
      if(typeof ball.slide_id != "undefined") {
        var ballImg = $("<div class='ballImg' ballTime='" + ball.etime + "'><span class='ballLetterSpan'>" + ball.letter + "</span></div>");
        $(ballWrapper).append(ballImg);
        $(ballWrapper).attr("slide_id", ball.slide_id)
      }
      var ballTimeSpan = $("<span class='ballTimeSpan' eVideoId='" + ball.eVideoId + "' ballid='" + ball.id + "' balltime='" + ball.etime + "' videoDuration='" + duration + "'>" + V.Utils.fomatTimeForMPlayer(ball.etime) + "</span>");
      $(ballWrapper).append(ballTimeSpan);
      var handler = $(ballSlider).find(".ui-slider-handle");
      $(handler).append(ballWrapper)
    }});
    ball.drawed = true;
    balls[ball.id].drawed = true
  };
  var _updateBall = function(eVideoDOM, eVideoJSON, ball, duration) {
    var left = Math.min(100, ball.etime * 100 / duration);
    var ballSliderWrapper = $(eVideoDOM).find(".ballSliderWrapper[ballid='" + ball.id + "']");
    var ballSlider = $(ballSliderWrapper).find(".ballSlider");
    var isSliderInitialized = $(ballSlider).hasClass("ui-slider");
    if(!isSliderInitialized) {
      return _drawBall(eVideoDOM, eVideoJSON, ball, duration)
    }
    var sliderValue = $(ballSlider).slider("value");
    if(Math.abs(left - sliderValue) > 0.05) {
      $(ballSlider).slider("value", left)
    }
    if(typeof ball.slide_id != "undefined") {
      var ballLetterSpan = $(ballSliderWrapper).find("span.ballLetterSpan");
      $(ballLetterSpan).html(ball.letter)
    }
  };
  var _onAddChapter = function() {
    var chaptersFancy = $("#chapters_fancybox");
    var title = $(chaptersFancy).find("#eVideoChaptersTextArea").val();
    var time = _getEditableChapterTime();
    if(typeof title != "string" || title.trim() == "") {
      title = V.I18n.getTrans("i.Untitled")
    }
    var video = _getCurrentVideo();
    var duration = V.Video.getDuration(video);
    time = Math.max(0, Math.min(duration, time));
    var eVideoDOM = V.Slides.getCurrentSlide();
    var eVideoId = $(eVideoDOM).attr("id");
    var chapter = _getCurrentChapter();
    var _isEditingExistingChapter = typeof _getCurrentDOMChapter() != "undefined" && typeof chapter != "undefined";
    if(_isEditingExistingChapter) {
      var ballId = chapter.ballId;
      balls[ballId].name = title;
      if(Math.round(time) != Math.round(balls[ballId].etime)) {
        balls[ballId].etime = time
      }
      _updateBalls(eVideoDOM)
    }else {
      var ball = {};
      ball.id = V.Utils.getId(eVideoId + "_poi");
      ball.eVideoId = eVideoId;
      ball.name = title;
      ball.etime = time;
      if(typeof chapter != "undefined" && typeof chapter.slideId != "undefined") {
        ball.slide_id = chapter.slideId
      }
      _addBall(ball)
    }
    _cChapter = undefined;
    $.fancybox.close();
    return false
  };
  var _onCancelAddChapter = function(event) {
    var chapter = _getCurrentChapter();
    if(typeof chapter != "undefined" && typeof chapter.slideId != "undefined") {
      _drawPois(V.Slides.getCurrentSlide())
    }
    _cChapter = undefined;
    $.fancybox.close();
    return false
  };
  var _onEditChapter = function(event) {
    var chapter = $("ul.evideoChapters li").has(event.target);
    $("ul.evideoChapters li").removeClass("selected");
    $(chapter).addClass("selected");
    _updateCChapterFromDOM();
    $(hiddenLinkToAddChapters).trigger("click")
  };
  var _onRemoveChapter = function(event) {
    var chapter = $("ul.evideoChapters li").has(event.target);
    var options = {};
    options.width = 375;
    options.height = 135;
    options.notificationIconSrc = V.ImagesPath + "icons/timestamp_delete.png";
    options.notificationIconClass = "notificationIconDeleteTimestampLink";
    options.text = V.I18n.getTrans("i.areyousureNotification");
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    var button2 = {};
    button2.text = V.I18n.getTrans("i.delete");
    button2.callback = function() {
      _removeChapter(chapter);
      $.fancybox.close()
    };
    options.buttons = [button1, button2];
    V.Utils.showDialog(options)
  };
  var _removeChapter = function(chapter) {
    var ball = balls[$(chapter).attr("id")];
    if(typeof ball == "object") {
      _removeBall(ball)
    }
  };
  var _onDownChapter = function(event) {
    var chapter = $("ul.evideoChapters li").has(event.target);
    _exchangeChapters(chapter, $(chapter).next())
  };
  var _onUpChapter = function(event) {
    var chapter = $("ul.evideoChapters li").has(event.target);
    _exchangeChapters(chapter, $(chapter).prev())
  };
  var _exchangeChapters = function(chapterA, chapterB) {
    var ballA = balls[$(chapterA).attr("id")];
    var ballB = balls[$(chapterB).attr("id")];
    var timeBallA = ballA.etime;
    var timeBallB = ballB.etime;
    if(Math.round(timeBallA) != Math.round(timeBallB)) {
      return
    }
    var eVideoId = ballA.eVideoId;
    var eVideoDOM = $("#" + eVideoId);
    var timeOrigin;
    var lastChangedTime;
    var chapterAisBefore = $(chapterA).attr("id") === $(chapterB).prev().attr("id");
    if(chapterAisBefore) {
      timeOrigin = timeBallA;
      timeBallA = timeBallB + TIME_DELTA;
      lastChangedTime = timeBallA
    }else {
      timeOrigin = timeBallB;
      timeBallB = timeBallA + TIME_DELTA;
      lastChangedTime = timeBallB
    }
    eVideos[eVideoId].balls.map(function(ball) {
      if(ball.id === ballA.id) {
        ball.etime = timeBallA;
        return true
      }
      if(ball.id === ballB.id) {
        ball.etime = timeBallB;
        return true
      }
      if(ball.etime > timeOrigin && ball.etime < lastChangedTime) {
        ball.etime = lastChangedTime + TIME_DELTA;
        lastChangedTime = ball.etime
      }
    });
    _updateBallsArray(eVideoId);
    _updateBalls(eVideoDOM)
  };
  var _onClickChapterInfo = function(event) {
    var chapter = $("ul.evideoChapters li").has(event.target);
    var ballId = $(chapter).attr("ballid");
    _bringBallToFront(balls[ballId])
  };
  var _bringBallToFront = function(ball) {
    if(typeof ball == "undefined") {
      return
    }
    var eVideoDOM = $("#" + ball.eVideoId);
    var ballSliderWrapper = $(eVideoDOM).find("div.ballSliderWrapper[ballid='" + ball.id + "']");
    if(ballSliderWrapper.length > 0) {
      $(eVideoDOM).find("div.ballSliderWrapper").attr("layer", 2);
      $(ballSliderWrapper).attr("layer", 1);
      _updateBallLayers(eVideoDOM)
    }
  };
  var _updateBallLayers = function(eVideoDOM) {
    $(eVideoDOM).find("div.ballSliderWrapper").each(function(value, ballSliderWrapper) {
      $(ballSliderWrapper).css("z-index", 11 - parseInt($(ballSliderWrapper).attr("layer")))
    })
  };
  _addBallToCurrentTime = function(slideId) {
    var eVideoDOM = V.Slides.getCurrentSlide();
    var eVideoId = $(eVideoDOM).attr("id");
    if(_isVideoCreated(eVideoDOM)) {
      var cVideo = _getCurrentVideo();
      var cTime = Math.max(0, Math.min(Math.round(V.Video.getCurrentTime(cVideo)), V.Video.getDuration(cVideo)))
    }
    _cChapter = {};
    _cChapter.name = "";
    _cChapter.etime = typeof cTime == "number" ? cTime : 0;
    _cChapter.slideId = slideId;
    $("ul.evideoChapters li").removeClass("selected");
    $(hiddenLinkToAddChapters).trigger("click")
  };
  var _addBall = function(ball) {
    var eVideoDOM = $("#" + ball.eVideoId);
    eVideos[ball.eVideoId].balls.push(ball);
    balls[ball.id] = ball;
    _updateBalls(eVideoDOM)
  };
  var _removeBall = function(ball) {
    var eVideoId = ball.eVideoId;
    var eVideoDOM = $("#" + eVideoId);
    var ballWrapper = $(eVideoDOM).find(".ballWrapper[ballid='" + ball.id + "']");
    if(ballWrapper.length === 1) {
      $(ballWrapper).remove()
    }
    var chapter = $("#" + ball.id);
    $(chapter).remove();
    $(eVideos[eVideoId].balls).each(function(index, eball) {
      if(ball.id === eball.id) {
        eVideos[eVideoId].balls.splice(index, 1);
        return false
      }
    });
    delete balls[ball.id];
    _updateBalls(eVideoDOM);
    if(typeof ball.slide_id != "undefined") {
      _drawPois(eVideoDOM)
    }
  };
  var _removeAllBalls = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    var ballWrappers = $(eVideoDOM).find(".ballWrapper[ballid]");
    $(ballWrappers).each(function(index, ballWrapper) {
      var chapter = $("#" + $(ballWrapper).attr("ballid"));
      $(chapter).remove()
    });
    $(ballWrappers).remove();
    $(eVideos[eVideoId].balls).each(function(index, eball) {
      delete balls[eball.id]
    });
    eVideos[eVideoId].balls = [];
    _drawPois(eVideoDOM)
  };
  var _getCurrentChapter = function(updateFromDOM) {
    return _cChapter
  };
  var _getCurrentDOMChapter = function() {
    return $(V.Slides.getCurrentSlide()).find(".evideoChapters li.selected")[0]
  };
  var _updateCChapterFromDOM = function() {
    var cDOMChapter = _getCurrentDOMChapter();
    if(typeof cDOMChapter != "undefined") {
      _cChapter = {};
      _cChapter.name = $(cDOMChapter).find(".eVideoIndexEntryBody").html();
      _cChapter.ballId = $(cDOMChapter).attr("ballid");
      try {
        _cChapter.etime = Math.round(parseFloat($(cDOMChapter).attr("etime")))
      }catch(e) {
      }
    }
  };
  var _disableTimeInput = function(input) {
    $(input).val(0);
    $(input).attr("readonly", "readonly");
    $(input).parent().find(".tlt_input_title").addClass("tlt_input_title_disabled")
  };
  var _enableTimeInput = function(input) {
    $(input).val(0);
    $(input).removeAttr("readonly");
    $(input).parent().find(".tlt_input_title").removeClass("tlt_input_title_disabled")
  };
  var _onChapterTimeChange = function(event) {
    if(event && event.keyCode === 13) {
      $(event.target).blur();
      return
    }
    var cTime = _getEditableChapterTime();
    if(typeof cTime == "number") {
      cTime = Math.max(0, Math.min(cTime, parseFloat($("#eVideochapters_duration_value").attr("duration"))));
      var sN = $("#eVideochapters_duration_value").attr("sN");
      $("#eVideochapters_current_value").val(V.Utils.fomatTimeForMPlayer(cTime, sN))
    }else {
      $("#eVideochapters_current_value").val("")
    }
  };
  var _getEditableChapterTime = function() {
    var hours = $("#eVideochapters_hours").val();
    var minutes = $("#eVideochapters_minutes").val();
    var seconds = $("#eVideochapters_seconds").val();
    if(jQuery.isNumeric(hours) && (jQuery.isNumeric(minutes) && jQuery.isNumeric(seconds))) {
      hours = parseInt(hours);
      minutes = parseInt(minutes);
      seconds = parseInt(seconds);
      return(hours * 60 + minutes) * 60 + seconds
    }
    return undefined
  };
  var draw = function(slidesetJSON, scaffoldDOM) {
    _drawEVideo(slidesetJSON, scaffoldDOM)
  };
  var onEnterSlideset = function(eVideoDOM) {
    V.Utils.removeTempShown(eVideoDOM)
  };
  var onLeaveSlideset = function(eVideoDOM) {
    V.Utils.addTempShown(eVideoDOM)
  };
  var loadSlideset = function(eVideoDOM) {
    var eVideoBox = $(eVideoDOM).find(".evideoBox");
    if($(eVideoBox).attr("loaded") == "false") {
      var eVideoBox = $(eVideoDOM).find(".evideoBox");
      V.Utils.removeTempShown(eVideoBox)
    }
    $(eVideoBox).attr("loaded", "true");
    $("#subslides_list").find("div.draggable_sc_div[ddend='scrollbar']").show()
  };
  var unloadSlideset = function(eVideoDOM) {
    var eVideoBox = $(eVideoDOM).find(".evideoBox");
    if($(eVideoBox).attr("loaded") != "false") {
      $(eVideoBox).attr("loaded", "false");
      V.Utils.addTempShown($(eVideoDOM).find(".evideoBox"))
    }
  };
  var beforeCreateSlidesetThumbnails = function(eVideoDOM) {
    _drawPois(eVideoDOM)
  };
  var beforeRemoveSlideset = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    if(typeof eVideos[eVideoId] !== "undefined") {
      delete eVideos[eVideoId];
      _updateBallsArray(eVideoId)
    }
  };
  var beforeRemoveSubslide = function(eVideoDOM, subslide) {
    var subslideId = $(subslide).attr("id");
    var eVideoJSON = _getCurrentEVideoJSON();
    $(eVideoJSON.slides).each(function(index, slide) {
      if(slide.id == subslideId) {
        eVideos[eVideoJSON.id].slides.splice(index, 1);
        return false
      }
    });
    $(eVideoJSON.balls).each(function(index, ball) {
      if(ball.slide_id === subslideId) {
        _removeBall(ball);
        return false
      }
    });
    _updateBalls($(subslide).parent())
  };
  var afterCreateSubslide = function(eVideoDOM, subslide) {
    var subslideId = $(subslide).attr("id");
    var eVideoJSON = _getCurrentEVideoJSON();
    if(typeof eVideos[eVideoJSON.id].slides == "undefined") {
      eVideos[eVideoJSON.id].slides = []
    }
    eVideos[eVideoJSON.id].slides.push({id:subslideId})
  };
  var _existPoiForSlideId = function(eVideoJSON, slideId) {
    if(typeof eVideoJSON == "undefined" || typeof slideId == "udnefined") {
      return false
    }
    var _existPoiForSlideId = false;
    $(eVideoJSON.balls).each(function(index, ball) {
      if(ball.slide_id === slideId) {
        _existPoiForSlideId = true;
        return false
      }
    });
    return _existPoiForSlideId
  };
  var _drawPois = function(eVideoDOM) {
    var slidesetDOM = eVideoDOM;
    var eVideoJSON = _getCurrentEVideoJSON();
    if(!eVideoJSON) {
      return
    }
    var subslides = $(eVideoDOM).find("article");
    $("#subslides_list").find("div.wrapper_barbutton").each(function(index, div) {
      var slide = subslides[index];
      if(slide) {
        var slide_id = $(slide).attr("id");
        var arrowDiv = $(div).find("div.draggable_sc_div[slide_id='" + slide_id + "']");
        if($(arrowDiv).length === 0) {
          arrowDiv = $('<div class="draggable_sc_div" slide_id="' + slide_id + '" slideNumber="' + (index + 1) + '"" >');
          $(arrowDiv).append($('<img src="' + V.ImagesPath + 'icons/flashcard_button.png" class="fc_draggable_arrow">'));
          $(arrowDiv).append($('<p class="draggable_number">' + String.fromCharCode(64 + index + 1) + "</p>"));
          $(div).prepend(arrowDiv)
        }
        if(_existPoiForSlideId(eVideoJSON, slide_id)) {
          $(arrowDiv).hide()
        }else {
          $(arrowDiv).removeAttr("style").show()
        }
      }
    });
    $("div.draggable_sc_div").draggable({start:function(event, ui) {
      var position = $(event.target).css("position");
      if(position === "absolute") {
        var current_offset = $(event.target).offset();
        $(event.target).css("position", "fixed");
        $(event.target).css("margin-top", current_offset.top + "px");
        $(event.target).css("margin-left", current_offset.left + "px");
        $(event.target).attr("ddstart", "scrollbar")
      }
    }, stop:function(event, ui) {
      var current_offset = $(event.target).offset();
      var slideset_offset = $(slidesetDOM).offset();
      var yOk = current_offset.top > slideset_offset.top - 10 && current_offset.top < slideset_offset.top + $(slidesetDOM).outerHeight() - 38;
      var xOk = current_offset.left > slideset_offset.left - 5 && current_offset.left < slideset_offset.left + $(slidesetDOM).outerWidth() - 44;
      var insideSlideset = yOk && xOk;
      insideSlideset = insideSlideset && V.Editor.Slideset.getCurrentSubslide() == null;
      var isVideoCreated = _isVideoCreated(V.Slides.getCurrentSlide());
      if(insideSlideset && isVideoCreated) {
        $(event.target).attr("ddend", "background");
        if($(event.target).attr("ddstart") === "scrollbar") {
          var newTop = $(event.target).cssNumber("margin-top") + $(event.target).cssNumber("top");
          var newLeft = $(event.target).cssNumber("margin-left") + $(event.target).cssNumber("left");
          $(event.target).css("margin-top", "0px");
          $(event.target).css("margin-left", "0px");
          $(event.target).css("top", newTop + "px");
          $(event.target).css("left", newLeft + "px");
          var slide_id = $(event.target).attr("slide_id");
          $(event.target).hide();
          _addBallToCurrentTime(slide_id)
        }
      }else {
        $(event.target).animate({top:0, left:0}, "slow", function() {
          $(event.target).css("position", "absolute");
          $(event.target).css("margin-top", "-20px");
          $(event.target).css("margin-left", "15px");
          $(event.target).attr("ddend", "scrollbar")
        })
      }
    }});
    return
  };
  var getThumbnailURL = function(eVideo) {
    return V.ImagesPath + "templatesthumbs/tEVideo.png"
  };
  var getSlideHeader = function(eVideoDOM) {
    var eVideoId = $(eVideoDOM).attr("id");
    var eVideoJSON = eVideos[eVideoId];
    var videoDOM = _getVideoFromEVideo(eVideoDOM);
    var duration = V.Video.getDuration(videoDOM);
    var slide = {};
    slide.id = eVideoId;
    slide.type = V.Constant.EVIDEO;
    slide.video = {};
    slide.video.type = V.Video.getTypeVideo(videoDOM);
    switch(slide.video.type) {
      case V.Constant.MEDIA.HTML5_VIDEO:
        var sources = V.Video.HTML5.getSources(videoDOM);
        var sourcesString = "";
        $(sources).each(function(index, source) {
          if(index !== 0) {
            sourcesString = sourcesString + ","
          }
          var sourceSrc = V.Utils.removeParamFromUrl(source.src, "timestamp");
          sourcesString = sourcesString + '{ "src": "' + sourceSrc + '" , "type": "' + source.mimeType + '"}'
        });
        sourcesString = "[" + sourcesString + "]";
        slide.video.sources = sourcesString;
        slide.video.duration = duration;
        break;
      case V.Constant.MEDIA.YOUTUBE_VIDEO:
        slide.video.source = V.Video.Youtube.getEmbedSource(videoDOM);
        slide.video.duration = duration;
        break;
      default:
        break
    }
    slide.width = "100%";
    slide.height = "100%";
    var pois = [];
    $(eVideoJSON.balls).each(function(index, ball) {
      var poi = {};
      poi.id = ball.id;
      poi.etime = _getValidatedBallTime(ball.etime, duration);
      if(typeof ball.slide_id != "undefined") {
        poi.slide_id = ball.slide_id
      }
      poi.name = ball.name;
      pois.push(poi)
    });
    slide.pois = pois;
    slide.slides = [];
    return slide
  };
  var _getValidatedBallTime = function(etime, duration) {
    return Math.max(Math.min(etime, duration), 0)
  };
  var preCopyActions = function(eVideoJSON, eVideoDOM) {
  };
  var postCopyActions = function(eVideoJSON, eVideoDOM) {
  };
  var _getCurrentEVideoJSON = function() {
    return eVideos[$(V.Slides.getCurrentSlide()).attr("id")]
  };
  var _getCurrentVideo = function() {
    return _getVideoFromEVideo(V.Slides.getCurrentSlide())
  };
  var _getVideoFromEVideo = function(eVideoDOM) {
    return V.EVideo.getVideoFromVideoBox($(eVideoDOM).find(".evideoBox"))
  };
  var _isVideoCreated = function(eVideoDOM) {
    var videoBox = $(eVideoDOM).find(".evideoBox");
    var video = V.EVideo.getVideoFromVideoBox(videoBox);
    return typeof $(video).attr("videotype") != "undefined"
  };
  var _updateBallsArray = function(eVideoId) {
    $(balls).each(function(index, ball) {
      if(ball.eVideoId === eVideoId) {
        balls.splice(index, 1)
      }
    });
    if(typeof eVideos[eVideoId] != "undefined") {
      eVideos[eVideoId].balls.map(function(ball) {
        balls[ball.id] = ball
      })
    }
  };
  return{init:init, onChangeVideo:onChangeVideo, getDummy:getDummy, draw:draw, onVideoSelected:onVideoSelected, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, loadSlideset:loadSlideset, unloadSlideset:unloadSlideset, beforeCreateSlidesetThumbnails:beforeCreateSlidesetThumbnails, beforeRemoveSlideset:beforeRemoveSlideset, beforeRemoveSubslide:beforeRemoveSubslide, afterCreateSubslide:afterCreateSubslide, getSlideHeader:getSlideHeader, getThumbnailURL:getThumbnailURL, preCopyActions:preCopyActions, 
  postCopyActions:postCopyActions, onHTML5VideoReady:onHTML5VideoReady}
}(VISH, jQuery);
VISH.Editor.Events.Mobile = function(V, $, undefined) {
  var _bindedEditorMobileEventListeners = false;
  var _touchable = false;
  var init = function() {
    _touchable = V.Status.getDevice().features.touchScreen;
    if(_touchable) {
      V.Events.Touchable.init()
    }
  };
  var bindEditorMobileEventListeners = function() {
    if(_bindedEditorMobileEventListeners) {
      return
    }
    _bindedEditorMobileEventListeners = true;
    var device = V.Status.getDevice();
    var isIphoneAndSafari = device.iPhone && device.browser.name === V.Constant.SAFARI;
    var clickDelegationBug = isIphoneAndSafari;
    if(_touchable) {
      V.Events.Touchable.bindTouchableEventListeners();
      V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onSimpleClick, function(params) {
        var event = params.event;
        var target = event.target;
        if($(target).parents("#slides_list").length > 0) {
          var slide_number = $(target).attr("slidenumber");
          V.Slides.goToSlide(slide_number)
        }else {
          if($(target).parents("#subslides_list").length > 0) {
            var subslide_number = $(target).attr("slidenumber");
            V.Editor.Slideset.openSubslideWithNumber(subslide_number)
          }
        }
      })
    }
    $(window).on("orientationchange", function() {
      $(window).trigger("resize")
    })
  };
  var unbindEditorMobileEventListeners = function() {
    if(!_bindedEditorMobileEventListeners) {
      return
    }
    if(_touchable) {
      V.Events.Touchable.unbindTouchableEventListeners()
    }
    $(window).off("orientationchange", function() {
      window.onresize()
    });
    _bindedEditorMobileEventListeners = false
  };
  return{init:init, bindEditorMobileEventListeners:bindEditorMobileEventListeners, unbindEditorMobileEventListeners:unbindEditorMobileEventListeners}
}(VISH, jQuery);
VISH.Editor.Filter = function(V, $, undefined) {
  var init = function() {
    var device = V.Status.getDevice();
    var browser = device.browser;
    switch(browser.name) {
      case V.Constant.IE:
        $("#tab_object_snapshot").hide();
        break;
      case V.Constant.UNKNOWN:
        $("#tab_object_snapshot").hide();
        break
    }
    if(!device.features.reader) {
      $(".liInsertJson > a").css("display", "none")
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.IMSQTI = function(V, $, undefined) {
  var init = function() {
  };
  var isCompliantXMLFile = function(fileXML) {
    var isCompliant;
    var schema;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    var itemBody = $(xml).find("itemBody");
    var simpleChoice = $(xml).find("simpleChoice");
    var orderInteraction = $(xml).find("orderInteraction");
    var correctResponse = $(xml).find("correctResponse value");
    if($(xml).find("assessmentItem").length != 0) {
      $(xml).find("assessmentItem").each(function() {
        $(this.attributes).each(function(index, attribute) {
          if(attribute.name == "xsi:schemaLocation") {
            if(attribute.textContent.indexOf("http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1p1.xsd") != -1 || attribute.textContent.indexOf("http://www.imsglobal.org/xsd/qti/qtiv2p1/imsqti_v2p1.xsd") != -1) {
              schema = true
            }else {
              schema = false
            }
          }
        })
      })
    }else {
      schema = false
    }
    if(checkQuizType(fileXML) == "multipleCA") {
      if(itemBody.length == 0 || (simpleChoice.length == 0 || (correctResponse.length == 0 || schema == false))) {
        isCompliant = false
      }else {
        isCompliant = true
      }
    }else {
      if(checkQuizType(fileXML) == "order") {
        if(itemBody.length == 0 || (orderInteraction.length == 0 || (correctResponse.length == 0 || schema == false))) {
          isCompliant = false
        }else {
          isCompliant = true
        }
      }else {
        if(checkQuizType(fileXML) == "openshortAnswer" || checkQuizType(fileXML) == "fillInTheBlankText") {
          if(itemBody.length == 0 || (correctResponse.length == 0 || schema == false)) {
            isCompliant = false
          }else {
            isCompliant = true
          }
        }else {
          isCompliant = false
        }
      }
    }
    return isCompliant
  };
  var checkAnswer = function(answer, correctArray) {
    var answerBoolean;
    if(jQuery.inArray(answer, correctArray) == -1) {
      answerBoolean = false
    }else {
      answerBoolean = true
    }
    return answerBoolean
  };
  var checkQuizType = function(fileXML) {
    var quizType;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    var multipleCA = $(xml).find("simpleChoice");
    var fillInTheBlankText = $(xml).find("textEntryInteraction");
    var hotSpotClick = $(xml).find("selectPointInteraction");
    var openshortAnswer = $(xml).find("extendedTextInteraction");
    var order = $(xml).find("orderInteraction");
    var fillInTheBlankGap = $(xml).find("gapMatchInteraction");
    var matching = $(xml).find("matchInteraction");
    if(fillInTheBlankText.length != 0) {
      quizType = "fillInTheBlankText"
    }else {
      if(hotSpotClick.length != 0) {
        quizType = "hotSpotClick"
      }else {
        if(openshortAnswer.length != 0) {
          quizType = "openshortAnswer"
        }else {
          if(order.length != 0) {
            quizType = "order"
          }else {
            if(fillInTheBlankGap.length != 0) {
              quizType = "fillInTheBlankGap"
            }else {
              if(matching.length != 0) {
                quizType = "matching"
              }else {
                if(multipleCA.length != 0) {
                  quizType = "multipleCA"
                }
              }
            }
          }
        }
      }
    }
    return quizType
  };
  var getJSONFromXMLFile = function(fileXML) {
    var itemBodyContent;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    var myRandomHash = [];
    var randomArray = [];
    var min, max;
    var ident;
    if($(xml).find("templateProcessing setTemplateValue randomInteger").length != 0) {
      $(xml).find("templateProcessing setTemplateValue randomInteger").each(function() {
        $(this).parent().each(function() {
          $(this.attributes).each(function(index, attribute) {
            if(attribute.name == "identifier") {
              ident = attribute.textContent
            }
          })
        });
        $(this.attributes).each(function(index, attribute) {
          if(attribute.name == "min") {
            min = attribute.textContent
          }else {
            if(attribute.name == "max") {
              max = attribute.textContent
            }
          }
        });
        myRandomHash[ident] = Math.floor(Math.random() * (parseInt(max) - parseInt(min) + 1) + parseInt(min))
      })
    }
    if($(xml).find("templateProcessing setTemplateValue randomFloat").length != 0) {
      $(xml).find("templateProcessing setTemplateValue randomFloat").each(function() {
        $(this).parent().each(function() {
          $(this.attributes).each(function(index, attribute) {
            if(attribute.name == "identifier") {
              ident = attribute.textContent
            }
          })
        });
        $(this.attributes).each(function(index, attribute) {
          if(attribute.name == "min") {
            min = attribute.textContent
          }else {
            if(attribute.name == "max") {
              max = attribute.textContent
            }
          }
        });
        myRandomHash[ident] = parseFloat(Math.min(parseInt(min) + Math.random() * (parseInt(max) - parseInt(min)), parseInt(max)).toFixed(2))
      })
    }
    if($(xml).find("templateProcessing setTemplateValue random").length != 0) {
      $(xml).find("templateProcessing setTemplateValue random").each(function() {
        $(this).parent().each(function() {
          $(this.attributes).each(function(index, attribute) {
            if(attribute.name == "identifier") {
              ident = attribute.textContent
            }
          })
        });
        $(this).children().each(function() {
          for(var i = 1;i <= $(this).text().split("\n").length - 2;i++) {
            randomArray[i - 1] = $(this).text().split("\n")[i]
          }
        });
        myRandomHash[ident] = randomArray[Math.floor(Math.random() * randomArray.length)]
      })
    }
    if($(xml).find("printedVariable").length != 0) {
      $(xml).find("printedVariable").each(function() {
        $(this.attributes).each(function(index, attribute) {
          if(attribute.name == "identifier") {
            if(myRandomHash[attribute.textContent] != undefined) {
              $(xml).find("itemBody").each(function() {
                $(this).find("printedVariable").replaceWith(myRandomHash[attribute.textContent].toString());
                itemBodyContent = $(xml).find("itemBody")
              })
            }
          }
        })
      })
    }else {
      itemBodyContent = $(xml).find("itemBody")
    }
    switch(checkQuizType(fileXML)) {
      case "multipleCA":
        return getJSONFromXMLFileMC(fileXML, itemBodyContent);
        break;
      case "order":
        return getJSONFromXMLFileSorting(fileXML, itemBodyContent);
        break;
      case "openshortAnswer":
        return getJSONFromXMLFileSA(fileXML, itemBodyContent);
        break;
      case "fillInTheBlankText":
        return getJSONFromXMLFileSA(fileXML, itemBodyContent);
        break
    }
  };
  var getJSONFromXMLFileMC = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var answerArray = [];
    var correctanswerArray = [];
    var nAnswers;
    var answerIds = [];
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    if($(xml).find("prompt").length != 0) {
      $(xml).find("prompt").each(function() {
        question = $(this).text()
      })
    }else {
      itemBodyContent.children().first().each(function() {
        question = $(this).text()
      })
    }
    itemBodyContent.find("simpleChoice").each(function() {
      var answer = $(this).text();
      answerArray.push(answer)
    });
    $(xml).find("correctResponse value").each(function() {
      var cAnswer = $(this).text();
      correctanswerArray.push(cAnswer)
    });
    itemBodyContent.find("simpleChoice").each(function() {
      $(this.attributes).each(function(index, attribute) {
        if(attribute.name == "identifier") {
          answerIds.push(attribute.textContent)
        }
      })
    });
    if(correctanswerArray.length > 1) {
      nAnswers = true
    }else {
      nAnswers = false
    }
    var choices = [];
    for(var i = 1;i <= answerArray.length;i++) {
      var iChoice;
      iChoice = {"id":i.toString(), "value":answerArray[i - 1].toString(), "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + answerArray[i - 1].toString() + "&shy;</span></span></p>\n", "answer":checkAnswer(answerIds[i - 1], correctanswerArray)};
      choices.push(iChoice)
    }
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "selfA":true, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "choices":$.extend([{}], choices), "extras":{"multipleAnswer":nAnswers}});
    var options = {template:"t2"};
    return V.Editor.Presentation.generatePresentationScaffold(elements, options)
  };
  var getJSONFromXMLFileSorting = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var answerArray = [];
    var correctanswerArray = [];
    var answerIds = [];
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    if($(xml).find("prompt").length != 0) {
      $(xml).find("prompt").each(function() {
        question = $(this).text()
      })
    }else {
      itemBodyContent.children().first().each(function() {
        question = $(this).text()
      })
    }
    itemBodyContent.find("simpleChoice").each(function() {
      var answer = $(this).text();
      answerArray.push(answer)
    });
    $(xml).find("correctResponse value").each(function() {
      var cAnswer = $(this).text();
      correctanswerArray.push(cAnswer)
    });
    itemBodyContent.find("simpleChoice").each(function() {
      $(this.attributes).each(function(index, attribute) {
        if(attribute.name == "identifier") {
          answerIds.push(attribute.textContent)
        }
      })
    });
    itemBodyContent.find("simpleChoice").each(function() {
      $(this.attributes).each(function(index, attribute) {
        if(attribute.name == "identifier") {
          answerIds.push(attribute.textContent)
        }
      })
    });
    var myHash = [];
    for(var i = 1;i <= answerArray.length;i++) {
      myHash[answerIds[i - 1]] = answerArray[i - 1]
    }
    var choices = [];
    for(var i = 1;i <= answerArray.length;i++) {
      var iChoice;
      iChoice = {"id":i.toString(), "value":myHash[correctanswerArray[i - 1]], "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + myHash[correctanswerArray[i - 1]] + "&shy;</span></span></p>\n", "answer":i.toString()};
      choices.push(iChoice)
    }
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"sorting", "selfA":true, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "choices":$.extend([{}], choices)});
    var options = {template:"t2"};
    return V.Editor.Presentation.generatePresentationScaffold(elements, options)
  };
  var getJSONFromXMLFileSA = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var correctanswerArray = [];
    var selfA;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    $(xml).find("responseProcessing").each(function() {
      $(this.attributes).each(function(index, attribute) {
        if(attribute.name == "template") {
          if(attribute.textContent == "http://www.imsglobal.org/question/qti_v2p1/rptemplates/map_response") {
            selfA = true
          }else {
            selfA = false
          }
        }
      })
    });
    if($(xml).find("prompt").length != 0) {
      $(xml).find("prompt").each(function() {
        question = $(this).text()
      })
    }else {
      itemBodyContent.children().first().each(function() {
        question = $(this).text()
      })
    }
    $(xml).find("correctResponse value").each(function() {
      var cAnswer = $(this).text();
      correctanswerArray.push(cAnswer)
    });
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"openAnswer", "selfA":selfA, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "answer":{"value":correctanswerArray[0], "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + correctanswerArray[0] + 
    "</span></span></p>\n"}});
    var options = {template:"t2"};
    return V.Editor.Presentation.generatePresentationScaffold(elements, options)
  };
  return{init:init, isCompliantXMLFile:isCompliantXMLFile, getJSONFromXMLFile:getJSONFromXMLFile}
}(VISH, jQuery);
VISH.Editor.Image.Europeana = function(V, $, undefined) {
  var containerDivId = "tab_pic_europeana_content";
  var carrouselDivId = "tab_pic_europeana_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var europeanaImgBlackList = ["http://www.limburgserfgoed.nl/beeld/icon_book_100x100.png"];
  var maxObjectsToShow = 30;
  var init = function() {
    myInput = $("#tab_pic_europeana_content").find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInEuropeana(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInEuropeana = function(text) {
    var text = text || "*";
    var urlEuropeana = "http://www.europeana.eu/api/v2/search.json?wskey=" + V.Configuration.getConfiguration()["EuropeanaAPIKEY"] + "&query=" + text + "&qf=TYPE:IMAGE&profile=RICH&media=true&rows=100&qf=IMAGE_SIZE:small&callback=VISH.Editor.Image.Europeana.onEuropeanaSearchCallback";
    urlEuropeana = V.Utils.checkUrlProtocol(urlEuropeana);
    $("#europeana_search_call").remove();
    $("head").append('<script id="europeana_search_call" src="' + urlEuropeana + '">\x3c/script>')
  };
  var onEuropeanaSearchCallback = function(data) {
    if(data && (data.success === true && data.items instanceof Array)) {
      _onDataReceived(data)
    }else {
      _onAPIError()
    }
  };
  var _getEuropeanaItemData = function(europeanaItem) {
    var data = {};
    if(typeof europeanaItem == "object") {
      if(europeanaItem.title instanceof Array && europeanaItem.title.length > 0) {
        data.title = europeanaItem.title[0]
      }
      if(europeanaItem.edmIsShownBy instanceof Array && europeanaItem.edmIsShownBy.length > 0) {
        data.src = europeanaItem.edmIsShownBy[0]
      }
    }
    return data
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || (!data.items || data.items.length == 0)) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var europeanaImgs = [];
    $.each(data.items, function(index, item) {
      var europeanaItemData = _getEuropeanaItemData(item);
      if(typeof europeanaItemData.title == "string" && typeof europeanaItemData.src == "string") {
        if(europeanaImgBlackList.indexOf(europeanaItemData.src) == -1) {
          europeanaImgs.push(europeanaItemData)
        }
      }
    });
    if(europeanaImgs.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }else {
      if(europeanaImgs.length > maxObjectsToShow) {
        europeanaImgs = europeanaImgs.slice(0, maxObjectsToShow)
      }
    }
    var carrouselImages = [];
    $.each(europeanaImgs, function(index, item) {
      var myImg = $("<img src='" + item.src + "' title='" + item.title + "'/>");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorEuropeanaConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options["rows"] = 2;
        options["callback"] = _onClickCarrouselElement;
        options["rowItems"] = 4;
        options["scrollItems"] = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, onEuropeanaSearchCallback:onEuropeanaSearchCallback}
}(VISH, jQuery);
VISH.Editor.Image.Flickr = function(V, $, undefined) {
  var containerDivId = "tab_pic_flickr_content";
  var carrouselDivId = "tab_pic_flickr_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#tab_pic_flickr_content").find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInFlickr(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInFlickr = function(text) {
    var flickrURL = "http://api.flickr.com/services/feeds/photos_public.gne?tags=" + text + "&tagmode=any&format=json&jsoncallback=?";
    flickrURL = V.Utils.checkUrlProtocol(flickrURL);
    $.getJSON(flickrURL, function(data) {
      _onDataReceived(data)
    }).error(function() {
      _onAPIError()
    })
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || (!data.items || data.items.length == 0)) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.items, function(index, item) {
      var myImg = $("<img src='" + item.media.m.replace(/_m/i, "") + "' title='" + item.title + "'/>");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorFlickrConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options["rows"] = 2;
        options["callback"] = _onClickCarrouselElement;
        options["rowItems"] = 4;
        options["scrollItems"] = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.LRE = function(V, $, undefined) {
  var containerDivId = "tab_pic_lre_content";
  var carrouselDivId = "tab_pic_lre_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.LRE.requestImages(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || (!data.pictures || data.pictures.length == 0)) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.pictures, function(index, image) {
      var myTitle = image.title;
      var myImg = $("<img src='" + image.src + "' title='" + myTitle + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    var loadedImages = $("#" + carrouselDivId + " div:not(#loading_fancy)");
    var emptyResults = loadedImages && $(loadedImages).length === 0;
    if(emptyResults) {
      _drawData(true)
    }else {
      _drawData()
    }
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorLREConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 2;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 4;
        options.scrollItems = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.Repository = function(V, $, undefined) {
  var containerDivId = "tab_pic_repo_content";
  var carrouselDivId = "tab_pic_repo_content_carrousel";
  var myInput;
  var timestampLastSearch;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestImages(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data, function(index, image) {
      var myImg = $("<img src='" + image.url_full + "' title='" + image.title + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 2;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 4;
        options.scrollItems = 4;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Image.Thumbnails = function(V, $, undefined) {
  var containerDivId = "tab_pic_thumbnails_content";
  var carrouselDivId = "tab_pic_thumbnails_carrousel";
  var thumbnailsRequested = false;
  var dataDrawed = false;
  var t1;
  var init = function() {
  };
  var beforeLoadTab = function() {
  };
  var onLoadTab = function() {
    if(!thumbnailsRequested) {
      thumbnailsRequested = true;
      t1 = Date.now();
      _requestThumbnails()
    }
  };
  var _requestThumbnails = function() {
    _cleanCarrouselAndLoading();
    V.Editor.API.requestThumbnails(_onDataReceived, _onAPIError)
  };
  var _cleanCarrouselAndLoading = function() {
    _cleanCarrousel();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId))
  };
  var _cleanCarrousel = function() {
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId);
    $("#" + carrouselDivId).hide()
  };
  var _onDataReceived = function(data) {
    var t2 = Math.max(1250 - (Date.now() - t1), 0);
    setTimeout(function() {
      _loadData(data)
    }, t2)
  };
  var _loadData = function(data) {
    if(!data.pictures || data.pictures.length == 0) {
      _stopLoading();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    $.each(data.pictures, function(index, image) {
      var myImg = $("<img src='" + image.src + "' title='" + image.title + "' >");
      carrouselImages.push(myImg)
    });
    var options = {};
    options.callback = _onImagesLoaded;
    options.order = true;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _stopLoading();
    _drawData()
  };
  var _stopLoading = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId))
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 3;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "thumbnails";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
    dataDrawed = true
  };
  var _onAPIError = function() {
    _stopLoading();
    _drawData(false)
  };
  var _onClickCarrouselElement = function(event) {
    var image_url = $(event.target).attr("src");
    V.Editor.Image.addContent(image_url)
  };
  var _isCarrouselVisible = function() {
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.LRE = function(V, $, undefined) {
  var VISH_LRE_URL = "";
  var LRE_THUMBNAILS_URL = "http://lrethumbnails.eun.org/";
  var DEFAULT_LIMIT = 40;
  var DEFAULT_MAXAGE = 20;
  var DEFAULT_MINAGE = 4;
  var DEFAULT_LANGUAGE = "en";
  var PROVIDERS_TO_REMOVE = ["KHAN", "OPENLEARN"];
  var init = function(lang) {
    VISH_LRE_URL = V.LREPath;
    if(lang != "en") {
      DEFAULT_LANGUAGE = "x-mt-" + lang
    }else {
      DEFAULT_LANGUAGE = lang
    }
  };
  var requestImages = function(text, successCallback, failCallback) {
    var query = _composeLREQuery(text.split(" "), ["image"]);
    _requestLRE(query, DEFAULT_LIMIT, "image", successCallback, failCallback)
  };
  var requestObjects = function(text, successCallback, failCallback) {
    var query = _composeLREQuery(text.split(" "), ["audio", "video", "data", "text"]);
    _requestLRE(query, DEFAULT_LIMIT, "object", successCallback, failCallback)
  };
  var _requestLRE = function(query, limit, response_type, successCallback, failCallback) {
    $.ajax({type:"GET", url:VISH_LRE_URL + "?q=" + query + "&limit=" + limit, dataType:"json", success:function(response) {
      if(typeof successCallback == "function") {
        var formatedResponse = formatLREResponse(response, response_type);
        successCallback(formatedResponse)
      }
    }, error:function(xhr, ajaxOptions, thrownError) {
      if(typeof failCallback == "function") {
        failCallback()
      }
    }})
  };
  var _composeLREQuery = function(terms, lrt) {
    var query = "";
    if(terms.length == 0) {
      failCallback("Search terms can\u00b4t be blank")
    }
    for(var i = 0;i < terms.length;i++) {
      query += "((content[" + terms[i] + "]))"
    }
    if(lrt && lrt.length > 0) {
      query += "(";
      for(var j = 0;j < lrt.length;j++) {
        query += "(lrt[" + lrt[j] + "])"
      }
      query += ")"
    }
    return query
  };
  var formatLREResponse = function(lre_response, type) {
    var the_array = new Array;
    var the_return_list = {};
    if(lre_response && lre_response["results"]) {
      var results_array = lre_response["results"];
      for(var i = 0;i < results_array.length;i++) {
        var the_elem = _formatLREElem(results_array[i], type);
        if(the_elem) {
          the_array.push(the_elem)
        }
      }
      switch(type) {
        case "image":
          the_return_list.pictures = the_array;
          break;
        case "object":
          the_return_list = the_array;
          break
      }
    }
    return the_return_list
  };
  var _formatLREElem = function(the_element, type) {
    if(type === "object" || type === "image" && _checkValidImgElem(the_element)) {
      var tmp_elem = {};
      tmp_elem.id = the_element.meta.id;
      if($.inArray(the_element.meta.provider, PROVIDERS_TO_REMOVE) >= 0) {
        return null
      }
      tmp_elem.author = the_element.meta.provider;
      var title_and_desc = _getTitleAndDescInMyLang(the_element.meta.langBlocks);
      tmp_elem.title = title_and_desc.title;
      tmp_elem.description = title_and_desc.description;
      switch(type) {
        case "image":
          tmp_elem.src = _getValidSRC(the_element, type);
          if(!tmp_elem.src) {
            return null
          }
          break;
        case "object":
          tmp_elem.object = _getValidSRC(the_element, type);
          if(!tmp_elem.object) {
            return null
          }
          break
      }
      tmp_elem.thumbnail = LRE_THUMBNAILS_URL + tmp_elem.id.toString().slice(-3) + "/" + tmp_elem.id.toString() + ".png";
      return tmp_elem
    }
  };
  var _isValidImageUrl = function(url, callback) {
    var img = new Image;
    img.onerror = function() {
      V.Debugger("This is not an image: " + url);
      callback(url, false)
    };
    img.onload = function() {
      callback(url, true)
    };
    img.src = url
  };
  var _getValidSRC = function(my_element, type) {
    if(!my_element) {
      return""
    }
    if(my_element.meta && my_element.meta.expressions) {
      for(var i = 0;i < my_element.meta.expressions.length;i++) {
        var exp = my_element.meta.expressions[i];
        for(var j = 0;j < exp.manifestations.length;j++) {
          if(type === "image" && exp.manifestations[j].player == "webBrowser") {
            return exp.manifestations[j].urls[0]
          }else {
            if(type === "object" && (exp.manifestations[j].player == "webBrowser" || (exp.manifestations[j].player == "landingPage" || exp.manifestations[j].player == "printable"))) {
              return exp.manifestations[j].urls[0]
            }
          }
        }
      }
    }
    return""
  };
  var _checkValidImgElem = function(img_element) {
    if(!img_element) {
      return false
    }
    if(img_element.meta && img_element.meta.expressions) {
      for(var i = 0;i < img_element.meta.expressions.length;i++) {
        var exp = img_element.meta.expressions[i];
        for(var j = 0;j < exp.manifestations.length;j++) {
          if(exp.manifestations[j].player == "webBrowser") {
            return true
          }
        }
      }
    }
    return false
  };
  var _getTitleAndDescInMyLang = function(langBlocks) {
    var filled_lang = false;
    var title_and_desc = {};
    var default_title_and_desc = {};
    if(langBlocks.length == 1) {
      default_title_and_desc.title = langBlocks[0].title;
      default_title_and_desc.description = langBlocks[0].description;
      return default_title_and_desc
    }
    for(var i = 0;i < langBlocks.length;i++) {
      if(langBlocks[i].language == DEFAULT_LANGUAGE) {
        title_and_desc.title = langBlocks[i].title;
        title_and_desc.description = langBlocks[i].description;
        filled_lang = true
      }
      if(langBlocks[i].language == "en" || langBlocks[i].language == "en-GB") {
        default_title_and_desc.title = langBlocks[i].title;
        default_title_and_desc.description = langBlocks[i].description
      }
    }
    if(filled_lang) {
      return title_and_desc
    }else {
      return default_title_and_desc
    }
  };
  return{init:init, requestImages:requestImages, requestObjects:requestObjects, formatLREResponse:formatLREResponse}
}(VISH, jQuery);
VISH.Editor.MenuTablet = function(V, $, undefined) {
  var init = function() {
    $(".menu_option_main").click(function(event) {
      if($("ul.menu_option_main").css("display") == "none") {
        $("ul.menu_option_main > li > ul").hide();
        $("ul.menu_option_main").show()
      }else {
        $("ul.menu_option_main").hide()
      }
    });
    $("a.menu_option").click(function(event) {
      if(!$(this).hasClass("menu_action") && ($(this).parent()[0].tagName === "LI" && $(this).parent().find("ul").length == 1)) {
        event.preventDefault();
        event.stopPropagation();
        var subMenu = $(this).parent().find("ul")[0];
        if($(subMenu).is(":visible")) {
          $(subMenu).hide();
          return
        }
        $("ul.menu_option_main > li > ul").hide();
        $(subMenu).show()
      }else {
      }
    })
  };
  return{init:init}
}(VISH, jQuery);
VISH.Editor.MoodleXML = function(V, $, undefined) {
  var init = function() {
  };
  var isCompliantXMLFile = function(fileXML) {
    var isCompliant = true;
    var schema = false;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    var quiz = $(xml).find("quiz");
    var itemBody = quiz.children("question");
    if(quiz.children().length != itemBody.length) {
      isCompliant = false
    }
    isCompliant = checkQuizCompliance(xml);
    return isCompliant || schema
  };
  var checkAnswer = function(answer, correctArray) {
    var answerBoolean;
    if(jQuery.inArray(answer, correctArray) == -1) {
      answerBoolean = false
    }else {
      answerBoolean = true
    }
    return answerBoolean
  };
  var checkQuizType = function(fileXML) {
    var quizType = $(fileXML).attr("type");
    var quizRecognise;
    if(quizType == null) {
      quizRecognise = "not_recognised"
    }else {
      if(quizType === "category") {
        return"category"
      }else {
        if(quizType === "multichoice") {
          return"multichoice"
        }else {
          if(quizType === "truefalse") {
            return"truefalse"
          }else {
            if(quizType === "shortanswer") {
              return"shortanswer"
            }else {
              if(quizType === "matching") {
                return"matching"
              }else {
                if(quizType === "cloze") {
                  return"cloze"
                }else {
                  if(quizType === "essay") {
                    return"essay"
                  }else {
                    if(quizType === "numerical") {
                      return"numerical"
                    }else {
                      if(quiztype === "description") {
                        return"description"
                      }else {
                        quizRecognise = "not_recognised"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    return quizRecognise
  };
  var checkQuizCompliance = function(fileXML) {
    var quizType = fileXML.find("question");
    var quizRecognise;
    if(quizType != null) {
      for(var i = 0;i < quizType.length;i++) {
        type = $(quizType[i]).attr("type");
        if(type === "category" || (type === "multichoice" || (type === "truefalse" || (type === "shortanswer" || (type === "matching" || (type === "cloze" || (type === "essay" || (type === "numerical" || type === "description")))))))) {
          quizRecognise = true
        }else {
          quizRecognise = false;
          return false
        }
      }
    }
    return quizRecognise
  };
  var getJSONFromXMLFile = function(fileXML) {
    var itemBodyContent;
    var xmlDoc = $.parseXML(fileXML);
    var xml = $(xmlDoc);
    var question = xml.find("question");
    var questionArray = [];
    var notRecognized = 0;
    var questionsSupported = "ALL";
    var options = {template:"t2"};
    for(var n = 0;n < question.length;n++) {
      switch(checkQuizType(question[n])) {
        case "multichoice":
          questionArray.push(getJSONFromXMLFileMC(question[n], itemBodyContent)[0]);
          break;
        case "matching":
          notRecognized++;
          break;
        case "truefalse":
          questionArray.push(getJSONFromXMLFileTF(question[n], itemBodyContent)[0]);
          break;
        case "shortanswer":
          questionArray.push(getJSONFromXMLFileSA(question[n], itemBodyContent)[0]);
          break;
        case "numerical":
          questionArray.push(getJSONFromXMLFileNum(question[n], itemBodyContent)[0]);
          break;
        case "category":
        ;
        case "description":
          break;
        case "cloze":
        ;
        case "essay":
        ;
        default:
          notRecognized++;
          break
      }
    }
    if(questionArray.length > 0) {
      if(notRecognized > 0) {
        questionsSupported = "SEVERAL"
      }else {
        questionsSupported = "ALL"
      }
    }else {
      questionsSupported = "NONE"
    }
    return{json:V.Editor.Presentation.generatePresentationScaffold(questionArray), questionsSupported:questionsSupported}
  };
  var getJSONFromXMLFileMC = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var answerArray = [];
    var correctanswerArray = [];
    var nAnswers;
    var answerIds = [];
    var title;
    var shuffleanswers = false;
    question = $(fileXML).children("questiontext").children("text").text();
    title = $(fileXML).children("name").children("text").text();
    $(fileXML).find("answer").each(function() {
      var answer = $(this).text();
      answerArray.push(answer)
    });
    $(fileXML).find("answer").each(function() {
      if($(this).attr("fraction") > 0) {
        var answer = $(this).text();
        correctanswerArray.push(answer)
      }
    });
    if(correctanswerArray.length > 1) {
      nAnswers = true
    }else {
      nAnswers = false
    }
    if($(fileXML).find("shuffleanswers").text() == 1) {
      shuffleanswers = true
    }
    var choices = [];
    for(var i = 1;i <= answerArray.length;i++) {
      var iChoice;
      iChoice = {"id":i.toString(), "value":answerArray[i - 1].toString(), "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + answerArray[i - 1].toString() + "&shy;</span></span></p>\n", "answer":correctanswerArray.indexOf(answerArray[i - 1]) != -1};
      choices.push(iChoice)
    }
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"multiplechoice", "settings":{"shuffleChoices":shuffleanswers}, "selfA":true, "title":title, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "choices":$.extend([{}], choices), "extras":{"multipleAnswer":nAnswers}});
    var options = {template:"t2"};
    return elements
  };
  var getJSONFromXMLFileSA = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var correctanswerArray = [];
    var selfA;
    question = $(fileXML).children("questiontext").children("text").text();
    $(fileXML).find("answer").each(function() {
      if($(this).attr("fraction") > 0) {
        var answer = $(this).children("text").text();
        correctanswerArray.push(answer)
      }
    });
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"openAnswer", "selfA":selfA, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "answer":{"value":correctanswerArray[0], "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + correctanswerArray[0] + 
    "</span></span></p>\n"}});
    var options = {template:"t2"};
    return elements
  };
  var getJSONFromXMLFileTF = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var correctanswerArray = [];
    var answerArray = [];
    var answerIds = [];
    question = $(fileXML).children("name").children("text").text();
    if($(fileXML).find("generalfeedback").length != 0) {
      $(fileXML).find("generalfeedback").each(function() {
        var answer = $(this).text();
        if(answer.trim() == "") {
          var answer = $(this).parent().children("questiontext").text()
        }
        answerArray.push(answer)
      })
    }else {
      $(fileXML).find("questiontext").each(function() {
        var answer = $(this).text();
        answerArray.push(answer)
      })
    }
    $(fileXML).find("answer").each(function() {
      if($(this).attr("fraction") > 0) {
        if($(this).find("text").text() == "true") {
          correctanswerArray.push(true)
        }else {
          correctanswerArray.push(false)
        }
      }
    });
    var choices = [];
    for(var i = 1;i <= answerArray.length;i++) {
      var iChoice;
      iChoice = {"id":i.toString(), "value":answerArray[i - 1].toString(), "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + answerArray[i - 1].toString() + "&shy;</span></span></p>\n", "answer":correctanswerArray[i - 1]};
      choices.push(iChoice)
    }
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "selfA":true, "quiztype":"truefalse", "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "choices":$.extend([{}], choices)});
    var options = {template:"t2"};
    return elements
  };
  var getJSONFromXMLFileNum = function(fileXML, itemBodyContent) {
    var elements = [];
    var question;
    var correctanswerArray = [];
    var selfA = true;
    question = $(fileXML).children("questiontext").children("text").text();
    $(fileXML).find("answer").each(function() {
      if($(this).attr("fraction") > 0) {
        var answer = $(this).children("text").text();
        correctanswerArray.push(answer)
      }
    });
    elements.push({"id":"article2_zone1", "type":"quiz", "areaid":"left", "quiztype":"openAnswer", "selfA":selfA, "question":{"value":question, "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + question + "</span></span></p>\n"}, "answer":{"value":correctanswerArray[0], "wysiwygValue":'<p style="text-align:left;">\n\t<span autocolor="true" style="color:#000"><span style="font-size:38px;">&shy;' + correctanswerArray[0] + 
    "</span></span></p>\n"}});
    var options = {template:"t2"};
    return elements
  };
  return{init:init, isCompliantXMLFile:isCompliantXMLFile, getJSONFromXMLFile:getJSONFromXMLFile}
}(VISH, jQuery);
VISH.Editor.Object.Flash = function(V, $, undefined) {
  var drawFlashObjectWithSource = function(src) {
    var current_area = V.Editor.getCurrentArea();
    var template = V.Editor.getTemplate(current_area);
    var nextFlashId = V.Utils.getId();
    var idToDrag = "draggable" + nextFlashId;
    var idToResize = "resizable" + nextFlashId;
    current_area.attr("type", "object");
    var embedDiv = document.createElement("div");
    embedDiv.setAttribute("id", idToDrag);
    $(embedDiv).addClass("object_wrapper");
    $(embedDiv).addClass(template + "_object");
    var embedTag = document.createElement("embed");
    embedTag.setAttribute("id", idToResize);
    embedTag.setAttribute("class", template + "_object");
    src = V.Utils.addParamToUrl(src, "wmode", "opaque");
    embedTag.setAttribute("src", src);
    embedTag.setAttribute("wmode", "opaque");
    $(embedDiv).append(embedTag);
    $(current_area).html("");
    $(current_area).append(embedDiv);
    V.Editor.addDeleteButton($(current_area));
    $("#" + idToDrag).draggable({cursor:"move"})
  };
  return{drawFlashObjectWithSource:drawFlashObjectWithSource}
}(VISH, jQuery);
VISH.Editor.Object.GoogleDOC = function(V, $, undefined) {
  var init = function() {
  };
  var generateWrapper = function(url) {
    return V.Object.GoogleDOC.generateWrapper(url)
  };
  var generatePreviewWrapper = function(url) {
    var objectWrapper = V.Object.GoogleDOC.generateWrapper(url);
    var previewWrapper = $(objectWrapper);
    $(previewWrapper).addClass("objectPreview");
    return V.Utils.getOuterHTML(previewWrapper)
  };
  return{init:init, generatePreviewWrapper:generatePreviewWrapper, generateWrapper:generateWrapper}
}(VISH, jQuery);
VISH.Editor.Object.LRE = function(V, $, undefined) {
  var containerDivId = "tab_object_lre_content";
  var carrouselDivId = "tab_object_lre_content_carrousel";
  var previewDivId = "tab_object_lre_content_preview";
  var myInput;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.LRE.requestObjects(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || (!data.length || data.length == 0)) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var myImg = $("<img src='" + objectItem.thumbnail + "' objectId='" + objectItem.id + "' title='" + objectItem.title + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorLREConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].object);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#tab_object_lre_content_preview_object");
    var metadataArea = $("#tab_object_lre_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var objectInfo = V.Object.getObjectInfo(object.object);
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description, url:objectInfo.source});
      $(metadataArea).html(table);
      $("#tab_object_lre_content_preview").find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#tab_object_lre_content_preview_object");
    var metadataArea = $("#tab_object_lre_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#tab_object_lre_content_preview").find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      V.Editor.Object.drawObject(selectedObject.object);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Live = function(V, $, undefined) {
  var containerDivId = "tab_live_resource_content";
  var carrouselDivId = "tab_live_resource_content_carrousel";
  var previewDivId = "tab_live_resource_content_preview";
  var myInput;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestLives(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var objectInfo = V.Object.getObjectInfo(objectItem.object);
      var imageSource = null;
      switch(objectInfo.type) {
        case V.Constant.MEDIA.FLASH:
          imageSource = V.ImagesPath + "carrousel/swf.png";
          break;
        case V.Constant.MEDIA.YOUTUBE_VIDEO:
          imageSource = V.ImagesPath + "carrousel/video.png";
          break;
        case V.Constant.MEDIA.WEB:
          if(objectInfo.wrapper == "IFRAME") {
            imageSource = V.ImagesPath + "carrousel/iframe.png"
          }else {
            imageSource = V.ImagesPath + "carrousel/object.png"
          }
          break;
        default:
          imageSource = V.ImagesPath + "carrousel/object.png"
      }
      var myImg = $("<img src='" + imageSource + "' objectId='" + objectItem.id + "' title='" + objectItem.title + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectItem.id] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].fulltext);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      $(objectArea).append(renderedObject);
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description});
      $(metadataArea).html(table);
      $("#tab_live_resource_content_preview_foot").find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_live");
    var metadataArea = $("#" + previewDivId).find("#tab_live_resource_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#tab_live_resource_content_preview_foot").find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      V.Editor.Object.drawObject(selectedObject.fulltext);
      $.fancybox.close()
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.PDF = function(V, $, undefined) {
  var init = function() {
  };
  var generateWrapper = function(url) {
    return V.Object.PDF.generateWrapper(url)
  };
  var generatePreviewWrapper = function(url) {
    var objectWrapper = V.Object.PDF.generateWrapper(url);
    var previewWrapper = $(objectWrapper);
    $(previewWrapper).addClass("objectPreview");
    return V.Utils.getOuterHTML(previewWrapper)
  };
  return{init:init, generateWrapper:generateWrapper, generatePreviewWrapper:generatePreviewWrapper}
}(VISH, jQuery);
VISH.Editor.Object.Repository = function(V, $, undefined) {
  var containerDivId = "tab_object_repo_content";
  var carrouselDivId = "tab_object_repo_content_carrousel";
  var previewDivId = "tab_object_repo_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentObject = new Array;
  var selectedObject = null;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch();
    _cleanObjectPreview()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestObjects(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanObjectPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanObjectPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentObject = new Array;
    var carrouselImages = [];
    var carrouselImagesTitles = [];
    $.each(data, function(index, objectItem) {
      var objectType;
      var imageSource = undefined;
      switch(objectItem.type) {
        case "Picture":
          objectType = V.Constant.MEDIA.IMAGE;
          imageSource = V.ImagesPath + "carrousel/image.png";
          break;
        case "Link":
          objectType = V.Constant.MEDIA.WEB;
          imageSource = V.ImagesPath + "carrousel/iframe.png";
          break;
        case "Video":
          objectType = V.Constant.MEDIA.HTML5_VIDEO;
          imageSource = V.ImagesPath + "carrousel/video.png";
          objectItem.objectToDraw = V.Video.HTML5.renderVideoFromJSON(objectItem, {loadSources:true, id:V.Utils.getId(), extraClasses:["preview_video"]});
          break;
        case "Audio":
          objectType = V.Constant.MEDIA.HTML5_AUDIO;
          imageSource = V.ImagesPath + "carrousel/audio.png";
          objectItem.objectToDraw = V.Audio.HTML5.renderAudioFromJSON(objectItem, {loadSources:true, id:V.Utils.getId()});
          break;
        case "Swf":
          objectType = V.Constant.MEDIA.FLASH;
          imageSource = V.ImagesPath + "carrousel/swf.png";
          break;
        case "Scormfile":
          objectType = V.Constant.MEDIA.SCORM_PACKAGE;
          imageSource = V.ImagesPath + "carrousel/scorm.png";
          break;
        case "Webapp":
          objectType = V.Constant.MEDIA.WEB_APP;
          imageSource = V.ImagesPath + "carrousel/webapp.png";
          break;
        case "IMS_QTI_QUIZ":
          objectType = V.Constant.MEDIA.IMS_QTI_QUIZ;
          imageSource = V.ImagesPath + "carrousel/quizxml.png";
          break;
        default:
          objectType = V.Object.getObjectInfo(objectItem.url_full).type;
          imageSource = V.ImagesPath + "carrousel/object.png"
      }
      objectItem.vetype = objectType;
      if(typeof objectItem.objectToDraw == "undefined") {
        objectItem.objectToDraw = objectItem.url_full
      }
      if(typeof objectItem.avatar_url != "undefined") {
        imageSource = objectItem.avatar_url
      }
      var objectId = "objectCarrousel_" + index;
      var myImg = $("<img src='" + imageSource + "' objectId='" + objectId + "' title='" + objectItem.title + "' objectType='" + objectType + "'>");
      carrouselImages.push(myImg);
      carrouselImagesTitles.push(objectItem.title);
      currentObject[objectId] = objectItem
    });
    var options = {};
    options.titleArray = carrouselImagesTitles;
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.styleClass = "title";
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var objectId = $(event.target).attr("objectid");
    if(typeof objectId != "undefined") {
      var options = {};
      if(typeof currentObject[objectId].vetype != "undefined") {
        options.forceType = currentObject[objectId].vetype
      }
      renderedObject = V.Editor.Object.renderObjectPreview(currentObject[objectId].objectToDraw, options);
      _renderObjectPreview(renderedObject, currentObject[objectId]);
      selectedObject = currentObject[objectId]
    }
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderObjectPreview = function(renderedObject, object) {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    if(renderedObject && object) {
      renderedObject = $(renderedObject);
      $(objectArea).append(renderedObject);
      var objectTagName = $(renderedObject)[0].tagName;
      if(objectTagName === "AUDIO" || objectTagName === "VIDEO") {
        var sources = object.sources;
        if(objectTagName == "VIDEO") {
          V.Video.HTML5.addSourcesToVideoTag(sources, renderedObject, {timestamp:true})
        }else {
          if(objectTagName == "AUDIO") {
            V.Audio.HTML5.addSourcesToAudioTag(sources, renderedObject, {timestamp:true})
          }
        }
      }
      var table = V.Editor.Utils.generateTable({title:object.title, author:object.author, description:object.description});
      $(metadataArea).html(table);
      $("#" + previewDivId).find(".okButton").show()
    }
  };
  var _cleanObjectPreview = function() {
    var objectArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_object");
    var metadataArea = $("#" + previewDivId).find("#tab_object_repo_content_preview_metadata");
    $(objectArea).html("");
    $(metadataArea).html("");
    $("#" + previewDivId).find(".okButton").hide()
  };
  var addSelectedObject = function() {
    if(selectedObject != null) {
      var options = {};
      if(typeof selectedObject.vetype != "undefined") {
        options.forceType = selectedObject.vetype
      }
      V.Editor.Object.drawObject(selectedObject.objectToDraw, options);
      $.fancybox.close()
    }
  };
  var _translateViSHEntityType = function(vishObjectType) {
    switch(vishObjectType) {
      case "Picture":
        objectType = V.Constant.MEDIA.IMAGE;
        break;
      case "Link":
        objectType = V.Constant.MEDIA.WEB;
        break;
      case "Video":
        objectType = V.Constant.MEDIA.HTML5_VIDEO;
        break;
      case "Audio":
        objectType = V.Constant.MEDIA.HTML5_AUDIO;
        break;
      case "Swf":
        objectType = V.Constant.MEDIA.FLASH;
        break;
      case "Scormfile":
        objectType = V.Constant.MEDIA.SCORM_PACKAGE;
        break;
      case "Webapp":
        objectType = V.Constant.MEDIA.WEB_APP;
        break;
      case "IMS_QTI_QUIZ":
        objectType = V.Constant.MEDIA.IMS_QTI_QUIZ;
        break;
      default:
        objectType = V.Object.getObjectInfo(objectItem.url_full).type
    }
    return objectType
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedObject:addSelectedObject}
}(VISH, jQuery);
VISH.Editor.Object.Scorm = function(V, $, undefined) {
  var init = function() {
  };
  var generatePreviewWrapperForScorm = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    return"<iframe class='objectPreview' objecttype='" + V.Constant.MEDIA.SCORM_PACKAGE + "' src='" + url + "' wmode='opaque'></iframe>"
  };
  var generateWrapperForScorm = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    return"<iframe objecttype='" + V.Constant.MEDIA.SCORM_PACKAGE + "' src='" + url + "' wmode='opaque'></iframe>"
  };
  var afterDrawSCORM = function(iframe) {
  };
  return{init:init, generatePreviewWrapperForScorm:generatePreviewWrapperForScorm, generateWrapperForScorm:generateWrapperForScorm, afterDrawSCORM:afterDrawSCORM}
}(VISH, jQuery);
VISH.Editor.Object.Snapshot = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_snapshot_content";
  var urlInputId = "object_snapshot_code";
  var init = function() {
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    if(_validateSnapShot(contentToAdd)) {
      drawSnapShot(_wrapperSnapShot(contentToAdd));
      $.fancybox.close()
    }
  };
  var _validateSnapShot = function(object) {
    var objectInfo = V.Object.getObjectInfo(object);
    switch(objectInfo.wrapper) {
      case null:
        return _validateUrl(object);
        break;
      case "IFRAME":
        return _validateUrl(objectInfo.source);
        break;
      default:
        return false;
        break
    }
  };
  var _validateUrl = function(url) {
    var http_urls_pattern = /(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g;
    if(url.match(http_urls_pattern) != null) {
      return true
    }else {
      return false
    }
  };
  var _wrapperSnapShot = function(content) {
    var objectInfo = V.Object.getObjectInfo(content);
    content = V.Utils.addParamToUrl(content, "wmode", "opaque");
    if(objectInfo.wrapper === null) {
      return"<iframe src='" + content + "' wmode='opaque'></iframe>"
    }else {
      return content
    }
  };
  var drawSnapShot = function(wrapper, area, style, scrollTop, scrollLeft) {
    var current_area;
    var object_style = "";
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    if(style) {
      object_style = style
    }
    var template = V.Editor.getTemplate(current_area);
    var nextWrapperId = V.Utils.getId();
    var idToDrag = "draggable" + nextWrapperId;
    var idToResize = "resizable" + nextWrapperId;
    current_area.attr("type", "snapshot");
    var wrapperDiv = document.createElement("div");
    wrapperDiv.setAttribute("id", idToDrag);
    if(style) {
      wrapperDiv.setAttribute("style", style)
    }
    $(wrapperDiv).addClass("snapshot_wrapper");
    var iframeTag = $(wrapper);
    $(iframeTag).attr("id", idToResize);
    $(iframeTag).attr("class", "snapshot_content");
    $(iframeTag).attr("scrolling", "no");
    $(iframeTag).attr("wmode", "opaque");
    $(iframeTag).css("pointer-events", "none");
    $(current_area).html("");
    $(current_area).append(wrapperDiv);
    V.Editor.addDeleteButton($(current_area));
    $(wrapperDiv).append(iframeTag);
    if(scrollTop) {
      $("#" + idToDrag).scrollTop(scrollTop)
    }
    if(scrollLeft) {
      $("#" + idToDrag).scrollLeft(scrollLeft)
    }
    $(wrapperDiv).attr("scrollTop", scrollTop);
    $(wrapperDiv).attr("scrollLeft", scrollLeft);
    $("#" + idToDrag).bind("mousedown", function(event) {
      event.preventDefault()
    });
    $("#" + idToDrag).draggable({cursor:"move", disabled:false, start:function(event, ui) {
      if(!_isBorderClick(event, idToDrag)) {
        return false
      }
    }});
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var _isBorderClick = function(event, idToDrag) {
    var accuracy = 6;
    var scrollAccuracy = -10;
    var width = $("#" + idToDrag).width();
    var height = $("#" + idToDrag).height();
    var offset = $("#" + idToDrag).offset();
    var dif1 = event.pageX - offset.left;
    if(dif1 < accuracy) {
      return true
    }
    var dif2 = event.pageY - offset.top;
    if(dif2 < accuracy) {
      return true
    }
    var dif3 = offset.left + width - event.pageX;
    if(dif3 < scrollAccuracy) {
      return true
    }
    var dif4 = offset.top + height - event.pageY;
    if(dif4 < scrollAccuracy) {
      return true
    }
    return false
  };
  var _resizeWebIframe = function(id, width) {
    var proportion = $("#" + id).height() / $("#" + id).width();
    $("#" + id).width(width);
    $("#" + id).height(width * proportion)
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, drawSnapShot:drawSnapShot}
}(VISH, jQuery);
VISH.Editor.Object.Web = function(V, $, undefined) {
  var contentToAdd = null;
  var urlDivId = "tab_object_from_web_content";
  var urlInputId = "object_embedWeb_code";
  var init = function() {
    var urlInput = $("#" + urlDivId).find("input");
    $("#" + urlDivId + " .previewButton").click(function(event) {
      if(V.Police.validateObject($("#" + urlInputId).val())[0]) {
        contentToAdd = V.Editor.Utils.autocompleteUrls($("#" + urlInputId).val());
        V.Editor.Object.drawPreview(urlDivId, contentToAdd)
      }
    })
  };
  var onLoadTab = function(tab) {
    contentToAdd = null;
    V.Editor.Object.resetPreview(urlDivId);
    $("#" + urlInputId).val("")
  };
  var drawPreviewElement = function() {
    V.Editor.Object.drawPreviewObject(contentToAdd)
  };
  var generateWrapperForWeb = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    return"<iframe src='" + url + "' wmode='opaque'></iframe>"
  };
  var generatePreviewWrapperForWeb = function(url) {
    url = V.Utils.checkUrlProtocol(V.Utils.addParamToUrl(url, "wmode", "opaque"));
    return"<iframe class='objectPreview' src='" + url + "' wmode='opaque'></iframe>"
  };
  return{init:init, onLoadTab:onLoadTab, drawPreviewElement:drawPreviewElement, generatePreviewWrapperForWeb:generatePreviewWrapperForWeb, generateWrapperForWeb:generateWrapperForWeb}
}(VISH, jQuery);
VISH.Editor.Object.Webapp.Handler = function(V, $, undefined) {
  var init = function() {
  };
  var onWAPPConnected = function(origin, originId) {
    var iframe = $("iframe[src='" + origin + "']");
    if($(iframe).length > 0) {
      $(iframe).each(function(index, iframe) {
        if(typeof $(iframe).attr("wappid") === "undefined") {
          V.Editor.Object.Webapp.convertIframeToWebApp(iframe)
        }
      })
    }
  };
  return{init:init, onWAPPConnected:onWAPPConnected}
}(VISH, jQuery);
VISH.Editor.PDFex = function(V, $, undefined) {
  var uploadDivId = "tab_pdfex_content";
  var init = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    $("#" + uploadDivId + " input[name='pdfex[attach]']").change(function() {
      var filterFilePath = V.Editor.Utils.filterFilePath($("#" + uploadDivId + " input:file").val());
      $("#" + uploadDivId + " input[name='pdfex[title]']").val(filterFilePath);
      _resetUploadFields();
      $("#" + uploadDivId + " form" + " .button").show();
      $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide()
    });
    $("#" + uploadDivId + " #upload_pdfex_submit").click(function(event) {
      if(!V.Police.validateFileUpload($("#" + uploadDivId + " input[name='pdfex[attach]']").val())[0]) {
        event.preventDefault()
      }else {
        $("#" + uploadDivId + " input[name='pdfex[owner_id]']").val(V.User.getId());
        $("#" + uploadDivId + " input[name='authenticity_token']").val(V.User.getToken());
        $("#" + uploadDivId + " .documentsForm").attr("action", V.UploadPDF2PPath);
        $("#" + uploadDivId + " .upload_progress_bar_wrapper").show()
      }
    });
    $("#" + uploadDivId + " form").ajaxForm({beforeSend:function() {
      var percentVal = "0%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, uploadProgress:function(event, position, total, percentComplete) {
      var percentVal = percentComplete + "%";
      bar.width(percentVal);
      percent.html(percentVal);
      if(percentVal === "100%") {
        V.Utils.Loader.startLoading()
      }
    }, success:function(responseText, statusText, xhr, form) {
      if(V.Debugging.isDevelopping() !== true) {
        processResponse(responseText)
      }
      var percentVal = "100%";
      bar.width(percentVal);
      percent.html(percentVal)
    }, complete:function(xhr) {
      if(V.Debugging.isDevelopping()) {
        setTimeout(function() {
          var responseTest = {};
          responseTest.urls = [];
          for(var v = 0;v < 13;v++) {
            responseTest.urls.push("http://localhost/examples/contents/pdf2p/Presentacion_INTED2013_VishViewer-" + v + ".jpg")
          }
          responseTest.pdfexId = 365;
          processResponse(responseTest)
        }, 1E4)
      }
    }, error:function(error) {
      if(V.Debugging.isDevelopping()) {
        return
      }
      var PDFexAPIError = error;
      V.Utils.Loader.stopLoading(function() {
        if(typeof PDFexAPIError != "undefined" && typeof PDFexAPIError.responseText == "string") {
          if(PDFexAPIError.responseText.match(/#PDFexAPIError:1/)) {
            _showErrorDialog(V.I18n.getTrans("i.pdfErrorNotificationFormat"))
          }else {
            if(PDFexAPIError.responseText.match(/#PDFexAPIError:2/)) {
              _showErrorDialog(V.I18n.getTrans("i.pdfErrorNotificationSize"))
            }else {
              if(PDFexAPIError.responseText.match(/#PDFexAPIError:3/)) {
                _showErrorDialog(V.I18n.getTrans("i.pdfErrorNotificationPages"))
              }else {
                _showErrorDialog(V.I18n.getTrans("i.pdfErrorNotification"))
              }
            }
          }
        }
      })
    }})
  };
  var onLoadTab = function() {
    $("#" + uploadDivId + " form" + " .button").hide();
    $("#" + uploadDivId + " .upload_progress_bar_wrapper").hide();
    $("#" + uploadDivId + " input[name='pdfex[attach]']").val("");
    _resetUploadFields()
  };
  var _resetUploadFields = function() {
    var bar = $("#" + uploadDivId + " .upload_progress_bar");
    var percent = $("#" + uploadDivId + " .upload_progress_bar_percent");
    bar.width("0%");
    percent.html("0%")
  };
  var _showErrorDialog = function(msg) {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = msg;
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var processResponse = function(jsonResponse) {
    try {
      var presentation = _generatePresentationWithImgArray(jsonResponse.urls, jsonResponse.pdfexId);
      V.Editor.Presentation.previewPresentation(presentation)
    }catch(e) {
      V.Utils.Loader.stopLoading()
    }
  };
  var _generatePresentationWithImgArray = function(imgs, pdfexId) {
    var elements = [];
    var imgL = imgs.length;
    for(var i = 0;i < imgL;i++) {
      elements.push({"body":imgs[i], "type":V.Constant.IMAGE})
    }
    var options = {template:"t10", pdfexId:pdfexId};
    return V.Editor.Presentation.generatePresentationScaffold(elements, options)
  };
  return{init:init, onLoadTab:onLoadTab}
}(VISH, jQuery);
VISH.Editor.Presentation.File = function(V, $, undefined) {
  var fileDivId = "tab_efile_content";
  var inputFileId = "efile_input";
  var buttonId = "efile_preview_button";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      var previewButton = $("#" + buttonId);
      var formInputEl = $("#" + inputFileId);
      $(previewButton).click(function() {
        var files = $("#" + inputFileId)[0].files;
        if(files.length > 0) {
          _insertFile(files[0])
        }else {
          _showErrorDialog(V.I18n.getTrans("i.NoFileError"))
        }
      });
      $(formInputEl).change(function() {
        $(previewButton).show()
      });
      initialized = true
    }
  };
  var onLoadTab = function(tab) {
    $("#" + buttonId).hide();
    $("#" + inputFileId).attr("value", "")
  };
  var _insertFile = function(file) {
    var fileType = undefined;
    if(file.type != "") {
      if(file.type.match("text/xml")) {
        fileType = "xml"
      }else {
        if(file.type.match("json")) {
          fileType = "json"
        }else {
          if(file.type.match("application/zip")) {
            fileType = "zip"
          }
        }
      }
    }else {
      var objectInfo = V.Object.getObjectInfo(file.name);
      if(objectInfo.type === "json" || objectInfo === "xml") {
        fileType = objectInfo.type
      }
    }
    if(typeof fileType == "undefined") {
      _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
      return
    }
    var reader = new FileReader;
    reader.onload = function(theFile) {
      return function(e) {
        switch(fileType) {
          case "xml":
            if(V.Editor.IMSQTI.isCompliantXMLFile(e.target.result)) {
              var json = V.Editor.IMSQTI.getJSONFromXMLFile(e.target.result);
              V.Editor.Presentation.previewPresentation(json)
            }else {
              if(V.Editor.MoodleXML.isCompliantXMLFile(e.target.result)) {
                var moodleXMLFileAnalysis = V.Editor.MoodleXML.getJSONFromXMLFile(e.target.result);
                var json = moodleXMLFileAnalysis.json;
                switch(moodleXMLFileAnalysis.questionsSupported) {
                  case "ALL":
                    V.Editor.Presentation.previewPresentation(json);
                    break;
                  case "SEVERAL":
                    var options = {};
                    options.text = V.I18n.getTrans("i.QuizErrorQuestionsUnsupported");
                    var button1 = {};
                    button1.text = V.I18n.getTrans("i.Ok");
                    button1.callback = function() {
                      V.Editor.Presentation.previewPresentation(json)
                    };
                    options.buttons = [button1];
                    V.Utils.showDialog(options);
                    break;
                  case "NONE":
                  ;
                  default:
                    _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
                    break
                }
              }else {
                _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
                return
              }
            }
            break;
          case "json":
            try {
              var json = JSON.parse(e.target.result);
              V.Editor.Presentation.previewPresentation(json)
            }catch(e) {
              _showErrorDialog(V.I18n.getTrans("i.readJSONfileError"))
            }
            break;
          case "zip":
            try {
              var zip = new JSZip(e.target.result);
              var uncompressedfile = zip.file(/.xml/)
            }catch(e) {
              _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
              return
            }
            if(uncompressedfile.length == 1) {
              var targetFile = uncompressedfile[0].asText();
              if(V.Editor.IMSQTI.isCompliantXMLFile(targetFile)) {
                var json = V.Editor.IMSQTI.getJSONFromXMLFile(targetFile);
                V.Editor.Presentation.previewPresentation(json)
              }else {
                if(V.Editor.MoodleXML.isCompliantXMLFile(targetFile)) {
                  var moodleXMLFileAnalysis = V.Editor.MoodleXML.getJSONFromXMLFile(targetFile);
                  var json = moodleXMLFileAnalysis.json;
                  switch(moodleXMLFileAnalysis.questionsSupported) {
                    case "ALL":
                      V.Editor.Presentation.previewPresentation(json);
                      break;
                    case "SEVERAL":
                      var options = {};
                      options.text = V.I18n.getTrans("i.QuizErrorQuestionsUnsupported");
                      var button1 = {};
                      button1.text = V.I18n.getTrans("i.Ok");
                      button1.callback = function() {
                        V.Editor.Presentation.previewPresentation(json)
                      };
                      options.buttons = [button1];
                      V.Utils.showDialog(options);
                      break;
                    case "NONE":
                    ;
                    default:
                      _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
                      break
                  }
                }else {
                  _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
                  return
                }
              }
            }else {
              if(uncompressedfile.length > 1) {
                var quizesArray = [];
                for(var i = 0;i < uncompressedfile.length;i++) {
                  if(uncompressedfile[i].name != "imsmanifest.xml") {
                    var iterationFile = uncompressedfile[i].asText();
                    if(V.Editor.IMSQTI.isCompliantXMLFile(iterationFile)) {
                      var json = V.Editor.IMSQTI.getJSONFromXMLFile(iterationFile);
                      quizesArray.push(json.slides[0])
                    }
                  }
                }
                if(quizesArray.length > 0) {
                  var finalJson = {"VEVersion":"0.9.1", "type":"presentation", "theme":"theme1", "slides":quizesArray};
                  V.Editor.Presentation.previewPresentation(finalJson)
                }else {
                  _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"))
                }
              }else {
                _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"))
              }
            }
            break;
          default:
            _showErrorDialog(V.I18n.getTrans("i.NoSupportedFileError"));
            return
        }
      }
    }(file);
    if(fileType != "zip") {
      reader.readAsText(file)
    }else {
      reader.readAsArrayBuffer(file)
    }
  };
  var _showErrorDialog = function(msg) {
    var options = {};
    options.width = 650;
    options.height = 190;
    options.text = msg;
    var button1 = {};
    button1.text = V.I18n.getTrans("i.Ok");
    button1.callback = function() {
      V.Editor.Tools.Menu.insertEFile()
    };
    options.buttons = [button1];
    V.Utils.showDialog(options)
  };
  var exportTo = function(format, successCallback, failCallback) {
    var presentation = V.Editor.savePresentation();
    V.Editor.API.uploadTmpJSON(presentation, format, successCallback, failCallback)
  };
  return{init:init, onLoadTab:onLoadTab, exportTo:exportTo}
}(VISH, jQuery);
VISH.Editor.Preview = function(V, $, undefined) {
  var presentationPreview = null;
  var init = function() {
    setTimeout(function() {
      _realInit()
    }, 2E3)
  };
  var _realInit = function() {
    $("#preview_action").fancybox({"width":910, "height":680, "padding":0, "autoScale":false, "transitionIn":"none", "transitionOut":"none", "type":"iframe", "onStart":function() {
      if(presentationPreview === null) {
        _prepare()
      }
      V.Editor.Utils.Loader.unloadObjectsInEditorSlide(V.Slides.getCurrentSlide())
    }, "onClosed":function() {
      presentationPreview = null;
      V.Editor.Utils.Loader.loadObjectsInEditorSlide(V.Slides.getCurrentSlide())
    }, "onComplete":function() {
      $("#fancybox-wrap").css("top", "45px");
      $("#fancybox-wrap").css("left", "135px");
      $("#fancybox-frame").addClass("vishEditorIframe")
    }})
  };
  var preview = function(options) {
    _prepare(options);
    $("#preview_action").trigger("click")
  };
  var _prepare = function(options) {
    var slideNumberToPreview;
    if(!options || (!options["slideNumberToPreview"] || typeof options["slideNumberToPreview"] != "number")) {
      slideNumberToPreview = V.Slides.getCurrentSlideNumber()
    }else {
      slideNumberToPreview = options["slideNumberToPreview"]
    }
    if(typeof V.PreviewPresentationPath != "undefined") {
      $("#preview_action").attr("href", V.PreviewPresentationPath + "#" + slideNumberToPreview)
    }
    if(!options || (!options["presentationJSON"] || typeof options["presentationJSON"] != "object")) {
      presentationPreview = V.Editor.savePresentation()
    }else {
      presentationPreview = options["presentationJSON"]
    }
    if(options && (options["insertMode"] && typeof options["insertMode"] == "boolean")) {
      presentationPreview.insertMode = options["insertMode"]
    }
  };
  var getPreview = function() {
    return presentationPreview
  };
  return{init:init, preview:preview, getPreview:getPreview}
}(VISH, jQuery);
VISH.Editor.Quiz.MC = function(V, $, undefined) {
  var addQuizOptionButtonClass = "add_quiz_option_mc";
  var deleteQuizOptionButtonClass = "delete_quiz_option_mc";
  var mcCheckbox = "mcCheckbox";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "mcContainer", _clickOnQuizArea);
      $(document).on("click", "." + addQuizOptionButtonClass, _clickToAddOptionInQuiz);
      $(document).on("click", "." + deleteQuizOptionButtonClass, _removeOptionInQuiz);
      $(document).on("click", "." + mcCheckbox, _onCheckboxClick);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "mcContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      case "mc_option_text":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.parentElement.id));
        break;
      case "mc_option":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.id));
        break;
      default:
        break
    }
  };
  var _onCheckboxClick = function(event) {
    var check = $(event.target).attr("check");
    switch(check) {
      case "true":
        V.Quiz.updateCheckbox(event.target, "none");
        break;
      case "false":
        break;
      case "none":
      ;
      default:
        V.Quiz.updateCheckbox(event.target, "true");
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.MCHOICE);
    _launchTextEditorForQuestion(area);
    _addOptionInQuiz(area);
    V.Editor.addDeleteButton(area)
  };
  var _getDummy = function() {
    return"<div class='mcContainer'><div class='mc_question_wrapper'></div><ul class='mc_options'></ul><img src='" + V.ImagesPath + "icons/add.png' class='" + addQuizOptionButtonClass + "'/><input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getOptionDummy = function() {
    return"<li class='mc_option'><div class='mc_option_wrapper'><span class='mc_option_index'></span><div class='mc_option_text'></div><table class='mc_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "icons/ve_delete.png' class='" + deleteQuizOptionButtonClass + "'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + mcCheckbox + "' check='none'/></td></tr></table></div></li>"
  };
  var _clickToAddOptionInQuiz = function(event) {
    var area = $("#" + event.target.parentElement.parentElement.id);
    V.Editor.setCurrentArea(area);
    _addOptionInQuiz(area)
  };
  var _addOptionInQuiz = function(area, value, check) {
    var nChoices = $(area).find("li.mc_option").size();
    var quiz_option = $(_getOptionDummy()).attr("nChoice", nChoices + 1);
    $(area).find(".mc_options").append(quiz_option);
    _refreshChoicesIndexs(area);
    if(check) {
      V.Quiz.updateCheckbox($(quiz_option).find("td > img")[1], check)
    }
    _launchTextEditorForOptions(area, nChoices, value);
    if(nChoices > 0) {
      $(area).find("li[nChoice='" + (nChoices + 1) + "']").find("." + deleteQuizOptionButtonClass).css("visibility", "visible")
    }
  };
  var _removeOptionInQuiz = function(event) {
    var area = $("div[type='quiz']").has(event.target);
    V.Editor.setCurrentArea(area);
    var liToRemove = $("li.mc_option").has(event.target);
    $(liToRemove).remove();
    _refreshChoicesIndexs(area)
  };
  var _refreshChoicesIndexs = function(area) {
    $(area).find("li.mc_option").each(function(index, option_element) {
      $(option_element).find(".mc_option_index").text(String.fromCharCode(96 + index + 1) + ")")
    })
  };
  var _launchTextEditorForQuestion = function(area, question) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForOptions = function(area, nChoice, value) {
    var first = nChoice === 0;
    var textArea = $(area).find(".mc_option_text")[nChoice];
    if(!value) {
      if(first) {
        V.Editor.Text.launchTextEditor({}, textArea, V.I18n.getTrans("i.QuizzesWriteOptions"), {forceNew:true, fontSize:24, autogrow:true, placeholder:true})
      }else {
        V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:24, autogrow:true, focus:true})
      }
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, value, {autogrow:true})
    }
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = V.Constant.QZ_TYPE.MCHOICE;
    quiz.selfA = false;
    quiz.extras = {};
    quiz.extras.multipleAnswer = false;
    var nAnswers = 0;
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    quiz.choices = [];
    var nChoices = $(area).find("li.mc_option").size();
    var optionTextAreas = $(area).find(".mc_option_text");
    for(var i = 0;i < nChoices;i++) {
      var textArea = optionTextAreas[i];
      var optionInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      var choice = {};
      choice.id = (i + 1).toString();
      choice.value = optionInstance.getPlainText();
      choice.wysiwygValue = optionInstance.getData();
      if($(textArea).parent().find(".mcCheckbox").attr("check") === "true") {
        choice.answer = true;
        quiz.selfA = true;
        nAnswers++
      }else {
        choice.answer = "?"
      }
      quiz.choices.push(choice)
    }
    if(quiz.selfA) {
      $(quiz.choices).each(function(index, choice) {
        if(choice.answer !== true) {
          choice.answer = false
        }
      })
    }
    if(nAnswers > 1) {
      quiz.extras.multipleAnswer = true
    }
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.MCHOICE);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    V.Editor.addDeleteButton(area);
    $(quiz.choices).each(function(index, choice) {
      var check = undefined;
      if(quiz.selfA) {
        if(choice.answer === true) {
          check = "true"
        }
      }
      _addOptionInQuiz(area, choice.wysiwygValue, check)
    })
  };
  var isSelfAssessment = function(quizDOM) {
    var sA = false;
    $(quizDOM).find("img.mcCheckbox").each(function(index, checkbox) {
      if($(checkbox).attr("check") === "true") {
        sA = true
      }
    });
    return sA
  };
  return{init:init, add:add, save:save, draw:draw, isSelfAssessment:isSelfAssessment}
}(VISH, jQuery);
VISH.Editor.Quiz.Open = function(V, $, undefined) {
  var initialized = false;
  var qCheckbox = "openQCheckbox";
  var SHORT_ANSWER_MAX_WORDS = 6;
  var SHORT_ANSWER_MAX_CHARS = 40;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "openQContainer", _clickOnQuizArea);
      $(document).on("click", "." + qCheckbox, _onCheckboxClick);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "openQContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      default:
        break
    }
  };
  var _onCheckboxClick = function(event) {
    var check = $(event.target).attr("check");
    switch(check) {
      case "true":
        V.Quiz.updateCheckbox(event.target, "none");
        break;
      case "false":
        break;
      case "none":
      ;
      default:
        V.Quiz.updateCheckbox(event.target, "true");
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.OPEN);
    _launchTextEditorForQuestion(area);
    _launchTextEditorForAnswer(area);
    V.Editor.addDeleteButton(area)
  };
  var _getDummy = function() {
    return"<div class='openQContainer'><div class='mc_question_wrapper'></div>" + _getAnswerDummy() + "<input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getAnswerDummy = function() {
    return"<div class='openq_answer_wrapper'><div class='openq_answer_text'></div><table class='open_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + qCheckbox + "' check='none'/></td></tr></table></div>"
  };
  var _launchTextEditorForQuestion = function(area, question, callback) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForAnswer = function(area, answer, callback) {
    var textArea = $(area).find(".openq_answer_text");
    if(!answer) {
      V.Editor.Text.launchTextEditor({}, textArea, V.I18n.getTrans("i.QuizzesWriteOptionsOpen"), {forceNew:true, fontSize:24, autogrow:true, placeholder:true, onKeyup:_onAnswerKeyUp, callback:callback})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, answer, {autogrow:true, onKeyup:_onAnswerKeyUp, callback:callback})
    }
  };
  var _onAnswerKeyUp = function(area, ckeditorInstance) {
    var checkBox = $(area).parent().find("img.openQCheckbox");
    var checkBoxDisabled = $(checkBox).hasClass("quizCheckBoxDisabled");
    var answer = ckeditorInstance.getPlainText();
    try {
      var charCount = answer.length;
      var wordCount = answer.match(/\w+/g).length
    }catch(e) {
      var charCount = 0;
      var wordCount = 0
    }
    if(wordCount > SHORT_ANSWER_MAX_WORDS || charCount > SHORT_ANSWER_MAX_CHARS) {
      if(!checkBoxDisabled) {
        _disableCheckBox(checkBox)
      }
    }else {
      if(checkBoxDisabled) {
        _enableCheckBox(checkBox)
      }
    }
  };
  var _disableCheckBox = function(checkbox) {
    $(checkbox).addClass("quizCheckBoxDisabled");
    $(checkbox).prop("disabled", true);
    V.Quiz.updateCheckbox(checkbox, "none")
  };
  var _enableCheckBox = function(checkbox) {
    $(checkbox).removeClass("quizCheckBoxDisabled");
    $(checkbox).prop("disabled", false);
    V.Quiz.updateCheckbox(checkbox, "none")
  };
  var isSelfAssessment = function(quizDOM) {
    var openCheckBox = $(quizDOM).find("img.openQCheckbox");
    return $(openCheckBox).attr("check") === "true" && $(openCheckBox).hasClass("quizCheckBoxDisabled") === false
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = V.Constant.QZ_TYPE.OPEN;
    quiz.selfA = isSelfAssessment(area);
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    var answerInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".openq_answer_text"));
    quiz.answer = {};
    quiz.answer.value = answerInstance.getPlainText();
    quiz.answer.wysiwygValue = answerInstance.getData();
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.OPEN);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    _launchTextEditorForAnswer(area, quiz.answer.wysiwygValue, function() {
      var openQAnswerTextArea = $(area).find("div.openq_answer_text");
      _onAnswerKeyUp(openQAnswerTextArea, V.Editor.Text.getCKEditorFromTextArea(openQAnswerTextArea))
    });
    if(quiz.selfA) {
      var checkBox = $(area).find("img.openQCheckbox");
      _enableCheckBox(checkBox);
      V.Quiz.updateCheckbox(checkBox, "true")
    }
    V.Editor.addDeleteButton(area)
  };
  return{init:init, add:add, save:save, draw:draw, isSelfAssessment:isSelfAssessment}
}(VISH, jQuery);
VISH.Editor.Quiz.Sorting = function(V, $, undefined) {
  var addQuizOptionButtonClass = "add_quiz_option_sorting";
  var deleteQuizOptionButtonClass = "delete_quiz_option_sorting";
  var initialized = false;
  var ckEditorTmpData;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "sortingQContainer", _clickOnQuizArea);
      $(document).on("click", "." + addQuizOptionButtonClass, _clickToAddOptionInQuiz);
      $(document).on("click", "." + deleteQuizOptionButtonClass, _removeOptionInQuiz);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "sortingQContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      case "mc_option_text":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.parentElement.id));
        break;
      case "mc_option":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.id));
        break;
      default:
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.SORTING);
    _launchTextEditorForQuestion(area);
    _addOptionInQuiz(area);
    V.Editor.addDeleteButton(area);
    _applySortable(area)
  };
  var _applySortable = function(area) {
    $(area).find(".mc_options").sortable({cursor:"move", start:function(event, ui) {
      try {
        var textArea = $(ui.item).find(".wysiwygTextArea");
        var ckEditorInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
        ckEditorTmpData = ckEditorInstance.getData()
      }catch(e) {
        ckEditorTmpData = undefined
      }
    }, stop:function(event, ui) {
      var textArea = $(ui.item).find(".wysiwygTextArea");
      var ckEditorInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      ckEditorInstance.destroy();
      if(typeof ckEditorTmpData != "string" || $(ckEditorTmpData).text().trim() == "\u00ad") {
        V.Editor.Text.launchTextEditor({}, $(textArea).parent(), "", {forceNew:true, fontSize:24, autogrow:true, focus:false, disableTmpShown:true})
      }else {
        V.Editor.Text.launchTextEditor({}, $(textArea).parent(), ckEditorTmpData, {autogrow:true, disableTmpShown:true})
      }
      ckEditorTmpData = undefined;
      _refreshChoicesIndex(area)
    }})
  };
  var _getDummy = function() {
    return"<div class='sortingQContainer'><div class='mc_question_wrapper'></div><ul class='mc_options'></ul><img src='" + V.ImagesPath + "icons/add.png' class='" + addQuizOptionButtonClass + "'/><input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getOptionDummy = function() {
    return"<li class='mc_option'><div class='mc_option_wrapper'><span class='mc_option_index sorting_option_index'></span><div class='mc_option_text sorting_option_text'></div><table class='mc_checks sorting_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "icons/ve_delete.png' class='" + deleteQuizOptionButtonClass + "'/></td></tr></table></div></li>"
  };
  var _clickToAddOptionInQuiz = function(event) {
    var area = $("#" + event.target.parentElement.parentElement.id);
    V.Editor.setCurrentArea(area);
    _addOptionInQuiz(area)
  };
  var _addOptionInQuiz = function(area, value) {
    var nChoices = $(area).find("li.mc_option").size();
    var quiz_option = $(_getOptionDummy()).attr("nChoice", nChoices + 1);
    $(area).find(".mc_options").append(quiz_option);
    _refreshChoicesIndex(area);
    _launchTextEditorForOptions(area, nChoices, value);
    if(nChoices > 0) {
      $(area).find("li[nChoice='" + (nChoices + 1) + "']").find("." + deleteQuizOptionButtonClass).css("visibility", "visible")
    }
  };
  var _removeOptionInQuiz = function(event) {
    var area = $("div[type='quiz']").has(event.target);
    V.Editor.setCurrentArea(area);
    var liToRemove = $("li.mc_option").has(event.target);
    $(liToRemove).remove();
    _refreshChoicesIndex(area)
  };
  var _refreshChoicesIndex = function(area) {
    var choices = $(area).find("li.mc_option");
    var nChoices = $(choices).length;
    $(choices).each(function(index, optEl) {
      var deleteButton = $(optEl).find("." + deleteQuizOptionButtonClass);
      if(index === 0 && nChoices === 1) {
        $(deleteButton).css("visibility", "hidden")
      }else {
        $(deleteButton).css("visibility", "visible")
      }
      $(optEl).find(".sorting_option_index").text((index + 1).toString() + ")")
    })
  };
  var _launchTextEditorForQuestion = function(area, question) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForOptions = function(area, nChoice, value) {
    var first = nChoice === 0;
    var textArea = $(area).find(".mc_option_text")[nChoice];
    if(!value) {
      if(first) {
        V.Editor.Text.launchTextEditor({}, textArea, V.I18n.getTrans("i.QuizzesWriteOptionsSorting"), {forceNew:true, fontSize:24, autogrow:true, placeholder:true})
      }else {
        V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:24, autogrow:true, focus:true})
      }
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, value, {autogrow:true})
    }
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = V.Constant.QZ_TYPE.SORTING;
    quiz.selfA = true;
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    quiz.choices = [];
    var nChoices = $(area).find("li.mc_option").size();
    var optionTextAreas = $(area).find(".mc_option_text");
    for(var i = 0;i < nChoices;i++) {
      var textArea = optionTextAreas[i];
      var optionInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      var choice = {};
      choice.id = (i + 1).toString();
      choice.value = optionInstance.getPlainText();
      choice.wysiwygValue = optionInstance.getData();
      choice.answer = i + 1;
      quiz.choices.push(choice)
    }
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.SORTING);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    V.Editor.addDeleteButton(area);
    $(quiz.choices).each(function(index, choice) {
      _addOptionInQuiz(area, choice.wysiwygValue)
    });
    _applySortable(area)
  };
  var isSelfAssessment = function() {
    return true
  };
  var afterCopyQuiz = function(quizDOM) {
    _applySortable(quizDOM)
  };
  return{init:init, add:add, save:save, draw:draw, isSelfAssessment:isSelfAssessment, afterCopyQuiz:afterCopyQuiz}
}(VISH, jQuery);
VISH.Editor.Quiz.TF = function(V, $, undefined) {
  var addQuizOptionButtonClass = "add_quiz_option_tf";
  var deleteQuizOptionButtonClass = "delete_quiz_option_tf";
  var tfCheckbox = "tfCheckbox";
  var initialized = false;
  var init = function() {
    if(!initialized) {
      $(document).on("click", "." + "mcContainer", _clickOnQuizArea);
      $(document).on("click", "." + addQuizOptionButtonClass, _clickToAddOptionInQuiz);
      $(document).on("click", "." + deleteQuizOptionButtonClass, _removeOptionInQuiz);
      $(document).on("click", "." + tfCheckbox, _onCheckboxClick);
      initialized = true
    }
  };
  var _clickOnQuizArea = function(event) {
    switch(event.target.classList[0]) {
      case "mcContainer":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.id));
        break;
      case "mc_option_text":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.parentElement.id));
        break;
      case "mc_option":
        V.Editor.setCurrentArea($("#" + event.target.parentElement.parentElement.parentElement.id));
        break;
      default:
        break
    }
  };
  var _onCheckboxClick = function(event) {
    var check = $(event.target).attr("check");
    var column = $(event.target).attr("column");
    switch(column) {
      case "true":
        if(check === "true") {
          V.Quiz.updateCheckbox(event.target, "none")
        }else {
          var falseColumnCheckbox = $("tr").has(event.target).find(".tfCheckbox[column='false']");
          V.Quiz.updateCheckbox(falseColumnCheckbox, "none");
          V.Quiz.updateCheckbox(event.target, "true")
        }
        break;
      case "false":
        if(check === "false") {
          V.Quiz.updateCheckbox(event.target, "none")
        }else {
          var trueColumnCheckbox = $("tr").has(event.target).find(".tfCheckbox[column='true']");
          V.Quiz.updateCheckbox(trueColumnCheckbox, "none");
          V.Quiz.updateCheckbox(event.target, "false")
        }
        break;
      default:
        break
    }
  };
  var add = function(area) {
    area.append(_getDummy());
    area.find(".menuselect_hide").remove();
    area.attr("type", "quiz");
    area.attr("quiztype", V.Constant.QZ_TYPE.TF);
    _launchTextEditorForQuestion(area);
    _addOptionInQuiz(area);
    V.Editor.addDeleteButton(area)
  };
  var _getDummy = function() {
    return"<div class='tfContainer'><div class='mc_question_wrapper'></div><ul class='mc_options'></ul><img src='" + V.ImagesPath + "icons/add.png' class='" + addQuizOptionButtonClass + "'/><input type='hidden' name='quiz_id'/></div></div>"
  };
  var _getOptionDummy = function() {
    return"<li class='mc_option'><div class='mc_option_wrapper'><span class='mc_option_index'></span><div class='mc_option_text'></div><table class='mc_checks'><tr class='checkFirstRow'><td><img src='" + V.ImagesPath + "icons/ve_delete.png' class='" + deleteQuizOptionButtonClass + "'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + tfCheckbox + "' column='true' check='none'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox.png' class='" + tfCheckbox + "' column='false' check='none'/></td></tr></table></div></li>"
  };
  var _clickToAddOptionInQuiz = function(event) {
    var area = $("#" + event.target.parentElement.parentElement.id);
    V.Editor.setCurrentArea(area);
    _addOptionInQuiz(area)
  };
  var _addOptionInQuiz = function(area, value, check) {
    var nChoices = $(area).find("li.mc_option").size();
    var quiz_option = _getOptionDummy();
    var quiz_option = $(quiz_option).attr("nChoice", nChoices + 1);
    $(area).find(".mc_options").append(quiz_option);
    _refreshChoicesIndexs(area);
    if(check === "true") {
      V.Quiz.updateCheckbox($(quiz_option).find("td > img")[1], check)
    }else {
      if(check === "false") {
        V.Quiz.updateCheckbox($(quiz_option).find("td > img")[2], check)
      }
    }
    _launchTextEditorForOptions(area, nChoices, value);
    if(nChoices > 0) {
      $(area).find("li[nChoice='" + (nChoices + 1) + "']").find("." + deleteQuizOptionButtonClass).css("visibility", "visible")
    }
  };
  var _removeOptionInQuiz = function(event) {
    var area = $("div[type='quiz']").has(event.target);
    V.Editor.setCurrentArea(area);
    var liToRemove = $("li.mc_option").has(event.target);
    $(liToRemove).remove();
    _refreshChoicesIndexs(area)
  };
  var _refreshChoicesIndexs = function(area) {
    $(area).find("li.mc_option").each(function(index, option_element) {
      $(option_element).find(".mc_option_index").text(String.fromCharCode(96 + index + 1) + ")")
    })
  };
  var _launchTextEditorForQuestion = function(area, question) {
    var textArea = $(area).find(".mc_question_wrapper");
    if(!question) {
      V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:38, focus:true, autogrow:true})
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, question, {autogrow:true})
    }
  };
  var _launchTextEditorForOptions = function(area, nChoice, value) {
    var first = nChoice === 0;
    var textArea = $(area).find(".mc_option_text")[nChoice];
    if(!value) {
      if(first) {
        V.Editor.Text.launchTextEditor({}, textArea, V.I18n.getTrans("i.QuizzesWriteOptions"), {forceNew:true, fontSize:24, autogrow:true, placeholder:true})
      }else {
        V.Editor.Text.launchTextEditor({}, textArea, "", {forceNew:true, fontSize:24, autogrow:true, focus:true})
      }
    }else {
      V.Editor.Text.launchTextEditor({}, textArea, value, {autogrow:true})
    }
  };
  var save = function(area) {
    var textArea = $(area).find(".mc_question_wrapper");
    var quiz = {};
    quiz.quizType = V.Constant.QZ_TYPE.TF;
    quiz.selfA = false;
    var questionInstance = V.Editor.Text.getCKEditorFromTextArea($(area).find(".mc_question_wrapper"));
    quiz.question = {};
    quiz.question.value = questionInstance.getPlainText();
    quiz.question.wysiwygValue = questionInstance.getData();
    quiz.choices = [];
    var nChoices = $(area).find("li.mc_option").size();
    var optionTextAreas = $(area).find(".mc_option_text");
    for(var i = 0;i < nChoices;i++) {
      var textArea = optionTextAreas[i];
      var optionInstance = V.Editor.Text.getCKEditorFromTextArea(textArea);
      var choice = {};
      choice.id = (i + 1).toString();
      choice.value = optionInstance.getPlainText();
      choice.wysiwygValue = optionInstance.getData();
      var trueColumCheckbox = $(textArea).parent().find(".tfCheckbox[column='true']");
      if($(trueColumCheckbox).attr("check") === "true") {
        choice.answer = true;
        quiz.selfA = true
      }else {
        var falseColumCheckbox = $(textArea).parent().find(".tfCheckbox[column='false']");
        if($(falseColumCheckbox).attr("check") === "false") {
          choice.answer = false;
          quiz.selfA = true
        }else {
          choice.answer = "?"
        }
      }
      quiz.choices.push(choice)
    }
    return quiz
  };
  var draw = function(area, quiz) {
    $(area).append(_getDummy());
    $(area).attr("type", V.Constant.QUIZ);
    $(area).attr("quiztype", V.Constant.QZ_TYPE.TF);
    _launchTextEditorForQuestion(area, quiz.question.wysiwygValue);
    V.Editor.addDeleteButton(area);
    $(quiz.choices).each(function(index, choice) {
      var check = undefined;
      if(quiz.selfA) {
        if(choice.answer === true) {
          check = "true"
        }else {
          if(choice.answer === false) {
            check = "false"
          }
        }
      }
      _addOptionInQuiz(area, choice.wysiwygValue, check)
    })
  };
  var isSelfAssessment = function(quizDOM) {
    var sA = false;
    $(quizDOM).find("img.tfCheckbox").each(function(index, checkbox) {
      if($(checkbox).attr("check") === "true" || $(checkbox).attr("check") === "false") {
        sA = true
      }
    });
    return sA
  };
  return{init:init, add:add, save:save, draw:draw, isSelfAssessment:isSelfAssessment}
}(VISH, jQuery);
VISH.Editor.Renderer = function(V, $, undefined) {
  var _isRendering;
  var init = function(presentation) {
    _isRendering = false;
    V.Editor.Animations.setCurrentAnimation(presentation.animation);
    if(presentation.type === V.Constant.PRESENTATION) {
      renderPresentation(presentation)
    }else {
      if(presentation.type === V.Constant.QUIZ_SIMPLE) {
        presentation.type = V.Constant.PRESENTATION;
        renderPresentation(presentation)
      }
    }
  };
  var renderPresentation = function(presentation) {
    _isRendering = true;
    var slides = presentation.slides;
    for(var i = 0;i < slides.length;i++) {
      var slideNumber = V.Slides.getSlidesQuantity() + 1;
      var type = slides[i].type;
      if(type === V.Constant.STANDARD) {
        _renderSlide(slides[i], {slideNumber:slideNumber})
      }else {
        var isSlideset = V.Slideset.isSlideset(type);
        if(isSlideset) {
          _renderSlideset(slides[i], slideNumber)
        }
      }
    }
    _isRendering = false
  };
  var _renderSlide = function(slide, renderOptions) {
    var options = {};
    options.template = "1";
    if(slide.template) {
      options.template = slide.template.substring(1)
    }
    options.slideNumber = renderOptions.slideNumber;
    var scaffold = V.Editor.Dummies.getScaffoldForSlide(slide, options);
    if(!renderOptions.subslide) {
      V.Editor.Slides.appendSlide(scaffold);
      V.Slides.updateSlides();
      V.Slides.lastSlide()
    }else {
      V.Editor.Slides.appendSubslide(renderOptions.slidesetDOM, scaffold);
      var scaffoldDOM = $("#" + $(scaffold).attr("id"));
      V.Utils.addTempShown(scaffoldDOM)
    }
    var slideElementsLength = slide.elements.length;
    for(var i = 0;i < slideElementsLength;i++) {
      var element = slide.elements[i];
      var zoneId = element.id;
      var area = $("div#" + zoneId + "[areaid='" + element.areaid + "']");
      if(area.length === 0) {
        continue
      }
      if(element.settings) {
        var serializedSettings = JSON.stringify(element.settings);
        $(area).attr("elSettings", serializedSettings)
      }
      if(element.type === V.Constant.TEXT) {
        V.Editor.Text.launchTextEditor({}, area, element.body)
      }else {
        if(element.type === V.Constant.IMAGE) {
          V.Editor.Image.drawImage(element.body, area, element.style, element.hyperlink, element.options)
        }else {
          if(element.type === V.Constant.VIDEO) {
            var options = [];
            options["poster"] = element.poster;
            options["autoplay"] = element.autoplay;
            V.Editor.Video.HTML5.drawVideo(V.Video.HTML5.getSourcesFromJSON(element), options, area, element.style)
          }else {
            if(element.type === V.Constant.AUDIO) {
              var options = [];
              options["autoplay"] = element.autoplay;
              V.Editor.Audio.HTML5.drawAudio(V.Audio.HTML5.getSourcesFromJSON(element), options, area, element.style)
            }else {
              if(element.type === V.Constant.OBJECT) {
                V.Editor.Object.drawObject(element.body, {area:area, style:element.style, zoomInStyle:element.zoomInStyle})
              }else {
                if(element.type === V.Constant.SNAPSHOT) {
                  V.Editor.Object.Snapshot.drawSnapShot(element.body, area, element.style, element.scrollTop, element.scrollLeft)
                }else {
                  if(element.type === V.Constant.QUIZ) {
                    V.Editor.Quiz.draw(area, element)
                  }
                }
              }
            }
          }
        }
      }
      var hideTooltip = true;
      if(V.Editor.isZoneEmpty(area)) {
        hideTooltip = false;
        $(area).addClass("editable")
      }
      V.Editor.Tools.addTooltipToZone(area, hideTooltip)
    }
    if(renderOptions.subslide) {
      V.Utils.removeTempShown(scaffoldDOM)
    }
  };
  var _renderSlideset = function(slidesetJSON, slideNumber) {
    var options = {};
    options.slideNumber = slideNumber;
    options.slidesetId = slidesetJSON.id.toString();
    var scaffold = V.Editor.Dummies.getScaffoldForSlide(slidesetJSON, options);
    if(scaffold) {
      V.Editor.Slides.appendSlide(scaffold);
      V.Slides.updateSlides();
      V.Slides.lastSlide();
      var slidesetId = $(scaffold).attr("id");
      var scaffoldDOM = $("#" + slidesetId);
      var subslides = slidesetJSON.slides;
      if(subslides) {
        var ssL = subslides.length;
        for(var i = 0;i < ssL;i++) {
          var subslideJSON = subslides[i];
          _renderSlide(subslideJSON, {slidesetDOM:scaffoldDOM, slideNumber:i + 1, subslide:true})
        }
      }
      var slidesetCreator = V.Editor.Slideset.getCreatorModule(slidesetJSON.type);
      slidesetCreator.draw(slidesetJSON, scaffoldDOM)
    }
  };
  var isRendering = function() {
    return _isRendering
  };
  return{init:init, renderPresentation:renderPresentation, isRendering:isRendering}
}(VISH, jQuery);
VISH.Editor.Scrollbar = function(V, $, undefined) {
  var createScrollbar = function(containerId, options) {
    if(!containerId) {
      return
    }
    var callback = null;
    var horizontalScroll = false;
    if(options) {
      if(options["callback"]) {
        callback = options["callback"]
      }
      if(options["horizontalScroll"]) {
        horizontalScroll = options["horizontalScroll"]
      }
    }
    var scrollbar = $("#" + containerId);
    $(scrollbar).mCustomScrollbar({scrollInertia:0, autoDraggerLength:true, horizontalScroll:horizontalScroll});
    $(scrollbar).find(".mCSB_container").css("margin-right", "5px");
    setTimeout(function() {
      $(scrollbar).mCustomScrollbar("update");
      setTimeout(function() {
        if(options && options.scrollTop === true) {
        }else {
          $(scrollbar).mCustomScrollbar("scrollTo", "bottom")
        }
        if(typeof callback === "function") {
          callback()
        }
      }, 150)
    }, 100);
    return
  };
  var cleanScrollbar = function(containerId) {
    var scrollbar = $("#" + containerId);
    $(scrollbar).html("");
    $(scrollbar).removeClass();
    return
  };
  var goToElement = function(containerId, element) {
    var elementId = $(element).attr("id");
    var hasId = typeof elementId == "string";
    if(!hasId) {
      var tmpId = V.Utils.getId("tmp");
      $(element).attr("id", tmpId);
      elementId = tmpId
    }
    $("#" + containerId).mCustomScrollbar("scrollTo", "#" + elementId);
    if(!hasId) {
      $(element).removeAttr("id", tmpId)
    }
  };
  var insertElement = function(containerId, element, posc) {
  };
  return{createScrollbar:createScrollbar, cleanScrollbar:cleanScrollbar, goToElement:goToElement}
}(VISH, jQuery);
VISH.Editor.Settings = function(V, $, undefined) {
  var tagsLoaded = false;
  var t1;
  var LOM_Difficulty;
  var presentationThumbnail;
  var _contributors;
  var init = function() {
    LOM_Difficulty = V.Editor.Utils.LOM.getDifficulty();
    _initSliders()
  };
  var _initSliders = function() {
    $("#slider-age").slider({range:true, min:0, max:30, values:[V.Constant.AGE_RANGE_MIN, V.Constant.AGE_RANGE_MAX], slide:function(event, ui) {
      _changeAgeRangeDisplayedValue(ui.values[0] + " - " + ui.values[1])
    }});
    _changeAgeRangeDisplayedValue(V.Constant.AGE_RANGE);
    $("#slider-difficulty").slider({min:0, max:5, value:[V.Constant.DIFFICULTY], slide:function(event, ui) {
      $("#difficulty_range").attr("difficulty", ui.value);
      $("#difficulty_range").val(LOM_Difficulty[ui.value].text)
    }});
    $("#difficulty_range").attr("difficulty", V.Constant.DIFFICULTY);
    $("#difficulty_range").val(LOM_Difficulty[V.Constant.DIFFICULTY].text);
    if(!tagsLoaded) {
      $("#tagBoxIntro").attr("HTMLcontent", $("#tagBoxIntro").html());
      V.Utils.Loader.startLoadingInContainer($("#tagBoxIntro"), {style:"loading_tags"});
      V.Editor.API.requestTags(_onInitialTagsReceived, _onInitialTagsReceived)
    }
  };
  var displaySettings = function() {
    $("a#edit_presentation_details").fancybox({"autoDimensions":false, "autoScale":true, "scrolling":"no", "width":1E3, "height":700, "padding":0, "hideOnOverlayClick":false, "hideOnContentClick":false, "showCloseButton":false, "onComplete":function(data) {
      $("#fancybox-wrap").css("margin-top", "20px");
      _onDisplaySettings()
    }});
    $("a#edit_presentation_details").trigger("click")
  };
  var _onDisplaySettings = function() {
    var options = V.Utils.getOptions();
    onTLTchange();
    if(typeof V.Utils.getOptions().configuration.catalog === "undefined" || V.Utils.getOptions().configuration.catalog.length == 0) {
      $("#catalog_button").hide()
    }
    _checkIfEnableContinueButton()
  };
  var loadPresentationSettings = function(presentation) {
    if(!presentation) {
      presentation = {}
    }
    if(presentation.avatar) {
      _addThumbnail(presentation.avatar)
    }
    if(presentation.title) {
      $("#presentation_details_preview_addtitle_textarea").val(presentation.title);
      $("#presentation_details_input_title").val(presentation.title)
    }
    var author = _getAuthor(presentation);
    if(author) {
      var authorName = author.name;
      if(typeof authorName == "string") {
        var authorDOM = $("#author_span_in_preview");
        $(authorDOM).html(authorName)
      }
    }
    var catalog_tags = V.Utils.getOptions().configuration.catalog;
    if(catalog_tags) {
      for(var i = 0;i < catalog_tags.length;i++) {
        $("#catalog_tags").append($("<option />").val(catalog_tags[i]).attr("i18n-key", "i." + catalog_tags[i]).text(catalog_tags[i]))
      }
    }
    if(typeof presentation.contributors == "object") {
      _contributors = presentation.contributors
    }else {
      _contributors = []
    }
    if(presentation.description) {
      var descriptionDOM = $("#presentation_details_textarea");
      $(descriptionDOM).val(presentation.description)
    }
    var validLicenseValues = [];
    $("#presentation_details_license_select option").each(function(index, optionTag) {
      validLicenseValues.push($(optionTag).attr("value"))
    });
    var hasLicense = typeof presentation.license == "object" && (typeof presentation.license.key == "string" && validLicenseValues.indexOf(presentation.license.key) != -1);
    if(hasLicense) {
      $("#presentation_details_license_select").val(presentation.license.key)
    }
    if(V.Editor.hasBeenPublished()) {
      if(hasLicense) {
        var hasPrivateLicense = hasLicense && presentation.license.key === "private";
        if(!hasPrivateLicense) {
          $("#presentation_details_license_select").attr("disabled", "disabled")
        }
      }
    }
    if(hasLicense) {
      switch(presentation.license.key) {
        case "public":
          document.getElementById("presentation_details_license_select").title = "Public Domain";
          break;
        case "cc-by":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution";
          break;
        case "cc-by-sa":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution-ShareAlike";
          break;
        case "cc-by-nd":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution-NoDerivs";
          break;
        case "cc-by-nc":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution-NonCommercial";
          break;
        case "cc-by-nc-sa":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution-NonCommercial-ShareAlike";
          break;
        case "cc-by-nc-nd":
          document.getElementById("presentation_details_license_select").title = "Creative Commons Attribution-NonCommercial-NoDerivs";
          break;
        default:
          document.getElementById("presentation_details_license_select").title = ""
      }
    }
    selectTheme(V.Editor.Themes.Presentation.getCurrentTheme().number);
    if(presentation.language) {
      $("#language_tag").val(presentation.language)
    }
    if(presentation.context) {
      $("#context_tag").val(presentation.context)
    }
    if(presentation.age_range) {
      var start_range = presentation.age_range.substring(0, presentation.age_range.indexOf("-") - 1);
      var end_range = presentation.age_range.substring(presentation.age_range.indexOf("-") + 2);
      $("#slider-age").slider("values", [start_range, end_range]);
      _changeAgeRangeDisplayedValue(presentation.age_range)
    }else {
      _changeAgeRangeDisplayedValue(V.Constant.AGE_RANGE)
    }
    if(presentation.difficulty) {
      var difficultyIndexValue = 0;
      for(var j = 0;j < LOM_Difficulty.length;j++) {
        if(LOM_Difficulty[j].value === presentation.difficulty) {
          difficultyIndexValue = j
        }
      }
      $("#difficulty_range").val(LOM_Difficulty[difficultyIndexValue].text);
      $("#difficulty_range").attr("difficulty", difficultyIndexValue);
      $("#slider-difficulty").slider("value", difficultyIndexValue)
    }
    if(presentation.TLT) {
      var durations = V.Utils.iso8601Parser.getDurationFromISOPerUnit(presentation.TLT);
      $("#tlt_hours").val(durations[4].toString());
      $("#tlt_minutes").val(durations[5].toString());
      $("#tlt_seconds").val(durations[6].toString())
    }
    if(presentation.subject) {
      $("#subject_tag").val(presentation.subject)
    }
    if(presentation.educational_objectives) {
      $("#educational_objectives_textarea").val(presentation.educational_objectives)
    }
    if(presentation.allow_clone == "false") {
      $("#allow_clone").prop("checked", false)
    }else {
      $("#allow_clone").prop("checked", true)
    }
    if(presentation.license != undefined && (presentation.license.key == "cc-by-nd" || presentation.license.key == "cc-by-nc-nd")) {
      $("#allow_clone").prop("checked", false);
      $("#allow_clone").prop("disabled", true)
    }
    if(presentation.allow_comment == "false") {
      $("#allow_comment").prop("checked", false)
    }else {
      $("#allow_comment").prop("checked", true)
    }
    if(presentation.allow_download == "false") {
      $("#allow_download").prop("checked", false)
    }else {
      $("#allow_download").prop("checked", true)
    }
    if(presentation.allow_following_rte == "false") {
      $("#allow_following_rte").prop("checked", false)
    }else {
      $("#allow_following_rte").prop("checked", true)
    }
    if(V.Editor.hasBeenSaved()) {
      $(".attachmentFileUpload").removeAttr("disabled");
      $("#attachment_file").removeAttr("disabled");
      if(presentation.attachment_file_name != undefined) {
        document.getElementById("description_attachment").value = presentation.attachment_file_name;
        $("#upload_icon_success").show()
      }
    }else {
      $(".attachmentFileUpload").prop("disabled", true);
      $("#attachment_file").prop("disabled", true)
    }
  };
  var selectTheme = function(themeNumber) {
    $(".theme_selected_in_fancybox").removeClass("theme_selected_in_fancybox");
    $("#theme_fancybox div#select_theme" + themeNumber + " img").addClass("theme_selected_in_fancybox")
  };
  var selectAnimation = function(animationNumber) {
    $(".animation_selected_in_fancybox").removeClass("animation_selected_in_fancybox");
    $("#animation_fancybox div#select_animation" + animationNumber).addClass("animation_selected_in_fancybox")
  };
  var _onInitialTagsReceived = function(data) {
    if(typeof data != "object") {
      data = []
    }
    tagsLoaded = true;
    V.Utils.Loader.stopLoadingInContainer($("#tagBoxIntro"));
    $("#tagBoxIntro").html($("#tagBoxIntro").attr("HTMLcontent"));
    var tagList = $("#tagBoxIntro .tagList");
    if($(tagList).children().length == 0) {
      var options = V.Utils.getOptions();
      if(options && options["extra_tags"] instanceof Array) {
        $(options["extra_tags"]).each(function(index, tag) {
          $(tagList).append("<li>" + tag + "</li>")
        })
      }
      var draftPresentation = V.Editor.getDraftPresentation();
      if(draftPresentation && draftPresentation.tags) {
        $.each(draftPresentation.tags, function(index, tag) {
          $(tagList).append("<li>" + tag + "</li>")
        })
      }
      var config = V.Configuration.getConfiguration();
      $(tagList).tagit({tagSource:data, sortable:true, maxLength:config.tagsSettings.maxLength, maxTags:config.tagsSettings.maxTags, triggerKeys:config.tagsSettings.triggerKeys, watermarkAllowMessage:V.I18n.getTrans("i.AddTags"), watermarkDenyMessage:V.I18n.getTrans("i.limitReached")})
    }
  };
  var onChangeThumbnailClicked = function() {
    $("#editthumb").hide();
    $("#hidden_button_to_uploadThumbnail").trigger("click")
  };
  var onThumbnailSelected = function(thumbnail_url) {
    V.Editor.Settings.displaySettings();
    _addThumbnail(thumbnail_url);
    _checkIfEnableContinueButton()
  };
  var _addThumbnail = function(thumbnail_url) {
    var thumbnail_wrapper = $("#presentation_details_preview_thumbnail");
    var thumbnail = $("#presentation_details_preview_thumbnail_img");
    $(thumbnail).removeClass("addThumbnailPlus");
    $(thumbnail).attr("src", thumbnail_url);
    $(thumbnail_wrapper).find("p.addthumbtitle").hide();
    presentationThumbnail = thumbnail_url
  };
  var onKeyUpOnTitle = function(event) {
    var inputData = $("#presentation_details_input_title");
    var inputPreview = $("#presentation_details_preview_addtitle_textarea");
    var title = $(inputData).val();
    if(title.trim() != "") {
      $(inputPreview).val(title)
    }else {
      $(inputPreview).val("")
    }
    _checkIfEnableContinueButton();
    if(event.keyCode === 13) {
      $(inputData).blur()
    }
  };
  var onKeyUpOnPreviewTitle = function(event) {
    var inputData = $("#presentation_details_input_title");
    var inputPreview = $("#presentation_details_preview_addtitle_textarea");
    var title = $(inputPreview).val();
    if(title.trim() != "") {
      $(inputData).val(title)
    }else {
      $(inputData).val("")
    }
    _checkIfEnableContinueButton();
    if(event.keyCode === 13) {
      $(inputPreview).blur()
    }
  };
  var _changeAgeRangeDisplayedValue = function(ageRange) {
    if(ageRange === "0 - 0") {
      ageRange = V.I18n.getTrans("i.unspecified")
    }
    $("#age_range").val(ageRange)
  };
  var onTLTchange = function(event) {
    if(event && event.keyCode === 13) {
      $(event.target).blur();
      return
    }
    var TLT = _getTLT();
    if(TLT === null) {
      $("#tlt_current_value").val(V.I18n.getTrans("i.invalidvalue"))
    }else {
      if(typeof TLT == "undefined") {
        $("#tlt_current_value").val(V.I18n.getTrans("i.unspecified"))
      }else {
        if(typeof TLT == "string") {
          $("#tlt_current_value").val(TLT)
        }
      }
    }
  };
  var _checkIfEnableContinueButton = function() {
    var enable = checkMandatoryFields();
    if(enable) {
      $("#save_presentation_details").removeClass("buttonDisabledOnSettings");
      $("#save_presentation_details").removeAttr("disabled");
      $("#save_presentation_details").removeAttr("title")
    }else {
      if(typeof $("#save_presentation_details").attr("title") == "undefined") {
        $("#save_presentation_details").attr("title", V.I18n.getTrans("i.tooltip.continueDisabled"))
      }
      $("#save_presentation_details").addClass("buttonDisabledOnSettings");
      $("#save_presentation_details").attr("disabled", "true")
    }
  };
  var checkMandatoryFields = function() {
    var title = $("#presentation_details_input_title").val();
    var thumbnailURL = presentationThumbnail;
    if(typeof title != "string" || title.trim() == "") {
      return false
    }
    if(typeof thumbnailURL != "string" || thumbnailURL.trim() == "") {
      return false
    }
    return true
  };
  var onSavePresentationDetailsButtonClicked = function(event) {
    event.preventDefault();
    if($(event.target).hasClass("buttonDisabledOnSettings")) {
      return
    }
    $("#catalog_content").hide();
    $.fancybox.close()
  };
  var saveSettings = function() {
    var settings = {};
    settings.VEVersion = V.VERSION;
    settings.type = V.Constant.PRESENTATION;
    var draftPresentation = V.Editor.getDraftPresentation();
    var title = $("#presentation_details_input_title").val();
    if(typeof title == "string" && title.trim() != "") {
      settings.title = title
    }
    var description = $("#presentation_details_textarea").val();
    if(typeof description == "string" && description.trim() != "") {
      settings.description = description
    }
    if(presentationThumbnail) {
      settings.avatar = presentationThumbnail
    }
    var author = _getAuthor(draftPresentation);
    var authorName = $("#author_span_in_preview").html();
    if(typeof authorName == "string" && authorName.trim() != "") {
      author.name = authorName
    }else {
      if(typeof author == "object") {
        delete author["name"]
      }
    }
    settings.author = author;
    if(typeof _contributors == "object" && _contributors.length > 0) {
      settings.contributors = _contributors
    }
    var tags = getTags();
    if(tags && tags.length > 0) {
      settings.tags = tags
    }
    var licenseName = $("#presentation_details_license_select").find(":selected").text();
    var licenseKey = $("#presentation_details_license_select").val();
    if(typeof licenseName == "string" && licenseKey) {
      settings.license = {name:licenseName, key:licenseKey}
    }
    var themeNumber = V.Editor.Themes.Presentation.getCurrentTheme().number;
    if(typeof themeNumber == "string") {
      settings.theme = "theme" + themeNumber
    }else {
      settings.theme = V.Constant.Themes.Default
    }
    var animationSelection = V.Editor.Animations.getCurrentAnimation().filename;
    if(typeof animationSelection == "string") {
      settings.animation = animationSelection
    }else {
      settings.animation = V.Constant.Animations.Default
    }
    var language = $("#language_tag").val();
    if(typeof language == "string") {
      settings.language = language
    }
    var context = $("#context_tag").val();
    if(typeof context == "string" && context != "unspecified") {
      settings.context = context
    }
    var age_range = $("#age_range").val();
    if(typeof age_range == "string" && age_range != V.I18n.getTrans("i.unspecified")) {
      settings.age_range = age_range
    }
    var difficultyIndexValue = $("#difficulty_range").attr("difficulty");
    var difficultyValue = LOM_Difficulty[difficultyIndexValue];
    if(typeof difficultyValue == "object") {
      var difficulty = difficultyValue.value;
      if(typeof difficulty == "string" && difficulty != "unspecified") {
        settings.difficulty = difficulty
      }
    }
    var TLT = _getTLT();
    if(typeof TLT == "string") {
      settings.TLT = TLT
    }
    var subjectsToSave = [];
    var subjects = $("#subject_tag").val();
    var sL = subjects.length;
    if(typeof sL == "number" && sL > 0) {
      for(var sI = 0;sI < sL;sI++) {
        var subject = subjects[sI];
        if(subject != "Unspecified") {
          subjectsToSave.push(subject)
        }
      }
      if(subjectsToSave.length > 0) {
        settings.subject = subjectsToSave
      }
    }
    var educational_objectives = $("#educational_objectives_textarea").val();
    if(typeof educational_objectives == "string" && educational_objectives.trim() != "") {
      settings.educational_objectives = educational_objectives
    }
    var allow_clone = $("#allow_clone").is(":checked");
    if(typeof allow_clone == "boolean") {
      settings.allow_clone = allow_clone.toString()
    }
    if(licenseKey == "cc-by-nd" || licenseKey == "cc-by-nc-nd") {
      settings.allow_clone = "false"
    }
    var allow_comment = $("#allow_comment").is(":checked");
    if(typeof allow_comment == "boolean") {
      settings.allow_comment = allow_comment.toString()
    }
    var allow_download = $("#allow_download").is(":checked");
    if(typeof allow_download == "boolean") {
      settings.allow_download = allow_download.toString()
    }
    var allow_following_rte = $("#allow_following_rte").is(":checked");
    if(typeof allow_following_rte == "boolean") {
      settings.allow_following_rte = allow_following_rte.toString()
    }
    var attachment_file_name = V.Editor.Utils.filterFilePath(document.getElementById("description_attachment").value);
    if(attachment_file_name != "" && $("#upload_file_attachment").prop("disabled")) {
      settings.attachment_file_name = attachment_file_name
    }
    $(".attachmentFileUpload").prop("disabled", false);
    $("#attachment_file").prop("disabled", false);
    $(".attachmentFileUpload").removeAttr("disabled");
    return settings
  };
  var _getTLT = function() {
    var TLT = "PT";
    var hours = $("#tlt_hours").val();
    var minutes = $("#tlt_minutes").val();
    var seconds = $("#tlt_seconds").val();
    if(jQuery.isNumeric(hours) && (jQuery.isNumeric(minutes) && jQuery.isNumeric(seconds))) {
      hours = parseInt(hours);
      minutes = parseInt(minutes);
      seconds = parseInt(seconds);
      if(hours >= 0 && (hours < 100 && (minutes >= 0 && (minutes < 60 && (seconds >= 0 && seconds < 60))))) {
        if(hours * 24 * 60 + minutes * 60 + seconds > 0) {
          if(hours != 0) {
            TLT = TLT + hours + "H"
          }
          if(minutes != 0) {
            TLT = TLT + minutes + "M"
          }
          if(seconds != 0) {
            TLT = TLT + seconds + "S"
          }
          return TLT
        }else {
          if(hours === 0 && (minutes === 0 && seconds === 0)) {
            return undefined
          }
        }
      }
    }
    return null
  };
  var getTags = function() {
    var tagIndex = $("#tagindex");
    if(tagIndex.length > 0 && $(tagIndex).hasClass("tagit")) {
      return V.Editor.Utils.convertToTagsArray($(tagIndex).tagit("tags"))
    }else {
      var draftPresentation = V.Editor.getDraftPresentation();
      if(typeof draftPresentation == "object") {
        return draftPresentation.tags
      }
    }
  };
  var _getAuthor = function(presentation) {
    var author;
    if(presentation && typeof presentation.author == "object") {
      author = presentation.author
    }else {
      author = {}
    }
    var user = V.User.getUser();
    if(typeof user != "undefined") {
      if(typeof V.User.getName() != "undefined") {
        author.name = V.User.getName()
      }
      author.vishMetadata = {};
      if(typeof V.User.getId() != "undefined") {
        author.vishMetadata.id = V.User.getId()
      }
    }
    return author
  };
  var advancedTabs = function(event) {
    event.preventDefault();
    if($(this).hasClass != true) {
      $(this).closest("ul").find(".fancy_selected").removeClass("fancy_selected");
      $(this).addClass("fancy_selected");
      $("#metadata_options_fields").children(".active").removeClass("active").hide();
      var attr = "#" + $(this).attr("tab");
      $(attr).addClass("active").show();
      $($(".help_in_settings")[1]).attr("id", "help-" + $(this).attr("tab"))
    }
  };
  var onMetadataButtonClicked = function(event) {
    event.preventDefault();
    $("#catalog_content").hide();
    $("#presentation_details_fields").slideUp();
    $("#metadata_options_fields").slideDown();
    if($("#advanced_tabs .fancy_selected") != undefined) {
      $(".help_in_settings").attr("id", "help-" + $("#advanced_tabs .fancy_selected").attr("tab"))
    }
  };
  var onDoneMetadataButtonClicked = function(event) {
    event.preventDefault();
    $("#metadata_options_fields").slideUp();
    $("#presentation_details_fields").slideDown();
    $(".help_in_settings").attr("id", "help_in_settings")
  };
  var onCatalogButtonClicked = function(event) {
    event.preventDefault();
    $("#catalog_content").fadeIn()
  };
  var onDoneCatalogButtonClicked = function(event) {
    event.preventDefault();
    var catalog_tags = $("#catalog_tags").find(":selected");
    if(catalog_tags.length > 0) {
      for(i = 0;i < catalog_tags.length;i++) {
        $("#tagBoxIntro .tagList").tagit("add", catalog_tags[i].value)
      }
      $("#catalog_tags :selected").removeAttr("selected")
    }
    $("#catalog_content").fadeOut()
  };
  var onChangeAttachmentFile = function(event) {
    $("#upload_icon_success").hide();
    if(V.Editor.hasBeenSaved()) {
      var fileName = document.getElementById("attachment_file").value;
      if(fileName != "") {
        document.getElementById("description_attachment").value = V.Editor.Utils.filterFilePath(fileName);
        $("#upload_file_attachment").prop("disabled", false)
      }
    }else {
      V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadHasToSaveFirst"))
    }
  };
  var onUploadAttachmentFile = function(event) {
    if(V.Editor.hasBeenSaved()) {
      var fileName = document.getElementById("attachment_file").value;
      if(fileName != "") {
        if(typeof V.UploadAttachmentPath == "string") {
          $("#attachment_file_form").attr("action", V.UploadAttachmentPath);
          $("#attachment_author").val(V.User.getId());
          $("#attachment_auth_token").val(V.User.getToken());
          $("#attachment_pres_id").val(V.Editor.getPresentationId());
          $("#attachment_file_form").ajaxForm({success:function(responseText, statusText, xhr, form) {
            if(responseText.status == "bad_request" && responseText.message == "bad_size") {
              V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadErrorTooBig"));
              $("#upload_file_attachment").prop("disabled", true)
            }else {
              if(responseText.status == "bad_request" && responseText.message == "wrong_params") {
                V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadErrorWrongServer"));
                $("#upload_file_attachment").prop("disabled", true)
              }else {
                if(responseText.status == "ok" && responseText.message == "success") {
                  $("#upload_icon_success").show();
                  $("#upload_file_attachment").prop("disabled", true);
                  V.Editor.Tools.save()
                }
              }
            }
          }, error:function(error) {
            V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadErrorWrongServer"))
          }})
        }
      }else {
        event.preventDefault();
        V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadErrorCantReach"))
      }
    }else {
      event.preventDefault();
      V.Editor.Utils.showErrorDialog(V.I18n.getTrans("i.uploadHasToSaveFirst"))
    }
  };
  var addContributor = function(contributor) {
    if(typeof contributor == "object" && typeof contributor.name == "string") {
      _contributors.push(contributor)
    }
  };
  return{init:init, displaySettings:displaySettings, loadPresentationSettings:loadPresentationSettings, onChangeThumbnailClicked:onChangeThumbnailClicked, onThumbnailSelected:onThumbnailSelected, onChangeAttachmentFile:onChangeAttachmentFile, onUploadAttachmentFile:onUploadAttachmentFile, selectTheme:selectTheme, onKeyUpOnTitle:onKeyUpOnTitle, onKeyUpOnPreviewTitle:onKeyUpOnPreviewTitle, onTLTchange:onTLTchange, advancedTabs:advancedTabs, checkMandatoryFields:checkMandatoryFields, onSavePresentationDetailsButtonClicked:onSavePresentationDetailsButtonClicked, 
  getTags:getTags, saveSettings:saveSettings, onMetadataButtonClicked:onMetadataButtonClicked, onDoneMetadataButtonClicked:onDoneMetadataButtonClicked, onCatalogButtonClicked:onCatalogButtonClicked, onDoneCatalogButtonClicked:onDoneCatalogButtonClicked, selectAnimation:selectAnimation, addContributor:addContributor}
}(VISH, jQuery);
VISH.Editor.Slides = function(V, $, undefined) {
  var updateCurrentSlideFromHash = function() {
    var slideNo = V.Utils.getSlideNumberFromHash();
    if(slideNo) {
      V.Slides.setCurrentSlideNumber(slideNo)
    }
  };
  var showSlides = function() {
    $(".slides > article").removeClass("temp_hidden")
  };
  var hideSlides = function() {
    $(".slides > article").addClass("temp_hidden")
  };
  var isSlideFocused = function() {
    if($(".wysiwygInstance").is(":focus")) {
      return false
    }
    if($("#fancybox-content").is(":visible")) {
      return false
    }
    if($("input").is(":focus")) {
      return false
    }
    if(V.Editor && V.Editor.getCurrentArea() !== null) {
      return false
    }
    return true
  };
  var forwardOneSubslide = function(event) {
    moveSubslides(1)
  };
  var backwardOneSubslide = function() {
    moveSubslides(-1)
  };
  var moveSubslides = function(n) {
    var cSlide = V.Slides.getCurrentSlide();
    if(!V.Slideset.isSlideset(cSlide)) {
      return
    }
    var cSubslideNumber = V.Slides.getCurrentSubslideNumber();
    if(typeof cSubslideNumber == "undefined") {
      cSubslideNumber = 0
    }
    var subslidesQuantity = V.Editor.Slideset.getSubslidesQuantity(cSlide);
    var no = cSubslideNumber + n;
    var cno = Math.min(Math.max(0, no), subslidesQuantity);
    if(no === cno) {
      goToSubslide(no)
    }
  };
  var goToSubslide = function(no) {
    if(no === 0) {
      V.Editor.Slideset.onClickOpenSlideset()
    }else {
      V.Editor.Slideset.openSubslideWithNumber(no)
    }
  };
  var moveSlideTo = function(orgPosition, destPosition) {
    var slide_to_move = V.Slides.getSlideWithNumber(orgPosition);
    var reference_slide = V.Slides.getSlideWithNumber(destPosition);
    if(typeof slide_to_move === "undefined" || typeof reference_slide === "undefined") {
      return
    }
    if(typeof slide_to_move.length !== undefined) {
      slide_to_move = $(slide_to_move)[0];
      if(typeof slide_to_move === "undefined") {
        return
      }
    }
    if(typeof reference_slide.length !== undefined) {
      reference_slide = $(reference_slide)[0];
      if(typeof reference_slide === "undefined") {
        return
      }
    }
    if(slide_to_move.tagName != "ARTICLE" || (reference_slide.tagName != "ARTICLE" || slide_to_move == reference_slide)) {
      return
    }
    var movement = null;
    if(destPosition > orgPosition) {
      movement = "after"
    }else {
      if(destPosition < orgPosition) {
        movement = "before"
      }else {
        return
      }
    }
    var article_to_move = slide_to_move;
    var article_reference = reference_slide;
    var moving_current_slide = false;
    var currentSlide = V.Slides.getCurrentSlide();
    var oldCurrentSlideNumber = parseInt($(currentSlide).attr("slidenumber"));
    if(currentSlide === article_to_move) {
      moving_current_slide = true
    }
    var textAreas = copyTextAreasOfSlide(article_to_move);
    $(article_to_move).remove();
    if(movement == "after") {
      $(article_reference).after(article_to_move)
    }else {
      if(movement == "before") {
        $(article_reference).before(article_to_move)
      }else {
        return
      }
    }
    V.Utils.addTempShown(article_to_move);
    V.Editor.Utils.refreshDraggables(article_to_move);
    V.Editor.Utils.refreshHTML5EVideo(article_to_move);
    _cleanTextAreas(article_to_move);
    _loadTextAreasOfSlide(article_to_move, textAreas);
    V.Utils.removeTempShown(article_to_move);
    V.Slides.setSlides($("section.slides > article"));
    $("#slides_list").find("div.wrapper_barbutton:has(img[slidenumber])").each(function(index, div) {
      var slideNumber = index + 1;
      var p = $(div).find("p.ptext_barbutton");
      $(p).html(slideNumber);
      var img = $(div).find("img.image_barbutton");
      $(img).attr("slidenumber", slideNumber)
    });
    var newCurrentSlideNumber;
    if(moving_current_slide) {
      newCurrentSlideNumber = destPosition
    }else {
      if(orgPosition > oldCurrentSlideNumber && destPosition <= oldCurrentSlideNumber) {
        newCurrentSlideNumber = oldCurrentSlideNumber + 1
      }else {
        if(orgPosition < oldCurrentSlideNumber && destPosition >= oldCurrentSlideNumber) {
          newCurrentSlideNumber = oldCurrentSlideNumber - 1
        }
      }
    }
    if(typeof newCurrentSlideNumber == "number") {
      V.Slides.setCurrentSlideNumber(newCurrentSlideNumber)
    }
    V.Slides.updateSlides()
  };
  var copySlideWithNumber = function(slideNumber, options) {
    var slide = V.Slides.getSlideWithNumber(slideNumber);
    if(slide === null) {
      return
    }
    var newSlide = $(slide).clone();
    copySlide(newSlide, options)
  };
  var copySlide = function(slideToCopy, options) {
    slideToCopy = _cleanTextAreas(slideToCopy);
    slideToCopy = V.Editor.Utils.replaceIdsForSlide(slideToCopy);
    var newId = $(slideToCopy).attr("id");
    if(typeof slideToCopy == "undefined") {
      return
    }
    var slideToCopyType = V.Slides.getSlideType(slideToCopy);
    var currentSlide = V.Slides.getCurrentSlide();
    if(currentSlide) {
      $(currentSlide).after(slideToCopy)
    }else {
      $("section#slides_panel").append(slideToCopy)
    }
    var slideCopied = $("#" + newId);
    V.Editor.Utils.refreshDraggables(slideCopied);
    if(slideToCopyType === V.Constant.STANDARD) {
      if(options.textAreas) {
        _loadTextAreasOfSlide(slideCopied, options.textAreas)
      }
    }
    $(slideToCopy).find("div.vezone").each(function(index, zone) {
      var zoneType = $(zone).attr("type");
      switch(zoneType) {
        case V.Constant.QUIZ:
          V.Editor.Quiz.afterCopyQuiz(zone);
          break;
        default:
          break
      }
    });
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      if(currentSlide) {
        V.Slides.goToSlide(V.Slides.getCurrentSlideNumber() + 1);
        V.Editor.Thumbnails.moveThumbnailsToSlide(V.Slides.getCurrentSlideNumber())
      }else {
        V.Slides.goToSlide(1);
        V.Editor.Thumbnails.moveThumbnailsToSlide(1)
      }
    })
  };
  var _cleanTextAreas = function(slide) {
    $(slide).find("div[type='text'],div.wysiwygTextArea").each(function(index, textArea) {
      $(textArea).html("")
    });
    return slide
  };
  var copyTextAreasOfSlide = function(slide) {
    var textAreas = {};
    $(slide).find("div[type='text']").each(function(index, textArea) {
      var areaId = $(textArea).attr("areaid");
      var ckEditor = V.Editor.Text.getCKEditorFromZone(textArea);
      if(areaId && ckEditor !== null) {
        textAreas[areaId] = ckEditor.getData()
      }
    });
    $(slide).find("div[type='quiz']").each(function(index, quizArea) {
      var areaId = $(quizArea).attr("areaid");
      textAreas[areaId] = [];
      $(quizArea).find("div.wysiwygTextArea").each(function(index, textArea) {
        var ckEditor = V.Editor.Text.getCKEditorFromTextArea(textArea);
        if(areaId && ckEditor !== null) {
          textAreas[areaId].push(ckEditor.getData())
        }
      })
    });
    return textAreas
  };
  var _loadTextAreasOfSlide = function(slide, textAreas) {
    $(slide).find("div[type='text']").each(function(index, textArea) {
      var areaId = $(textArea).attr("areaid");
      if(areaId && textAreas[areaId]) {
        var data = textAreas[areaId];
        V.Editor.Text.launchTextEditor({}, $(textArea), data)
      }
    });
    $(slide).find("div[type='quiz']").each(function(index, quizArea) {
      var areaId = $(quizArea).attr("areaid");
      if(areaId && textAreas[areaId]) {
        var data = textAreas[areaId];
        $(quizArea).find("div.wysiwygTextArea").each(function(index, textArea) {
          var parent = $(textArea).parent();
          $(parent).html("");
          V.Editor.Text.launchTextEditor({}, $(parent), data[index], {autogrow:true})
        })
      }
    })
  };
  var addSlide = function(slide) {
    var slide = $(slide);
    var slideType = V.Slides.getSlideType(slide);
    if(V.Slides.getCurrentSlide()) {
      $(V.Slides.getCurrentSlide()).after(slide)
    }else {
      appendSlide(slide)
    }
    var oldCurrentSlideNumber = V.Slides.getCurrentSlideNumber();
    V.Slides.setCurrentSlideNumber(oldCurrentSlideNumber + 1);
    if(slideType === V.Constant.STANDARD) {
      V.Editor.Tools.addTooltipsToSlide(slide)
    }
    V.Slides.triggerLeaveEvent(oldCurrentSlideNumber);
    V.Slides.updateSlides();
    V.Slides.triggerEnterEvent(V.Slides.getCurrentSlideNumber());
    if(V.Slideset.isSlideset(slideType)) {
      var slidesetCreator = V.Editor.Slideset.getCreatorModule(slideType);
      slidesetCreator.draw(null, slide)
    }
    V.Editor.Thumbnails.redrawThumbnails(function() {
      V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber());
      V.Editor.Thumbnails.moveThumbnailsToSlide(V.Slides.getCurrentSlideNumber())
    })
  };
  var appendSlide = function(slide) {
    $(".slides").append(slide)
  };
  var removeSlide = function(slide) {
    if(slide === null) {
      return
    }
    if(V.Slideset.isSlideset(slide)) {
      V.Editor.Slideset.beforeRemoveSlideset(slide)
    }
    var removing_current_slide = false;
    if(V.Slides.getCurrentSlide() === slide) {
      removing_current_slide = true
    }
    $(slide).remove();
    if(removing_current_slide) {
      if(V.Slides.getCurrentSlideNumber() === 1 && V.Slides.getSlidesQuantity() > 1) {
        V.Slides.setCurrentSlideNumber(1)
      }else {
        V.Slides.setCurrentSlideNumber(V.Slides.getCurrentSlideNumber() - 1)
      }
    }
    V.Slides.updateSlides();
    V.Editor.Thumbnails.redrawThumbnails(function() {
      if(typeof V.Slides.getCurrentSlide() != "undefined") {
        V.Editor.Thumbnails.selectThumbnail(V.Slides.getCurrentSlideNumber());
        V.Editor.Thumbnails.moveThumbnailsToSlide(V.Slides.getCurrentSlideNumber());
        V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
      }
    })
  };
  var addSubslide = function(slideset, subslide) {
    var subslide = $(subslide).css("display", "none");
    appendSubslide(slideset, subslide);
    V.Editor.Tools.addTooltipsToSlide(subslide);
    V.Editor.Slideset.openSubslide(subslide);
    V.Editor.Thumbnails.drawSlidesetThumbnails($(slideset).find("article"), function() {
      V.Editor.Thumbnails.selectSubslideThumbnail($(subslide).attr("slidenumber"))
    });
    V.Editor.Slideset.afterCreateSubslide(slideset, subslide)
  };
  var appendSubslide = function(slideset, subslide) {
    $(slideset).append(subslide)
  };
  var removeSubslide = function(subslide) {
    if(typeof subslide !== "object") {
      return
    }
    var slideset = $(subslide).parent();
    V.Editor.Slideset.beforeRemoveSubslide(slideset, subslide);
    $(subslide).remove();
    var subslides = $(slideset).find("article");
    $(subslides).each(function(index, subslide) {
      $(subslide).attr("slidenumber", index + 1)
    });
    V.Editor.Thumbnails.drawSlidesetThumbnails(subslides, function() {
    });
    V.Editor.Slideset.openSlideset(slideset)
  };
  var removeSlideKeyboard = function() {
    if(V.Editor.Slideset.getCurrentSubslide() != null) {
      removeSubslide(V.Editor.Slideset.getCurrentSubslide())
    }else {
      removeSlide(V.Slides.getCurrentSlide())
    }
  };
  var updateThumbnail = function(slide) {
    var slideThumbnail = V.Editor.Thumbnails.getThumbnailForSlide(slide);
    var thumbnailURL = V.Editor.Thumbnails.getThumbnailURL(slide);
    $(slideThumbnail).error(function(response) {
      _updateThumbnail(slide, slideThumbnail, V.Editor.Thumbnails.getDefaultThumbnailURL(slide))
    });
    _updateThumbnail(slide, slideThumbnail, thumbnailURL)
  };
  var _updateThumbnail = function(slide, slideThumbnail, thumbnailURL) {
    if(V.Slideset.isSlideset(slide)) {
      $("#slideset_selected > img").attr("src", thumbnailURL)
    }
    $(slideThumbnail).attr("src", thumbnailURL)
  };
  return{updateCurrentSlideFromHash:updateCurrentSlideFromHash, showSlides:showSlides, hideSlides:hideSlides, isSlideFocused:isSlideFocused, moveSlideTo:moveSlideTo, copySlide:copySlide, copySlideWithNumber:copySlideWithNumber, appendSlide:appendSlide, addSlide:addSlide, removeSlide:removeSlide, addSubslide:addSubslide, appendSubslide:appendSubslide, removeSubslide:removeSubslide, removeSlideKeyboard:removeSlideKeyboard, updateThumbnail:updateThumbnail, copyTextAreasOfSlide:copyTextAreasOfSlide, 
  forwardOneSubslide:forwardOneSubslide, backwardOneSubslide:backwardOneSubslide, moveSubslides:moveSubslides, goToSubslide:goToSubslide}
}(VISH, jQuery);
VISH.Editor.Themes.Presentation = function(V, $, undefined) {
  var _initialized = false;
  var _currentTheme;
  var _themes = {};
  var init = function() {
    if(_initialized === true) {
      return
    }
    _themes["theme1"] = {number:"1", color:"000"};
    _themes["theme2"] = {number:"2", color:"fff"};
    _themes["theme3"] = {number:"3", color:"666"};
    _themes["theme4"] = {number:"4", color:"000"};
    _themes["theme5"] = {number:"5", color:"fff"};
    _themes["theme6"] = {number:"6", color:"555"};
    _themes["theme7"] = {number:"7", color:"000"};
    _themes["theme8"] = {number:"8", color:"000"};
    _themes["theme9"] = {number:"9", color:"666"};
    _themes["theme10"] = {number:"10", color:"666"};
    _themes["theme11"] = {number:"11", color:"fff"};
    _themes["theme12"] = {number:"12", color:"666"};
    _themes["theme13"] = {number:"13", color:"666"};
    _themes["theme14"] = {number:"14", color:"000"};
    _themes["theme15"] = {number:"15", color:"fff"};
    _themes["theme16"] = {number:"16", color:"555"};
    _themes["theme17"] = {number:"17", color:"000"};
    _themes["theme18"] = {number:"18", color:"000"};
    _themes["theme19"] = {number:"19", color:"666"};
    _themes["theme20"] = {number:"20", color:"666"};
    _themes["theme21"] = {number:"21", color:"fff"};
    _themes["theme22"] = {number:"22", color:"fff"};
    _themes["theme23"] = {number:"23", color:"666"};
    _initialized = true
  };
  var onThemeSelected = function(event) {
    event.preventDefault();
    var themeNumber = $(event.currentTarget).attr("theme");
    if($(event.target).hasClass("waitCursor")) {
      return
    }
    selectTheme(themeNumber, true);
    V.Editor.Settings.selectTheme(_themes[themeNumber].number)
  };
  var selectTheme = function(theme, fromFancybox, callback) {
    if(fromFancybox) {
      $("#theme_fancybox").addClass("waitCursor");
      $(".themethumb").addClass("waitCursor")
    }
    V.Themes.Presentation.loadTheme(theme, function() {
      _currentTheme = theme;
      V.Editor.Text.refreshAutoColors();
      V.Editor.Tools.setAllTooltipMargins(function() {
        if(fromFancybox) {
          $.fancybox.close();
          $("#theme_fancybox").removeClass("waitCursor");
          $(".themethumb").removeClass("waitCursor")
        }
        if(typeof callback == "function") {
          callback()
        }
      })
    })
  };
  var getCurrentTheme = function() {
    if(_currentTheme) {
      return _themes[_currentTheme]
    }else {
      return _themes[V.Constant.Themes.Default]
    }
  };
  return{init:init, onThemeSelected:onThemeSelected, selectTheme:selectTheme, getCurrentTheme:getCurrentTheme}
}(VISH, jQuery);
VISH.Editor.Thumbnails = function(V, $, undefined) {
  var thumbnailsDivId = "slides_list";
  var slidesetThumbnailsDivId = "subslides_list";
  var redrawThumbnailsCallback;
  var drawSlidesetThumbnailsCallback;
  var lastSelectedSlideThumbnail = undefined;
  var lastSelectedSubslideThumbnail = undefined;
  var init = function() {
  };
  var redrawThumbnails = function(successCallback) {
    redrawThumbnailsCallback = successCallback;
    V.Editor.Scrollbar.cleanScrollbar(thumbnailsDivId);
    $("#" + thumbnailsDivId).hide();
    var imagesArray = [];
    var imagesArrayTitles = [];
    var slideElements = 0;
    $(".slides > article").each(function(index, s) {
      var srcURL = getThumbnailURL(s);
      var defaultURL = getDefaultThumbnailURL(s);
      if(srcURL) {
        slideElements += 1;
        imagesArray.push($("<img id='slideThumbnail" + slideElements + "' class='image_barbutton' slideNumber='" + slideElements + "' action='goToSlide' src='" + srcURL + "' defaultsrc='" + defaultURL + "'/>"));
        imagesArrayTitles.push(slideElements)
      }
    });
    var options = {};
    options.order = true;
    options.titleArray = imagesArrayTitles;
    options.callback = _onImagesLoaded;
    options.defaultOnError = true;
    options.onImageErrorCallback = _onImageError;
    V.Utils.Loader.loadImagesOnContainer(imagesArray, thumbnailsDivId, options)
  };
  var _onImageError = function(image) {
    var slideNumber = $(image).attr("slidenumber");
    var slide = V.Slides.getSlideWithNumber(slideNumber);
    var isSlideset = V.Slideset.isSlideset(slide);
    if(isSlideset) {
      var creator = V.Editor.Slideset.getCreatorModule(slide);
      if(typeof creator.onThumbnailLoadFail == "function") {
        creator.onThumbnailLoadFail(slide)
      }
    }
  };
  var _onImagesLoaded = function() {
    $("#" + thumbnailsDivId).find("img.image_barbutton").each(function(index, img) {
      var imgContainer = $(img).parent();
      $(imgContainer).addClass("wrapper_barbutton");
      $(imgContainer).addClass("preventNoselectable");
      var p = $(imgContainer).find("p");
      $(p).addClass("ptext_barbutton");
      $(img).click(function(event) {
        _onClickSlideElement(event)
      })
    });
    $(".barbutton").css("background-color", "transparent");
    var options = new Array;
    options["callback"] = _afterCreateSlidesScrollbar;
    $("#" + thumbnailsDivId).show();
    V.Editor.Scrollbar.createScrollbar(thumbnailsDivId, options)
  };
  var _afterCreateSlidesScrollbar = function() {
    $("#" + thumbnailsDivId).sortable({items:'div.wrapper_barbutton:has(img[action="goToSlide"])', change:function(event, ui) {
    }, start:function(event, ui) {
    }, stop:function(event, ui) {
      var dragElement = ui.item;
      var img = $(ui.item).find("img.image_barbutton[slidenumber]");
      if(isNaN($(img).attr("slidenumber"))) {
        return
      }
      var orgPosition = parseInt($(img).attr("slidenumber"));
      var destPosition;
      $("#slides_list").find("img.image_barbutton[slidenumber]").each(function(index, item) {
        var beforeIndex = parseInt($(item).attr("slidenumber"));
        var afterIndex = index + 1;
        if(beforeIndex === orgPosition && beforeIndex != afterIndex) {
          destPosition = afterIndex
        }
      });
      V.Editor.Slides.moveSlideTo(orgPosition, destPosition)
    }});
    if(!V.Status.getDevice().desktop) {
      $("#" + thumbnailsDivId).sortable("option", "delay", 500)
    }
    if(typeof redrawThumbnailsCallback == "function") {
      redrawThumbnailsCallback();
      redrawThumbnailsCallback = undefined
    }
  };
  var _onClickSlideElement = function(event) {
    switch($(event.target).attr("action")) {
      case "goToSlide":
        V.Slides.goToSlide($(event.target).attr("slideNumber"));
        break;
      default:
        return
    }
  };
  var selectThumbnail = function(no) {
    $("#slides_list img.image_barbutton").removeClass("selectedSlideThumbnail");
    $("#slides_list img.image_barbutton[slideNumber=" + no + "]").addClass("selectedSlideThumbnail");
    $("#slides_list div.wrapper_barbutton").removeClass("selectedThumbnailBackground");
    $("#slides_list img.image_barbutton[slideNumber=" + no + "]").parent("div.wrapper_barbutton").addClass("selectedThumbnailBackground");
    var advance = lastSelectedSlideThumbnail === undefined || no > lastSelectedSlideThumbnail;
    lastSelectedSlideThumbnail = no;
    var slide = V.Slides.getSlideWithNumber(no);
    if(!isThumbnailVisible(slide)) {
      if(advance) {
        moveThumbnailsToSlide(Math.max(no - 5, 1))
      }else {
        moveThumbnailsToSlide(no)
      }
    }
  };
  var moveThumbnailsToSlide = function(slideNumber) {
    var element = $("img.image_barbutton[slideNumber=" + slideNumber + "]");
    V.Editor.Scrollbar.goToElement(thumbnailsDivId, element)
  };
  var moveThumbnailsToSubslide = function(slideNumber) {
    var element = $("#subslides_list img.image_barbutton[slideNumber=" + slideNumber + "]").parent();
    V.Editor.Scrollbar.goToElement(slidesetThumbnailsDivId, element)
  };
  var getThumbnailForSlide = function(slide) {
    if(V.Slides.isSubslide(slide)) {
      return _getThumbnailForSubslide(slide)
    }
    var slidenumber = $(slide).attr("slidenumber");
    return $("#slides_list img.image_barbutton[slideNumber=" + slidenumber + "]")
  };
  var _getThumbnailForSubslide = function(subslide) {
    var slidenumber = $(subslide).attr("slidenumber");
    return $("#subslides_list img.image_barbutton[slideNumber=" + slidenumber + "]")
  };
  var getThumbnailURL = function(slide) {
    var thumbnailURL;
    var slideType = $(slide).attr("type");
    var isSlideset = V.Slideset.isSlideset(slideType);
    if(isSlideset) {
      thumbnailURL = V.Editor.Slideset.getCreatorModule(slideType).getThumbnailURL(slide)
    }else {
      if(slideType == V.Constant.STANDARD) {
        var zone = $(slide).children("div.vezone");
        if($(zone).length === 1 && (!V.Editor.isZoneEmpty(zone) && $(zone).attr("type") == "image")) {
          var img = $(zone).find("img");
          if($(img).length === 1 && typeof $(img).attr("src") == "string") {
            thumbnailURL = $(img).attr("src")
          }
        }else {
          thumbnailURL = _getDefaultThumbnailURLForStandardSlide(slide)
        }
      }
    }
    return thumbnailURL
  };
  var getDefaultThumbnailURL = function(slide) {
    var slideType = $(slide).attr("type");
    if(slideType == V.Constant.STANDARD) {
      return _getDefaultThumbnailURLForStandardSlide(slide)
    }else {
      if(V.Slideset.isSlideset(slideType)) {
        var creatorModule = V.Editor.Slideset.getCreatorModule(slideType);
        if(typeof creatorModule.getDefaultThumbnailURL == "function") {
          return creatorModule.getDefaultThumbnailURL(slide)
        }else {
          return creatorModule.getThumbnailURL(slide)
        }
      }
    }
  };
  var _getDefaultThumbnailURLForStandardSlide = function(slide) {
    var template = $(slide).attr("template");
    return V.ImagesPath + "templatesthumbs/" + template + ".png"
  };
  var drawSlidesetThumbnails = function(subslides, successCallback) {
    drawSlidesetThumbnailsCallback = successCallback;
    V.Editor.Scrollbar.cleanScrollbar(slidesetThumbnailsDivId);
    $("#" + slidesetThumbnailsDivId).hide();
    var imagesArray = [];
    var imagesArrayTitles = [];
    var slideElements = 0;
    $(subslides).each(function(index, s) {
      if($(s).attr("type") !== V.Constant.STANDARD) {
        V.Debugging.log("Subslide must be of standard type");
        return true
      }
      var srcURL = getThumbnailURL(s);
      var defaultURL = getDefaultThumbnailURL(s);
      slideElements += 1;
      imagesArray.push($("<img id='subslideThumbnail" + slideElements + "' class='image_barbutton' slideNumber='" + slideElements + "' src='" + srcURL + "' defaultsrc='" + defaultURL + "'/>"));
      imagesArrayTitles.push(String.fromCharCode(64 + slideElements))
    });
    var options = {};
    options.order = true;
    options.titleArray = imagesArrayTitles;
    options.callback = _onSlidesetThumbnailsImagesLoaded;
    options.defaultOnError = true;
    V.Utils.Loader.loadImagesOnContainer(imagesArray, slidesetThumbnailsDivId, options)
  };
  var _onSlidesetThumbnailsImagesLoaded = function() {
    $("#" + slidesetThumbnailsDivId).find("img.image_barbutton").each(function(index, img) {
      var imgContainer = $(img).parent();
      $(imgContainer).addClass("wrapper_barbutton");
      var p = $(imgContainer).find("p");
      $(p).addClass("ptext_barbutton");
      $(img).click(function(event) {
        _onClickSubslideElement(event)
      })
    });
    V.Editor.Slideset.beforeCreateSlidesetThumbnails();
    var options = new Array;
    options["horizontalScroll"] = true;
    options["callback"] = _afterCreateSubslidesScrollbar;
    $("#" + slidesetThumbnailsDivId).show();
    V.Editor.Scrollbar.createScrollbar(slidesetThumbnailsDivId, options)
  };
  var _afterCreateSubslidesScrollbar = function() {
    if(typeof drawSlidesetThumbnailsCallback == "function") {
      drawSlidesetThumbnailsCallback();
      drawSlidesetThumbnailsCallback = undefined
    }
  };
  var _onClickSubslideElement = function(event) {
    var subslideNumber = $(event.target).attr("slideNumber");
    V.Editor.Slideset.openSubslideWithNumber(subslideNumber)
  };
  var selectSubslideThumbnail = function(no) {
    $("#subslides_list img.image_barbutton").removeClass("selectedSubslideThumbnail");
    if(no === null) {
      return
    }
    $("#subslides_list img.image_barbutton[slideNumber=" + no + "]").addClass("selectedSubslideThumbnail");
    var advance = lastSelectedSubslideThumbnail === undefined || no > lastSelectedSubslideThumbnail;
    lastSelectedSubslideThumbnail = no;
    var subslide = V.Slides.getSubslideWithNumber(V.Slides.getCurrentSlide(), no);
    if(!isThumbnailVisible(subslide)) {
      if(advance) {
        moveThumbnailsToSubslide(Math.max(no - 7, 1))
      }else {
        moveThumbnailsToSubslide(no)
      }
    }
  };
  var isThumbnailVisible = function(slide) {
    var slideThumbnail = getThumbnailForSlide(slide);
    var offset = $(slideThumbnail).offset();
    if(typeof offset == "undefined" || offset === null) {
      return true
    }
    if(V.Slides.isSubslide(slide)) {
      var offsetLeft = offset.left;
      return offsetLeft > 466 && offsetLeft < 1119
    }else {
      var offsetTop = offset.top;
      return offsetTop > 132 && offsetTop < 667
    }
  };
  return{init:init, redrawThumbnails:redrawThumbnails, drawSlidesetThumbnails:drawSlidesetThumbnails, selectThumbnail:selectThumbnail, selectSubslideThumbnail:selectSubslideThumbnail, moveThumbnailsToSlide:moveThumbnailsToSlide, moveThumbnailsToSubslide:moveThumbnailsToSubslide, getThumbnailURL:getThumbnailURL, getDefaultThumbnailURL:getDefaultThumbnailURL, getThumbnailForSlide:getThumbnailForSlide, isThumbnailVisible:isThumbnailVisible}
}(VISH, jQuery);
VISH.Editor.Tools.Menu = function(V, $, undefined) {
  var _initialized = false;
  var _hoverMenu = false;
  var init = function() {
    if(!_initialized) {
      if(!V.Status.getDevice().desktop) {
        if(V.Status.getDevice().tablet) {
          V.Editor.MenuTablet.init()
        }else {
          disableMenu();
          return
        }
      }else {
        _hoverMenu = true
      }
      $.each($("#menu a.menu_action"), function(index, menuButton) {
        $(menuButton).on("click", function(event) {
          event.preventDefault();
          if($(menuButton).parent().hasClass("menu_item_disabled")) {
            return false
          }
          if(typeof V.Editor.Tools.Menu[$(menuButton).attr("action")] == "function") {
            V.Editor.Tools.Menu[$(menuButton).attr("action")](this);
            _hideMenuAfterAction()
          }
          return false
        })
      });
      if(V.Status.getDevice().desktop) {
        $("a.menu_option_main, a.menu_option:not('.menu_action')").on("click", function(event) {
          event.preventDefault();
          return false
        })
      }
      var options = V.Utils.getOptions();
      if(typeof options.exitURL != "string") {
        $(".menu_option.menu_action[action='exit']").parent().hide()
      }else {
        V.exitPath = options.exitURL
      }
      _initialized = true
    }
    $("#menu").show();
    $(".theme_selected_in_fancybox").removeClass("theme_selected_in_fancybox");
    $("#theme_fancybox div#select_theme" + V.Editor.Themes.Presentation.getCurrentTheme().number + " img").addClass("theme_selected_in_fancybox");
    if(V.Status.getDevice().desktop) {
      var _submenu = false;
      $("a:.menu_option_main").on("click", function() {
        if($("#menu li > ul.menu_option_main").css("display") === "none") {
          $("#menu li > ul.menu_option_main").css("display", "block");
          $("ul:.menu_option_main li").hover(function(e) {
            $(this).children("ul").css("display", "block").on("mouseenter", function() {
              _submenu = true;
              $(this).mouseleave(function(e) {
                _submenu = false
              })
            })
          }, function() {
            if(!_submenu) {
              $("ul:.menu_option_main li > ul").css("display", "none")
            }
          })
        }else {
          $("#menu li > ul.menu_option_main").css("display", "none")
        }
      });
      $(document).click(function() {
        $("#menu li > ul.menu_option_main").hide()
      })
    }
  };
  var _enableMenuItem = function(items) {
    $(items).removeClass("menu_item_disabled").addClass("menu_item_enabled")
  };
  var _disableMenuItem = function(items) {
    $(items).removeClass("menu_item_enabled").addClass("menu_item_disabled")
  };
  var disableMenu = function() {
    $("#menu").hide();
    $("#menu").attr("id", "menuDisabled")
  };
  var enableMenu = function() {
    $("#menuDisabled").show();
    $("#menuDisabled").attr("id", "menu")
  };
  var onSaveButtonClicked = function() {
    V.Editor.Tools.changeSaveButtonStatus("loading");
    var presentation = V.Editor.savePresentation();
    V.Editor.sendPresentation(presentation, "save", function() {
      V.Editor.Tools.changeSaveButtonStatus("disabled")
    }, function() {
      V.Editor.Tools.changeSaveButtonStatus("enabled")
    })
  };
  var onPublishButtonClicked = function() {
    if(!V.Editor.Settings.checkMandatoryFields()) {
      var options = {};
      options.width = 600;
      options.height = 220;
      options.text = V.I18n.getTrans("i.MandatoryFieldsNotification");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.GotoSettings");
      button1.callback = function() {
        V.Editor.Settings.displaySettings()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    if(V.Slides.getSlides().length === 0) {
      var options = {};
      options.width = 600;
      options.height = 150;
      options.text = V.I18n.getTrans("i.NoSlidesOnSaveNotification");
      var button1 = {};
      button1.text = V.I18n.getTrans("i.Ok");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons = [button1];
      V.Utils.showDialog(options);
      return
    }
    var options = {};
    options.width = 600;
    options.height = 200;
    options.notificationIconSrc = V.ImagesPath + "icons/publish_icon.png";
    options.notificationIconClass = "publishNotificationIcon";
    options.text = V.I18n.getTrans("i.Publish_confirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.publish");
    button2.callback = function() {
      V.Editor.Tools.changePublishButtonStatus("publishing");
      var presentation = V.Editor.savePresentation();
      V.Editor.sendPresentation(presentation, "publish", function(data) {
        if(V.Debugging.isDevelopping()) {
          V.Editor.Preview.preview();
          V.Editor.Tools.changePublishButtonStatus("unpublish")
        }else {
          if(typeof data == "object" && typeof data.url == "string") {
            V.Editor.Events.allowExitWithoutConfirmation();
            window.top.location.href = data.url
          }
        }
      }, function() {
        V.Editor.Tools.changePublishButtonStatus("publish")
      });
      $.fancybox.close()
    };
    options.buttons.push(button2);
    V.Utils.showDialog(options)
  };
  var onUnpublishButtonClicked = function() {
    var options = {};
    options.width = 600;
    options.height = 200;
    options.notificationIconSrc = V.ImagesPath + "icons/unpublish_icon.png";
    options.notificationIconClass = "publishNotificationIcon";
    options.text = V.I18n.getTrans("i.Unpublish_confirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.cancel");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.text = V.I18n.getTrans("i.unpublish");
    button2.callback = function() {
      V.Editor.Tools.changePublishButtonStatus("unpublishing");
      var presentation = V.Editor.savePresentation();
      V.Editor.sendPresentation(null, "unpublish", function() {
        V.Editor.Tools.changePublishButtonStatus("publish")
      }, function() {
        V.Editor.Tools.changePublishButtonStatus("unpublish")
      });
      $.fancybox.close()
    };
    options.buttons.push(button2);
    V.Utils.showDialog(options)
  };
  var notifyTeacherClicked = function() {
    var options = {};
    options.width = 600;
    options.height = 200;
    options.text = V.I18n.getTrans("i.notify_teacher_confirmation");
    options.buttons = [];
    var button1 = {};
    button1.text = V.I18n.getTrans("i.no");
    button1.callback = function() {
      $.fancybox.close()
    };
    options.buttons.push(button1);
    var button2 = {};
    button2.callback = function() {
      V.Editor.savePresentation();
      V.Editor.notifyTeacher();
      $.fancybox.close()
    };
    button2.text = V.I18n.getTrans("i.yes");
    options.buttons.push(button2);
    V.Utils.showDialog(options)
  };
  var preview = function() {
    V.Editor.Preview.preview()
  };
  var help = function() {
    $("#help_right").trigger("click")
  };
  var about = function() {
    V.Tour.startTourWithId("about_screen", "top")
  };
  var exit = function() {
    if(V.Editor.hasPresentationChanged()) {
      var options = {};
      options.width = 600;
      options.height = 200;
      options.notificationIconSrc = V.ImagesPath + "icons/save_document.png";
      options.text = V.I18n.getTrans("i.exitConfirmationMenu");
      options.buttons = [];
      var button1 = {};
      button1.text = V.I18n.getTrans("i.cancel");
      button1.callback = function() {
        $.fancybox.close()
      };
      options.buttons.push(button1);
      var button2 = {};
      button2.text = V.I18n.getTrans("i.ExitWSaving");
      button2.callback = function() {
        _exitFromVE();
        $.fancybox.close()
      };
      options.buttons.push(button2);
      var button3 = {};
      button3.text = V.I18n.getTrans("i.SaveAndExit");
      button3.callback = function() {
        $("#waiting_overlay").show();
        V.Editor.Tools.changeSaveButtonStatus("loading");
        var presentation = V.Editor.savePresentation();
        V.Editor.sendPresentation(presentation, "save", function() {
          V.Editor.Tools.changeSaveButtonStatus("disabled");
          _exitFromVE()
        }, function() {
          V.Editor.Tools.changeSaveButtonStatus("enabled");
          $("#waiting_overlay").hide()
        });
        $.fancybox.close()
      };
      options.buttons.push(button3);
      V.Utils.showDialog(options)
    }else {
      _exitFromVE()
    }
  };
  var _exitFromVE = function() {
    V.Editor.Events.allowExitWithoutConfirmation();
    window.top.location.href = V.exitPath
  };
  var insertSlide = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_slides");
    return false
  };
  var insertSubslide = function() {
    V.Editor.setContentAddMode(V.Constant.SLIDESET);
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_slides");
    return false
  };
  var insertPDFex = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_pdfex");
    return false
  };
  var insertPackage = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_epackage");
    return false
  };
  var insertEFile = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_efile")
  };
  var insertPresentation = function() {
    $("#addSlideFancybox").trigger("click");
    V.Editor.Utils.loadTab("tab_presentations_repo")
  };
  var _exportTo = function(format) {
    var t1 = Date.now();
    V.Utils.Loader.startLoading();
    V.Editor.Presentation.File.exportTo(format, function() {
      V.Utils.Loader.stopLoading()
    }, function() {
      var diff = Date.now() - t1;
      setTimeout(function() {
        var options = {};
        options.width = 600;
        options.height = 185;
        if(format.indexOf("scorm") != -1) {
          options.text = V.I18n.getTrans("i.exportPresToSCORMerrorNotification")
        }else {
          options.text = V.I18n.getTrans("i.exportPresToJSONerrorNotification")
        }
        var button1 = {};
        button1.text = V.I18n.getTrans("i.Ok");
        button1.callback = function() {
          $.fancybox.close()
        };
        options.buttons = [button1];
        V.Utils.showDialog(options)
      }, Math.max(1250 - diff, 0))
    })
  };
  var exportToJSON = function() {
    _exportTo("json")
  };
  var exportToSCORM12 = function() {
    _exportTo("scorm12")
  };
  var exportToSCORM2004 = function() {
    _exportTo("scorm2004")
  };
  var displaySettings = function() {
    V.Editor.Settings.displaySettings()
  };
  var _hideMenuAfterAction = function() {
    if(_hoverMenu) {
      $("#menu ul.menu_option_main").addClass("temp_hidden");
      setTimeout(function() {
        $("#menu ul.menu_option_main").removeClass("temp_hidden")
      }, 500)
    }
  };
  return{init:init, disableMenu:disableMenu, enableMenu:enableMenu, insertSlide:insertSlide, insertSubslide:insertSubslide, insertPDFex:insertPDFex, insertPackage:insertPackage, insertEFile:insertEFile, insertPresentation:insertPresentation, exportToJSON:exportToJSON, exportToSCORM12:exportToSCORM12, exportToSCORM2004:exportToSCORM2004, displaySettings:displaySettings, onPublishButtonClicked:onPublishButtonClicked, onUnpublishButtonClicked:onUnpublishButtonClicked, notifyTeacherClicked:notifyTeacherClicked, 
  onSaveButtonClicked:onSaveButtonClicked, preview:preview, help:help, about:about, exit:exit}
}(VISH, jQuery);
VISH.Editor.Utils.LOM = function(V, $, undefined) {
  var LOM_difficulty;
  var _init = function() {
    LOM_difficulty = new Array;
    LOM_difficulty[0] = {value:"unspecified", text:V.I18n.getTrans("i.unspecified")};
    LOM_difficulty[1] = {value:"very easy", text:V.I18n.getTrans("i.veryeasy")};
    LOM_difficulty[2] = {value:"easy", text:V.I18n.getTrans("i.easy")};
    LOM_difficulty[3] = {value:"medium", text:V.I18n.getTrans("i.medium")};
    LOM_difficulty[4] = {value:"difficult", text:V.I18n.getTrans("i.difficult")};
    LOM_difficulty[5] = {value:"very difficult", text:V.I18n.getTrans("i.verydifficult")}
  };
  var getDifficulty = function() {
    if(typeof LOM_difficulty == "undefined") {
      _init()
    }
    return LOM_difficulty
  };
  return{getDifficulty:getDifficulty}
}(VISH, jQuery);
VISH.Editor.Utils.Loader = function(V, $, undefined) {
  var _loadObjectsInEditor = function(objects) {
    $.each(objects, function(index, object) {
      var htmlContent = $(object).attr("htmlContent");
      if(typeof htmlContent !== "undefined") {
        $(object).html(htmlContent);
        $(object).removeAttr("htmlContent")
      }
    })
  };
  var _unloadObjectsInEditor = function(objects) {
    $.each(objects, function(index, object) {
      var htmlContent = $(object).html();
      if(typeof htmlContent !== "undefined" && htmlContent !== "") {
        $(object).attr("htmlContent", $(object).html());
        $(object).html("")
      }
    })
  };
  var _loadSnapshotsInEditor = function(snapshots) {
    $.each(snapshots, function(index, snapshot) {
      var htmlContent = $(snapshot).attr("htmlContent");
      if(typeof htmlContent !== "undefined") {
        $(snapshot).html(htmlContent);
        $(snapshot).removeAttr("htmlContent");
        var scrollTop = parseInt($(snapshot).attr("scrollTop"));
        var scrollLeft = parseInt($(snapshot).attr("scrollLeft"));
        $(snapshot).scrollTop(scrollTop);
        $(snapshot).scrollLeft(scrollLeft)
      }
    })
  };
  var _unloadSnapshotsInEditor = function(snapshots, updateScrolls) {
    $.each(snapshots, function(index, snapshot) {
      var htmlContent = $(snapshot).html();
      if(typeof htmlContent !== "undefined" && htmlContent !== "") {
        if(updateScrolls === true) {
          $(snapshot).attr("scrollTop", $(snapshot).scrollTop());
          $(snapshot).attr("scrollLeft", $(snapshot).scrollLeft())
        }
        $(snapshot).attr("htmlContent", htmlContent);
        $(snapshot).html("")
      }
    })
  };
  var loadObjectsInEditorSlide = function(slide) {
    _loadObjectsInEditor($(slide).find(".object_wrapper"));
    _loadSnapshotsInEditor($(slide).find(".snapshot_wrapper"))
  };
  var unloadObjectsInEditorSlide = function(slide) {
    _unloadObjectsInEditor($(slide).find(".object_wrapper"));
    _unloadSnapshotsInEditor($(slide).find(".snapshot_wrapper"), true)
  };
  var loadAllObjects = function() {
    _loadObjectsInEditor($(".object_wrapper"));
    _loadSnapshotsInEditor($(".snapshot_wrapper"))
  };
  var unloadAllObjects = function() {
    _unloadObjectsInEditor($(".object_wrapper"));
    _unloadSnapshotsInEditor($(".snapshot_wrapper"))
  };
  return{loadObjectsInEditorSlide:loadObjectsInEditorSlide, unloadObjectsInEditorSlide:unloadObjectsInEditorSlide, loadAllObjects:loadAllObjects, unloadAllObjects:unloadAllObjects}
}(VISH, jQuery);
VISH.Editor.Video.HTML5 = function(V, $, undefined) {
  var init = function() {
  };
  var drawVideoWithWrapper = function(videoTag) {
    var sources = V.Video.HTML5.getSources(videoTag);
    if(sources.length > 0) {
      var options = {};
      var poster = V.Video.HTML5.getPoster(videoTag);
      if(typeof poster == "string") {
        options.poster = poster
      }
      options.timestamp = true;
      drawVideo(sources, options)
    }
  };
  var drawVideoWithUrl = function(url) {
    var options = {};
    options.timestamp = true;
    drawVideo([{src:url}], options)
  };
  var drawVideo = function(sources, options, area, style) {
    var current_area;
    if(area) {
      current_area = area
    }else {
      current_area = V.Editor.getCurrentArea()
    }
    current_area.attr("type", "video");
    var posterUrl = V.Video.HTML5.getDefaultPosterURL();
    var autoplay = false;
    if(options) {
      if(options["poster"] && !V.Video.HTML5.isDefaultPosterPath(options["poster"])) {
        posterUrl = options["poster"]
      }
      if(options["autoplay"]) {
        autoplay = options["autoplay"]
      }
    }
    var template = V.Editor.getTemplate(area);
    var nextVideoId = V.Utils.getId();
    var idToDragAndResize = "draggable" + nextVideoId;
    var videoTag = document.createElement("video");
    videoTag.setAttribute("id", idToDragAndResize);
    videoTag.setAttribute("draggable", true);
    videoTag.setAttribute("class", template + "_video");
    videoTag.setAttribute("title", "Click to drag");
    videoTag.setAttribute("controls", "controls");
    videoTag.setAttribute("preload", "metadata");
    videoTag.setAttribute("poster", posterUrl);
    videoTag.setAttribute("autoplayonslideenter", autoplay);
    if(style) {
      videoTag.setAttribute("style", style)
    }
    $(current_area).html("");
    $(current_area).append(videoTag);
    V.Video.HTML5.addSourcesToVideoTag(sources, videoTag, {timestamp:true});
    V.Editor.addDeleteButton($(current_area));
    $("#" + idToDragAndResize).draggable({cursor:"move"});
    V.Editor.Tools.loadToolsForZone(current_area)
  };
  var renderVideoFromWrapper = function(videoTag, options) {
    var sources = V.Video.HTML5.getSources(videoTag);
    if(sources.length > 0) {
      var options = options || {};
      var poster = V.Video.HTML5.getPoster(videoTag);
      if(typeof poster == "string") {
        options.poster = poster
      }
      return V.Video.HTML5.renderVideoFromSources(sources, options)
    }
  };
  var renderVideoWithURL = function(url, options) {
    return V.Video.HTML5.renderVideoFromSources([{src:url}], options)
  };
  return{init:init, drawVideoWithUrl:drawVideoWithUrl, drawVideo:drawVideo, drawVideoWithWrapper:drawVideoWithWrapper, renderVideoFromWrapper:renderVideoFromWrapper, renderVideoWithURL:renderVideoWithURL}
}(VISH, jQuery);
VISH.Editor.Video.Repository = function(V, $, undefined) {
  var containerDivId = "tab_video_repo_content";
  var carrouselDivId = "tab_video_repo_content_carrousel";
  var previewDivId = "tab_video_repo_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentVideos = new Array;
  var selectedVideo = null;
  var init = function() {
    myInput = $("#tab_video_repo_content").find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    V.Editor.API.requestVideos(text, _onDataReceived, _onAPIError)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanVideoPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanVideoPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || data.length == 0) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    var carrouselImages = [];
    currentVideos = new Array;
    $.each(data, function(index, video) {
      if(video) {
        var videoPoster = typeof video.avatar_url == "string" ? video.avatar_url : V.ImagesPath + "icons/example_poster_image.jpg";
        var videoId = "videoCarrousel_" + index;
        var myImg = $("<img src='" + videoPoster + "' videoId='" + videoId + "' title='" + video.title + "'/>");
        carrouselImages.push(myImg);
        currentVideos[videoId] = video
      }
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorViSHConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoId");
    var renderedVideo = "<div>" + V.Video.HTML5.renderVideoFromJSON(currentVideos[videoId], {loadSources:false, extraClasses:["preview_video"]}) + "</div>";
    _renderVideoPreview(renderedVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderVideoPreview = function(renderedVideo, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedVideo && video) {
      renderedVideo = $(renderedVideo);
      $(videoArea).append(renderedVideo);
      var sources = V.Video.HTML5.getSourcesFromJSON(video);
      var videoDOM = $(renderedVideo).find("video");
      V.Video.HTML5.addSourcesToVideoTag(sources, videoDOM, {timestamp:true});
      var table = V.Editor.Utils.generateTable({title:video.title, author:video.author, description:video.description});
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_repo_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      var options = {};
      if(selectedVideo.poster) {
        options["poster"] = selectedVideo.poster
      }else {
        options["poster"] = V.Video.HTML5.getDefaultPosterURL()
      }
      V.Editor.Video.addContent(V.Video.HTML5.renderVideoFromSources(V.Video.HTML5.getSourcesFromJSON(selectedVideo), options))
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedVideo:addSelectedVideo}
}(VISH, jQuery);
VISH.Editor.Video.Youtube = function(V, $, undefined) {
  var containerDivId = "tab_video_youtube_content";
  var carrouselDivId = "tab_video_youtube_content_carrousel";
  var previewDivId = "tab_video_youtube_content_preview";
  var myInput;
  var timestampLastSearch;
  var currentVideos = new Array;
  var selectedVideo = null;
  var MAX_VIDEOS = 20;
  var init = function() {
    myInput = $("#" + containerDivId).find("input[type='search']");
    $(myInput).vewatermark(V.I18n.getTrans("i.SearchContent"));
    $(myInput).keydown(function(event) {
      if(event.keyCode == 13) {
        _requestData($(myInput).val());
        $(myInput).blur()
      }
    })
  };
  var beforeLoadTab = function() {
    _cleanSearch()
  };
  var onLoadTab = function() {
  };
  var _requestData = function(text) {
    _prepareRequest();
    _searchInYoutube(text)
  };
  var _prepareRequest = function() {
    _cleanCarrousel();
    _cleanVideoPreview();
    V.Utils.Loader.startLoadingInContainer($("#" + carrouselDivId));
    $(myInput).attr("disabled", "true");
    timestampLastSearch = Date.now()
  };
  var _cleanSearch = function() {
    timestampLastSearch = undefined;
    $(myInput).val("");
    $(myInput).removeAttr("disabled");
    _cleanVideoPreview();
    _cleanCarrousel()
  };
  var _cleanCarrousel = function() {
    $("#" + carrouselDivId).hide();
    V.Editor.Carrousel.cleanCarrousel(carrouselDivId)
  };
  var _searchInYoutube = function(text) {
    var urlYoutube = "https://www.googleapis.com/youtube/v3/search?part=id,snippet&maxResults=" + MAX_VIDEOS + "&q=" + text + "&key=" + V.Configuration.getConfiguration()["YoutubeAPIKEY"] + "&videoEmbeddable=true&type=video";
    urlYoutube = V.Utils.checkUrlProtocol(urlYoutube);
    $.getJSON(urlYoutube, function(data) {
      _onDataReceived(data)
    }).error(function() {
      _onAPIError()
    })
  };
  var _onDataReceived = function(data) {
    if(!_isValidResult()) {
      return
    }
    if(!data || (!(data.items instanceof Array) || data.items.length == 0)) {
      _onSearchFinished();
      _drawData(true);
      return
    }
    currentVideos = new Array;
    var carrouselImages = [];
    $.each(data.items, function(i, item) {
      var videoId = item["id"]["videoId"];
      var title = item["snippet"]["title"];
      var description = item["snippet"]["description"];
      var author = item["snippet"]["channelTitle"];
      var thumbnail_url = V.ImagesPath + "vicons/example_poster_image.jpg";
      if(item["snippet"]["thumbnails"] && (item["snippet"]["thumbnails"]["default"] && item["snippet"]["thumbnails"]["default"]["url"])) {
        thumbnail_url = item["snippet"]["thumbnails"]["default"]["url"]
      }
      thumbnail_url = V.Utils.checkUrlProtocol(thumbnail_url);
      if(typeof author != "string" || author.trim() === "") {
        author = V.I18n.getTrans("i.Unknown")
      }
      currentVideos[videoId] = new Object;
      currentVideos[videoId].id = videoId;
      currentVideos[videoId].title = title;
      currentVideos[videoId].description = description;
      currentVideos[videoId].author = author;
      if(thumbnail_url) {
        var myImg = $("<img videoId='" + videoId + "' src='" + thumbnail_url + "' title='" + title + "'/>");
        carrouselImages.push(myImg)
      }
    });
    var options = {};
    options.callback = _onImagesLoaded;
    V.Utils.Loader.loadImagesOnContainer(carrouselImages, carrouselDivId, options)
  };
  var _onImagesLoaded = function() {
    _onSearchFinished();
    _drawData()
  };
  var _onSearchFinished = function() {
    V.Utils.Loader.stopLoadingInContainer($("#" + carrouselDivId));
    $(myInput).removeAttr("disabled")
  };
  var _drawData = function(noResults) {
    $("#" + carrouselDivId).show();
    if(!_isValidResult()) {
      _cleanCarrousel();
      return
    }
    V.Utils.addTempShown([$("#" + containerDivId), $("#" + carrouselDivId)]);
    if(noResults === true) {
      $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.Noresultsfound") + "</p>");
      V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
    }else {
      if(noResults === false) {
        $("#" + carrouselDivId).html("<p class='carrouselNoResults'>" + V.I18n.getTrans("i.errorYoutubeConnection") + "</p>");
        V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
      }else {
        var options = new Array;
        options.rows = 1;
        options.callback = _onClickCarrouselElement;
        options.rowItems = 5;
        options.scrollItems = 5;
        options.afterCreateCarruselFunction = function() {
          setTimeout(function() {
            V.Utils.removeTempShown([$("#" + containerDivId), $("#" + carrouselDivId)])
          }, 100)
        };
        V.Editor.Carrousel.createCarrousel(carrouselDivId, options)
      }
    }
  };
  var addSelectedVideo = function() {
    if(selectedVideo != null) {
      V.Editor.Video.addContent(_generateWrapper(selectedVideo.id))
    }
  };
  var _onAPIError = function() {
    if(_isValidResult()) {
      _onSearchFinished();
      _drawData(false)
    }
  };
  var _onClickCarrouselElement = function(event) {
    var videoId = $(event.target).attr("videoId");
    var renderedPreviewVideo = _generatePreviewWrapper(videoId);
    _renderVideoPreview(renderedPreviewVideo, currentVideos[videoId]);
    selectedVideo = currentVideos[videoId]
  };
  var _isValidResult = function() {
    if(typeof timestampLastSearch == "undefined") {
      return false
    }
    var isVisible = $("#" + carrouselDivId).is(":visible");
    if(!isVisible) {
      return false
    }
    return true
  };
  var _renderVideoPreview = function(renderedIframe, video) {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    if(renderedIframe && video) {
      $(videoArea).append(renderedIframe);
      var table = V.Editor.Utils.generateTable({title:video.title, author:video.author, description:video.description});
      $(metadataArea).html(table);
      $(button).show()
    }
  };
  var _cleanVideoPreview = function() {
    var videoArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_video");
    var metadataArea = $("#" + previewDivId).find("#tab_video_youtube_content_preview_metadata");
    var button = $("#" + previewDivId).find(".okButton");
    $(videoArea).html("");
    $(metadataArea).html("");
    $(button).hide()
  };
  var _generateWrapper = function(videoId) {
    var videoURL = "https://www.youtube.com/embed/" + videoId;
    videoURL = V.Utils.addParamToUrl(videoURL, "wmode", "opaque");
    var videoWContainer = typeof V.Editor.getCurrentArea() != "undefined" && V.Editor.getCurrentArea() != null ? V.Editor.getCurrentArea() : V.Editor.getCurrentContainer();
    var dimensionsToDraw = V.Utils.dimentionsToDraw($(videoWContainer).width(), $(videoWContainer).height(), 325, 243);
    var wrapper = "<iframe src='" + videoURL + "' frameborder='0' style='width:" + dimensionsToDraw.width + "px; height:" + dimensionsToDraw.height + "px;'></iframe>";
    return wrapper
  };
  var generateWrapperForYoutubeVideoUrl = function(url) {
    var videoId = V.Video.Youtube.getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generateWrapper(videoId)
    }else {
      return"Youtube Video ID can't be founded."
    }
  };
  var _generatePreviewWrapper = function(videoId) {
    var videoURL = "https://www.youtube.com/embed/" + videoId;
    videoURL = V.Utils.addParamToUrl(videoURL, "wmode", "opaque");
    var wrapper = '<iframe class="objectPreview" src="' + videoURL + '" frameborder="0"></iframe>';
    return wrapper
  };
  var generatePreviewWrapperForYoutubeVideoUrl = function(url) {
    var videoId = V.Video.Youtube.getYoutubeIdFromURL(url);
    if(videoId != null) {
      return _generatePreviewWrapper(videoId)
    }else {
      return"<p class='objectPreview'>Youtube Video ID can't be founded.</p>"
    }
  };
  return{init:init, beforeLoadTab:beforeLoadTab, onLoadTab:onLoadTab, addSelectedVideo:addSelectedVideo, generateWrapperForYoutubeVideoUrl:generateWrapperForYoutubeVideoUrl, generatePreviewWrapperForYoutubeVideoUrl:generatePreviewWrapperForYoutubeVideoUrl}
}(VISH, jQuery);
VISH.Editor.ViewerAdapter = function(V, $, undefined) {
  var _fsButton;
  var _initialized = false;
  var init = function(options) {
    if(_initialized) {
      return
    }
    _initialized = true;
    _fsButton = V.FullScreen.canFullScreen();
    if(_fsButton) {
      V.FullScreen.enableFullScreen();
      $("#page-fullscreen").show()
    }else {
      $("#page-fullscreen").hide()
    }
  };
  var updateInterface = function() {
    var device = V.Status.getDevice();
    var editorDOM = $("section.slides_editor");
    var document_width = $(document).width();
    var document_height = $(document).height();
    var document_aspectRatio = document_width / document_height;
    var scale = 1;
    var extraHeaderHeight = 0;
    if(V.FullScreen.isFullScreen()) {
      if(device.desktop) {
        if(device.browser.name === V.Constant.CHROME) {
          extraHeaderHeight = 10
        }
      }else {
        if(device.features.touchScreen === true) {
          if(device.browser.name === V.Constant.CHROME) {
            extraHeaderHeight = 55
          }
        }
      }
      var original_width = 1200;
      var original_height = 750 + extraHeaderHeight;
      var original_aspectRatio = original_width / original_height;
      if(document_aspectRatio > original_aspectRatio) {
        scale = document_height / original_height
      }else {
        scale = document_width / original_width
      }
    }
    $(editorDOM).css("top", extraHeaderHeight);
    V.Utils.addScale3DToElement($(editorDOM), scale);
    var marginLeft = Math.max(0, (document_width - $(editorDOM).width() * scale) / 2);
    $("section.slides_editor").css("margin-left", marginLeft + "px")
  };
  return{init:init, updateInterface:updateInterface}
}(VISH, jQuery);
VISH.Events.Mobile = function(V, $, undefined) {
  var _bindedMobileEventListeners = false;
  var _touchable = false;
  var init = function() {
    _touchable = V.Status.getDevice().features.touchScreen;
    if(_touchable) {
      V.Events.Touchable.init()
    }
  };
  var bindViewerMobileEventListeners = function() {
    if(_bindedMobileEventListeners) {
      return
    }
    _bindedMobileEventListeners = true;
    var device = V.Status.getDevice();
    var isIphoneAndSafari = device.iPhone && device.browser.name === V.Constant.SAFARI;
    var clickDelegationBug = isIphoneAndSafari;
    if(_touchable) {
      V.Events.Touchable.bindTouchableEventListeners();
      V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onShiftRight, function(params) {
        V.Slides.backwardOneSlide()
      });
      V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onShiftLeft, function(params) {
        V.Slides.forwardOneSlide()
      });
      if(!clickDelegationBug) {
        $(document).on("click", ".close_subslide", V.Slideset.onCloseSubslideClicked)
      }else {
        V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onSimpleClick, function(params) {
          var event = params.event;
          var target = event.target;
          if($(target).hasClass("close_subslide")) {
            event.preventDefault();
            V.Slideset.onCloseSubslideClicked(event)
          }
        })
      }
      if(device.tablet) {
        V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onLongClick, function(params) {
          var event = params.event;
          var target = event.target;
          if(_checkPaginatorClick(event.target.id)) {
            event.preventDefault();
            event.stopPropagation();
            _applyPaginatorClick(event.target.id)
          }
        });
        V.EventsNotifier.registerCallback(V.Constant.Event.Touchable.onUnknownTouchMovement, function(params) {
          var event = params.event;
          var id = event.target.id;
          var touchParams = params.touchParams;
          if(_checkPaginatorClick(id)) {
            var PM_TOUCH_SENSITIVITY_FOR_PAGER_FALLBACK = 15;
            if((touchParams.absTouchDX + touchParams.absTouchDY) / 2 < PM_TOUCH_SENSITIVITY_FOR_PAGER_FALLBACK) {
              event.preventDefault();
              _applyPaginatorClick(id)
            }
          }
        })
      }
    }
    $(window).on("orientationchange", function() {
      $(window).trigger("resize")
    })
  };
  var unbindViewerMobileEventListeners = function() {
    if(!_bindedMobileEventListeners) {
      return
    }
    _bindedMobileEventListeners = false;
    if(_touchable) {
      V.Events.Touchable.unbindTouchableEventListeners()
    }
    $(window).off("orientationchange", function() {
      window.onresize()
    })
  };
  var _checkPaginatorClick = function(targetId) {
    return targetId === "page-switcher-end" || targetId === "page-switcher-start"
  };
  var _applyPaginatorClick = function(targetId) {
    if(targetId === "page-switcher-end") {
      $("#page-switcher-end").trigger("click")
    }else {
      if(targetId === "page-switcher-start") {
        $("#page-switcher-start").trigger("click")
      }
    }
  };
  return{init:init, bindViewerMobileEventListeners:bindViewerMobileEventListeners, unbindViewerMobileEventListeners:unbindViewerMobileEventListeners}
}(VISH, jQuery);
VISH.Events.Touchable = function(V, $, undefined) {
  var PM_TOUCH_SENSITIVITY_FOR_CLICK = 7;
  var PM_TOUCH_SENSITIVITY_FOR_SHIFT = 20;
  var PM_TOUCH_DESVIATION = 60;
  var MINIMUM_ZOOM_TO_ENABLE_SCROLL = 1.2;
  var LONG_TOUCH_DURATION = 1E3;
  var _bindedTouchableEventListeners = false;
  var init = function() {
  };
  var bindTouchableEventListeners = function() {
    if(_bindedTouchableEventListeners) {
      return
    }
    _bindedTouchableEventListeners = true;
    $(document).bind("touchstart", _handleTouchStart);
    document.body.addEventListener("touchmove", _handleTouchMove, true);
    document.body.addEventListener("touchend", _handleTouchEnd, true);
    document.body.addEventListener("touchcancel", _handleTouchCancel, true)
  };
  var unbindTouchableEventListeners = function() {
    if(_bindedTouchableEventListeners === false) {
      return
    }
    _bindedTouchableEventListeners = false;
    $(document).unbind("touchstart", _handleTouchStart);
    document.body.removeEventListener("touchmove", _handleTouchMove, true);
    document.body.removeEventListener("touchend", _handleTouchEnd, true);
    document.body.removeEventListener("touchcancel", _handleTouchCancel, true)
  };
  var _touchStartX = 0;
  var _touchStartY = 0;
  var _touchCX = 0;
  var _touchCY = 0;
  var _touchDX = 0;
  var _touchDY = 0;
  var _absTouchDX = 0;
  var _absTouchDY = 0;
  var _touchesLength = 0;
  var _touchStartTime = 0;
  var _touchDuration = 0;
  var _handleTouchStart = function(event) {
    _resetTouchVars();
    var touches = _getTouches(event);
    _touchesLength = touches.length;
    if(_touchesLength === 1) {
      _touchStartX = touches[0].pageX;
      _touchStartY = touches[0].pageY
    }
    _touchStartTime = (new Date).getTime()
  };
  var _handleTouchMove = function(event) {
    var touches = _getTouches(event);
    if(touches.length === 1) {
      _touchCX = touches[0].pageX;
      _touchCY = touches[0].pageY;
      var zoom = document.documentElement.clientWidth / window.innerWidth;
      if(zoom <= MINIMUM_ZOOM_TO_ENABLE_SCROLL) {
        event.preventDefault();
        return
      }
    }
  };
  var _handleTouchEnd = function(event) {
    if(_checkClickTouches(event)) {
      return
    }
    if(_checkAdvanceSlidesTouches(event)) {
      return
    }
    _checkOtherTouches(event)
  };
  var _handleTouchCancel = function() {
    _resetTouchVars()
  };
  var _resetTouchVars = function() {
    _touchStartX = -1;
    _touchStartY = -1;
    _touchCX = -1;
    _touchCY = -1;
    _touchDX = -1;
    _touchDY = -1;
    _absTouchDX = -1;
    _absTouchDY = -1;
    _touchesLength = -1;
    _touchStartTime = -1;
    _touchDuration = -1
  };
  var _checkClickTouches = function(event) {
    if(_touchesLength != 1) {
      return false
    }
    var click;
    if(_touchCX == -1 && _touchCY == -1) {
      click = true
    }else {
      _touchDX = _touchCX - _touchStartX;
      _touchDY = _touchCY - _touchStartY;
      _absTouchDX = Math.abs(_touchDX);
      _absTouchDY = Math.abs(_touchDY);
      if(_absTouchDX < PM_TOUCH_SENSITIVITY_FOR_CLICK && _absTouchDX < PM_TOUCH_SENSITIVITY_FOR_CLICK) {
        click = true
      }
    }
    if(click) {
      _touchDuration = (new Date).getTime() - _touchStartTime;
      if(_touchDuration < LONG_TOUCH_DURATION) {
        _simpleClick(event)
      }else {
        _longClick(event)
      }
    }
    return click
  };
  var _simpleClick = function(event) {
    V.EventsNotifier.notifyEvent(V.Constant.Event.Touchable.onSimpleClick, {event:event}, true);
    return true
  };
  var _longClick = function(event) {
    V.EventsNotifier.notifyEvent(V.Constant.Event.Touchable.onLongClick, {event:event}, true);
    return true
  };
  var _checkAdvanceSlidesTouches = function(event) {
    if(_touchesLength != 1) {
      return false
    }
    _touchDX = _touchCX - _touchStartX;
    _touchDY = _touchCY - _touchStartY;
    _absTouchDX = Math.abs(_touchDX);
    _absTouchDY = Math.abs(_touchDY);
    var significantTouch = _absTouchDX > PM_TOUCH_SENSITIVITY_FOR_SHIFT && _absTouchDY < PM_TOUCH_DESVIATION;
    significantTouch = significantTouch && _touchCX !== -1;
    if(significantTouch) {
      event.preventDefault();
      var zoom = document.documentElement.clientWidth / window.innerWidth;
      if(zoom > MINIMUM_ZOOM_TO_ENABLE_SCROLL) {
        return
      }
      if(_touchDX > 0) {
        V.EventsNotifier.notifyEvent(V.Constant.Event.Touchable.onShiftRight, {event:event, touchParams:_getTouchParams()}, true)
      }else {
        V.EventsNotifier.notifyEvent(V.Constant.Event.Touchable.onShiftLeft, {event:event, touchParams:_getTouchParams()}, true)
      }
    }
    return significantTouch
  };
  var _checkOtherTouches = function(event) {
    V.EventsNotifier.notifyEvent(V.Constant.Event.Touchable.onUnknownTouchMovement, {event:event, touchParams:_getTouchParams()}, true);
    return false
  };
  var _getTouches = function(event) {
    if(event.touches) {
      return event.touches
    }else {
      if(event.originalEvent.touches) {
        return event.originalEvent.touches
      }else {
        return null
      }
    }
  };
  var _getTouchParams = function() {
    return{touchStartX:_touchStartX, touchStartY:_touchStartY, touchCX:_touchCX, touchCY:_touchCY, touchDX:_touchDX, touchDY:_touchDY, absTouchDX:_absTouchDX, absTouchDY:_absTouchDY, touchesLength:_touchesLength}
  };
  return{init:init, bindTouchableEventListeners:bindTouchableEventListeners, unbindTouchableEventListeners:unbindTouchableEventListeners}
}(VISH, jQuery);
VISH.EventsNotifier = function(V, $, undefined) {
  var listeners;
  var init = function() {
    listeners = new Array
  };
  var registerCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      listeners[listenedEvent].push(callback)
    }else {
      listeners[listenedEvent] = [];
      listeners[listenedEvent].push(callback);
      if(listenedEvent == V.Constant.Event.onSendIframeMessage) {
        V.Messenger.init()
      }
    }
  };
  var unRegisterCallback = function(listenedEvent, callback) {
    if(listenedEvent in listeners) {
      if(listeners[listenedEvent].indexOf(callback) !== -1) {
        listeners[listenedEvent].splice(listeners[listenedEvent].indexOf(callback), 1)
      }
    }
  };
  var notifyEvent = function(triggeredEvent, params, triggeredByUser) {
    if(!listeners) {
      return
    }
    params = params || {};
    params.triggeredByUser = !(triggeredByUser === false);
    var eventListeners = listeners[triggeredEvent];
    if(eventListeners) {
      for(var i = 0;i < eventListeners.length;i++) {
        eventListeners[i](params)
      }
    }
  };
  return{init:init, notifyEvent:notifyEvent, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback}
}(VISH, jQuery);
VISH.FullScreen = function(V, $, undefined) {
  var _currentFSElement;
  var _lastFSElement;
  var _lastFSTimestamp;
  var _pageIsFullScreen;
  var _fallbackFs;
  var _enterFsURL;
  var _exitFsURL;
  var init = function() {
    _addContainerFSAttributes();
    if(!_canUseNativeFs() && _canUseFallbackFs()) {
      _fallbackFs = true;
      _initFallback()
    }else {
      _fallbackFs = false
    }
    _updateFsButtons()
  };
  var _initFallback = function() {
    _pageIsFullScreen = false;
    if(V.Status.isEmbed()) {
      _enterFsURL = V.Utils.checkUrlProtocol(options["fullScreenFallback"]["enterFullscreenURL"])
    }else {
      _exitFsURL = V.Utils.checkUrlProtocol(options["fullScreenFallback"]["exitFullscreenURL"]);
      _pageIsFullScreen = true
    }
  };
  var canFullScreen = function() {
    if(!V.Editing) {
      return _canUseNativeFs() || _canUseFallbackFs()
    }else {
      return false && (_canUseNativeFs() && V.Status.getDevice().features.css3d)
    }
  };
  var _canUseNativeFs = function() {
    return V.Status.getDevice().features.fullscreen && _getFsEnabled(_getFSDocumentTarget())
  };
  var _canUseFallbackFs = function() {
    if(V.Status.isExternalDomain()) {
      return false
    }
    if(V.Editing) {
      return false
    }
    var options = V.Utils.getOptions();
    if(typeof options == "object" && typeof options["fullScreenFallback"] == "object") {
      if(V.Status.isEmbed() && typeof options["fullScreenFallback"]["enterFullscreenURL"] == "string") {
        return true
      }
      if(V.Status.isEmbed()) {
        if(typeof options["fullScreenFallback"]["enterFullscreenURL"] == "string") {
          return true
        }
      }else {
        if(typeof options["fullScreenFallback"]["exitFullscreenURL"] == "string") {
          return true
        }
      }
    }
    return false
  };
  var isFullScreen = function() {
    if(_fallbackFs === true) {
      return _pageIsFullScreen
    }
    return _isDocumentFullScreen()
  };
  var enableFullScreen = function() {
    if(_canUseNativeFs()) {
      _enableNativeFS()
    }else {
      if(_fallbackFs) {
        _enableFallbackFS()
      }
    }
  };
  var _enableNativeFS = function() {
    $(document).on("click", "#page-fullscreen", _toggleFullScreen);
    $(_getFSDocumentTarget()).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange", function(event) {
      _lastFSElement = _currentFSElement;
      _currentFSElement = _getFsElement(_getFSDocumentTarget());
      _lastFSTimestamp = new Date;
      _updateFsButtons()
    })
  };
  var _enableFallbackFS = function() {
    if(_pageIsFullScreen && typeof _exitFsURL == "string") {
      $(document).on("click", "#page-fullscreen", function() {
        window.location = V.Utils.removeHashFromUrlString(_exitFsURL) + "#" + V.Slides.getCurrentSlideNumber()
      })
    }else {
      if(!_pageIsFullScreen && typeof _enterFsURL == "string") {
        $(document).on("click", "#page-fullscreen", function() {
          V.Utils.sendParentToURL(V.Utils.removeHashFromUrlString(_enterFsURL) + "?orgUrl=" + V.Utils.removeHashFromUrlString(window.parent.location.href) + "#" + V.Slides.getCurrentSlideNumber())
        })
      }
    }
  };
  var _toggleFullScreen = function() {
    if(V.Status.isSlaveMode()) {
      return
    }
    var myDoc = _getFSDocumentTarget();
    var myElem = _getFSElementTarget();
    if(_isDocumentFullScreen()) {
      _cancelFullscreenForElement(myDoc)
    }else {
      _launchFullscreenForElement(myDoc, myElem)
    }
  };
  var exitFromNativeFullScreen = function() {
    if(_canUseNativeFs() && _isDocumentFullScreen()) {
      _toggleFullScreen()
    }
  };
  var _updateFsButtons = function() {
    if(isFullScreen()) {
      _enableFsEnterButon()
    }else {
      _enableFsLeaveButon()
    }
  };
  var _enableFsEnterButon = function() {
    $("#page-fullscreen").removeClass("fsoff").addClass("fson")
  };
  var _enableFsLeaveButon = function() {
    $("#page-fullscreen").removeClass("fson").addClass("fsoff")
  };
  var _addContainerFSAttributes = function() {
    try {
      var container = V.Status.getContainer();
      if(typeof container != "undefined") {
        if(typeof $(container).attr("allowfullscreen") == "undefined") {
          $(container).attr("allowfullscreen", "true");
          $(container).attr("webkitAllowFullScreen", "true");
          $(container).attr("mozallowfullscreen", "true")
        }else {
          if($(container).attr("allowfullscreen") == "false") {
            $(container).removeAttr("allowfullscreen");
            $(container).removeAttr("webkitAllowFullScreen");
            $(container).removeAttr("mozallowfullscreen");
            return
          }
        }
        var fsElementTarget = _getFSElementTarget();
        if(V.Status.getContainerType() === "OBJECT") {
          $(container).addClass("VEditorFS");
          $(fsElementTarget).addClass("VEditorFS");
          $(window.parent.document).find("head").append("<style>.VEditorFS:full-screen, :full-screen > object.VEditorFS {width: 100% !important;height: 100% !important;}</style>");
          $(window.parent.document).find("head").append("<style>.VEditorFS:-webkit-full-screen, :-webkit-full-screen > object.VEditorFS {width: 100% !important;height: 100% !important;}</style>");
          $(window.parent.document).find("head").append("<style>.VEditorFS:-moz-full-screen, :-moz-full-screen > object.VEditorFS {width: 100% !important;height: 100% !important;}</style>")
        }
      }
    }catch(e) {
    }
  };
  var _isBrowserInFullScreen = function() {
    var fsElement = _getFsElement(_getFSDocumentTarget());
    return typeof fsElement !== "undefined" && fsElement !== null
  };
  var _isDocumentFullScreen = function() {
    if(V.Status.getContainerType() === "OBJECT") {
      return _isObjectFullScreen()
    }
    return $(_getFsElement(_getFSDocumentTarget())).is("html")
  };
  var _isObjectFullScreen = function() {
    return _isBrowserInFullScreen()
  };
  var isOtherElementInFullScreen = function() {
    return _isBrowserInFullScreen() && !_isDocumentFullScreen()
  };
  var getFSParams = function() {
    return{currentFSElement:_currentFSElement, lastFSElement:_lastFSElement, lastFSTimestamp:_lastFSTimestamp, fsElementTarget:_getFSElementTarget()}
  };
  var _isElementInFullScreen = function(elem) {
    return typeof elem !== "undefined" && (elem !== null && elem === _getFsElement(_getFSDocumentTarget()))
  };
  var _getFsElement = function(myDoc) {
    return myDoc.fullscreenElement || (myDoc.mozFullScreenElement || (myDoc.webkitFullscreenElement || myDoc.msFullscreenElement))
  };
  var _getFsEnabled = function(myDoc) {
    return myDoc.fullscreenEnabled || (myDoc.mozFullScreenEnabled || (myDoc.webkitFullscreenEnabled || myDoc.msFullscreenEnabled))
  };
  var _getFSDocumentTarget = function() {
    return V.Status.getContainerType() == "OBJECT" ? window.parent.document : document
  };
  var _getFSElementTarget = function() {
    return V.Status.getContainerType() == "OBJECT" ? V.Status.getContainer().parentElement : document.documentElement
  };
  var _launchFullscreenForElement = function(myDoc, element) {
    if(element.requestFullscreen) {
      element.requestFullscreen()
    }else {
      if(element.mozRequestFullScreen) {
        element.mozRequestFullScreen()
      }else {
        if(element.webkitRequestFullscreen) {
          element.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);
          setTimeout(function() {
            if(!myDoc.webkitCurrentFullScreenElement) {
              element.webkitRequestFullScreen()
            }
          }, 250)
        }else {
          if(element.msRequestFullscreen) {
            element.msRequestFullscreen()
          }
        }
      }
    }
  };
  var _cancelFullscreenForElement = function(elem) {
    if(elem.exitFullscreen) {
      elem.exitFullscreen()
    }else {
      if(elem.cancelFullScreen) {
        elem.cancelFullScreen()
      }else {
        if(elem.mozCancelFullScreen) {
          elem.mozCancelFullScreen()
        }else {
          if(elem.webkitExitFullscreen) {
            elem.webkitExitFullscreen()
          }else {
            if(elem.webkitCancelFullScreen) {
              elem.webkitCancelFullScreen()
            }else {
              if(elem.msExitFullscreen) {
                elem.msExitFullscreen()
              }
            }
          }
        }
      }
    }
  };
  var isFullScreenSupported = function() {
    var elem = document.createElement("div");
    if(elem && (elem.requestFullScreen || (elem.mozRequestFullScreen || (elem.webkitRequestFullScreen || elem.msRequestFullscreen)))) {
      return true
    }else {
      return false
    }
  };
  return{init:init, isFullScreenSupported:isFullScreenSupported, canFullScreen:canFullScreen, enableFullScreen:enableFullScreen, isFullScreen:isFullScreen, isOtherElementInFullScreen:isOtherElementInFullScreen, getFSParams:getFSParams, exitFromNativeFullScreen:exitFromNativeFullScreen}
}(VISH, jQuery);
VISH.I18n = function(V, $, undefined) {
  var DEFAULT_LANGUAGE = "en";
  var _availableLocales;
  var _envLocales;
  var _availableLanguages;
  var _language;
  var _locales;
  var _defaultLocales;
  var init = function(options, presentation) {
    var configuration = V.Configuration.getConfiguration();
    _availableLocales = _getAvailableLocales();
    _availableLanguages = _getAvailableLanguages();
    if(_isValidLanguage(configuration["defaultLanguage"])) {
      DEFAULT_LANGUAGE = configuration["defaultLanguage"]
    }
    if(_isValidLanguage(options.lang)) {
      _language = options.lang
    }else {
      var browserLang = navigator.language || navigator.userLanguage;
      if(_isValidLanguage(browserLang)) {
        _language = browserLang
      }else {
        if(typeof presentation == "object" && _isValidLanguage(presentation.language)) {
          _language = presentation.language
        }else {
          _language = DEFAULT_LANGUAGE
        }
      }
    }
    _defaultLocales = V.Locales;
    if(typeof _envLocales == "object") {
      _locales = _envLocales
    }else {
      _locales = _defaultLocales
    }
  };
  var _getAvailableLanguages = function() {
    var _availableLanguages = [];
    var _availableLocales = _getAvailableLocales();
    for(var i = 0;i < _availableLocales.length;i++) {
      var languages = Object.keys(_availableLocales[i]);
      for(var j = 0;j < languages.length;j++) {
        if(_availableLanguages.indexOf(languages[j]) == -1) {
          _availableLanguages.push(languages[j])
        }
      }
    }
    return _availableLanguages
  };
  var getAvailableLanguages = function() {
    if(_availableLanguages instanceof Array) {
      return _availableLanguages
    }
    return _getAvailableLanguages()
  };
  var _getAvailableLocales = function() {
    var availableLocales = [];
    var configuration = V.Configuration.getConfiguration();
    if(typeof V.Locales == "object") {
      availableLocales.push(V.Locales)
    }
    if(typeof configuration["locales"] == "object") {
      availableLocales.push(configuration["locales"]);
      _envLocales = configuration["locales"]
    }
    return availableLocales
  };
  var getAvailableLocales = function() {
    if(_availableLocales instanceof Array) {
      return _availableLocales
    }
    return _getAvailableLocales()
  };
  var _isValidLanguage = function(language) {
    return typeof language == "string" && getAvailableLanguages().indexOf(language) != -1
  };
  var translateUI = function() {
    $("[i18n-key]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key"));
      if(typeof translation != "undefined") {
        switch(elem.tagName) {
          case "INPUT":
            _translateInput(elem, translation);
            break;
          case "TEXTAREA":
            _translateTextArea(elem, translation);
            break;
          case "DIV":
            _translateDiv(elem, translation);
            break;
          case "LI":
            _translateLI(elem, translation);
            break;
          case "IMG":
            _translateImg(elem, translation);
            break;
          default:
            _genericTranslate(elem, translation);
            break
        }
      }
    });
    $("[i18n-key-tooltip]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key-tooltip"));
      if(typeof translation != "undefined") {
        $(elem).attr("title", translation)
      }
    });
    $("[i18n-key-href]").each(function(index, elem) {
      var translation = getTrans($(elem).attr("i18n-key-href"));
      if(typeof translation != "undefined") {
        $(elem).attr("href", translation)
      }
    })
  };
  var _translateInput = function(input, translation) {
    if($(input).val() !== "") {
      $(input).val(translation)
    }
    if($(input).attr("placeholder")) {
      $(input).attr("placeholder", translation)
    }
  };
  var _translateDiv = function(div, translation) {
    if($(div).attr("data-text") != undefined) {
      $(div).attr("data-text", translation)
    }
    if($(div).attr("title") != undefined) {
      $(div).attr("title", translation)
    }
  };
  var _translateTextArea = function(textArea, translation) {
    $(textArea).attr("placeholder", translation)
  };
  var _translateLI = function(li, translation) {
    if($(li).attr("data-text") != undefined) {
      $(li).attr("data-text", translation)
    }else {
      _genericTranslate(li, translation)
    }
  };
  var _translateImg = function(img, translation) {
    var attrToChange = "src";
    if(typeof $(img).attr("srctoload") != "undefined") {
      attrToChange = "srctoload"
    }
    $(img).attr(attrToChange, V.ImagesPath + translation)
  };
  var _genericTranslate = function(elem, translation) {
    $(elem).text(translation)
  };
  var getTrans = function(s, params) {
    var trans = _getTransFromLocales(_locales, s, params);
    if(typeof trans == "string") {
      return trans
    }
    trans = _getTransFromLocales(_defaultLocales, s, params);
    if(typeof trans == "string") {
      return trans
    }
    var key_pattern = /^i\./g;
    if(key_pattern.exec(s) != null) {
      return undefined
    }else {
      return s
    }
  };
  var _getTransFromLocales = function(locales, s, params) {
    if(typeof locales[_language] != "undefined" && typeof locales[_language][s] == "string") {
      return _getTransWithParams(locales[_language][s], params)
    }
    if(_language != DEFAULT_LANGUAGE && (typeof locales[DEFAULT_LANGUAGE] != "undefined" && typeof locales[DEFAULT_LANGUAGE][s] == "string")) {
      return _getTransWithParams(locales[DEFAULT_LANGUAGE][s], params)
    }
    return undefined
  };
  var _getTransWithParams = function(trans, params) {
    if(typeof params != "object") {
      return trans
    }
    for(var key in params) {
      var stringToReplace = "#{" + key + "}";
      if(trans.indexOf(stringToReplace) != -1) {
        trans = trans.replaceAll(stringToReplace, params[key])
      }
    }
    return trans
  };
  var getLanguage = function() {
    return _language
  };
  return{init:init, getAvailableLanguages:getAvailableLanguages, getAvailableLocales:getAvailableLocales, getLanguage:getLanguage, getTrans:getTrans, translateUI:translateUI}
}(VISH, jQuery);
var VISH = VISH || {};
VISH.IframeAPI = function(V, undefined) {
  var _initialized = false;
  var _connected = false;
  var _options;
  var _mode = "EXTERNAL";
  var _origin = "?";
  var _originId = "?";
  var _listeners;
  var _wapplisteners;
  var VALID_TYPES = ["PROTOCOL", "VE", "WAPP"];
  var init = function(initOptions) {
    _connected = false;
    if(_initialized === false) {
      try {
        _origin = window.location.href
      }catch(e) {
      }
      _originId = _generateOriginId();
      if(window.addEventListener) {
        window.addEventListener("message", _onIframeMessageReceived, false)
      }else {
        if(window.attachEvent) {
          window.attachEvent("message", _onIframeMessageReceived)
        }
      }
      _defineVEConstants()
    }
    _initialized = true;
    _options = initOptions || {};
    if(["EXTERNAL", "INTERNAL"].indexOf(_options.mode) != -1) {
      _mode = _options.mode
    }
    if(_options.wapp === true) {
      _mode = "INTERNAL"
    }else {
      if(_options.ve === true) {
        _mode = "EXTERNAL"
      }
    }
    if(_options.tracking === true && (_mode = "INTERNAL")) {
      enableTracker()
    }
    _listeners = new Array;
    _wapplisteners = new Array;
    registerCallback("onConnect", function(origin) {
      if(_mode === "EXTERNAL") {
        _afterConnectExternal(origin)
      }
      if(_options && typeof _options.callback === "function") {
        _options.callback(origin)
      }
    });
    _initHelloExchange()
  };
  function IframeMessage(type, data, destination, destinationId) {
    this.IframeMessage = true;
    this.mode = _mode;
    this.type = type || _mode;
    this.data = data || {};
    this.origin = _origin;
    this.originId = _originId;
    this.destination = destination || "*";
    if(destinationId) {
      this.destinationId = destinationId
    }
  }
  var _createMessage = function(type, data, destination, destinationId) {
    var iframeMessage = new IframeMessage(type, data, destination, destinationId);
    return JSON.stringify(iframeMessage)
  };
  var _validateWrapperedIframeMessage = function(wrapperedIframeMessage) {
    if(typeof wrapperedIframeMessage != "object" || typeof wrapperedIframeMessage.data != "string") {
      return false
    }
    return _validateIframeMessage(wrapperedIframeMessage.data)
  };
  var _validateIframeMessage = function(iframeMessage) {
    try {
      var iframeMessage = JSON.parse(iframeMessage);
      if(iframeMessage.IframeMessage !== true || VALID_TYPES.indexOf(iframeMessage.type) == -1) {
        return false
      }
    }catch(e) {
      return false
    }
    return true
  };
  var registerCallback = function(listenedEvent, callback) {
    if(callback) {
      _listeners[listenedEvent] = callback
    }
  };
  var unRegisterCallback = function(listenedEvent) {
    if(listenedEvent in _listeners) {
      _listeners[listenedEvent] = null
    }
  };
  var sendMessage = function(iframeMessage, iframeId) {
    if(!_connected) {
      return"Not connected"
    }
    return _sendMessage(iframeMessage, iframeId)
  };
  var _sendMessage = function(iframeMessage, iframeId) {
    if(!_validateIframeMessage(iframeMessage)) {
      return"Invalid message"
    }
    switch(_mode) {
      case "EXTERNAL":
        return _sendInternalMessage(iframeMessage, iframeId);
      case "INTERNAL":
        return _sendExternalMessage(iframeMessage);
      default:
        return
    }
  };
  var _sendExternalMessage = function(iframeMessage) {
    window.parent.postMessage(iframeMessage, "*")
  };
  var _sendInternalMessage = function(iframeMessage, iframeId) {
    if(typeof iframeId == "undefined") {
      _broadcastInternalMessage(iframeMessage)
    }else {
      if(typeof iframeId === "string") {
        var iframe = document.getElementById(iframeId);
        _sendMessageToIframe(iframeMessage, iframe)
      }else {
        if(iframeId instanceof Array && iframeId.length > 0) {
          for(var i = 0;i < iframeId.length;i++) {
            if(typeof iframeId[i] == "string") {
              var iframe = document.getElementById(iframeId[i]);
              _sendMessageToIframe(iframeMessage, iframe)
            }
          }
        }
      }
    }
  };
  var _broadcastInternalMessage = function(iframeMessage) {
    var allVEIframes = document.querySelectorAll("iframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      _sendMessageToIframe(iframeMessage, allVEIframes[i])
    }
  };
  var _sendMessageToIframe = function(iframeMessage, iframe) {
    if(iframe && iframe.contentWindow) {
      iframe.contentWindow.postMessage(iframeMessage, "*")
    }
  };
  var _onIframeMessageReceived = function(wrapperedIframeMessage) {
    if(_validateWrapperedIframeMessage(wrapperedIframeMessage)) {
      var iframeMessage = JSON.parse(wrapperedIframeMessage.data);
      if(iframeMessage.destination != _origin && iframeMessage.destination !== "*") {
        return
      }
      if(typeof iframeMessage.destinationId != "undefined" && iframeMessage.destinationId != _originId) {
        return
      }
      if(iframeMessage.origin === _origin && iframeMessage.originId === _originId) {
        return false
      }
      switch(iframeMessage.type) {
        case "PROTOCOL":
          return _processProtocolMessage(iframeMessage);
        case "VE":
          return _processVEMessage(iframeMessage);
        case "WAPP":
          return _processWAPPMessage(iframeMessage);
        default:
          return
      }
    }
  };
  var _generateOriginId = function() {
    var timestamp = (new Date).getTime().toString();
    var random = parseInt(Math.random() * 1E6).toString();
    return parseInt(timestamp.substr(timestamp.length - 7, timestamp.length - 1) + random)
  };
  var _helloAttempts;
  var MAX_HELLO_ATTEMPTS = 40;
  var _helloTimeout;
  var _initHelloExchange = function() {
    registerCallback("stopHelloExchange", function() {
      if(_helloTimeout) {
        clearTimeout(_helloTimeout)
      }
    });
    _helloAttempts = 0;
    _helloTimeout = setInterval(function() {
      _sayHello()
    }, 1250);
    _sayHello()
  };
  var _sayHello = function() {
    var helloMessage = _createProtocolMessage("onIframeMessengerHello");
    _sendMessage(helloMessage);
    _helloAttempts++;
    if(_helloAttempts >= MAX_HELLO_ATTEMPTS && _helloTimeout) {
      clearTimeout(_helloTimeout)
    }
  };
  var _createProtocolMessage = function(protocolMessage, destination, destinationId) {
    var data = {};
    data.message = protocolMessage;
    return _createMessage("PROTOCOL", data, destination, destinationId)
  };
  var _processProtocolMessage = function(protocolMessage) {
    if(protocolMessage.data && protocolMessage.data.message === "onIframeMessengerHello") {
      if(!_connected) {
        _connected = true;
        if(typeof _listeners["stopHelloExchange"] == "function") {
          _listeners["stopHelloExchange"]()
        }
        if(typeof _listeners["onConnect"] == "function") {
          _listeners["onConnect"](protocolMessage.origin)
        }
      }
    }
  };
  var _createVEMessage = function(VEevent, params, origin, destination, destinationId) {
    var data = {};
    data.VEevent = VEevent;
    data.params = params;
    return _createMessage("VE", data, destination, destinationId)
  };
  var _defineVEConstants = function() {
    VISH.Constant = VISH.Constant || {};
    VISH.Constant.Event = VISH.Constant.Event || {};
    VISH.Constant.Event.onSendIframeMessage = "onSendIframeMessage";
    VISH.Constant.Event.onGoToSlide = "onGoToSlide";
    VISH.Constant.Event.onEnterSlide = "onEnterSlide";
    VISH.Constant.Event.onPlayVideo = "onPlayVideo";
    VISH.Constant.Event.onPauseVideo = "onPauseVideo";
    VISH.Constant.Event.onSeekVideo = "onSeekVideo";
    VISH.Constant.Event.onPlayAudio = "onPlayAudio";
    VISH.Constant.Event.onPauseAudio = "onPauseAudio";
    VISH.Constant.Event.onSeekAudio = "onSeekAudio";
    VISH.Constant.Event.onSubslideOpen = "onSubslideOpen";
    VISH.Constant.Event.onSubslideClosed = "onSubslideClosed";
    VISH.Constant.Event.onAnswerQuiz = "onAnswerQuiz";
    VISH.Constant.Event.onSetSlave = "onSetSlave";
    VISH.Constant.Event.allowExitWithoutConfirmation = "allowExitWithoutConfirmation";
    VISH.Constant.Event.exit = "exit";
    VISH.Constant.Event.onSelectedSlides = "onSelectedSlides";
    VISH.Constant.Event.onVEFocusChange = "onVEFocusChange";
    VISH.Constant.Event.onTrackedAction = "onTrackedAction"
  };
  var _afterConnectExternal = function(origin) {
    if(_options) {
      if(_options.preventDefault === true) {
        _sendPreventDefaults(true, origin)
      }
    }
  };
  var _sendPreventDefaults = function(preventDefaults, destination) {
    var preventDefaultVEMessage;
    if(preventDefaults === true) {
      preventDefaultVEMessage = _createProtocolMessage("enablePreventDefault")
    }else {
      preventDefaultVEMessage = _createProtocolMessage("disablePreventDefault")
    }
    sendMessage(preventDefaultVEMessage)
  };
  var _processVEMessage = function(VEMessage) {
    var data = VEMessage.data;
    if(_listeners["onMessage"]) {
      _listeners["onMessage"](JSON.stringify(VEMessage), VEMessage.origin)
    }
    var callback = _listeners[data.VEevent];
    if(!callback) {
      return
    }
    switch(data.VEevent) {
      case VISH.Constant.Event.onGoToSlide:
        if(data.params) {
          callback(data.params.slideNumber, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onPlayVideo:
        if(data.params) {
          callback(data.params.videoId, data.params.currentTime, data.params.slideNumber, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onPauseVideo:
        if(data.params) {
          callback(data.params.videoId, data.params.currentTime, data.params.slideNumber, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onSeekVideo:
        if(data.params) {
          callback(data.params.videoId, data.params.currentTime, data.params.slideNumber, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onSubslideOpen:
        if(data.params) {
          callback(data.params.slideId, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onSubslideClosed:
        if(data.params) {
          callback(data.params.slideId, VEMessage.origin)
        }
        break;
      case VISH.Constant.Event.onVEFocusChange:
        if(data.params) {
          callback(data.params.focus, VEMessage.origin)
        }
        break;
      default:
        _print("VISH.Messenger.Proceesor Error: Unrecognized event: " + data.VEevent);
        break
    }
  };
  var goToSlide = function(slideNumber) {
    var params = {};
    params.slideNumber = slideNumber;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onGoToSlide, params);
    sendMessage(VEMessage)
  };
  var playVideo = function(videoId, currentTime, videoSlideNumber) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onPlayVideo, params);
    sendMessage(VEMessage)
  };
  var pauseVideo = function(videoId, currentTime, videoSlideNumber) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onPauseVideo, params);
    sendMessage(VEMessage)
  };
  var seekVideo = function(videoId, currentTime, videoSlideNumber) {
    var params = {};
    params.videoId = videoId;
    params.currentTime = currentTime;
    params.slideNumber = videoSlideNumber;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onSeekVideo, params);
    sendMessage(VEMessage)
  };
  var openSubslide = function(slideId) {
    var params = {};
    params.slideId = slideId;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onSubslideOpen, params);
    sendMessage(VEMessage)
  };
  var closeSubslide = function(slideId) {
    var params = {};
    params.slideId = slideId;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onSubslideClosed, params);
    sendMessage(VEMessage)
  };
  var setSlave = function(slave, iframeId) {
    var params = {};
    params.slave = slave;
    var VEMessage = _createVEMessage(VISH.Constant.Event.onSetSlave, params);
    sendMessage(VEMessage, iframeId)
  };
  var setMaster = function(master) {
    var params = {};
    var allVEIframes = document.querySelectorAll(".vishEditorIframe");
    for(var i = 0;i < allVEIframes.length;i++) {
      if(allVEIframes[i].id !== master) {
        params.slave = true
      }else {
        params.slave = false
      }
      var iframeId = allVEIframes[i].id;
      var VEMessage = _createVEMessage(VISH.Constant.Event.onSetSlave, params);
      sendMessage(VEMessage, iframeId)
    }
  };
  var allowExitWithoutConfirmation = function() {
    var params = {};
    var VEMessage = _createVEMessage(VISH.Constant.Event.allowExitWithoutConfirmation, params);
    sendMessage(VEMessage)
  };
  var _createWAPPMessage = function(method, params, origin, destination, destinationId) {
    var data = {};
    data.method = method;
    data.params = params;
    return _createMessage("WAPP", data, destination, destinationId)
  };
  var _processWAPPMessage = function(WAPPMessage) {
    var data = WAPPMessage.data;
    if(typeof _wapplisteners[data.method] == "function") {
      _wapplisteners[data.method](data.params);
      _wapplisteners[data.method] = undefined
    }
  };
  var getUser = function(callback) {
    _callWAPPMethod("getUser", {}, callback)
  };
  var getAuthToken = function(callback) {
    _callWAPPMethod("getAuthToken", {}, callback)
  };
  var setScore = function(score, callback) {
    _callWAPPMethod("setScore", score, callback)
  };
  var setProgress = function(progress, callback) {
    _callWAPPMethod("setProgress", progress, callback)
  };
  var setSuccessStatus = function(status, callback) {
    _callWAPPMethod("setSuccessStatus", status, callback)
  };
  var setCompletionStatus = function(status, callback) {
    _callWAPPMethod("setCompletionStatus", status, callback)
  };
  var _callWAPPMethod = function(methodName, params, callback) {
    if(typeof params == "undefined") {
      params = {}
    }
    _wapplisteners[methodName] = callback;
    var WAPPMessage = _createWAPPMessage(methodName, params);
    sendMessage(WAPPMessage)
  };
  _trackerEnabled = false;
  _trackerEventsLoaded = false;
  var enableTracker = function() {
    _trackerEnabled = true;
    _loadTrackerEvents()
  };
  var _loadTrackerEvents = function() {
    if(_trackerEventsLoaded) {
      return
    }
    _trackerEventsLoaded = true;
    $(document).bind("click", function(event) {
      var params = {};
      params["x"] = event.clientX;
      params["y"] = event.clientY;
      if(event.target) {
        if(event.target.tagName) {
          params["tagName"] = event.target.tagName
        }
        if(event.target.id) {
          params["id"] = event.target.id
        }
      }
      notifyTrackerAction("click", params)
    });
    $(document).bind("keydown", function(event) {
      var params = {};
      params["keyCode"] = event.keyCode;
      notifyTrackerAction("keydown", params)
    })
  };
  var notifyTrackerAction = function(action, actionParams) {
    var data = {};
    data.action = action;
    data.params = actionParams;
    var WAPPMessage = _createWAPPMessage("notifyTrackerAction", data);
    sendMessage(WAPPMessage)
  };
  var _print = function(objectToPrint) {
    if(console && console.log) {
      console.log(objectToPrint)
    }
  };
  var isConnected = function() {
    return _connected
  };
  return{init:init, registerCallback:registerCallback, unRegisterCallback:unRegisterCallback, sendMessage:sendMessage, setSlave:setSlave, setMaster:setMaster, allowExitWithoutConfirmation:allowExitWithoutConfirmation, goToSlide:goToSlide, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, openSubslide:openSubslide, closeSubslide:closeSubslide, getUser:getUser, setScore:setScore, setProgress:setProgress, setSuccessStatus:setSuccessStatus, setCompletionStatus:setCompletionStatus, getAuthToken:getAuthToken, 
  enableTracker:enableTracker, notifyTrackerAction:notifyTrackerAction, isConnected:isConnected}
}(VISH);
VISH.IframeMessenger = function(V, undefined) {
  var VALID_TYPES = ["PROTOCOL", "VE", "WAPP"];
  var _initialized = false;
  var _connected = false;
  var _origin = "?";
  var _originId = "?";
  var init = function(config) {
    if(_initialized) {
      return
    }
    _initialized = true;
    try {
      _origin = window.location.href
    }catch(e) {
    }
    _originId = _generateOriginId();
    if(window.addEventListener) {
      window.addEventListener("message", _onIframeMessageReceived, false)
    }else {
      if(window.attachEvent) {
        window.attachEvent("message", _onIframeMessageReceived)
      }
    }
    V.EventsNotifier.registerCallback(V.Constant.Event.onSendIframeMessage, sendIframeMessage)
  };
  var sendIframeMessage = function(iframeMessage) {
    if(_initialized && (_connected && validateIframeMessage(iframeMessage))) {
      _sendMessage(iframeMessage)
    }
  };
  var _sendMessage = function(iframeMessage) {
    var parsedIframeMessage = JSON.parse(iframeMessage);
    switch(parsedIframeMessage.mode) {
      case "EXTERNAL":
        window.parent.postMessage(iframeMessage, "*");
        break;
      case "INTERNAL":
        $("iframe[src='" + parsedIframeMessage.destination + "']").each(function(index, iframe) {
          _sendMessageToIframe(iframeMessage, iframe)
        });
        break;
      default:
        return
    }
  };
  var _sendMessageToIframe = function(iframeMessage, iframe) {
    if(iframe && iframe.contentWindow) {
      iframe.contentWindow.postMessage(iframeMessage, "*")
    }
  };
  var _onIframeMessageReceived = function(wrapperedIframeMessage) {
    if(_validateWrapperedIframeMessage(wrapperedIframeMessage)) {
      var iframeMessage = JSON.parse(wrapperedIframeMessage.data);
      if(iframeMessage.destination != _origin && iframeMessage.destination !== "*") {
        return
      }
      if(typeof iframeMessage.destinationId != "undefined" && iframeMessage.destinationId != _originId) {
        return
      }
      if(iframeMessage.type !== "VE") {
        if(iframeMessage.origin === _origin && iframeMessage.originId === _originId) {
          return false
        }
      }
      switch(iframeMessage.type) {
        case "PROTOCOL":
          return _onProtocolMessage(iframeMessage);
        case "VE":
          var processSelfMessages = V.Status.isPreventDefaultMode();
          if(processSelfMessages === false && (iframeMessage.origin === _origin && iframeMessage.originId === _originId)) {
            return false
          }
          return V.Messenger.VE.processVEMessage(iframeMessage);
        case "WAPP":
          return V.Messenger.WAPP.processWAPPMessage(iframeMessage);
        default:
          return
      }
    }
  };
  function IframeMessage(type, data, destination, destinationId, mode) {
    this.IframeMessage = true;
    this.mode = mode || "EXTERNAL";
    this.type = type || _type;
    this.data = data || {};
    this.origin = _origin;
    this.originId = _originId;
    this.destination = destination || "*";
    if(destinationId) {
      this.destinationId = destinationId
    }
  }
  var createMessage = function(type, data, destination, destinationId, mode) {
    var iframeMessage = new IframeMessage(type, data, destination, destinationId, mode);
    return JSON.stringify(iframeMessage)
  };
  var _validateWrapperedIframeMessage = function(wrapperedIframeMessage) {
    if(typeof wrapperedIframeMessage != "object" || typeof wrapperedIframeMessage.data != "string") {
      return false
    }
    return validateIframeMessage(wrapperedIframeMessage.data)
  };
  var validateIframeMessage = function(iframeMessage) {
    try {
      var iframeMessage = JSON.parse(iframeMessage);
      if(iframeMessage.IframeMessage !== true || VALID_TYPES.indexOf(iframeMessage.type) == -1) {
        return false
      }
    }catch(e) {
      return false
    }
    return true
  };
  var _generateOriginId = function() {
    var timestamp = (new Date).getTime().toString();
    var random = parseInt(Math.random() * 1E6).toString();
    return parseInt(timestamp.substr(timestamp.length - 7, timestamp.length - 1) + random)
  };
  var _onProtocolMessage = function(protocolMessage) {
    if(protocolMessage.data) {
      switch(protocolMessage.data.message) {
        case "onIframeMessengerHello":
          var helloMessage = protocolMessage;
          if(V.Status.isEmbed() && V.Status.getContainerType() === "IFRAME") {
            if(helloMessage.origin != "?") {
              _connected = true;
              if(V.Editing) {
                V.Editor.Object.Webapp.Handler.onWAPPConnected(helloMessage.origin, helloMessage.originId)
              }else {
                V.Object.Webapp.Handler.onWAPPConnected(helloMessage.origin, helloMessage.originId)
              }
              helloMessage.destination = helloMessage.origin;
              helloMessage.destinationId = helloMessage.originId;
              helloMessage.origin = _origin;
              helloMessage.originId = _originId;
              _sendMessage(JSON.stringify(helloMessage))
            }
          }
          break;
        case "enablePreventDefault":
          V.Status.setPreventDefaultMode(true);
          break;
        case "disablePreventDefault":
          V.Status.setPreventDefaultMode(false);
          break;
        default:
          break
      }
    }
  };
  return{init:init, createMessage:createMessage, validateIframeMessage:validateIframeMessage, sendIframeMessage:sendIframeMessage}
}(VISH, jQuery);
VISH.ImagePlayer = function() {
  var reloadGifs = function(slide) {
    var imgs = $(slide).find("img");
    $.each(imgs, function(index, img) {
      var ext = V.Object.getExtensionFromSrc($(img).attr("src"));
      if(ext === "gif") {
        $(img).attr("src", $(img).attr("src"))
      }
    })
  };
  return{reloadGifs:reloadGifs}
}(VISH, jQuery);
VISH.Messenger.VE = function(V, undefined) {
  var createVEMessage = function(VEevent, params, destination, destinationId) {
    var data = {};
    data.VEevent = VEevent;
    data.params = params;
    return V.IframeMessenger.createMessage("VE", data, destination, destinationId)
  };
  var validateVEMessage = function(VEMessage) {
    if(!V.IframeMessenger.validateIframeMessage(VEMessage)) {
      return false
    }
    if(typeof VEMessage.data != "object") {
      return false
    }
    if(typeof VEMessage.data.VEevent != "string") {
      return false
    }
    return true
  };
  var processVEMessage = function(VEMessage) {
    data = VEMessage.data;
    switch(data.VEevent) {
      case V.Constant.Event.onGoToSlide:
        if(data.params && data.params.slideNumber) {
          V.Slides.goToSlide(data.params.slideNumber, false)
        }
        break;
      case V.Constant.Event.onPlayVideo:
        if(data.params && data.params.videoId) {
          if(data.params.slideNumber && V.Slides.getCurrentSlideNumber() != data.params.slideNumber) {
            V.Slides.goToSlide(data.params.slideNumber, false)
          }
          V.Video.playVideo(data.params.videoId, data.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onPauseVideo:
        if(data.params && data.params.videoId) {
          if(data.params.slideNumber && V.Slides.getCurrentSlideNumber() != data.params.slideNumber) {
            V.Slides.goToSlide(data.params.slideNumber, false)
          }
          V.Video.pauseVideo(data.params.videoId, data.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onSeekVideo:
        if(data.params && data.params.videoId) {
          if(data.params.slideNumber && V.Slides.getCurrentSlideNumber() != data.params.slideNumber) {
            V.Slides.goToSlide(data.params.slideNumber, false)
          }
          V.Video.seekVideo(data.params.videoId, data.params.currentTime, false)
        }
        break;
      case V.Constant.Event.onSubslideOpen:
        if(data.params && data.params.slideId) {
          V.Slides.openSubslide(data.params.slideId, false)
        }
        break;
      case V.Constant.Event.onSubslideClosed:
        if(data.params && data.params.slideId) {
          V.Slides.closeSubslide(data.params.slideId, false)
        }
        break;
      case V.Constant.Event.onSetSlave:
        if(data.params && typeof data.params.slave != "undefined") {
          V.Status.setSlaveMode(data.params.slave)
        }
        break;
      case V.Constant.Event.allowExitWithoutConfirmation:
        if(V.Editing) {
          V.Editor.Events.allowExitWithoutConfirmation()
        }
        break;
      case V.Constant.Event.onSelectedSlides:
        break;
      case V.Constant.Event.onVEFocusChange:
        break;
      default:
        V.Debugging.log("V.Messenger.Proceesor Error: Unrecognized event: " + data.VEevent);
        break
    }
  };
  return{createVEMessage:createVEMessage, processVEMessage:processVEMessage, validateVEMessage:validateVEMessage}
}(VISH, jQuery);
VISH.Messenger.WAPP = function(V, undefined) {
  var _createWAPPMessage = function(method, params, destination, destinationId, mode) {
    var data = {};
    data.method = method;
    data.params = params;
    return V.IframeMessenger.createMessage("WAPP", data, destination, destinationId, mode)
  };
  var _createWAPPResponseMessage = function(method, params, WAPPMessage) {
    return _createWAPPMessage(method, params, WAPPMessage.origin, WAPPMessage.originId, WAPPMessage.mode)
  };
  var _validateWAPPMessage = function(VEMessage, params) {
    if(!V.IframeMessenger.validateIframeMessage(VEMessage)) {
      return false
    }
    if(typeof VEMessage.data != "object") {
      return false
    }
    if(typeof VEMessage.data.method != "string") {
      return false
    }
    return true
  };
  var processWAPPMessage = function(WAPPMessage) {
    data = WAPPMessage.data;
    switch(data.method) {
      case "getUser":
        var params = {username:V.User.getName(), logged:V.User.isLogged()};
        V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, params, WAPPMessage));
        break;
      case "setScore":
        var score = data.params;
        V.Object.Webapp.Handler.onSetScore(score, WAPPMessage.origin);
        V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, score, WAPPMessage));
        break;
      case "setProgress":
        var progress = data.params;
        V.Object.Webapp.Handler.onSetProgress(progress, WAPPMessage.origin);
        V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, progress, WAPPMessage));
        break;
      case "setSuccessStatus":
        var status = data.params;
        V.Object.Webapp.Handler.onSetSuccessStatus(status, WAPPMessage.origin);
        V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, status, WAPPMessage));
        break;
      case "setCompletionStatus":
        var status = data.params;
        V.Object.Webapp.Handler.onSetCompletionStatus(status, WAPPMessage.origin);
        V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, status, WAPPMessage));
        break;
      case "getAuthToken":
        V.Object.Webapp.Handler.getAuthToken(function(token) {
          V.IframeMessenger.sendIframeMessage(_createWAPPResponseMessage(data.method, token, WAPPMessage))
        });
        break;
      case "notifyTrackerAction":
        var action = data.params;
        if(typeof action.params != "object") {
          action.params = {}
        }
        action.params["wapp"] = WAPPMessage.origin;
        V.EventsNotifier.notifyEvent(V.Constant.Event.onTrackedAction, action, true);
        break;
      default:
        break
    }
  };
  return{processWAPPMessage:processWAPPMessage}
}(VISH, jQuery);
VISH.Object.GoogleDOC = function(V, $, undefined) {
  var init = function() {
  };
  var generateWrapper = function(url) {
    url = V.Utils.checkUrlProtocol(url);
    return"<iframe src='https://docs.google.com/viewer?url=" + url + "&embedded=true'></iframe>"
  };
  return{init:init, generateWrapper:generateWrapper}
}(VISH, jQuery);
VISH.Object.PDF = function(V, $, undefined) {
  var _pdfSupport = false;
  var init = function() {
    _pdfSupport = V.Status.getDevice().features.pdfReader
  };
  var generateWrapper = function(url) {
    url = V.Utils.checkUrlProtocol(url);
    if(_pdfSupport) {
      return"<iframe src='" + url + "'></iframe>"
    }else {
      return V.Object.GoogleDOC.generateWrapper(url)
    }
  };
  var renderPDFFromJSON = function(pdfJSON, options) {
    if(typeof options != "object" || typeof options.source != "string") {
      return""
    }
    var style = pdfJSON["style"] ? pdfJSON["style"] : "";
    var pdfBody = generateWrapper(options.source);
    var zoomInStyle = pdfJSON["zoomInStyle"] ? pdfJSON["zoomInStyle"] : "";
    var classes = "objectelement";
    if(options.extraClasses) {
      classes = classes + " " + options.extraClasses
    }
    return"<div id='" + pdfJSON["id"] + "' class='" + classes + "' objectStyle='" + style + "' zoomInStyle='" + zoomInStyle + "' objectWrapper=\"" + pdfBody + '"></div>'
  };
  return{init:init, generateWrapper:generateWrapper, renderPDFFromJSON:renderPDFFromJSON}
}(VISH, jQuery);
VISH.Object.Webapp.Handler = function(V, $, undefined) {
  var _WAPP_TOKEN_API_URL;
  var _validOrigins = {};
  var init = function() {
    if(typeof V.Configuration.getConfiguration()["WAPP_TOKEN_API"] == "object") {
      if(typeof V.Configuration.getConfiguration()["WAPP_TOKEN_API"]["rootURL"] == "string") {
        _WAPP_TOKEN_API_URL = V.Utils.checkUrlProtocol(V.Configuration.getConfiguration()["WAPP_TOKEN_API"]["rootURL"])
      }
    }
  };
  var onWAPPConnected = function(origin) {
    var iframe = $("iframe[src='" + origin + "']");
    var wrapper = $(iframe).parents("div.objectelement");
    var settings = $(wrapper).attr("settings");
    if(typeof settings == "string") {
      try {
        settings = JSON.parse(settings);
        if(settings.wappAPI === true) {
          _validOrigins[origin] = settings;
          _validOrigins[origin].wappId = $(iframe).attr("wappid")
        }
      }catch(e) {
      }
    }
  };
  var onSetScore = function(score, origin) {
    if(typeof origin == "undefined" || (typeof _validOrigins[origin] == "undefined" || _validOrigins[origin]["wappScore"] != true)) {
      return false
    }
    var params = {};
    params.objectiveId = _validOrigins[origin].wappId;
    if(typeof score == "number") {
      params.score = score / 100
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onNewObjectiveScore, params, false);
    return true
  };
  var onSetProgress = function(progress, origin) {
    if(typeof origin == "undefined" || (typeof _validOrigins[origin] == "undefined" || _validOrigins[origin]["wappProgress"] != true)) {
      return false
    }
    return true
  };
  var onSetSuccessStatus = function(status, origin) {
    if(typeof origin == "undefined" || (typeof _validOrigins[origin] == "undefined" || _validOrigins[origin]["wappScore"] != true)) {
      return false
    }
    return true
  };
  var onSetCompletionStatus = function(status, origin) {
    if(typeof origin == "undefined" || (typeof _validOrigins[origin] == "undefined" || _validOrigins[origin]["wappProgress"] != true)) {
      return false
    }
    return true
  };
  var getAuthToken = function(callback) {
    _requestAuthToken(function(data) {
      var token = data["auth_token"];
      callback(token)
    })
  };
  var _requestAuthToken = function(successCallback, failCallback) {
    if(typeof _WAPP_TOKEN_API_URL != "string") {
      if(V.Debugging.isDevelopping()) {
        successCallback({auth_token:V.Debugging.getRandomToken(8)});
        return
      }
      return
    }
    var params = {"authenticity_token":V.User.getToken()};
    $.ajax({type:"GET", url:_WAPP_TOKEN_API_URL, data:params, success:function(data) {
      if(typeof successCallback == "function") {
        successCallback(data)
      }
    }, error:function(error) {
      if(typeof failCallback == "function") {
        failCallback(error)
      }
    }})
  };
  return{init:init, onWAPPConnected:onWAPPConnected, onSetScore:onSetScore, onSetProgress:onSetProgress, onSetSuccessStatus:onSetSuccessStatus, onSetCompletionStatus:onSetCompletionStatus, getAuthToken:getAuthToken}
}(VISH, jQuery);
VISH.ObjectPlayer = function(V, $, undefined) {
  var loadObject = function(slide) {
    $.each(slide.children(".objectelement"), function(index, objectWrapper) {
      if($(objectWrapper).hasClass("loadedObject")) {
        return
      }else {
        $(objectWrapper).addClass("loadedObject")
      }
      if($(objectWrapper).hasClass("youtubeelement")) {
        V.Video.Youtube.loadYoutubeObject(objectWrapper);
        return
      }
      if($(objectWrapper).attr("objectWrapper").match("^<iframe") !== null && V.Status.isOnline() === false) {
        $(objectWrapper).html("<img src='" + V.ImagesPath + "/adverts/advert_new_grey_iframe.png'/>");
        return
      }
      var object = $($(objectWrapper).attr("objectWrapper"));
      $(object).attr("style", $(objectWrapper).attr("zoomInStyle"));
      $(objectWrapper).html("<div style='" + $(objectWrapper).attr("objectStyle") + "'>" + V.Utils.getOuterHTML(object) + "</div>");
      adjustDimensionsAfterZoom($($(objectWrapper).children()[0]).children()[0])
    })
  };
  var unloadObject = function(slide) {
    $.each($(slide).children('.objectelement:not(".unloadableObject")'), function(index, objectWrapper) {
      $(objectWrapper).removeClass("loadedObject");
      $(objectWrapper).html("")
    })
  };
  var aftersetupSize = function() {
    if($(".current").hasClass("object")) {
      loadObject($(".current"))
    }
  };
  var adjustDimensionsAfterZoom = function(objectWithZoom) {
    var parent = $(objectWithZoom).parent();
    var parentHeight = $(parent).height();
    var parentWidth = $(parent).width();
    var zoom = V.Utils.getZoomFromStyle($(objectWithZoom).attr("style"));
    var percentHeight = parentHeight / zoom / parentHeight * 100;
    var percentWidth = parentWidth / zoom / parentWidth * 100;
    $(objectWithZoom).height(percentHeight + "%");
    $(objectWithZoom).width(percentWidth + "%")
  };
  return{loadObject:loadObject, unloadObject:unloadObject, aftersetupSize:aftersetupSize, adjustDimensionsAfterZoom:adjustDimensionsAfterZoom}
}(VISH, jQuery);
VISH.Police = function(V, $, undefined) {
  var init = function() {
  };
  var validateObject = function(object, callback) {
    if(!object) {
      return[false, "Object is null or undefined"]
    }
    if(typeof object == "string" && object.trim() == "") {
      return[false, "Object is an empty string"]
    }
    var objectInfo = V.Object.getObjectInfo(object);
    if(!objectInfo) {
      return[false, "Can't get Object info"]
    }
    if(!objectInfo.source || !objectInfo.type) {
      return[false, "Can't recognize object source"]
    }
    if(typeof objectInfo.source == "string") {
      if(objectInfo.source.trim() == "") {
        return[false, "Object source is an empty string"]
      }
    }else {
      if(typeof objectInfo.source == "object") {
        if(objectInfo.source.length < 1) {
          return[false, "Object source is an empty object"]
        }
      }else {
        return[false, "Invalid object source"]
      }
    }
    if(typeof callback == "function") {
      _validateUrl(objectInfo.source, callback)
    }
    return[true, "Validation Ok"]
  };
  function _validateUrl(url, callback) {
    _checkUrl(url, function(status) {
      if(status === 404) {
        callback([false, "HTTP 404: Not found"])
      }else {
        callback([true, "Validation Ok"])
      }
    })
  }
  function _checkUrl(url, cb) {
    jQuery.ajax({url:url, dataType:"text", type:"GET", complete:function(xhr) {
      if(typeof cb === "function") {
        cb.apply(this, [xhr.status])
      }
    }})
  }
  var validateFileUpload = function(fileName) {
    if(!fileName) {
      return[false, "Name is null or undefined"]
    }
    if(fileName.trim() == "") {
      return[false, "Name is an empty string"]
    }
    return[true, "Validation Ok"]
  };
  return{init:init, validateObject:validateObject, validateFileUpload:validateFileUpload}
}(VISH, jQuery);
VISH.Presentation = function(V, undefined) {
  var mySlides = null;
  var init = function(slides, callback) {
    mySlides = slides;
    V.Renderer.init();
    for(var i = 0;i < slides.length;i++) {
      V.Renderer.renderSlide(slides[i])
    }
    if(typeof callback == "function") {
      callback()
    }
  };
  return{init:init}
}(VISH);
VISH.Quiz.API.Development = function(V, $, undefined) {
  var ARS_API_RootURL;
  var getResultsCount = 0;
  var init = function(ARS_API) {
    if(typeof ARS_API == "object" && typeof ARS_API.rootURL == "string") {
      ARS_API_RootURL = V.Utils.checkUrlProtocol(ARS_API.rootURL)
    }
  };
  var startQuizSession = function(quizDOM, quizJSON, successCallback, failCallback) {
    var quizSessionId = Math.ceil(1E4 * (1 + Math.random())).toString();
    var url = ARS_API_RootURL + quizSessionId;
    var quiz_session = {id:quizSessionId, url:url};
    if(typeof successCallback == "function" && typeof failCallback == "function") {
      setTimeout(function() {
        successCallback(quizDOM, quiz_session)
      }, 1E3)
    }
    return
  };
  var closeQuizSession = function(quizSessionId, name, successCallback, failCallback) {
    var data = {"processed":"true"};
    if(typeof successCallback == "function" && typeof failCallback == "function") {
      setTimeout(function() {
        successCallback(data)
      }, 1E3)
    }
    return
  };
  var deleteQuizSession = function(quizSessionId, successCallback, failCallback) {
    var data = {"processed":"true"};
    if(typeof successCallback == "function") {
      setTimeout(function() {
        successCallback(data)
      }, 1E3)
    }
    return
  };
  var getResults = function(quizSessionId, successCallback, failCallback) {
    var mc_data = [{"answer":'[{"choiceId":"1","answer":"true"}]', "created_at":"2013-11-28T13:24:14Z", "id":62, "quiz_session_id":50}, {"answer":'[{"choiceId":"1","answer":"true"}]', "created_at":"2013-11-28T13:24:22Z", "id":63, "quiz_session_id":50}, {"answer":'[{"choiceId":"3","answer":"true"}]', "created_at":"2013-11-28T13:25:13Z", "id":64, "quiz_session_id":50}];
    var mc_one_data = [{"answer":'[{"choiceId":"3","answer":"true"}]', "created_at":"2013-11-26T12:49:34Z", "id":47, "quiz_session_id":31}];
    var mcm_data = [{"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"true"},{"choiceId":"3","answer":"true"}]', "created_at":"2013-11-22T17:51:20Z", "id":37, "quiz_session_id":27}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"true"},{"choiceId":"3","answer":"true"}]', "created_at":"2013-11-22T17:51:29Z", "id":38, "quiz_session_id":27}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"true"}]', "created_at":"2013-11-22T17:51:35Z", 
    "id":39, "quiz_session_id":27}];
    var tf_data = [{"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"false"},{"choiceId":"3","answer":"true"},{"choiceId":"4","answer":"true"}]', "created_at":"2013-05-13T13:10:23Z", "id":30, "quiz_session_id":19}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"false"},{"choiceId":"3","answer":"false"},{"choiceId":"4","answer":"true"}]', "created_at":"2013-05-13T13:10:37Z", "id":31, "quiz_session_id":19}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"true"},{"choiceId":"3","answer":"false"},{"choiceId":"4","answer":"false"}]', 
    "created_at":"2013-05-13T13:10:52Z", "id":32, "quiz_session_id":19}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"false"},{"choiceId":"3","answer":"true"},{"choiceId":"4","answer":"true"}]', "created_at":"2013-05-13T13:11:09Z", "id":33, "quiz_session_id":19}, {"answer":'[{"choiceId":"1","answer":"true"},{"choiceId":"2","answer":"false"},{"choiceId":"3","answer":"true"},{"choiceId":"4","answer":"true"}]', "created_at":"2013-05-13T13:11:41Z", "id":34, "quiz_session_id":19}];
    var s_data = [{"answer":'[{"choiceId":"2","answer":2},{"choiceId":"1","answer":1},{"choiceId":"3","answer":3},{"selfAssessment":{"result":true}}]', "created_at":"2013-11-26T12:49:34Z", "id":47, "quiz_session_id":31}, {"answer":'[{"choiceId":"2","answer":1},{"choiceId":"1","answer":2},{"choiceId":"3","answer":3},{"selfAssessment":{"result":false}}]', "created_at":"2013-11-26T12:49:34Z", "id":48, "quiz_session_id":31}];
    var o_data = [{"answer":'[{"answer":"Lorem ipsum dolor si amet one."}]', "created_at":"2013-11-28T13:24:14Z", "id":62, "quiz_session_id":50}, {"answer":'[{"answer":"Proin in blandit odio. Mauris placerat sollicitudin urna, at malesuada odio rhoncus eget."}]', "created_at":"2013-11-28T13:24:14Z", "id":63, "quiz_session_id":50}, {"answer":'[{"answer":"Aenean imperdiet tortor arcu, at congue sapien aliquam a."}]', "created_at":"2013-11-28T13:24:14Z", "id":64, "quiz_session_id":50}];
    var data;
    if(getResultsCount < 1) {
      data = []
    }else {
      if(getResultsCount < 3) {
        data = mc_data
      }else {
        data = mc_data
      }
    }
    getResultsCount++;
    if(typeof successCallback == "function") {
      setTimeout(function() {
        successCallback(data)
      }, 1E3)
    }
  };
  var sendAnwers = function(answers, quizSessionId, successCallback, failCallback) {
    if(typeof successCallback == "function") {
      setTimeout(function() {
        successCallback()
      }, 1E3)
    }
    return
  };
  return{init:init, startQuizSession:startQuizSession, closeQuizSession:closeQuizSession, deleteQuizSession:deleteQuizSession, getResults:getResults, sendAnwers:sendAnwers}
}(VISH, jQuery);
VISH.Quiz.MC = function(V, $, undefined) {
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
  };
  var render = function(quizJSON, template) {
    var quizId = quizJSON.quizId;
    var container = $("<div id='" + quizId + "' class='quizContainer mcContainer' type='" + V.Constant.QZ_TYPE.MCHOICE + "'></div>");
    var multipleAnswer = false;
    var inputType = "radio";
    if(quizJSON.extras && quizJSON.extras.multipleAnswer === true) {
      multipleAnswer = true;
      inputType = "checkbox";
      $(container).attr("multipleAnswer", true)
    }
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(quizJSON.question.wysiwygValue);
    $(container).append(questionWrapper);
    var optionsWrapper = $("<table cellspacing='0' cellpadding='0' class='mc_options'></table>");
    var quizChoices;
    if(quizJSON.settings && quizJSON.settings.shuffleChoices === true) {
      quizChoices = V.Utils.shuffle(jQuery.extend(true, [], quizJSON.choices))
    }else {
      quizChoices = quizJSON.choices
    }
    var quizChoicesLength = quizChoices.length;
    for(var i = 0;i < quizChoicesLength;i++) {
      var option = quizChoices[i];
      var optionWrapper = $("<tr class='mc_option' choiceId='" + option.id + "'></tr>");
      var optionBox = $("<td><input class='mc_box' type='" + inputType + "' name='mc_option' value='" + i + "'/></td>");
      var optionIndex = $("<td><span class='mc_option_index mc_option_index_viewer'>" + String.fromCharCode(96 + i + 1) + ") </span></td>");
      var optionText = $("<td><div class='mc_option_text mc_option_text_viewer'></div></td>");
      $(optionText).html(option.wysiwygValue);
      $(optionWrapper).append(optionBox);
      $(optionWrapper).append(optionIndex);
      $(optionWrapper).append(optionText);
      $(optionsWrapper).append(optionWrapper)
    }
    $(container).append(optionsWrapper);
    var quizButtons = V.Quiz.renderButtons(quizJSON);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz, options) {
    var afterAnswerAction = typeof options.afterAnswerAction != "undefined" && typeof options.afterAnswerAction == "string" ? options.afterAnswerAction : "disabled";
    var canRetry = typeof options.canRetry != "undefined" && typeof options.canRetry == "boolean" ? options.canRetry : false;
    var answeredQuizCorrectly = false;
    var correctStatements = 0;
    var incorrectStatements = 0;
    var totalCorrectStatements = 0;
    var quizJSON = V.Quiz.getQuiz($(quiz).attr("id"));
    var quizChoices = quizJSON.choices;
    var quizChoicesById = {};
    $(quizChoices).each(function(index, quizChoice) {
      quizChoicesById[quizChoice.id] = quizChoice
    });
    var multipleAnswer = quizJSON.extras && quizJSON.extras.multipleAnswer === true;
    $(quiz).find("tr.mc_option").each(function(index, tr) {
      var choiceId = $(tr).attr("choiceid");
      var choice = quizChoicesById[choiceId];
      if(choice.answer === true) {
        totalCorrectStatements += 1
      }
      var radioBox = $(tr).find("input[name='mc_option']");
      var answerValue = parseInt($(radioBox).attr("value"));
      if($(radioBox).is(":checked")) {
        var trAnswer = $("tr.mc_option").has(radioBox);
        if(choice.answer === true) {
          $(trAnswer).addClass("mc_correct_choice");
          correctStatements += 1
        }else {
          if(choice.answer === false) {
            $(trAnswer).addClass("mc_wrong_choice");
            incorrectStatements += 1
          }
        }
      }
    });
    var answeredQuiz = correctStatements + incorrectStatements > 0;
    answeredQuizCorrectly = correctStatements > 0 && incorrectStatements == 0;
    if(multipleAnswer) {
      totalCorrectStatements = Math.max(1, totalCorrectStatements);
      var quizScore = Math.max(0, correctStatements - incorrectStatements) / totalCorrectStatements * 100
    }else {
      var quizScore = answeredQuizCorrectly == true ? 100 : 0
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onAnswerQuiz, {"id":quizJSON.id, "quizId":quizJSON.quizId, "type":V.Constant.QZ_TYPE.MCHOICE, "correct":answeredQuizCorrectly, "multipleAnswer":multipleAnswer, "score":quizScore}, true);
    var willRetry = canRetry && answeredQuizCorrectly === false;
    if(!willRetry) {
      var trCorrectAnswers = [];
      $(quizChoices).each(function(index, quizChoice) {
        if(quizChoice.answer === true) {
          var trCorrect = $(quiz).find("tr.mc_option[choiceid='" + quizChoice.id + "']");
          trCorrectAnswers.push(trCorrect);
          if(answeredQuiz) {
            $(trCorrect).addClass("mc_correct_choice")
          }
        }
      })
    }
    if(!answeredQuiz) {
      if(!willRetry) {
        $(trCorrectAnswers).each(function(index, trCorrect) {
          $(trCorrect).find("input[name='mc_option']").attr("checked", "checked")
        })
      }
    }
    if(willRetry) {
      _disableQuiz(quiz);
      V.Quiz.retryAnswerButton(quiz)
    }else {
      switch(afterAnswerAction) {
        case "continue":
          V.Quiz.continueAnswerButton(quiz);
          break;
        case "disabled":
        ;
        default:
          disableQuiz(quiz);
          break
      }
    }
  };
  var onRetryQuiz = function(quizDOM) {
    $(quizDOM).find("tr").removeClass("mc_correct_choice");
    $(quizDOM).find("tr").removeClass("mc_wrong_choice");
    $(quizDOM).find("input[name='mc_option']").removeAttr("checked");
    _enableQuiz(quizDOM);
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    $(quiz).find("tr.mc_option").each(function(index, tr) {
      var radioBox = $(tr).find("input[name='mc_option']");
      if($(radioBox).is(":checked")) {
        var choiceId = $(tr).attr("choiceid");
        report.answers.push({choiceId:V.Quiz.getQuizChoiceOriginalId(choiceId).toString(), answer:"true"})
      }
    });
    report.empty = report.answers.length === 0;
    return report
  };
  var disableQuiz = function(quiz) {
    _disableQuiz(quiz);
    V.Quiz.disableAnswerButton(quiz)
  };
  var _disableQuiz = function(quiz) {
    $(quiz).find("input[name='mc_option']").attr("disabled", "disabled")
  };
  var _enableQuiz = function(quiz) {
    $(quiz).find("input[name='mc_option']").removeAttr("disabled")
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
VISH.Quiz.Open = function(V, $, undefined) {
  var hiddenLinkToShowAnswer;
  var currentQuizJSONToShowInFancy;
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
    hiddenLinkToShowAnswer = $('<a href="#openQuizAnswer_fancybox" style="display:none"></a>');
    $(hiddenLinkToShowAnswer).fancybox({"autoDimensions":false, "scrolling":"no", "width":"0%", "height":"0%", "padding":0, "autoScale":true, "onStart":function(data) {
      $("#fancybox-close").css("visibility", "hidden");
      if(typeof currentQuizJSONToShowInFancy == "object") {
        var answerBody = $("#openQuizAnswer_fancybox").find("div.oQA_body");
        $(answerBody).html(currentQuizJSONToShowInFancy.answer.wysiwygValue)
      }
    }, "onComplete":function(data) {
      setTimeout(function() {
        V.ViewerAdapter.updateFancyboxAfterSetupSize();
        $("#fancybox-close").css("visibility", "visible")
      }, 300)
    }, "onClosed":function() {
      currentQuizJSONToShowInFancy = undefined
    }})
  };
  var render = function(quizJSON, template) {
    var quizId = quizJSON.quizId;
    var container = $("<div id='" + quizId + "' class='quizContainer openQContainer' type='" + V.Constant.QZ_TYPE.OPEN + "'></div>");
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(quizJSON.question.wysiwygValue);
    $(container).append(questionWrapper);
    var answerTextArea = $("<textarea class='openQTextArea'></textarea>");
    $(container).append(answerTextArea);
    var quizButtons = V.Quiz.renderButtons(quizJSON);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz, options) {
    var afterAnswerAction = typeof options.afterAnswerAction == "string" ? options.afterAnswerAction : "disabled";
    var canRetry = typeof options.canRetry == "boolean" ? options.canRetry : false;
    var quizJSON = V.Quiz.getQuiz($(quiz).attr("id"));
    var textArea = $(quiz).find("textarea.openQTextArea");
    if(quizJSON.selfA) {
      var quizAnswer = V.Utils.purgeString(quizJSON.answer.value);
      var userAnswer = V.Utils.purgeString($(textArea).val());
      var sA = userAnswer.toLowerCase().replace(/\r\n|\n|\r/g, " ").replace(/\s{2,}/g, " ");
      var sB = quizAnswer.toLowerCase().replace(/\r\n|\n|\r/g, " ").replace(/\s{2,}/g, " ");
      sA = V.Utils.purgeString(sA);
      sB = V.Utils.purgeString(sB);
      var levenshteinDistance = V.Utils.getLevenshteinDistance(sA, sB);
      var answeredQuizCorrectly = false;
      if(levenshteinDistance === 0) {
        $(textArea).addClass("openQ_correct_answer");
        answeredQuizCorrectly = true
      }else {
        $(textArea).addClass("openQ_wrong_answer")
      }
      var quizScore = answeredQuizCorrectly == true ? 100 : 0;
      V.EventsNotifier.notifyEvent(V.Constant.Event.onAnswerQuiz, {"id":quizJSON.id, "quizId":quizJSON.quizId, "type":V.Constant.QZ_TYPE.OPEN, "correct":answeredQuizCorrectly, "score":quizScore}, true);
      var willRetry = canRetry && answeredQuizCorrectly === false;
      if(willRetry) {
        _disableQuiz(quiz);
        V.Quiz.retryAnswerButton(quiz)
      }else {
        if(answeredQuizCorrectly === false) {
          var rawUserAnswer = $(textArea).val();
          $(textArea).val($(textArea).val() + "\n\n" + V.I18n.getTrans("i.ResponseCorrect") + ":" + "\n" + V.Utils.purgeString(quizJSON.answer.value))
        }
        switch(afterAnswerAction) {
          case "continue":
            V.Quiz.continueAnswerButton(quiz);
            break;
          case "disabled":
          ;
          default:
            disableQuiz(quiz);
            break
        }
      }
    }else {
      currentQuizJSONToShowInFancy = quizJSON;
      $(hiddenLinkToShowAnswer).trigger("click");
      switch(afterAnswerAction) {
        case "continue":
          V.Quiz.continueAnswerButton(quiz);
          break;
        case "disabled":
        ;
        default:
          break
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onAnswerQuiz, {"id":quizJSON.id, "quizId":quizJSON.quizId, "type":V.Constant.QZ_TYPE.OPEN}, true)
    }
  };
  var onRetryQuiz = function(quizDOM) {
    var textArea = $(quizDOM).find("textarea.openQTextArea");
    $(textArea).removeClass("openQ_correct_answer");
    $(textArea).removeClass("openQ_wrong_answer");
    _enableQuiz(quizDOM);
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    var textArea = $(quiz).find("textarea.openQTextArea");
    var userAnswer = V.Utils.purgeString($(textArea).val());
    report.answers.push({answer:userAnswer});
    report.empty = report.answers.length === 0;
    return report
  };
  var disableQuiz = function(quiz) {
    _disableQuiz(quiz);
    V.Quiz.disableAnswerButton(quiz)
  };
  var _disableQuiz = function(quiz) {
    var textArea = $(quiz).find("textarea.openQTextArea");
    $(textArea).attr("readonly", "readonly")
  };
  var _enableQuiz = function(quiz) {
    var textArea = $(quiz).find("textarea.openQTextArea");
    $(textArea).removeAttr("readonly");
    $(textArea).text("")
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
VISH.Quiz.Sorting = function(V, $, undefined) {
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
    $("section.slides").find("div.quizContainer[type='sorting'] table.sorting_options tbody").each(function(index, tableTbody) {
      _applySortable(tableTbody)
    })
  };
  var _applySortable = function(tableTbody) {
    $(tableTbody).sortable({cursor:"move", scroll:false, start:function(event, ui) {
    }, stop:function(event, ui) {
      var trOption = ui.item;
      _refreshChoicesIndex(trOption)
    }})
  };
  var _refreshChoicesIndex = function(trOption) {
    var tableTBody = $(trOption).parent();
    $(tableTBody).find("tr").each(function(index, tr) {
      $($(tr).find("td")[0]).html("<span class='mc_option_index sorting_option_index sorting_option_index_viewer'>" + (index + 1) + ") </span>")
    })
  };
  var render = function(quizJSON, template) {
    var quizId = quizJSON.quizId;
    var container = $("<div id='" + quizId + "' class='quizContainer sortingQContainer' type='" + V.Constant.QZ_TYPE.SORTING + "'></div>");
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(quizJSON.question.wysiwygValue);
    $(container).append(questionWrapper);
    var optionsWrapper = $("<table cellspacing='0' cellpadding='0' class='sorting_options'></table>");
    var quizChoices = V.Utils.shuffle(jQuery.extend(true, [], quizJSON.choices));
    var quizChoicesLength = quizChoices.length;
    for(var i = 0;i < quizChoicesLength;i++) {
      var option = quizChoices[i];
      var optionWrapper = $("<tr class='mc_option' choiceId='" + option.id + "'></tr>");
      var optionIndex = $("<td><span class='mc_option_index sorting_option_index sorting_option_index_viewer'>" + (i + 1) + ") </span></td>");
      var optionText = $("<td></td>");
      var optionTextWrapper = $("<div class='sorting_option_text_wrapper_viewer'></div>");
      $(optionTextWrapper).html(option.wysiwygValue);
      $(optionText).append(optionTextWrapper);
      $(optionWrapper).append(optionIndex);
      $(optionWrapper).append(optionText);
      $(optionsWrapper).append(optionWrapper)
    }
    $(container).append(optionsWrapper);
    var quizButtons = V.Quiz.renderButtons(quizJSON);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz, options) {
    var afterAnswerAction = typeof options.afterAnswerAction != "undefined" && typeof options.afterAnswerAction == "string" ? options.afterAnswerAction : "disabled";
    var canRetry = typeof options.canRetry != "undefined" && typeof options.canRetry == "boolean" ? options.canRetry : false;
    var answeredQuiz = true;
    var answeredQuizCorrectly = false;
    var answeredQuizWrong = false;
    var quizJSON = V.Quiz.getQuiz($(quiz).attr("id"));
    var quizChoices = quizJSON.choices;
    var quizChoicesById = {};
    $(quizChoices).each(function(index, quizChoice) {
      quizChoicesById[quizChoice.id] = quizChoice
    });
    $(quiz).find("tr.mc_option").each(function(index, tr) {
      var choiceId = $(tr).attr("choiceid");
      var choice = quizChoicesById[choiceId];
      var answerValue = index + 1;
      if(choice.answer === answerValue) {
        $(tr).addClass("mc_correct_choice");
        answeredQuizCorrectly = true
      }else {
        $(tr).addClass("mc_wrong_choice");
        answeredQuizWrong = true
      }
    });
    answeredQuizCorrectly = answeredQuizCorrectly && !answeredQuizWrong;
    var quizScore = answeredQuizCorrectly == true ? 100 : 0;
    V.EventsNotifier.notifyEvent(V.Constant.Event.onAnswerQuiz, {"id":quizJSON.id, "quizId":quizJSON.quizId, "type":V.Constant.QZ_TYPE.SORTING, "correct":answeredQuizCorrectly, "score":quizScore}, true);
    var willRetry = canRetry && answeredQuizCorrectly === false;
    if(!willRetry) {
      var trCorrectAnswers = [];
      $(quizChoices).each(function(index, quizChoice) {
        var answerValue = index + 1;
        if(quizChoice.answer === answerValue) {
          var trCorrect = $(quiz).find("tr.mc_option[choiceid='" + quizChoice.id + "']");
          trCorrectAnswers.push(trCorrect);
          if(answeredQuiz) {
            $(trCorrect).addClass("mc_correct_choice")
          }
        }
      })
    }
    if(willRetry) {
      _disableQuiz(quiz);
      V.Quiz.retryAnswerButton(quiz)
    }else {
      switch(afterAnswerAction) {
        case "continue":
          V.Quiz.continueAnswerButton(quiz);
          break;
        case "disabled":
        ;
        default:
          disableQuiz(quiz);
          break
      }
    }
  };
  var onRetryQuiz = function(quizDOM) {
    $(quizDOM).find("tr").removeClass("mc_correct_choice");
    $(quizDOM).find("tr").removeClass("mc_wrong_choice");
    _enableQuiz(quizDOM);
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    var quizJSON = V.Quiz.getQuiz($(quiz).attr("id"));
    var quizChoices = quizJSON.choices;
    var quizChoicesById = {};
    $(quizChoices).each(function(index, quizChoice) {
      quizChoicesById[quizChoice.id] = quizChoice
    });
    var answeredQuizCorrectly = false;
    var answeredQuizWrong = false;
    var quizAnswered = false;
    $(quiz).find("tr.mc_option").each(function(index, tr) {
      var choiceId = $(tr).attr("choiceid");
      var choice = quizChoicesById[choiceId];
      var answerValue = index + 1;
      if(choice.answer === answerValue) {
        answeredQuizCorrectly = true
      }else {
        answeredQuizWrong = true
      }
      quizAnswered = true;
      report.answers.push({choiceId:V.Quiz.getQuizChoiceOriginalId(choiceId).toString(), answer:answerValue})
    });
    answeredQuizCorrectly = answeredQuizCorrectly && !answeredQuizWrong;
    if(quizAnswered) {
      report.answers.push({selfAssessment:{result:answeredQuizCorrectly}})
    }
    report.empty = report.answers.length === 0;
    return report
  };
  var disableQuiz = function(quiz) {
    _disableQuiz(quiz);
    V.Quiz.disableAnswerButton(quiz)
  };
  var _disableQuiz = function(quiz) {
    var tableTBody = $(quiz).find("table.sorting_options tbody");
    $(tableTBody).sortable("disable")
  };
  var _enableQuiz = function(quiz) {
    var tableTBody = $(quiz).find("table.sorting_options tbody");
    $(tableTBody).sortable("enable")
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
VISH.Quiz.TF = function(V, $, undefined) {
  var init = function() {
    _loadEvents()
  };
  var _loadEvents = function() {
  };
  var render = function(quizJSON, template) {
    var quizId = quizJSON.quizId;
    var container = $("<div id='" + quizId + "' class='quizContainer mcContainer' type='" + V.Constant.QZ_TYPE.TF + "'></div>");
    var questionWrapper = $("<div class='mc_question_wrapper, mc_question_wrapper_viewer'></div>");
    $(questionWrapper).html(quizJSON.question.wysiwygValue);
    $(container).append(questionWrapper);
    var optionsWrapper = $("<table cellspacing='0' cellpadding='0' class='tf_options'></table>");
    var newTr = $("<tr class='mc_option tf_head'><td><img src='" + V.ImagesPath + "quiz/checkbox_checked.png' class='tfCheckbox_viewer'/></td><td><img src='" + V.ImagesPath + "quiz/checkbox_wrong.png' class='tfCheckbox_viewer'/></td><td></td><td></td></tr>");
    $(optionsWrapper).prepend(newTr);
    var quizChoices;
    if(quizJSON.settings && quizJSON.settings.shuffleChoices === true) {
      quizChoices = V.Utils.shuffle(jQuery.extend(true, [], quizJSON.choices))
    }else {
      quizChoices = quizJSON.choices
    }
    var quizChoicesLength = quizChoices.length;
    for(var i = 0;i < quizChoicesLength;i++) {
      var option = quizChoices[i];
      var optionWrapper = $("<tr class='mc_option' choiceId='" + option.id + "'></tr>");
      var optionBox1 = $("<td><input class='tf_radio' type='radio' name='tf_radio" + i + "' column='true'  /></td>");
      var optionBox2 = $("<td><input class='tf_radio' type='radio' name='tf_radio" + i + "' column='false' /></td>");
      var optionIndex = $("<td><span class='mc_option_index mc_option_index_viewer'>" + String.fromCharCode(96 + i + 1) + ") </span></td>");
      var optionText = $("<td><div class='mc_option_text mc_option_text_viewer'></div></td>");
      $(optionText).html(option.wysiwygValue);
      $(optionWrapper).append(optionBox1);
      $(optionWrapper).append(optionBox2);
      $(optionWrapper).append(optionIndex);
      $(optionWrapper).append(optionText);
      $(optionsWrapper).append(optionWrapper)
    }
    $(container).append(optionsWrapper);
    var quizButtons = V.Quiz.renderButtons(quizJSON);
    $(container).append(quizButtons);
    return V.Utils.getOuterHTML(container)
  };
  var onAnswerQuiz = function(quiz, options) {
    var afterAnswerAction = typeof options.afterAnswerAction != "undefined" && typeof options.afterAnswerAction == "string" ? options.afterAnswerAction : "disabled";
    var canRetry = typeof options.canRetry != "undefined" && typeof options.canRetry == "boolean" ? options.canRetry : false;
    var answeredQuizCorrectly = true;
    var correctStatements = 0;
    var incorrectStatements = 0;
    var quizJSON = V.Quiz.getQuiz($(quiz).attr("id"));
    var quizChoices = quizJSON.choices;
    var quizChoicesById = {};
    $(quizChoices).each(function(index, quizChoice) {
      quizChoicesById[quizChoice.id] = quizChoice
    });
    $(quiz).find("tr.mc_option").not(".tf_head").each(function(index, tr) {
      var trueRadio = $(tr).find("input[type='radio'][column='true']")[0];
      var falseRadio = $(tr).find("input[type='radio'][column='false']")[0];
      var myAnswer;
      if($(trueRadio).is(":checked")) {
        myAnswer = true
      }else {
        if($(falseRadio).is(":checked")) {
          myAnswer = false
        }else {
          myAnswer = undefined
        }
      }
      var choiceId = $(tr).attr("choiceid");
      var choice = quizChoicesById[choiceId];
      var choiceHasAnswer = typeof choice.answer == "boolean";
      if(choiceHasAnswer) {
        var trChoice = $(quiz).find("tr.mc_option").not(".tf_head")[index];
        if(myAnswer === choice.answer) {
          $(trChoice).addClass("mc_correct_choice");
          correctStatements += 1
        }else {
          if(typeof myAnswer != "undefined") {
            answeredQuizCorrectly = false;
            $(trChoice).addClass("mc_wrong_choice");
            incorrectStatements += 1
          }else {
            answeredQuizCorrectly = false;
            if(!canRetry) {
              if(choice.answer === true) {
                $(trueRadio).attr("checked", true)
              }else {
                if(choice.answer === false) {
                  $(falseRadio).attr("checked", true)
                }
              }
            }
            incorrectStatements += 1
          }
        }
      }
    });
    var totalStatements = correctStatements + incorrectStatements;
    var quizScore;
    if(totalStatements > 0) {
      quizScore = correctStatements / totalStatements * 100
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onAnswerQuiz, {"id":quizJSON.id, "quizId":quizJSON.quizId, "type":V.Constant.QZ_TYPE.TF, "correct":answeredQuizCorrectly, "correctStatements":correctStatements, "incorrectStatements":incorrectStatements, "score":quizScore}, true);
    var willRetry = canRetry && answeredQuizCorrectly === false;
    if(willRetry) {
      _disableQuiz(quiz);
      V.Quiz.retryAnswerButton(quiz)
    }else {
      switch(afterAnswerAction) {
        case "continue":
          V.Quiz.continueAnswerButton(quiz);
          break;
        case "disabled":
        ;
        default:
          disableQuiz(quiz);
          break
      }
    }
  };
  var onRetryQuiz = function(quizDOM) {
    $(quizDOM).find("tr").removeClass("mc_correct_choice");
    $(quizDOM).find("tr").removeClass("mc_wrong_choice");
    $(quizDOM).find("input[type='radio']").removeAttr("checked");
    _enableQuiz(quizDOM);
    V.Quiz.enableAnswerButton(quizDOM)
  };
  var getReport = function(quiz) {
    var report = {};
    report.answers = [];
    report.empty = true;
    $(quiz).find("tr.mc_option").not(".tf_head").each(function(index, tr) {
      var trueRadio = $(tr).find("input[type='radio'][column='true']")[0];
      var falseRadio = $(tr).find("input[type='radio'][column='false']")[0];
      var choiceId = $(tr).attr("choiceid");
      var originalChoiceId = V.Quiz.getQuizChoiceOriginalId(choiceId);
      if($(trueRadio).is(":checked")) {
        report.answers.push({choiceId:originalChoiceId.toString(), answer:"true"});
        report.empty = false
      }else {
        if($(falseRadio).is(":checked")) {
          report.answers.push({choiceId:originalChoiceId.toString(), answer:"false"});
          report.empty = false
        }else {
          report.answers.push({choiceId:originalChoiceId.toString(), answer:"none"})
        }
      }
    });
    return report
  };
  var disableQuiz = function(quiz) {
    _disableQuiz(quiz);
    V.Quiz.disableAnswerButton(quiz)
  };
  var _disableQuiz = function(quiz) {
    $(quiz).find("input[type='radio']").attr("disabled", "disabled")
  };
  var _enableQuiz = function(quiz) {
    $(quiz).find("input[type='radio']").removeAttr("disabled")
  };
  return{init:init, render:render, onAnswerQuiz:onAnswerQuiz, onRetryQuiz:onRetryQuiz, getReport:getReport, disableQuiz:disableQuiz}
}(VISH, jQuery);
var VISH = VISH || {};
VISH.Constant = VISH.Constant || {};
VISH.Constant.QZ_TYPE = VISH.Constant.QZ_TYPE || {};
VISH.Constant.QZ_TYPE.OPEN = "openAnswer";
VISH.Constant.QZ_TYPE.MCHOICE = "multiplechoice";
VISH.Constant.QZ_TYPE.TF = "truefalse";
VISH.Constant.QZ_TYPE.SORTING = "sorting";
VISH.QuizCharts = function(V, $, undefined) {
  var pieBackgroundColor = ["#F38630", "#E0E4CC", "#69D2E7", "#FFF82A", "#FF0FB4", "#2A31FF", "#FF6075", "#00D043"];
  var pieLetterColor = ["#000"];
  var i18n = {"es":{"i.T":"V", "i.F":"F", "i.Correct":"Correctas", "i.Incorrect":"Incorrectas", "i.Responses":"Respuestas", "i.WaitingResponses":"Esperando respuestas..."}, "en":{"i.T":"T", "i.F":"F", "i.Correct":"Correct", "i.Incorrect":"Incorrect", "i.Responses":"Responses", "i.WaitingResponses":"Waiting for responses..."}};
  var DEFAULT_LANGUAGE = "en";
  var language;
  var translations;
  var init = function(lang) {
    if(_isValidLocale(lang)) {
      language = lang
    }else {
      var browserLang = navigator.language || navigator.userLanguage;
      if(_isValidLocale(browserLang)) {
        language = browserLang
      }else {
        language = DEFAULT_LANGUAGE
      }
    }
    translations = i18n[language];
    _insertCss("div.openQuizAnswersListWrapper{ overflow: auto; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; padding: 15px;} ul.openQuizAnswersList{ padding: 0px; list-style: none; } ul.openQuizAnswersList li { font-family: Arial, Helvetica, sans-serif; position: relative; font-style: italic; border-bottom: 1px solid #D7EEFF; padding: 3% 6% 2% 6%; font-size: 1.2rem; } ul.openQuizAnswersList li:first-child { padding-left: 10%; text-align: left; color: #838383; font-weight: bold; border-bottom: 1px solid #D8DAFF; padding-top: 0%; border-bottom: 1px solid #AFAFAF; font-style: normal; padding-bottom: 20px; font-size: 1.7rem; } ul.openQuizAnswersList li:last-child { -webkit-border-bottom-left-radius: 15px; -webkit-border-bottom-right-radius: 15px; -moz-border-radius-bottomleft: 15px; -moz-border-radius-bottomright: 15px; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px; }");
    _insertCss("div.openQuizAnswerLeft{position: absolute; width: 5%; height: 70%; top: 15%; left: 3%; background-image: url('" + (V.ImagesPath || "") + "vicons/userAnswer.png'); background-position: center; background-size: contain; background-repeat: no-repeat;} div.openQuizAnswerRight{ margin-left: 5%; };")
  };
  var _isValidLocale = function(locale) {
    return typeof locale == "string" && ["en", "es"].indexOf(locale) != -1
  };
  var _getTrans = function(s, params) {
    if(typeof translations[s] == "string") {
      return _getTransWithParams(translations[s], params)
    }
    return _getTransWithParams(i18n[DEFAULT_LANGUAGE][s], params)
  };
  var _getTransWithParams = function(trans, params) {
    if(typeof params != "object") {
      return trans
    }
    for(var key in params) {
      var stringToReplace = "#{" + key + "}";
      if(trans.indexOf(stringToReplace) != -1) {
        trans = trans.replaceAll(stringToReplace, params[key])
      }
    }
    return trans
  };
  var drawQuizChart = function(canvas, quizJSON, results, options) {
    var quizParams = _getQuizParams(quizJSON);
    var answersList = _getAnswers(results);
    switch(quizParams.quizType) {
      case V.Constant.QZ_TYPE.OPEN:
        _drawOpenEndedQuizAnswers(canvas, quizParams, answersList, options);
        break;
      case V.Constant.QZ_TYPE.MCHOICE:
        if(quizParams.extras.multipleAnswer == true) {
          _drawMcChoiceMAnswerQuizChart(canvas, quizParams, answersList, options)
        }else {
          _drawMcChoiceQuizChart(canvas, quizParams, answersList, options)
        }
        break;
      case V.Constant.QZ_TYPE.TF:
        _drawTFQuizChart(canvas, quizParams, answersList, options);
        break;
      case V.Constant.QZ_TYPE.SORTING:
        _drawSortingQuizChart(canvas, quizParams, answersList, options);
        break;
      default:
        return null;
        break
    }
  };
  var _drawMcChoiceQuizChart = function(canvas, quizParams, answersList, options) {
    var pieFragments = {};
    var data = [];
    var pBCL = pieBackgroundColor.length;
    var pLCL = pieLetterColor.length;
    var choicesQuantity = quizParams.choices.length;
    for(var i = 0;i < choicesQuantity;i++) {
      var choiceId = quizParams.choices[i].id;
      pieFragments[choiceId] = {};
      pieFragments[choiceId].value = 0;
      pieFragments[choiceId].label = String.fromCharCode(96 + i + 1);
      pieFragments[choiceId].color = pieBackgroundColor[i % pBCL];
      pieFragments[choiceId].labelColor = pieLetterColor[i % pLCL];
      pieFragments[choiceId].labelFontSize = "16";
      pieFragments[choiceId].tooltipLabel = _purgeString(quizParams.choices[i].value)
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var choiceId = answer.choiceId;
        if(answer.answer === "true" && pieFragments[choiceId]) {
          pieFragments[choiceId].value++
        }
      }
    }
    for(var l = 0;l < choicesQuantity;l++) {
      var choiceId = quizParams.choices[l].id;
      data.push(pieFragments[choiceId])
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var chartOptions = {showTooltips:true, animation:false};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Pie(data, chartOptions);
    if(options && (options.animation != true && typeof options.callback == "function")) {
      options.callback()
    }
  };
  var _drawMcChoiceMAnswerQuizChart = function(canvas, quizParams, answersList, options) {
    var labels = {};
    var tooltipLabels = {};
    var dataValues = {};
    var maxValue = 0;
    var scaleSteps = 10;
    var choicesQuantity = quizParams.choices.length;
    for(var i = 0;i < choicesQuantity;i++) {
      var choiceId = quizParams.choices[i].id;
      labels[choiceId] = String.fromCharCode(96 + i + 1);
      tooltipLabels[choiceId] = _purgeString(quizParams.choices[i].value);
      dataValues[choiceId] = 0
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var choiceId = answer.choiceId;
        if(answer.answer === "true") {
          dataValues[choiceId]++
        }
      }
    }
    for(var l = 0;l < choicesQuantity;l++) {
      var choiceId = quizParams.choices[l].id;
      if(dataValues[choiceId] > maxValue) {
        maxValue = dataValues[choiceId]
      }
    }
    if(maxValue < 10) {
      scaleSteps = Math.max(1, maxValue)
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var data = {labels:$.map(labels, function(v) {
      return v
    }), tooltipLabels:$.map(tooltipLabels, function(v) {
      return v
    }), datasets:[{fillColor:"#E2FFE3", strokeColor:"rgba(220,220,220,1)", data:$.map(dataValues, function(v) {
      return v
    })}]};
    var chartOptions = {showTooltips:true, animation:false, scaleOverride:true, scaleStepWidth:Math.max(1, Math.ceil(maxValue / 10)), scaleSteps:scaleSteps};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Bar(data, chartOptions);
    if(options && (options.animation != true && typeof options.callback == "function")) {
      options.callback()
    }
  };
  var _drawTFQuizChart = function(canvas, quizParams, answersList, options) {
    var labels = {};
    var tooltipLabels = {};
    var dataTrue = {};
    var dataFalse = {};
    var maxValue = 0;
    var scaleSteps = 10;
    var choicesQuantity = quizParams.choices.length;
    for(var i = 0;i < choicesQuantity;i++) {
      var choiceId = quizParams.choices[i].id;
      labels[choiceId] = _getTrans("i.T") + "       " + String.fromCharCode(96 + i + 1) + "       " + _getTrans("i.F");
      tooltipLabels[choiceId] = _purgeString(quizParams.choices[i].value);
      dataTrue[choiceId] = 0;
      dataFalse[choiceId] = 0
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var choiceId = answer.choiceId;
        if(answer.answer === "true") {
          dataTrue[choiceId]++
        }else {
          dataFalse[choiceId]++
        }
      }
    }
    for(var l = 0;l < choicesQuantity;l++) {
      var choiceId = quizParams.choices[l].id;
      if(dataTrue[choiceId] > maxValue) {
        maxValue = dataTrue[choiceId]
      }
      if(dataFalse[choiceId] > maxValue) {
        maxValue = dataFalse[choiceId]
      }
    }
    if(maxValue < 10) {
      scaleSteps = Math.max(1, maxValue)
    }
    var ctx = $(canvas).get(0).getContext("2d");
    var data = {labels:$.map(labels, function(v) {
      return v
    }), tooltipLabels:$.map(tooltipLabels, function(v) {
      return v
    }), datasets:[{fillColor:"#E2FFE3", strokeColor:"rgba(220,220,220,1)", data:$.map(dataTrue, function(v) {
      return v
    })}, {fillColor:"#FFE2E2", strokeColor:"rgba(220,220,220,1)", data:$.map(dataFalse, function(v) {
      return v
    })}]};
    var chartOptions = {showTooltips:true, animation:false, scaleOverride:true, scaleStepWidth:Math.max(1, Math.ceil(maxValue / 10)), scaleSteps:scaleSteps};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Bar(data, chartOptions);
    if(options && (options.animation != true && typeof options.callback == "function")) {
      options.callback()
    }
  };
  var _drawSortingQuizChart = function(canvas, quizParams, answersList, options) {
    var pieFragments = {};
    var data = [];
    var pBCL = pieBackgroundColor.length;
    var pLCL = pieLetterColor.length;
    for(var i = 0;i < 2;i++) {
      var fragmentId = i === 0 ? "true" : "false";
      pieFragments[fragmentId] = {};
      pieFragments[fragmentId].value = 0;
      pieFragments[fragmentId].label = i === 0 ? _getTrans("i.Correct") : _getTrans("i.Incorrect");
      pieFragments[fragmentId].color = pieBackgroundColor[i % pBCL];
      pieFragments[fragmentId].labelColor = pieLetterColor[i % pLCL];
      pieFragments[fragmentId].labelFontSize = "16";
      pieFragments[fragmentId].tooltipLabel = i === 0 ? _getTrans("i.Correct") : _getTrans("i.Incorrect")
    }
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        if(answer.selfAssessment && typeof answer.selfAssessment.result == "boolean") {
          if(answer.selfAssessment.result === true) {
            pieFragments["true"].value++
          }else {
            pieFragments["false"].value++
          }
        }
      }
    }
    data.push(pieFragments["true"]);
    data.push(pieFragments["false"]);
    var ctx = $(canvas).get(0).getContext("2d");
    var chartOptions = {showTooltips:true, animation:false};
    if(options && options.animation === true) {
      chartOptions.animation = true;
      chartOptions.onAnimationComplete = function() {
        if(typeof options.callback == "function") {
          options.callback()
        }
      }
    }
    var myNewChart = (new Chart(ctx)).Pie(data, chartOptions);
    if(options && (options.animation != true && typeof options.callback == "function")) {
      options.callback()
    }
  };
  var _drawOpenEndedQuizAnswers = function(canvas, quizParams, answersList, options) {
    var canvasWrapper = $(canvas).parent();
    var container = $(canvasWrapper).find("div.openQuizAnswersListWrapper");
    if($(container).length === 0) {
      var canvasWidth = $(canvas).width();
      var canvasHeight = $(canvas).height();
      if(canvasWidth === 0) {
        canvasWidth = $(canvas).attr("width")
      }
      if(canvasHeight === 0) {
        canvasHeight = $(canvas).attr("height")
      }
      container = $("<div class='openQuizAnswersListWrapper' style='width:" + canvasWidth + "px; height:" + canvasHeight + "px; display: block;'></div>");
      $(container).insertBefore(canvas)
    }
    $(canvas).hide();
    $(container).html("");
    $(container).append("<ul class='openQuizAnswersList'></ul>");
    var answersListDOM = $(container).find("ul.openQuizAnswersList");
    var alL = answersList.length;
    for(var j = 0;j < alL;j++) {
      var answers = answersList[j];
      var aL = answers.length;
      for(var k = 0;k < aL;k++) {
        var answer = answers[k];
        var userAnswer = answer.answer;
        $(answersListDOM).append("<li><div class='openQuizAnswerLeft'></div><div class='openQuizAnswerRight'>" + userAnswer + "</div></li>")
      }
    }
    if($(answersListDOM).children().length === 0) {
      $(answersListDOM).append("<li>" + _getTrans("i.WaitingResponses") + "</li>")
    }else {
      $(answersListDOM).prepend("<li>" + _getTrans("i.Responses") + "</li>")
    }
    if(typeof options.callback == "function") {
      options.callback()
    }
  };
  var _getAnswers = function(results) {
    var answers = [];
    var rL = results.length;
    for(var i = 0;i < rL;i++) {
      answers.push(JSON.parse(results[i].answer))
    }
    return answers
  };
  var _getQuizParams = function(quiz) {
    var params = {};
    params.extras = {};
    try {
      var quizEls = quiz["slides"][0]["elements"];
      var quizElsL = quizEls.length;
      for(var i = 0;i < quizElsL;i++) {
        if(quizEls[i]["type"] === "quiz") {
          var quizEl = quizEls[i];
          params.quizType = quizEl["quiztype"];
          if(params.quizType == V.Constant.QZ_TYPE.MCHOICE) {
            if(quizEl.extras && quizEl.extras.multipleAnswer == true) {
              params.extras.multipleAnswer = true
            }
          }
          params.choices = quizEl["choices"];
          params.nAnswers = params.choices.length
        }
      }
    }catch(e) {
    }
    return params
  };
  var _purgeString = function(str) {
    if(typeof str != "string") {
      return str
    }
    str = str.replace(/\u00e2\u20ac\u2039/g, "");
    return str.replace(/\u00c2/g, "")
  };
  var _insertCss = function(code) {
    var style = document.createElement("style");
    style.type = "text/css";
    if(style.styleSheet) {
      style.styleSheet.cssText = code
    }else {
      style.innerHTML = code
    }
    document.getElementsByTagName("head")[0].appendChild(style)
  };
  return{init:init, drawQuizChart:drawQuizChart}
}(VISH, jQuery);
VISH.Recommendations = function(V, $, undefined) {
  var _enabled;
  var _requesting;
  var _generated;
  var _isRecVisible;
  var _isEvalVisible;
  var _hasParentEvaluateFunction;
  var _showFancyboxTimer;
  var _recommendationAPIUrl;
  var _userId;
  var _presEnvironment;
  var _presId;
  var _searchTerms;
  var _RSTrackingData;
  var init = function(options) {
    _enabled = false;
    _isRecVisible = false;
    _requesting = false;
    _generated = false;
    var options = V.Utils.getOptions();
    if(options && (!options.preview && (typeof options["configuration"]["recommendationsAPI"] != "undefined" && typeof options["configuration"]["recommendationsAPI"]["rootURL"] == "string"))) {
      _recommendationAPIUrl = options["configuration"]["recommendationsAPI"]["rootURL"];
      _recommendationAPIUrl = V.Utils.checkUrlProtocol(_recommendationAPIUrl);
      _enabled = true
    }else {
      return
    }
    _userId = V.User.getId();
    var presentation = V.Viewer.getCurrentPresentation();
    if(presentation["vishMetadata"] && presentation["vishMetadata"]["id"]) {
      _presEnvironment = presentation["vishMetadata"].name;
      _presId = presentation["vishMetadata"]["id"]
    }
    _getHasParentEvaluateFunction();
    _searchTerms = getCurrentSearchTerms();
    $("#fancyRec").fancybox({"type":"inline", "autoDimensions":false, "scrolling":"no", "autoScale":false, "width":"100%", "height":"100%", "padding":0, "overlayOpacity":0, "center":false, "onStart":function() {
      $("#fancybox-outer").css("display", "none")
    }, "onComplete":function(data) {
      $("#fancybox-outer").css("background", "rgba(0,0,0,.7)");
      $("#fancybox-wrap").css("margin-top", "0px");
      V.Slides.triggerLeaveEvent(V.Slides.getCurrentSlideNumber());
      _isRecVisible = true;
      V.ViewerAdapter.updateFancyboxAfterSetupSize();
      $("#fancybox-outer").css("display", "block");
      V.ViewerAdapter.decideIfPageSwitcher()
    }, "onClosed":function(data) {
      V.EventsNotifier.notifyEvent(V.Constant.Event.onHideRecommendations, {}, true);
      $("#fancybox-outer").css("background", "white");
      $("#fancybox-wrap").css("margin-top", "-14px");
      V.Slides.triggerEnterEvent(V.Slides.getCurrentSlideNumber());
      _isRecVisible = false;
      V.ViewerAdapter.decideIfPageSwitcher()
    }});
    $("#fancyEvaluations").fancybox({"type":"inline", "autoDimensions":false, "scrolling":"no", "autoScale":false, "width":"100%", "height":"100%", "padding":0, "overlayOpacity":0, "center":false, "onStart":function() {
      $("#fancybox-outer").css("display", "none")
    }, "onComplete":function(data) {
      $("#fancybox-outer").css("background", "rgba(0,0,0,.7)");
      $("#fancybox-wrap").css("margin-top", "0px");
      _isRecVisible = true;
      _isEvalVisible = true;
      V.ViewerAdapter.updateFancyboxAfterSetupSize();
      $("#fancybox-outer").css("display", "block");
      V.ViewerAdapter.decideIfPageSwitcher();
      var loepSettings = _getLOEPSettings();
      if(typeof loepSettings == "object") {
        loepSettings.language = V.Utils.getOptions()["lang"];
        loepSettings.containerDOM = $("#fancy_evaluations");
        loepSettings.loadCallback = function() {
        };
        loepSettings.submitCallback = function() {
          $.fancybox.close()
        };
        loepSettings.errorCallback = function(errorMsg) {
          hideEvaluations();
          $.fancybox.close()
        };
        loepSettings.debug = V.Debugging.isDevelopping();
        new LOEP.IframeAPI.instance(loepSettings)
      }
    }, "onClosed":function(data) {
      $("#fancy_evaluations").html("");
      $("#fancybox-outer").css("background", "white");
      $("#fancybox-wrap").css("margin-top", "-14px");
      V.Slides.triggerEnterEvent(V.Slides.getCurrentSlideNumber());
      _isEvalVisible = false;
      _isRecVisible = false;
      V.ViewerAdapter.decideIfPageSwitcher()
    }})
  };
  var canShowRecommendations = function() {
    return true
  };
  var canShowEvaluateButton = function() {
    var _showEvaluateButton = _hasLOEPSettings() || _getHasParentEvaluateFunction();
    _showEvaluateButton = _showEvaluateButton && V.Status.getDevice().desktop;
    return _showEvaluateButton
  };
  var checkForRecommendations = function() {
    if(!_enabled) {
      return
    }
    var slidesQuantity = V.Slides.getSlidesQuantity();
    var cSlideNumber = V.Slides.getCurrentSlideNumber();
    if(cSlideNumber > slidesQuantity - 3) {
      if(!_generated) {
        _requestRecommendations()
      }
    }
  };
  var _requestRecommendations = function() {
    if(_enabled && (typeof _recommendationAPIUrl != "undefined" && (!_generated && _requesting != true))) {
      _requesting = true;
      var params = {};
      params["quantity"] = 6;
      if(_searchTerms) {
        params["q"] = _searchTerms
      }
      if(typeof _userId != "undefined") {
        params["user_id"] = _userId
      }
      if(typeof _presId != "undefined") {
        params["presentation_id"] = _presId
      }
      params["user_environment"] = V.Status.getEnvironmentName();
      params["presentation_environment"] = _presEnvironment;
      $.ajax({type:"GET", url:_recommendationAPIUrl, data:params, success:function(data) {
        _fillFancyboxWithData(data)
      }, error:function(error) {
        _enabled = false;
        _requesting = false
      }})
    }
  };
  var _fillFancyboxWithData = function(data) {
    if(!data || data.length === 0) {
      _enabled = false;
      _requesting = false;
      return
    }
    _RSTrackingData = data;
    var applyTargetBlank = V.Status.isExternalSite();
    var ex;
    var result = "";
    for(var i = data.length - 1;i >= 0;i--) {
      ex = data[i];
      if(applyTargetBlank) {
        result += '<a target="_blank" class="recommendedItemLinkBlank" href="' + ex.url + '" ex_id="' + ex.id + '">'
      }
      result += '<div class="rec-excursion" id="recom-' + ex.id + '" ex_id="' + ex.id + '"number="' + i + '">' + '<ul class="rec-thumbnail">' + '<li class="rec-img-excursion">' + '<img src="' + ex.image + '">' + "</li>" + '<li class="rec-info-excursion">' + '<div class="rec-title-excursion">' + ex.title + "</div>" + '<div class="rec-by">' + V.I18n.getTrans("i.by") + ' <span class="rec-name">' + ex.author + "</span></div>" + '<span class="rec-visits">' + ex.views + '</span> <span class="rec-views">' + 
      V.I18n.getTrans("i.exviews") + "</span>" + '<div class="rec-likes"><span class="rec-likes-number">' + ex.favourites + '</span><img class="rec-menu_icon" src="' + V.ImagesPath + 'vicons/star-on10.png"></div>' + "</li>" + "</ul>" + "</div>";
      if(applyTargetBlank) {
        result += "</a>"
      }
    }
    $("#fancy_recommendations .rec-grid").html(result);
    aftersetupSize();
    _generated = true;
    _requesting = false;
    if(!applyTargetBlank) {
      for(var i = data.length - 1;i >= 0;i--) {
        $("#recom-" + data[i].id).click(function(my_event) {
          V.EventsNotifier.notifyEvent(V.Constant.Event.onAcceptRecommendation, {"id":$(this).attr("ex_id")}, true);
          V.Utils.sendParentToURL(data[$(my_event.target).closest(".rec-excursion").attr("number")].url)
        })
      }
    }
  };
  var showFancybox = function() {
    if(_enabled == false) {
      return
    }
    if(V.Editing) {
      return
    }
    if(V.Viewer.getPresentationType() != V.Constant.PRESENTATION) {
      return
    }
    if(V.Utils.getOptions() && V.Utils.getOptions().preview) {
      return
    }
    if(isRecVisible()) {
      return
    }
    if(!V.Slides.isCurrentLastSlide()) {
      return
    }
    if(!_generated) {
      if(!_requesting) {
        _requestRecommendations()
      }
      if(typeof _showFancyboxTimer == "undefined") {
        _showFancyboxTimer = setTimeout(function() {
          clearTimeout(_showFancyboxTimer);
          _showFancyboxTimer = undefined;
          showFancybox()
        }, 300)
      }
      return
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onShowRecommendations, {}, true);
    $("#fancyRec").trigger("click")
  };
  var hideFancybox = function() {
    V.EventsNotifier.notifyEvent(V.Constant.Event.onHideRecommendations, {}, true);
    $.fancybox.close()
  };
  var isRecVisible = function() {
    return _isRecVisible
  };
  var isEnabled = function() {
    return _enabled
  };
  var aftersetupSize = function(increase) {
    var items = $(".rec-excursion");
    if(items.length < 1) {
      return
    }
    increase = typeof increase == "number" ? increase : V.ViewerAdapter.getLastIncrease()[0];
    if(increase > 0.82) {
      $(items).css("width", "44%")
    }else {
      if(increase > 0.36) {
        $(items).css("width", "40%")
      }else {
        $(items).css("width", "36%")
      }
    }
  };
  var getCurrentSearchTerms = function() {
    return getSearchTerms(V.Viewer.getCurrentPresentation())
  };
  var getSearchTerms = function(pJSON) {
    var searchTerms = [];
    if(typeof pJSON["tags"] != "undefined") {
      $(pJSON["tags"]).each(function(index, tag) {
        searchTerms.push(tag)
      })
    }
    if(typeof pJSON["subject"] != "undefined") {
      $(pJSON["subject"]).each(function(index, tag) {
        searchTerms.push(tag)
      })
    }
    if(typeof pJSON["title"] != "undefined") {
      searchTerms.push(pJSON["title"])
    }
    return searchTerms.join(",")
  };
  var getData = function() {
    return _RSTrackingData
  };
  var onClickEvaluateButton = function() {
    V.EventsNotifier.notifyEvent(V.Constant.Event.onEvaluate, {}, true);
    try {
      if(_getHasParentEvaluateFunction()) {
        V.FullScreen.exitFromNativeFullScreen();
        window.parent.triggerEvaluation();
        return
      }
    }catch(e) {
    }
    if(_hasLOEPSettings()) {
      _showEvaluationsFancybox()
    }else {
      window.alert("Evaluate!")
    }
  };
  var _getHasParentEvaluateFunction = function() {
    if(typeof _hasParentEvaluateFunction == "boolean") {
      return _hasParentEvaluateFunction
    }
    try {
      _hasParentEvaluateFunction = V.Status.isExternalDomain() === false && (V.Status.isEmbed() && typeof window.parent.triggerEvaluation == "function")
    }catch(e) {
      _hasParentEvaluateFunction = false
    }
    return _hasParentEvaluateFunction
  };
  var _hasLOEPSettings = function() {
    return typeof _getLOEPSettings() == "object"
  };
  var _getLOEPSettings = function() {
    try {
      var confLOEPSettings = V.Utils.getOptions()["configuration"]["loepSettings"];
      confLOEPSettings.domain = V.Utils.checkUrlProtocol(confLOEPSettings.domain);
      confLOEPSettings.tokenURL = V.Utils.checkUrlProtocol(confLOEPSettings.tokenURL);
      return confLOEPSettings
    }catch(e) {
      return undefined
    }
  };
  var _showEvaluationsFancybox = function() {
    $("#fancyEvaluations").trigger("click")
  };
  var showEvaluations = function() {
    $(".rec-first-row").show()
  };
  var hideEvaluations = function() {
    $(".rec-first-row").hide();
    $(".rec-second-row").css("margin-top", "10%")
  };
  return{init:init, canShowRecommendations:canShowRecommendations, canShowEvaluateButton:canShowEvaluateButton, checkForRecommendations:checkForRecommendations, showFancybox:showFancybox, hideFancybox:hideFancybox, isRecVisible:isRecVisible, isEnabled:isEnabled, getData:getData, onClickEvaluateButton:onClickEvaluateButton, showEvaluations:showEvaluations, hideEvaluations:hideEvaluations, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Renderer.Filter = function(V, $, undefined) {
  var init = function() {
  };
  var allowElement = function(element) {
    var device = V.Status.getDevice();
    if(device.desktop) {
      switch(element.type) {
        case "applet":
          return false;
        default:
          return true
      }
    }else {
      if(device.mobile || device.tablet) {
        switch(element.type) {
          case "object":
            var objectInfo = V.Object.getObjectInfo(element.body);
            if(objectInfo.type == "swf") {
              return false
            }else {
              if(objectInfo.type == "youtube") {
                return true
              }
            }
            break;
          case "video":
            return true;
            break;
          case "snapshot":
            return true;
            break;
          case "applet":
            return false;
          default:
            return true
        }
      }
    }
    return true
  };
  var renderContentFiltered = function(element, template) {
    return"<div id='" + element["id"] + "' class='contentfiltered " + template + "_" + element["areaid"] + "'><img class='" + template + "_image' src='" + V.ImagesPath + "adverts/advert_new_grey.png'/></div>"
  };
  return{init:init, allowElement:allowElement, renderContentFiltered:renderContentFiltered}
}(VISH, jQuery);
VISH.SlidesSelector = function(V, $, undefined) {
  var initialized = false;
  var countIndex;
  var acceptButton;
  var nSlides;
  var slides;
  var init = function() {
    if(!initialized) {
      _preloadImages();
      countIndex = $("#ssbsp");
      acceptButton = $("#ssbaccept");
      nSlides = V.Slides.getSlidesQuantity();
      slides = [nSlides];
      _acceptAll();
      _updateIndex();
      _updateAllInterface("accept");
      $("#ssbAll").click(function(event) {
        _acceptAll();
        _updateAllInterface("accept");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $("#ssbuAll").click(function(event) {
        _denyAll();
        _updateAllInterface("deny");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $(acceptButton).click(function(event) {
        var aIndex = V.Slides.getCurrentSlideNumber() - 1;
        if(slides[aIndex] === true) {
          slides[aIndex] = false;
          _updateOneInterface(V.Slides.getCurrentSlide(), "deny")
        }else {
          slides[aIndex] = true;
          _updateOneInterface(V.Slides.getCurrentSlide(), "accept")
        }
        $("#ssbAll").removeClass("selected_inactive");
        $("#ssbuAll").removeClass("selected_inactive");
        _updateButtonValue(V.Slides.getCurrentSlideNumber());
        _updateIndex()
      });
      $("#ssbdone").click(function(event) {
        var params = new Object;
        params.acceptedSlides = _getAcceptedSlides();
        params.JSON = V.Viewer.getCurrentPresentation();
        V.Messenger.notifyEventByMessage(V.Constant.Event.onSelectedSlides, params)
      });
      V.EventsNotifier.registerCallback(V.Constant.Event.onGoToSlide, function(params) {
        _updateButtonValue(params.slideNumber)
      });
      initialized = true
    }
  };
  _preloadImages = function() {
    $("#SelectedSlidesToAdd").attr("src", V.ImagesPath + "templatesthumbs/addt.png");
    $("#tutorialSelectAllImage").attr("src", V.ImagesPath + "tutorial/selectall.png");
    $("tutorialUnselectAllImage").attr("src", V.ImagesPath + "tutorial/unselectall.png");
    $("tutorialSelectSlidesImage").attr("src", V.ImagesPath + "tutorial/selectslides.png");
    $("li.addslidestut img[srctoload]").each(function(index, img) {
      $(img).attr("src", $(img).attr("srctoload"))
    })
  };
  _acceptAll = function() {
    for(var i = 0;i < nSlides;i++) {
      slides[i] = true
    }
  };
  _denyAll = function() {
    for(var i = 0;i < nSlides;i++) {
      slides[i] = false
    }
  };
  _updateIndex = function() {
    var nAcceptedSlides = _getAcceptedSlides().length;
    $(countIndex).html("+" + nAcceptedSlides);
    if(nAcceptedSlides === 0) {
      $(countIndex).removeClass("selected_n_slides");
      $(countIndex).addClass("selected_zero_slides")
    }else {
      $(countIndex).removeClass("selected_zero_slides");
      $(countIndex).addClass("selected_n_slides")
    }
    $(countIndex).addClass("addslidetrans");
    $(countIndex).addClass("addslidetrans2");
    setTimeout(function() {
      $(countIndex).removeClass("addslidetrans");
      $(countIndex).removeClass("addslidetrans2")
    }, 800)
  };
  _getAcceptedSlides = function() {
    var aSlides = [];
    for(var i = 0;i < nSlides;i++) {
      if(slides[i]) {
        aSlides.push(i + 1)
      }
    }
    return aSlides
  };
  _updateAllInterface = function(status) {
    if(status === "accept") {
      $("#ssbAll").addClass("selected_inactive");
      $("#ssbuAll").removeClass("selected_inactive")
    }else {
      $("#ssbuAll").addClass("selected_inactive");
      $("#ssbAll").removeClass("selected_inactive")
    }
    var all_slides = V.Slides.getSlides();
    for(var i = 0;i < all_slides.length;i++) {
      _updateOneInterface(all_slides[i], status)
    }
  };
  _updateOneInterface = function(the_slide, status) {
    $(the_slide).removeClass("selected_accept");
    $(the_slide).removeClass("selected_deny");
    $(the_slide).addClass("selected_" + status)
  };
  _updateButtonValue = function(slideNumber) {
    var img = $(acceptButton).find("table tr td:nth-child(1) img");
    var span = $(acceptButton).find("table tr td:nth-child(2) span");
    if(slides[slideNumber - 1] === true) {
      $(img).attr("src", V.ImagesPath + "quiz/checkbox_wrong.png");
      $(span).text(V.I18n.getTrans("i.UnselectSlide"))
    }else {
      $(img).attr("src", V.ImagesPath + "quiz/checkbox_checked.png");
      $(span).text(V.I18n.getTrans("i.SelectSlide"))
    }
  };
  return{init:init}
}(VISH, jQuery);
VISH.Slideset = function(V, $, undefined) {
  var _modules;
  var initialized = false;
  var init = function() {
    if(initialized) {
      return
    }
    _modules = {};
    _modules[V.Constant.FLASHCARD] = V.Flashcard;
    _modules[V.Constant.VTOUR] = V.VirtualTour;
    _modules[V.Constant.EVIDEO] = V.EVideo;
    for(var slidesetType in _modules) {
      var viewerModule = _modules[slidesetType];
      if(typeof viewerModule != "undefined" && typeof viewerModule.init == "function") {
        viewerModule.init()
      }
    }
    initialized = true
  };
  var getViewerModule = function(obj) {
    return _modules[getSlidesetType(obj)]
  };
  var isSlideset = function(obj) {
    type = getSlidesetType(obj);
    return _isSlidesetType(type)
  };
  var _isSlidesetType = function(type) {
    switch(type) {
      case V.Constant.FLASHCARD:
      ;
      case V.Constant.VTOUR:
      ;
      case V.Constant.EVIDEO:
        return true;
      default:
        return false
    }
  };
  var getSlidesetType = function(obj) {
    if(typeof obj == "string") {
      return obj
    }else {
      if(typeof obj == "object") {
        return $(obj).attr("type")
      }else {
        if(typeof obj != "undefined" && typeof obj.type == "string") {
          return obj.type
        }
      }
    }
    return undefined
  };
  var draw = function(slidesetJSON) {
    var slidesetViewer = getViewerModule(slidesetJSON.type);
    if(typeof slidesetViewer.draw == "function") {
      slidesetViewer.draw(slidesetJSON)
    }
  };
  var onEnterSlideset = function(slideset) {
    var openSubslides = $(slideset).children("article.show_in_smartcard");
    if(openSubslides.length === 1) {
      var openSubslide = openSubslides[0];
      var subSlideId = $(openSubslide).attr("id");
      V.Slides.triggerEnterEventById(subSlideId)
    }
    var slidesetViewer = getViewerModule($(slideset).attr("type"));
    if(typeof slidesetViewer.onEnterSlideset == "function") {
      slidesetViewer.onEnterSlideset(slideset)
    }
  };
  var onLeaveSlideset = function(slideset) {
    var openSubslides = $(slideset).children("article.show_in_smartcard");
    if(openSubslides.length === 1) {
      var openSubslide = openSubslides[0];
      var subSlideId = $(openSubslide).attr("id");
      V.Slides.triggerLeaveEventById(subSlideId)
    }
    var slidesetViewer = getViewerModule($(slideset).attr("type"));
    if(typeof slidesetViewer.onLeaveSlideset == "function") {
      slidesetViewer.onLeaveSlideset(slideset)
    }
  };
  var afterSetupSize = function(increaseW, increaseH) {
    for(var slidesetType in _modules) {
      var viewerModule = _modules[slidesetType];
      if(typeof viewerModule != "undefined" && typeof viewerModule.afterSetupSize == "function") {
        viewerModule.afterSetupSize(increaseW, increaseH)
      }
    }
  };
  var onCloseSubslideClicked = function(event) {
    var close_slide_id = event.target.id.substring(5);
    V.Slides.closeSubslide(close_slide_id, true)
  };
  return{init:init, getViewerModule:getViewerModule, isSlideset:isSlideset, getSlidesetType:getSlidesetType, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, onCloseSubslideClicked:onCloseSubslideClicked, afterSetupSize:afterSetupSize}
}(VISH, jQuery);
VISH.SnapshotPlayer = function(V, $, undefined) {
  var loadSnapshot = function(element) {
    $.each(element.children(".snapshotelement"), function(index, value) {
      var wrapper_class = "snapshot_wrapper" + "_viewer";
      var content_class = "snapshot_content" + "_viewer";
      var content = $(value).attr("objectWrapper");
      if(V.Status.isOnline() === false) {
        $(value).html("<img src='" + V.ImagesPath + "adverts/advert_new_grey_iframe.png'/>");
        return
      }
      var iframe = $(V.Utils.getOuterHTML($(content)));
      $(iframe).removeClass();
      $(iframe).addClass(content_class);
      var scrollTop = $(value).attr("scrollTop");
      var scrollLeft = $(value).attr("scrollLeft");
      $(value).html("<div class='" + wrapper_class + "' style='" + $(value).attr("objectStyle") + "'>" + V.Utils.getOuterHTML(iframe) + "</div>");
      if($(value).attr("zoom")) {
        $(value).find("." + content_class).attr("style", V.Utils.getZoomInStyle($(value).attr("zoom")))
      }
      $(value).find("." + wrapper_class).scrollTop(scrollTop);
      $(value).find("." + wrapper_class).scrollLeft(scrollLeft)
    })
  };
  var unloadSnapshot = function(element) {
    var element = $(".past, .next");
    $.each(element.children(".snapshotelement"), function(index, value) {
      $(value).html("")
    })
  };
  var aftersetupSize = function(increase) {
    $.each($(".snapshot_content_viewer"), function(index, iframe) {
      var area = $(iframe).parent().parent();
      var iframe_wrapper = $(iframe).parent();
      $(area).attr("zoom", increase);
      $(iframe).attr("style", V.Utils.getZoomInStyle(increase));
      var scrollLeft = $(area).attr("scrollLeftOrigin");
      var newScrollLeft = scrollLeft * increase;
      var scrollTop = $(area).attr("scrollTopOrigin");
      var newScrollTop = scrollTop * increase;
      $(area).attr("scrollLeft", newScrollLeft);
      $(area).attr("scrollTop", newScrollTop);
      $(iframe_wrapper).scrollLeft(newScrollLeft);
      $(iframe_wrapper).scrollTop(newScrollTop)
    })
  };
  return{loadSnapshot:loadSnapshot, unloadSnapshot:unloadSnapshot, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Status.Device.Browser = function(V, $, undefined) {
  var init = function() {
  };
  var fillBrowser = function() {
    var browser = {};
    var _version;
    var _isAndroid;
    _version = _getInternetExplorerVersion();
    if(_version != -1) {
      browser.name = V.Constant.IE;
      browser.version = _version;
      return browser
    }
    _version = _getFirefoxVersion();
    if(_version != -1) {
      browser.name = V.Constant.FIREFOX;
      browser.version = _version;
      return browser
    }
    _version = _getGoogleChromeVersion();
    if(_version != -1) {
      browser.name = V.Constant.CHROME;
      browser.version = _version;
      return browser
    }
    _isAndroid = /android/i.test(navigator.userAgent);
    _version = _getSafariVersion();
    if(_version != -1) {
      if(_isAndroid) {
        browser.name = V.Constant.ANDROID_BROWSER
      }else {
        browser.name = V.Constant.SAFARI
      }
      browser.version = _version;
      return browser
    }
    browser.name = V.Constant.UNKNOWN;
    browser.version = -1;
    if(_isAndroid) {
      browser.name = V.Constant.ANDROID_BROWSER
    }
    return browser
  };
  var _getInternetExplorerVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_IE) {
      var ua = navigator.userAgent;
      var re = new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }else {
      if(navigator.appName === V.Constant.UA_NETSCAPE) {
        var ua = navigator.userAgent;
        var re = new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");
        if(re.exec(ua) != null) {
          rv = parseFloat(RegExp.$1)
        }
      }
    }
    return rv
  };
  var _getFirefoxVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Firefox/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getGoogleChromeVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      var re = new RegExp(".* Chrome/([0-9.]+)");
      if(re.exec(ua) != null) {
        rv = parseFloat(RegExp.$1)
      }
    }
    return rv
  };
  var _getSafariVersion = function() {
    var rv = -1;
    if(navigator.appName === V.Constant.UA_NETSCAPE) {
      var ua = navigator.userAgent;
      if(ua.indexOf("Safari") !== -1 && (ua.indexOf("Chrome") === -1 && ua.indexOf("crmo") == -1)) {
        var rv = -2;
        var re = new RegExp(".* Version/([0-9.]+)");
        if(re.exec(ua) != null) {
          rv = parseFloat(RegExp.$1)
        }
      }
    }
    return rv
  };
  return{init:init, fillBrowser:fillBrowser}
}(VISH, jQuery);
VISH.Status.Device.Features = function(V, $, undefined) {
  var init = function() {
  };
  var fillFeatures = function(browser) {
    var features = {};
    features.fullscreen = V.FullScreen.isFullScreenSupported();
    features.touchScreen = !!("ontouchstart" in window);
    features.localStorage = V.Storage.checkLocalStorageSupport();
    features.history = typeof history === "object" && (typeof history.back === "function" && typeof history.go === "function");
    if(features.history && typeof history.pushState == "function") {
      features.historypushState = true
    }else {
      features.historypushState = false
    }
    if(window.File && (window.FileReader && (window.FileList && window.Blob))) {
      features.reader = true
    }else {
      features.reader = false
    }
    features.sandbox = "sandbox" in document.createElement("iframe");
    features.pdfReader = false;
    if(typeof navigator.mimeTypes == "object" && "application/pdf" in navigator.mimeTypes) {
      features.pdfReader = true
    }
    features.css3d = false;
    if(browser.name === V.Constant.CHROME && browser.version > 12 || (browser.name === V.Constant.FIREFOX && browser.version > 16 || browser.name === V.Constant.SAFARI && browser.version > 4)) {
      features.css3d = true
    }
    return features
  };
  return{init:init, fillFeatures:fillFeatures}
}(VISH, jQuery);
VISH.Storage = function(V, $, undefined) {
  var _initialized;
  var _testing = false;
  var _isLocalStorageSupported;
  var init = function() {
    if(!_initialized) {
      _isLocalStorageSupported = checkLocalStorageSupport();
      _initialized = true;
      if(_testing) {
        clear();
        _isLocalStorageSupported = false
      }
    }
  };
  var isSupported = function() {
    if(!_initialized) {
      init()
    }
    return _isLocalStorageSupported
  };
  var add = function(key, value, persistent) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      persistent = !(persistent === false);
      var myObject = {};
      myObject.value = value;
      myObject.persistent = persistent;
      myObject.version = V.VERSION;
      myObject = JSON.stringify(myObject);
      localStorage.setItem(key, myObject);
      return true
    }else {
      return false
    }
  };
  var get = function(key) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      var myObject = localStorage.getItem(key);
      if(typeof myObject === "string") {
        myObject = JSON.parse(myObject);
        if(myObject && myObject.value) {
          if(!myObject.persistent && myObject.version) {
            if(V.Utils.isObseleteVersion(myObject.version)) {
              return undefined
            }
          }
          return myObject.value
        }
      }
      return undefined
    }else {
      return undefined
    }
  };
  var addPresentation = function(presentation) {
    if(!_initialized) {
      init()
    }
    if(_isLocalStorageSupported) {
      var list = localStorage.getItem("presentation_list") ? JSON.parse(localStorage.getItem("presentation_list")) : new Array;
      if($.inArray(presentation.id, list) === -1) {
        list.push(presentation.id);
        localStorage.setItem("presentation_list", JSON.stringify(list))
      }
      localStorage.setItem("presentation_" + presentation.id, JSON.stringify(presentation));
      localStorage.setItem("presentation_" + presentation.id + "_url", window.location.href);
      if(presentation.avatar !== undefined) {
        _saveImage(presentation.avatar)
      }
    }else {
    }
  };
  var _saveImage = function(path) {
    if(!_initialized) {
      init()
    }
    if(localStorage.getItem(path) === null && !path.match(/^http/)) {
      var canvas = document.createElement("canvas");
      var ctx = canvas.getContext("2d");
      var img = new Image;
      img.src = path;
      img.onload = function() {
        canvas.width = this.width;
        canvas.height = this.height;
        ctx.drawImage(this, 0, 0, canvas.width, canvas.height);
        var name = img.src.replace(/http:\/\/[^\/]+/i, "");
        localStorage.setItem(name, canvas.toDataURL())
      }
    }
  };
  var checkLocalStorageSupport = function() {
    var LSSupported = typeof Storage !== "undefined";
    if(LSSupported) {
      try {
        localStorage.setItem("myKey", "myKeyValue");
        localStorage.getItem("myKey");
        localStorage.removeItem("myKey");
        return true
      }catch(e) {
        return false
      }
    }else {
      return false
    }
  };
  var clear = function() {
    localStorage.clear()
  };
  var setTestingMode = function(bolean) {
    _testing = bolean
  };
  return{init:init, isSupported:isSupported, add:add, get:get, addPresentation:addPresentation, checkLocalStorageSupport:checkLocalStorageSupport, clear:clear, setTestingMode:setTestingMode}
}(VISH, jQuery);
VISH.Text = function(V, $, undefined) {
  var disableConversion = false;
  var init = function() {
    if(V.Status.getDevice().browser.name === V.Constant.IE && V.Status.getDevice().browser.version < 9) {
      disableConversion = true
    }
    if(disableConversion) {
      return
    }
    _makeTextResponsive($("article > div.VEtextArea"));
    _makeTextResponsive($("article div.quizContainer > div"));
    _makeTextResponsive($("article div.quizContainer").find("td"));
    $("article > div.VEtextArea > table").each(function(index, table) {
      _makeTextResponsive($(table).find("caption"));
      $(table).find("td").each(function(index, td) {
        _makeTextResponsive(td)
      });
      var tableOrgStyle = $(table).attr("style");
      if(tableOrgStyle) {
        var tableStyle = "";
        var tableWidth = V.Utils.getWidthFromStyle(tableOrgStyle);
        if(tableWidth) {
          var percentWidth = tableWidth * 100 / 800;
          tableStyle += "width:" + percentWidth + "%;"
        }
        var tableHeight = V.Utils.getHeightFromStyle(tableOrgStyle);
        if(tableHeight) {
          var percentHeight = tableHeight * 100 / 600;
          tableStyle += "height:" + percentHeight + "%;"
        }
        if(tableStyle !== "") {
          $(table).attr("style", tableStyle)
        }
      }
    })
  };
  var _makeTextResponsive = function(container) {
    _adaptFonts($(container).find("font"));
    _setStyleInRem($(container).find("[style]"))
  };
  var _setStyleInRem = function(els) {
    $(els).each(function(index, el) {
      var oldStyle = $(el).attr("style");
      if(typeof oldStyle !== "string") {
        return
      }
      var fontSize = V.Utils.getFontSizeFromStyle(oldStyle);
      if(typeof fontSize != "number" || isNaN(fontSize)) {
        return
      }
      var rem = fontSize / V.Constant.TextBase + "rem";
      var newStyle = V.Utils.addFontSizeToStyle(oldStyle, rem);
      $(el).attr("style", newStyle)
    })
  };
  var _adaptFonts = function(fonts) {
    $(fonts).each(function(index, font) {
      var fSize = $(font).attr("size");
      if(!fSize) {
        return
      }
      var fontSize = parseInt(fSize);
      if(isNaN(fontSize)) {
        return
      }
      $(font).hide();
      var pxfontSize = _font_to_px(fontSize);
      var rem = pxfontSize / V.Constant.TextBase + "rem";
      var span = $("<span style='font-size:" + rem + "'></span>");
      $(span).html($(font).html());
      $(font).before(span);
      $(font).remove()
    })
  };
  var aftersetupSize = function(increase) {
    increase = increase * _correctionFactor(increase);
    var reference_font_size = V.Constant.TextBase;
    var texts = $("html");
    $(texts).css("font-size", reference_font_size * increase + "px")
  };
  var _correctionFactor = function(factor) {
    if(factor < 0.25) {
      return 0.5
    }else {
      if(_isInRange(factor, 0.25, 0.3)) {
        return 0.55
      }else {
        if(_isInRange(factor, 0.3, 0.35)) {
          return 0.65
        }else {
          if(_isInRange(factor, 0.35, 0.4)) {
            return 0.7
          }else {
            if(_isInRange(factor, 0.4, 0.5)) {
              return 0.8
            }else {
              if(_isInRange(factor, 0.5, 0.6)) {
                return 0.85
              }else {
                if(_isInRange(factor, 0.6, 0.75)) {
                  return 0.9
                }else {
                  if(_isInRange(factor, 0.75, 0.95)) {
                    return 0.95
                  }else {
                    if(_isInRange(factor, 0.95, 1.5)) {
                      return 1
                    }else {
                      if(factor > 1.5) {
                        return 1
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
    return 1
  };
  var _isInRange = function(number, min, max) {
    return number > min && number <= max
  };
  var _font_to_px = function(fz) {
    switch(fz) {
      case 7:
        return 48;
        break;
      case 6:
        return 32;
        break;
      case 5:
        return 24;
        break;
      case 4:
        return 18;
        break;
      case 3:
        return 16;
        break;
      case 2:
        return 14;
        break;
      case 1:
        return 12;
        break;
      default:
        break
    }
  };
  return{init:init, aftersetupSize:aftersetupSize}
}(VISH, jQuery);
VISH.Themes.Core = function(V, $, undefined) {
  var _initialized = false;
  var _theme = {};
  var init = function() {
    if(_initialized === true) {
      return
    }
  };
  var applyConfigTheme = function(callback) {
    var configuration = V.Configuration.getConfiguration();
    if(typeof configuration["ve_theme"] == "object") {
      _theme = configuration["ve_theme"];
      return _applyTheme(_theme, callback)
    }
    if(typeof callback == "function") {
      callback(_theme)
    }
  };
  var _applyTheme = function(theme, callback) {
    if(typeof theme == "object") {
      if(typeof theme["cssPath"] == "string") {
        V.Utils.Loader.loadCSS(theme["cssPath"], function() {
          _applyThemeAfterCssLoaded(theme, callback)
        })
      }else {
        _applyThemeAfterCssLoaded(theme, callback)
      }
    }else {
      if(typeof callback == "function") {
        callback(_theme)
      }
    }
  };
  var _applyThemeAfterCssLoaded = function(theme, callback) {
    if(typeof callback == "function") {
      callback(_theme)
    }
  };
  var getCurrentTheme = function() {
    return _theme
  };
  var onThemeCallback = function(options, presentation) {
    if(typeof _theme == "object" && typeof _theme["callback"] == "function") {
      _theme["callback"](V, options, presentation)
    }
  };
  return{init:init, applyConfigTheme:applyConfigTheme, getCurrentTheme:getCurrentTheme, onThemeCallback:onThemeCallback}
}(VISH, jQuery);
VISH.Themes.Presentation = function(V, $, undefined) {
  var init = function() {
  };
  var loadTheme = function(theme, callback) {
    if(!theme) {
      theme = V.Constant.Themes.Default
    }
    _unloadAllThemes();
    V.Utils.Loader.loadCSS("themes/" + theme + ".css", callback)
  };
  var _unloadAllThemes = function() {
    var theme_pattern = "(^" + V.StylesheetsPath + "themes/)";
    $("head").find("link[type='text/css']").each(function(index, link) {
      var href = $(link).attr("href");
      if(href) {
        if(href.match(theme_pattern) !== null) {
          $(link).remove()
        }
      }
    })
  };
  return{init:init, loadTheme:loadTheme}
}(VISH, jQuery);
VISH.Tour = function(V, $, undefined) {
  var startTourWithId = function(helpid, tipLocation) {
    _clean();
    var loc;
    if(tipLocation === undefined) {
      loc = "top"
    }else {
      loc = tipLocation
    }
    $(window).joyride({"tipLocation":loc, "tipContent":"#" + helpid, "postRideCallback":_onTourFinish, "postStepCallback":_onStepFinish, "onInitCallback":_onInit})
  };
  var _onInit = function() {
  };
  var _onStepFinish = function(count) {
    _adjustMaxHeightOfCurrentTour()
  };
  var _onTourFinish = function(el) {
    _clean()
  };
  var _clean = function() {
    $(".joyride-tip-guide").each(function() {
      $(this).remove()
    })
  };
  var getCurrentTour = function() {
    var currentJoyride = $(".joyRideCurrent");
    if(currentJoyride.length > 0) {
      return currentJoyride
    }
  };
  var _adjustMaxHeightOfCurrentTour = function() {
    var currentJoyride = getCurrentTour();
    if(typeof currentJoyride != "undefined") {
      var joyRideParent = $(currentJoyride).parent();
      var joyRideWrapper = $(currentJoyride).find(".joyride-content-wrapper");
      var top = $(currentJoyride).cssNumber("top");
      var paddingTop = $(joyRideWrapper).cssNumber("padding-top");
      var paddingBottom = $(joyRideWrapper).cssNumber("padding-bottom");
      var outerPercentage = (top + paddingTop + paddingBottom) * 100 / $(joyRideParent).width();
      var maxHeightPercentage = Math.floor(100 - outerPercentage);
      if(maxHeightPercentage > 1.5) {
        maxHeightPercentage = maxHeightPercentage - 1.5
      }
      $(currentJoyride).css("max-height", maxHeightPercentage + "%");
      if(top === 0) {
        var currentHeightPercentage = $(currentJoyride).height() * 100 / $(window).height();
        currentHeightPercentage = Math.min(currentHeightPercentage, maxHeightPercentage);
        var topPorcentage = (100 - currentHeightPercentage) / 2;
        $(currentJoyride).css("top", topPorcentage + "%")
      }
    }
  };
  return{startTourWithId:startTourWithId, getCurrentTour:getCurrentTour}
}(VISH, jQuery);
VISH.User = function(V, $, undefined) {
  var _user;
  var init = function(options) {
    var userOptions = {};
    if(typeof options == "object") {
      userOptions = options["user"]
    }
    setUser(userOptions)
  };
  var getUser = function() {
    if(Object.keys(_user).length > 0) {
      return _user
    }else {
      return undefined
    }
  };
  var setUser = function(userObject) {
    if(typeof userObject == "object") {
      _user = userObject
    }else {
      _user = {}
    }
    var options = V.Utils.getOptions();
    if(options.scorm === true) {
      if(typeof _user["token"] != "undefined") {
        delete _user["token"]
      }
    }
  };
  var isLogged = function() {
    return _user && (typeof _user["token"] == "string" && _user["id"])
  };
  var getName = function() {
    return _user["name"]
  };
  var getId = function() {
    return _user["id"]
  };
  var getToken = function() {
    return _user["token"]
  };
  return{init:init, getUser:getUser, setUser:setUser, isLogged:isLogged, getName:getName, getId:getId, getToken:getToken}
}(VISH, jQuery);
VISH.Utils.Loader = function(V, undefined) {
  var init = function() {
  };
  var loadImagesOnContainer = function(imagesArray, containerId, options) {
    if(options.order === true) {
      _loadImagesOnContainerWithOrder(imagesArray, containerId, options)
    }else {
      _loadImagesOnContainer(imagesArray, containerId, options)
    }
  };
  var _loadImagesOnContainer = function(imagesArray, containerId, options) {
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        _insertElementOnContainer(image, imagesArray, containerId, options);
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength && typeof options.callback == "function") {
          options.callback()
        }
      });
      $(image).error(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength && typeof options.callback == "function") {
          options.callback()
        }
      })
    })
  };
  var _loadImagesOnContainerWithOrder = function(imagesArray, containerId, options) {
    var validImagesArray = imagesArray;
    var imagesLength = imagesArray.length;
    var imagesLoaded = 0;
    $.each(imagesArray, function(i, image) {
      $(image).load(function(response) {
        imagesLoaded = imagesLoaded + 1;
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, containerId, options);
          if(typeof options.callback == "function") {
            options.callback()
          }
        }
      });
      $(image).error(function(response) {
        if(options && options.defaultOnError) {
          var defaultSrc = $(image).attr("defaultsrc");
          if(typeof defaultSrc == "string") {
            $(image).removeAttr("defaultsrc");
            $(image).attr("src", defaultSrc);
            if(typeof options.onImageErrorCallback == "function") {
              options.onImageErrorCallback(image)
            }
            return
          }
        }
        imagesLoaded = imagesLoaded + 1;
        validImagesArray.splice(validImagesArray.indexOf(image), 1);
        if(imagesLoaded == imagesLength) {
          _insertElementsWithOrder(validImagesArray, containerId, options);
          if(typeof options.callback == "function") {
            options.callback()
          }
        }
      })
    })
  };
  var _insertElementsWithOrder = function(imagesArray, containerId, options) {
    $.each(imagesArray, function(i, image) {
      _insertElementOnContainer(image, imagesArray, containerId, options)
    })
  };
  var _insertElementOnContainer = function(image, imagesArray, containerId, options) {
    var titleArray = options.titleArray;
    if(titleArray && titleArray[imagesArray.indexOf(image)]) {
      $("#" + containerId).append("<div><p>" + titleArray[imagesArray.indexOf(image)] + "</p>" + V.Utils.getOuterHTML(image) + "</div>")
    }else {
      $("#" + containerId).append("<div>" + V.Utils.getOuterHTML(image) + "</div>")
    }
  };
  var loadScript = function(scriptSrc, callback) {
    if(typeof scriptSrc !== "string" || typeof callback !== "function") {
      return
    }
    var head = document.getElementsByTagName("head")[0];
    if(head) {
      var script = document.createElement("script");
      script.setAttribute("src", scriptSrc);
      script.setAttribute("type", "text/javascript");
      var callbackCalled = false;
      var callCallback = function() {
        if(!callbackCalled) {
          if(typeof callback == "function") {
            callbackCalled = true;
            callback()
          }
        }
      };
      var loadFunction = function() {
        if(this.readyState == "complete" || this.readyState == "loaded") {
          callCallback()
        }
      };
      script.onreadystatechange = loadFunction;
      script.onload = callCallback;
      head.appendChild(script)
    }
  };
  var _loadGoogleLibraryCallback = undefined;
  var loadGoogleLibrary = function(scriptSrc, callback) {
    if(typeof callback === "function") {
      _loadGoogleLibraryCallback = callback
    }else {
      return
    }
    var fullScriptSrc = scriptSrc + "&callback=VISH.Utils.Loader.onGoogleLibraryLoaded";
    loadScript(fullScriptSrc, function() {
    })
  };
  var onGoogleLibraryLoaded = function() {
    if(typeof _loadGoogleLibraryCallback === "function") {
      _loadGoogleLibraryCallback()
    }
    _loadGoogleLibraryCallback = undefined
  };
  var loadCSS = function(path, callback) {
    var url = path;
    if(url.indexOf("http") != 0) {
      url = V.StylesheetsPath + url;
      if(V.Status.getProtocol() === "file") {
        if(url.indexOf("/") == 0) {
          url = url.replace("/", "")
        }
      }
    }
    var head = document.getElementsByTagName("head")[0];
    var link = document.createElement("link");
    link.type = "text/css";
    link.rel = "stylesheet";
    link.href = url;
    if(typeof callback == "function") {
      var callbackCalled = false;
      var callCallback = function() {
        if(!callbackCalled) {
          callbackCalled = true;
          callback()
        }
      };
      link.onload = callCallback;
      link.onerror = callCallback;
      var loadFunction = function() {
        if(this.readyState == "complete" || this.readyState == "loaded") {
          callCallback()
        }
      };
      link.onreadystatechange = loadFunction
    }
    head.appendChild(link);
    if(typeof callback == "function") {
      var img = document.createElement("img");
      img.onerror = function() {
        callCallback()
      };
      img.src = url
    }
  };
  var loadDeviceCSS = function() {
    if(V.Status.getDevice().desktop) {
      loadCSS("device/desktop.css")
    }else {
      if(V.Status.getDevice().mobile) {
        loadCSS("device/mobile.css")
      }else {
        if(V.Status.getDevice().tablet) {
          loadCSS("device/tablet.css")
        }
      }
    }
    switch(V.Status.getDevice().browser.name) {
      case V.Constant.FIREFOX:
        loadCSS("browser/firefox.css");
        break;
      case V.Constant.IE:
        loadCSS("browser/ie.css");
        break;
      case V.Constant.CHROME:
        loadCSS("browser/chrome.css");
        break
    }
  };
  var loadLanguageCSS = function() {
    var languagesWithCSS = ["es", "fr", "hu", "nl", "de"];
    var language = V.I18n.getLanguage();
    if(languagesWithCSS.indexOf(language) != -1) {
      loadCSS("language/" + language + ".css")
    }
  };
  var t1Loading;
  var startLoading = function() {
    if(!_isFullLoadingActive()) {
      t1Loading = Date.now();
      $("#fancyLoad").trigger("click")
    }
  };
  var stopLoading = function(callback) {
    var diff = Date.now() - t1Loading;
    if(diff < 1250) {
      setTimeout(function() {
        stopLoading(callback)
      }, Math.max(0, Math.min(1250 - diff, 1250)))
    }else {
      var closed = false;
      var tWClose = 0;
      if(_isFullLoadingActive()) {
        $.fancybox.close();
        closed = true;
        tWClose = 800
      }
      if(typeof callback == "function") {
        setTimeout(function() {
          callback(closed)
        }, tWClose)
      }
    }
  };
  var prepareFancyboxForFullLoading = function() {
    $("#fancybox-outer").css("background", "rgba(255,255,255,0.9)");
    $("#fancybox-wrap").css("margin-top", "20px");
    $("#fancybox-wrap").css("margin-left", "20px")
  };
  var _isFullLoadingActive = function() {
    return $("#loading_fancy").is(":visible")
  };
  var startLoadingInContainer = function(container, options) {
    var loadImg = document.createElement("img");
    $(loadImg).addClass("loading_fancy_img");
    $(loadImg).attr("src", V.ImagesPath + "lightbox-ico-loading.gif");
    if(options && options.style) {
      $(loadImg).addClass(options.style)
    }
    var loadingBody = document.createElement("div");
    $(loadingBody).addClass("loading_fancy");
    $(loadingBody).append(loadImg);
    $(container).html("");
    $(container).append(loadingBody);
    $(container).addClass("loadingtmpShown")
  };
  var stopLoadingInContainer = function(container) {
    $(container).find(".loading_fancy_img").parent().remove();
    $(container).removeClass("loadingtmpShown")
  };
  return{init:init, loadImagesOnContainer:loadImagesOnContainer, loadScript:loadScript, loadGoogleLibrary:loadGoogleLibrary, loadCSS:loadCSS, loadDeviceCSS:loadDeviceCSS, loadLanguageCSS:loadLanguageCSS, onGoogleLibraryLoaded:onGoogleLibraryLoaded, prepareFancyboxForFullLoading:prepareFancyboxForFullLoading, startLoading:startLoading, stopLoading:stopLoading, startLoadingInContainer:startLoadingInContainer, stopLoadingInContainer:stopLoadingInContainer}
}(VISH);
VISH.Utils.iso8601Parser = function(V, $, undefined) {
  var multiplicators = [31104E3, 2592E3, 604800, 86400, 3600, 60, 1];
  var getDurationFromISO = function(period) {
    var durationPerUnit = getDurationFromISOPerUnit(period, true);
    if(durationPerUnit) {
      var durationInSeconds = 0;
      var dL = durationPerUnit.length;
      for(var i = 0;i < dL;i++) {
        durationInSeconds += durationPerUnit[i] * multiplicators[i]
      }
      return durationInSeconds
    }
    return null
  };
  var getDurationFromISOPerUnit = function(period, distributeOverflow) {
    var distributeOverflow = typeof distributeOverflow == "boolean" ? distributeOverflow : false;
    try {
      var durationPerUnit = _parsePeriodString(period, distributeOverflow)
    }catch(e) {
      return null
    }
    return durationPerUnit
  };
  function _parsePeriodString(period, _distributeOverflow) {
    var distributeOverflow = _distributeOverflow ? _distributeOverflow : false;
    var valueIndexes = [2, 3, 4, 5, 7, 8, 9];
    var duration = [0, 0, 0, 0, 0, 0, 0];
    var overflowLimits = [0, 12, 4, 7, 24, 60, 60];
    var struct;
    period = period.toUpperCase();
    if(!period) {
      return duration
    }else {
      if(typeof period !== "string") {
        throw new Error("Invalid iso8601 period string '" + period + "'");
      }
    }
    if(struct = /^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(period)) {
      for(var i = 0;i < valueIndexes.length;i++) {
        var structIndex = valueIndexes[i];
        duration[i] = struct[structIndex] ? +struct[structIndex].replace(/[A-Za-z]+/g, "") : 0
      }
    }else {
      throw new Error("String '" + period + "' is not a valid ISO8601 period.");
    }
    if(distributeOverflow) {
      for(var i = duration.length - 1;i > 0;i--) {
        if(duration[i] >= overflowLimits[i]) {
          duration[i - 1] = duration[i - 1] + Math.floor(duration[i] / overflowLimits[i]);
          duration[i] = duration[i] % overflowLimits[i]
        }
      }
    }
    return duration
  }
  var getISODurationFromSecs = function(n, bPrecise) {
    n = n * 100;
    var str = "P", nCs = Math.max(n, 0), nY = 0, nM = 0, nD = 0, nH, nMin;
    nCs = Math.round(nCs);
    if(bPrecise === true) {
      nD = Math.floor(nCs / 864E4)
    }else {
      nY = Math.floor(nCs / 315576E4);
      nCs -= nY * 315576E4;
      nM = Math.floor(nCs / 26298E4);
      nCs -= nM * 26298E4;
      nD = Math.floor(nCs / 864E4)
    }
    nCs -= nD * 864E4;
    nH = Math.floor(nCs / 36E4);
    nCs -= nH * 36E4;
    nMin = Math.floor(nCs / 6E3);
    nCs -= nMin * 6E3;
    if(nY > 0) {
      str += nY + "Y"
    }
    if(nM > 0) {
      str += nM + "M"
    }
    if(nD > 0) {
      str += nD + "D"
    }
    if(nH > 0 || (nMin > 0 || nCs > 0)) {
      str += "T";
      if(nH > 0) {
        str += nH + "H"
      }
      if(nMin > 0) {
        str += nMin + "M"
      }
      if(nCs > 0) {
        str += nCs / 100 + "S"
      }
    }
    if(str === "P") {
      str = "PT0H0M0S"
    }
    return str
  };
  return{getDurationFromISO:getDurationFromISO, getDurationFromISOPerUnit:getDurationFromISOPerUnit, getISODurationFromSecs:getISODurationFromSecs}
}();
VISH.Video.CustomPlayer = function(V, $, undefined) {
  var progressBarTimer;
  var init = function() {
  };
  var addCustomPlayerControls = function(videoId, loadEvents) {
    var video = document.getElementById(videoId);
    var customPlayerContainer = $("<div class='customPlayerContainer'>");
    $(video).parent().append(customPlayerContainer);
    $(video).remove();
    $(customPlayerContainer).append(video);
    $(customPlayerContainer).append($("<div class='customPlayerControls'><div class='customPlayerButton customPlayerPlay'></div></div>"));
    $(customPlayerContainer).append($("<div class='customPlayerProgressBar'><div class='progressBarElapsed'></div></div>"));
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    $(customPlayerContainer).attr("style", $(video).attr("style"));
    $(video).attr("style", "width:100%; height:100%;");
    $(customPlayerControls).attr("style", "width: 100%; height:100%;");
    _adjustPlayerControls(customPlayerControls);
    $(video).attr("customPlayerStatus", "ready");
    if(loadEvents) {
      loadCustomPlayerControlEvents(video)
    }
  };
  var _adjustPlayerControls = function(customPlayerControls) {
    var width = $(customPlayerControls).width();
    var height = $(customPlayerControls).height();
    var min_width = 70;
    var originalBackgroundSize = 0.5;
    var icon_width = originalBackgroundSize * width;
    if(icon_width > height) {
      _applyBackgroundSize(customPlayerControls, height / width)
    }else {
      if(icon_width < min_width) {
        _applyBackgroundSize(customPlayerControls, Math.min(1, min_width / width))
      }else {
        _applyBackgroundSize(customPlayerControls, originalBackgroundSize)
      }
    }
  };
  var _applyBackgroundSize = function(customPlayerControls, bs) {
    $(customPlayerControls).find("div.customPlayerButton").css("background-size", bs * 100 + "%")
  };
  var loadCustomPlayerControlEvents = function(video) {
    var customPlayerContainer = $(video).parent();
    var customPlayerControls = $(customPlayerContainer).find("div.customPlayerControls");
    var progressBar = $(customPlayerContainer).parent().find("div.customPlayerProgressBar");
    $(customPlayerControls).bind("click", _onClickCustomPlayerControls);
    $(customPlayerContainer).bind("mouseenter", _onEnterCustomPlayer);
    $(customPlayerContainer).bind("mouseleave", _onLeaveCustomPlayer);
    $(progressBar).bind("click", _onClickProgressBar)
  };
  var _onClickCustomPlayerControls = function(event) {
    event.preventDefault();
    var video = $(this).parent().children()[0];
    onClickVideo(video)
  };
  var _onEnterCustomPlayer = function(event) {
    var video = $(event.target).parent().children()[0];
    if($(video).attr("customPlayerStatus") !== "ready") {
      var progressBar = $(video).parent().find("div.customPlayerProgressBar");
      $(progressBar).show()
    }
  };
  var _onLeaveCustomPlayer = function(event) {
    var progressBar = $(event.target).parent().find("div.customPlayerProgressBar");
    $(progressBar).hide()
  };
  var _startProgressBar = function(video) {
    var progressBar = $(video).parent().find("div.progressBarElapsed");
    var timer = progressBarTimer = setInterval(function() {
      try {
        var ratio = V.Video.getCurrentTime(video) / V.Video.getDuration(video) * 100;
        $(progressBar).width(ratio + "%");
        if(ratio === 100) {
          clearTimeout(timer)
        }
      }catch(e) {
        clearTimeout(timer)
      }
    }, 400)
  };
  var _onClickProgressBar = function(event) {
    if(V.Status.isSlaveMode()) {
      return
    }
    if($(event.target).hasClass("customPlayerProgressBar")) {
      var progressBar = event.target;
      var elapsed = $(progressBar).find("div.progressBarElapsed")[0]
    }else {
      if($(event.target).hasClass("progressBarElapsed")) {
        var elapsed = event.target;
        var progressBar = $(elapsed).parent()
      }else {
        return
      }
    }
    event.preventDefault();
    event.stopPropagation();
    var video = $(progressBar).parent().children()[0];
    var ratio = (event.pageX - $(progressBar).offset().left) / $(progressBar).outerWidth();
    var seekToPos = Math.round(V.Video.getDuration(video) * ratio);
    V.Video.seekVideo(video.id, seekToPos, true)
  };
  var onClickVideo = function(video) {
    if(V.Status.isSlaveMode()) {
      return
    }
    switch($(video).attr("customPlayerStatus")) {
      case "ready":
      ;
      case "pause":
        if(!V.Status.isPreventDefaultMode()) {
          onPlayVideo(video)
        }
        V.Video.playVideo(video.id, null, true);
        break;
      case "playing":
        if(!V.Status.isPreventDefaultMode()) {
          onPauseVideo(video)
        }
        V.Video.pauseVideo(video.id, null, true);
        break;
      default:
        break
    }
  };
  var onPlayVideo = function(video) {
    _startProgressBar(video);
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    var progressBar = $(video).parent().find("div.customPlayerProgressBar");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerPause");
    $(customPlayerControlsButton).hide();
    $(video).attr("customPlayerStatus", "playing");
    $(progressBar).show()
  };
  var onPauseVideo = function(video) {
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerPlay");
    $(customPlayerControlsButton).show();
    $(video).attr("customPlayerStatus", "pause")
  };
  var onEndVideo = function(video) {
    $(video).attr("customPlayerStatus", "pause");
    var customPlayerControlsButton = $(video).parent().find("div.customPlayerControls").find("div");
    $(customPlayerControlsButton).removeClass().addClass("customPlayerButton customPlayerReplay");
    $(customPlayerControlsButton).show()
  };
  return{init:init, addCustomPlayerControls:addCustomPlayerControls, loadCustomPlayerControlEvents:loadCustomPlayerControlEvents, onPlayVideo:onPlayVideo, onPauseVideo:onPauseVideo, onEndVideo:onEndVideo}
}(VISH, jQuery);
VISH.Video.HTML5 = function(V, $, undefined) {
  var playTriggeredByUser = true;
  var pauseTriggeredByUser = true;
  var seekTriggeredByUser = true;
  var init = function() {
  };
  var playVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(video.paused) {
      playTriggeredByUser = false;
      video.play()
    }
  };
  var pauseVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
    if(!video.paused) {
      pauseTriggeredByUser = false;
      video.pause()
    }
  };
  var seekVideo = function(videoId, currentTime) {
    var video = $("#" + videoId)[0];
    if(typeof currentTime === "number" && video.currentTime !== currentTime) {
      seekTriggeredByUser = false;
      video.currentTime = currentTime
    }
  };
  var showControls = function(showControls) {
    var videos = $("video");
    $.each(videos, function(index, video) {
      if(!showControls) {
        $(video).removeAttr("controls")
      }else {
        $(video).attr("controls", true)
      }
    })
  };
  var setMultimediaEvents = function() {
    var multimediaEls = $("video, audio");
    $.each(multimediaEls, function(index, mEl) {
      var isVideo = mEl.tagName === "VIDEO";
      var isAudio = !isVideo;
      if(isVideo) {
        var mElType = "VIDEO"
      }else {
        if(isAudio) {
          var mElType = "AUDIO"
        }
      }
      mEl.addEventListener("play", function() {
        var params = new Object;
        params.multimediaType = mElType;
        params.type = "HTML5";
        params.id = mEl.id;
        params.currentTime = mEl.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        var eventId = isVideo ? V.Constant.Event.onPlayVideo : V.Constant.Event.onPlayAudio;
        V.EventsNotifier.notifyEvent(eventId, params, playTriggeredByUser);
        playTriggeredByUser = true
      }, false);
      mEl.addEventListener("pause", function() {
        var params = new Object;
        params.multimediaType = mElType;
        params.type = "HTML5";
        params.id = mEl.id;
        params.currentTime = mEl.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        var eventId = isVideo ? V.Constant.Event.onPauseVideo : V.Constant.Event.onPauseAudio;
        V.EventsNotifier.notifyEvent(eventId, params, pauseTriggeredByUser);
        pauseTriggeredByUser = true
      }, false);
      mEl.addEventListener("ended", function() {
      }, false);
      mEl.addEventListener("error", function(err) {
      }, false);
      mEl.addEventListener("seeked", function(err) {
        var params = new Object;
        params.multimediaType = mElType;
        params.type = "HTML5";
        params.id = mEl.id;
        params.currentTime = mEl.currentTime;
        params.slideNumber = V.Slides.getCurrentSlideNumber();
        var eventId = isVideo ? V.Constant.Event.onSeekVideo : V.Constant.Event.onSeekAudio;
        V.EventsNotifier.notifyEvent(eventId, params, seekTriggeredByUser);
        seekTriggeredByUser = true
      }, false);
      if(isVideo) {
        $(mEl).focus(function(event) {
          this.blur()
        })
      }
    })
  };
  var playMultimedia = function(slide) {
    var multimediaEls = $(slide).find("video, audio");
    $.each(multimediaEls, function(index, mEl) {
      if($(mEl).attr("wasplayingonslideleave") == "true") {
        mEl.play()
      }else {
        if($(mEl).attr("wasplayingonslideleave") == "false") {
        }else {
          if(typeof $(mEl).attr("wasplayingonslideleave") == "undefined") {
            if($(mEl).attr("autoplayonslideenter") == "true") {
              mEl.play()
            }
          }
        }
      }
    })
  };
  var stopMultimedia = function(slide) {
    var multimediaEls = $(slide).find("video, audio");
    $.each(multimediaEls, function(index, mEl) {
      var playing = !mEl.paused;
      $(mEl).attr("wasplayingonslideleave", playing);
      if(playing) {
        mEl.pause()
      }
    })
  };
  var renderVideoFromJSON = function(videoJSON, options) {
    var renderOptions = options || {};
    if(typeof renderOptions.id == "undefined") {
      renderOptions.id = typeof videoJSON != "undefined" && videoJSON["id"] ? videoJSON["id"] : V.Utils.getId()
    }
    if(typeof renderOptions.controls == "undefined") {
      renderOptions.controls = videoJSON["controls"]
    }
    if(typeof renderOptions.poster == "undefined") {
      if(isDefaultPosterPath(videoJSON["poster"])) {
        videoJSON["poster"] = getDefaultPosterURL()
      }
      renderOptions.poster = videoJSON["poster"]
    }
    renderOptions.style = videoJSON["style"];
    renderOptions.autoplay = videoJSON["autoplay"];
    renderOptions.loop = videoJSON["loop"];
    return renderVideoFromSources(getSourcesFromJSON(videoJSON), renderOptions)
  };
  var renderVideoFromSources = function(sources, options) {
    var video = $("<video></video>");
    $(video).attr("preload", "metadata");
    if(options && options.extraAttrs) {
      for(var key in options.extraAttrs) {
        $(video).attr(key, options.extraAttrs[key])
      }
    }
    if(options) {
      if(options["id"]) {
        $(video).attr("id", options["id"])
      }
      if(typeof options.onVideoReady == "string") {
        try {
          var onVideoReadySplit = options.onVideoReady.split(".");
          var onVideoReadyFunction = window[onVideoReadySplit[0]];
          for(var k = 1;k < onVideoReadySplit.length;k++) {
            onVideoReadyFunction = onVideoReadyFunction[onVideoReadySplit[k]]
          }
          if(typeof onVideoReadyFunction == "function") {
            $(video).attr("onloadeddata", options.onVideoReady + "(this)")
          }
        }catch(e) {
        }
      }
      if(options["extraClasses"]) {
        var extraClassesLength = options["extraClasses"].length;
        for(var i = 0;i < extraClassesLength;i++) {
          $(video).addClass(options["extraClasses"][i])
        }
      }
      if(options.controls !== false) {
        $(video).attr("controls", "controls")
      }
      if(typeof options.autoplay != "undefined") {
        $(video).attr("autoplayonslideenter", options.autoplay)
      }
      if(typeof options["poster"] == "string") {
        $(video).attr("poster", options["poster"])
      }
      if(options["loop"] === true) {
        $(video).attr("loop", "loop")
      }
      if(options["style"]) {
        $(video).attr("style", options["style"])
      }
    }
    if(typeof $(video).attr("onloadeddata") == "undefined") {
      $(video).attr("onloadeddata", "VISH.Video.HTML5.onVideoReady(this)")
    }
    video = V.Utils.getOuterHTML(video);
    video = video.split("</video>")[0];
    if(!options || options.loadSources !== false) {
      $.each(sources, function(index, source) {
        if(typeof source.src == "string") {
          var sourceSrc = source.src;
          if(typeof options != "undefined" && options.timestamp === true) {
            sourceSrc = V.Utils.addParamToUrl(sourceSrc, "timestamp", "" + (new Date).getTime())
          }
          var mimeType = source.mimeType ? "type='" + source.mimeType + "' " : "";
          video = video + "<source src='" + sourceSrc + "' " + mimeType + ">"
        }
      });
      if(sources.length > 0) {
        video = video + "<p>Your browser does not support HTML5 video.</p>"
      }
    }
    video = video + "</video>";
    return video
  };
  var addSourcesToVideoTag = function(sources, videoTag, options) {
    var options = options || {};
    $.each(sources, function(index, source) {
      if(typeof source.src == "string") {
        var sourceSrc = source.src;
        if(options.timestamp === true) {
          sourceSrc = V.Utils.addParamToUrl(sourceSrc, "timestamp", "" + (new Date).getTime())
        }
        var mimeType = source.mimeType ? "type='" + source.mimeType + "' " : "";
        $(videoTag).append("<source src='" + sourceSrc + "' " + mimeType + ">")
      }
    });
    if(sources.length > 0) {
      $(videoTag).append("<p>Your browser does not support HTML5 video.</p>")
    }
    if(options.initTimer === true) {
      _initLoadedTimerForVideo(videoTag)
    }
  };
  var _initLoadedTimerForVideo = function(videoTag) {
    var videoTimer = setInterval(function() {
      var nAttempts = typeof $(videoTag).attr("loadAttempts") != "undefined" ? parseInt($(videoTag).attr("loadAttempts")) : 1;
      if($(videoTag).attr("loaded") === "true" || nAttempts > 3) {
        clearTimeout(videoTimer)
      }else {
        $(videoTag).attr("loadAttempts", nAttempts + 1);
        _reloadTimestampSources(videoTag)
      }
    }, 1E4)
  };
  var _reloadTimestampSources = function(videoTag) {
    V.Debugging.log("ViSH.Video.HTML5 Module [BETA VERSION]: _reloadTimestampSources called");
    var sources = V.Video.HTML5.getSources(videoTag);
    sources.map(function(source) {
      source.src = V.Utils.addParamToUrl(source.src, "timestamp", "" + (new Date).getTime());
      return source
    });
    $(videoTag).children().remove();
    if($(videoTag).attr("loaded") === "true") {
      return
    }
    $(videoTag).load();
    addSourcesToVideoTag(sources, videoTag, {timestamp:true, initTimer:false});
    setTimeout(function() {
      $(videoTag).load()
    }, 500)
  };
  var onVideoReady = function(video) {
    if(typeof video != "undefined" && (video.readyState == 4 || video.readyState == 3)) {
      $(video).attr("loaded", "true")
    }
  };
  var getSources = function(videoDOM) {
    if(typeof videoDOM == "string") {
      var sources = [];
      var srcPattern = new RegExp("src=('||\")([a-z-.://0-9]+)", "g");
      var found;
      while(found = srcPattern.exec(videoDOM)) {
        if(found.length > 2) {
          sources.push(found[2])
        }
        srcPattern.lastIndex = found.index + 1
      }
      return sources.map(function(value) {
        return{"src":value, "mimeType":getVideoMimeType(value)}
      })
    }
    try {
      return $(videoDOM).find("source").map(function() {
        return{"src":this.src, "mimeType":getVideoMimeType(this.src)}
      })
    }catch(e) {
      return[]
    }
    return[]
  };
  var getSourcesFromJSON = function(videoJSON) {
    if(typeof videoJSON != "object") {
      return[]
    }
    if(typeof videoJSON.sources == "string") {
      try {
        var sources = JSON.parse(videoJSON.sources)
      }catch(e) {
        return[]
      }
    }else {
      if(typeof videoJSON.sources == "object") {
        var sources = videoJSON.sources
      }
    }
    if(typeof sources != "undefined") {
      $.each(sources, function(index, source) {
        if(typeof source.type != "undefined") {
          source.mimeType = source.type
        }
      })
    }
    return sources
  };
  var getVideoMimeType = function(url) {
    var source = V.Object.getObjectInfo(url).source;
    return"video/" + source.split(".").pop().split("?")[0]
  };
  var getPoster = function(videoDOM) {
    if(typeof videoDOM == "string") {
      var posterPattern = new RegExp("poster=('||\")([a-z.://0-9?=%]+)", "g");
      var found = posterPattern.exec(videoDOM);
      if(typeof found != "undefined" && (found != null && found.length > 2)) {
        return found[2]
      }
      return undefined
    }
    return $(videoDOM).attr("poster")
  };
  var getDefaultPosterURL = function() {
    return V.ImagesPath + "vicons/example_poster_image.jpg"
  };
  var isDefaultPosterPath = function(posterURL) {
    return typeof posterURL == "string" && /^\/[\w\/]+example_poster_image/g.test(posterURL)
  };
  return{init:init, renderVideoFromJSON:renderVideoFromJSON, renderVideoFromSources:renderVideoFromSources, addSourcesToVideoTag:addSourcesToVideoTag, setMultimediaEvents:setMultimediaEvents, playMultimedia:playMultimedia, stopMultimedia:stopMultimedia, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, showControls:showControls, getSources:getSources, getSourcesFromJSON:getSourcesFromJSON, getVideoMimeType:getVideoMimeType, getPoster:getPoster, getDefaultPosterURL:getDefaultPosterURL, 
  isDefaultPosterPath:isDefaultPosterPath, onVideoReady:onVideoReady}
}(VISH, jQuery);
var youtubePlayers = {};
var YT = YT || {};
YT.PlayerState = YT.PlayerState || {};
YT.PlayerState.UNSTARTED = -1;
YT.PlayerState.ENDED = 0;
YT.PlayerState.PLAYING = 1;
YT.PlayerState.PAUSED = 2;
YT.PlayerState.BUFFERING = 3;
YT.PlayerState.CUED = 5;
var _youTubeIframeApiReady = false;
function onYouTubeIframeAPIReady() {
  _youTubeIframeApiReady = true
}
VISH.Video.Youtube = function(V, $, undefined) {
  var _waitForLoadYouTubeAPI = true;
  var _enableCustomPlayer;
  var init = function(enableCustomPlayer) {
    _enableCustomPlayer = enableCustomPlayer;
    _loadYouTubeIframeAPILibrary();
    setTimeout(function() {
      _waitForLoadYouTubeAPI = false
    }, 11E3)
  };
  var _loadYouTubeIframeAPILibrary = function() {
    var tag = document.createElement("script");
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName("script")[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag)
  };
  var _isYouTubeIframeAPIReady = function() {
    if(window["YT"] && _youTubeIframeApiReady === true) {
      return true
    }else {
      return false
    }
  };
  var renderVideoFromJSON = function(videoJSON, options) {
    var source = videoJSON["body"] || videoJSON["source"];
    var options = options || {};
    options.id = videoJSON["id"] ? videoJSON["id"] : V.Utils.getId();
    options.objectStyle = videoJSON["style"];
    options.zoomInStyle = videoJSON["zoomInStyle"];
    return renderVideoFromSource(source, options)
  };
  var renderVideoFromSource = function(source, options) {
    var videoId = options && options.id ? options.id : V.Utils.getId();
    var ytContainerId = V.Utils.getId();
    var videoClasses = "";
    var objectStyle = "";
    var zoomInStyle = "";
    if(options) {
      if(options.extraClasses) {
        videoClasses = videoClasses + " " + options.extraClasses
      }
      if(options.objectStyle) {
        objectStyle = "objectStyle='" + options.objectStyle + "' "
      }else {
        if(options.style) {
          objectStyle = "objectStyle='" + options.style + "' "
        }
      }
      if(options.zoomInStyle) {
        zoomInStyle = "zoomInStyle='" + options.zoomInStyle + "' "
      }
    }
    var video = "<div id='" + videoId + "' ytContainerId='" + ytContainerId + "' class='" + videoClasses + "' " + objectStyle + zoomInStyle + " source='" + source + "'>" + "</div>";
    return video
  };
  var loadYoutubeObject = function(container, options) {
    var enableCustomPlayer = _enableCustomPlayer;
    var controls = enableCustomPlayer ? 0 : 1;
    var _onReadyCallback = onPlayerReady;
    var _onPlayerError = onPlayerError;
    if(options) {
      if(typeof options.enableCustomPlayer == "boolean") {
        enableCustomPlayer = options.enableCustomPlayer;
        controls = enableCustomPlayer ? 0 : 1
      }
      if(typeof options.controls == "boolean") {
        controls = options.controls === true ? 1 : 0
      }
      if(typeof options.onReadyCallback == "function") {
        _onReadyCallback = options.onReadyCallback
      }
      if(typeof options.onPlayerError == "function") {
        _onPlayerError = options.onPlayerError
      }
    }
    if(V.Status.isOnline() === false) {
      $(container).html("<img src='" + V.ImagesPath + "adverts/advert_new_grey_video.png'/>");
      _onPlayerError();
      return
    }
    if(!_isYouTubeIframeAPIReady()) {
      if(_waitForLoadYouTubeAPI) {
        setTimeout(function() {
          loadYoutubeObject(container, options)
        }, 1E3)
      }else {
        $(container).html("<img src='" + V.ImagesPath + "adverts/advert_new_grey_video.png'/>");
        $(container).addClass("videoOfflineContainer");
        var nonAvailableImg = $(container).find("img");
        $(nonAvailableImg).load(function(response) {
          $(nonAvailableImg).css("margin-top", ($(container).height() - $(nonAvailableImg).height()) / 2 + "px")
        });
        _onPlayerError()
      }
      return
    }
    var youtubeVideoId = getYoutubeIdFromURL($(container).attr("source"));
    if(youtubeVideoId === null) {
      _onPlayerError();
      return
    }
    var iframeId = $(container).attr("ytContainerId");
    var ytStyle = typeof $(container).attr("objectStyle") != "undefined" ? "style='" + $(container).attr("objectStyle") + "' " : "";
    $(container).html("<div id='" + iframeId + "' videotype='" + V.Constant.MEDIA.YOUTUBE_VIDEO + "' " + ytStyle + "'></div>");
    youtubePlayers[iframeId] = new YT.Player(iframeId, {height:"100%", width:"100%", videoId:youtubeVideoId, playerVars:{"autoplay":0, "controls":controls, "enablejsapi":1, "showinfo":0, wmode:"transparent", "rel":0}, events:{"onReady":_onReadyCallback, "onError":_onPlayerError}});
    $("#" + iframeId).attr("wmode", "transparent");
    if(_enableCustomPlayer) {
      V.Video.CustomPlayer.addCustomPlayerControls(iframeId, false)
    }
  };
  var onPlayerReady = function(event) {
    if(_enableCustomPlayer) {
      var iframe = event.target.getIframe();
      V.Video.CustomPlayer.loadCustomPlayerControlEvents(iframe)
    }
  };
  var onPlayerStateChange = function(event) {
    if(!_enableCustomPlayer) {
      return
    }
    var newState = event.data;
    var iframe = event.target.getIframe();
    switch(newState) {
      case -1:
        break;
      case 0:
        V.Video.CustomPlayer.onEndVideo(iframe);
        break;
      case 1:
        V.Video.CustomPlayer.onPlayVideo(iframe);
        break;
      case 2:
        V.Video.CustomPlayer.onPauseVideo(iframe);
        break;
      case 3:
        break;
      case 4:
        break;
      case 5:
        break;
      default:
        break
    }
  };
  var onPlayerError = function(event) {
    if(typeof event == "object" && typeof event.data != "undefined") {
      V.Debugging.log("onPlayerError with error type " + event.data)
    }
  };
  var playVideo = function(iframeId, currentTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onPlayVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onPlayVideo, params, triggeredByUser);
      _seekVideo(ytPlayer, iframeId, currentTime, false);
      if(ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING) {
        ytPlayer.playVideo()
      }
    }
  };
  var pauseVideo = function(iframeId, currentTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = ytPlayer.getCurrentTime();
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onPauseVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onPauseVideo, params, triggeredByUser);
      if(ytPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
        ytPlayer.pauseVideo()
      }
      _seekVideo(ytPlayer, iframeId, currentTime, false)
    }
  };
  var seekVideo = function(iframeId, seekTime, triggeredByUser) {
    var ytPlayer = youtubePlayers[iframeId];
    if(ytPlayer && ytPlayer.getPlayerState) {
      _seekVideo(ytPlayer, iframeId, seekTime, triggeredByUser)
    }
  };
  var _seekVideo = function(ytPlayer, iframeId, seekTime, triggeredByUser) {
    var changeCurrentTime = typeof seekTime === "number" && ytPlayer.getCurrentTime() !== seekTime;
    if(changeCurrentTime) {
      var params = new Object;
      params.videoId = iframeId;
      params.currentTime = seekTime;
      params.slideNumber = V.Slides.getCurrentSlideNumber();
      if(triggeredByUser && V.Status.isPreventDefaultMode()) {
        V.Messenger.notifyEventByMessage(V.Constant.Event.onSeekVideo, params);
        return
      }
      V.EventsNotifier.notifyEvent(V.Constant.Event.onSeekVideo, params, triggeredByUser);
      ytPlayer.seekTo(seekTime)
    }
  };
  var getYouTubePlayer = function(id) {
    return youtubePlayers[id]
  };
  var getYoutubeIdFromURL = function(url) {
    var id = null;
    if(!url) {
      return id
    }
    var youtube_video_pattern_1 = /https?:\/\/?youtu.be\/([aA-zZ0-9-]+)/g;
    var youtube_video_pattern_2 = /(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-zZ0-9-]+)[&=.]*/g;
    var youtube_video_pattern_3 = /(https?:\/\/)?(www.youtube.com\/v\/)([aA-zZ0-9-]+)/g;
    var youtube_video_pattern_4 = /(https?:\/\/)?(www.youtube.com\/embed\/)([aA-zZ0-9-]+)/g;
    if(url.match(youtube_video_pattern_1) != null) {
      var result = youtube_video_pattern_1.exec(url);
      if(result && result[1]) {
        id = result[1]
      }
      return id
    }
    if(url.match(youtube_video_pattern_2) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_2.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    if(url.match(youtube_video_pattern_3) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_3.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    if(url.match(youtube_video_pattern_4) != null) {
      var result = url.split("&")[0];
      var result = youtube_video_pattern_4.exec(url);
      if(result && result[3]) {
        id = result[3]
      }
      return id
    }
    return id
  };
  var getEmbedSource = function(youTubeVideoDOM) {
    return"https://www.youtube.com/embed/" + V.Video.Youtube.getYoutubeIdFromURL(V.Object.getObjectInfo(youTubeVideoDOM).source)
  };
  return{init:init, renderVideoFromJSON:renderVideoFromJSON, renderVideoFromSource:renderVideoFromSource, loadYoutubeObject:loadYoutubeObject, onPlayerReady:onPlayerReady, onPlayerStateChange:onPlayerStateChange, playVideo:playVideo, pauseVideo:pauseVideo, seekVideo:seekVideo, getYoutubeIdFromURL:getYoutubeIdFromURL, getYouTubePlayer:getYouTubePlayer, getEmbedSource:getEmbedSource}
}(VISH, jQuery);
VISH.Viewer = function(V, $, undefined) {
  var initOptions;
  var current_presentation;
  var init = function(options, presentation) {
    V.Editing = false;
    $("body").addClass("ViSHViewerBody");
    initOptions = typeof options == "object" ? options : {};
    V.Debugging.init(options);
    if(initOptions["configuration"] && V.Configuration) {
      V.Configuration.init(initOptions["configuration"])
    }
    if(V.Debugging.isDevelopping()) {
      if(!presentation && V.Debugging.getPresentationSamples() !== null) {
        presentation = V.Debugging.getPresentationSamples()
      }
    }
    V.Utils.init();
    V.I18n.init(initOptions, presentation);
    V.Debugging.log("\n\nViSH Viewer init with presentation:\n");
    V.Debugging.log(JSON.stringify(presentation));
    presentation = V.Utils.fixPresentation(presentation);
    if(presentation === null) {
      V.Utils.showPNotValidDialog();
      return
    }
    current_presentation = presentation;
    V.Status.init(function() {
      _initAferStatusLoaded(options, presentation)
    })
  };
  var _initAferStatusLoaded = function(options, presentation) {
    V.Utils.Loader.loadDeviceCSS();
    V.Utils.Loader.loadLanguageCSS();
    V.Themes.init();
    V.Themes.Core.applyConfigTheme(function(VEtheme) {
      _initAferVEThemeLoaded(options, presentation)
    })
  };
  var _initAferVEThemeLoaded = function(options, presentation) {
    V.EventsNotifier.init();
    V.Object.init();
    V.Slideset.init();
    V.Quiz.initBeforeRender(presentation);
    V.Slides.init();
    V.I18n.translateUI();
    V.User.init(options);
    V.Storage.init();
    V.Recommendations.init(options);
    V.Events.init();
    V.Video.init();
    V.Audio.init();
    V.FullScreen.init();
    V.SCORM.init();
    V.Themes.Presentation.loadTheme(presentation.theme, function() {
      _initAferPresentationThemeLoaded(options, presentation)
    })
  };
  var _initAferPresentationThemeLoaded = function(options, presentation) {
    V.Presentation.init(presentation.slides, function() {
      _initAferRenderPresentation(options, presentation)
    })
  };
  var _initAferRenderPresentation = function(options, presentation) {
    V.Video.HTML5.setMultimediaEvents();
    V.Animations.loadAnimation(presentation.animation, function() {
      _initAferAnimationLoaded(options, presentation)
    })
  };
  var _initAferAnimationLoaded = function(options, presentation) {
    V.Slides.updateCurrentSlideFromHash();
    V.Slides.updateSlides();
    V.Quiz.init();
    V.SCORM.initAfterRender();
    V.IframeMessenger.init();
    if(options.addons) {
      V.Addons.init(options.addons)
    }
    V.ViewerAdapter.init(options);
    if(V.Slides.getCurrentSlideNumber() > 0) {
      V.Slides.triggerEnterEventById($(V.Slides.getCurrentSlide()).attr("id"))
    }
    if(!V.Status.isExternalDomain()) {
      window.focus()
    }
    V.TrackingSystem.init()
  };
  var getOptions = function() {
    return initOptions
  };
  var onSlideEnterViewer = function(e) {
    var slide = e.target;
    var cSlideNumber = V.Slides.getCurrentSlideNumber();
    var isSubslide = V.Slides.isSubslide(slide);
    var isSlideset = !isSubslide && V.Slideset.isSlideset(slide);
    e.stopPropagation();
    var timeToLoadObjects = 500;
    if(!isSubslide) {
      V.ViewerAdapter.decideIfPageSwitcher()
    }else {
      timeToLoadObjects = 1E3
    }
    setTimeout(function() {
      if(!isSubslide) {
        if(cSlideNumber !== V.Slides.getCurrentSlideNumber()) {
          return
        }
      }
      if(!isSlideset) {
        if($(slide).hasClass(V.Constant.OBJECT)) {
          V.ObjectPlayer.loadObject($(slide))
        }
        if($(slide).hasClass(V.Constant.SNAPSHOT)) {
          V.SnapshotPlayer.loadSnapshot($(slide))
        }
      }
    }, timeToLoadObjects);
    if(!isSlideset) {
      V.Video.HTML5.playMultimedia(slide)
    }
    if(isSlideset) {
      V.Slideset.onEnterSlideset(slide)
    }
    if(!isSubslide) {
      V.Recommendations.checkForRecommendations()
    }
    V.EventsNotifier.notifyEvent(V.Constant.Event.onEnterSlide, {"id":slide.id, "slideNumber":cSlideNumber}, false)
  };
  var onSlideLeaveViewer = function(e) {
    var slide = e.target;
    var isSubslide = V.Slides.isSubslide(slide);
    var isSlideset = !isSubslide && V.Slideset.isSlideset(slide);
    e.stopPropagation();
    if(!isSlideset) {
      if($(slide).hasClass(V.Constant.OBJECT)) {
        V.ObjectPlayer.unloadObject($(slide))
      }else {
        if($(slide).hasClass(V.Constant.SNAPSHOT)) {
          V.SnapshotPlayer.unloadSnapshot($(slide))
        }
      }
      V.Video.HTML5.stopMultimedia(slide)
    }else {
      V.Slideset.onLeaveSlideset(slide)
    }
  };
  var updateSlideCounter = function() {
    var number_of_slides = V.Slides.getSlides().length;
    var slide_number = V.Slides.getCurrentSlideNumber();
    if(number_of_slides === 0) {
      slide_number = 0
    }
    $("#slide-counter-input").val(slide_number);
    $("#slide-counter-span").html("/" + number_of_slides)
  };
  var getCurrentPresentation = function() {
    return current_presentation
  };
  var getPresentationType = function() {
    var cPresentation = getCurrentPresentation();
    if(typeof cPresentation == "object") {
      return cPresentation.type
    }else {
      return undefined
    }
  };
  return{init:init, getOptions:getOptions, updateSlideCounter:updateSlideCounter, getCurrentPresentation:getCurrentPresentation, getPresentationType:getPresentationType, onSlideEnterViewer:onSlideEnterViewer, onSlideLeaveViewer:onSlideLeaveViewer}
}(VISH, jQuery);
VISH.ViewerAdapter = function(V, $, undefined) {
  var _showViewbar;
  var _showArrows;
  var _fsButton;
  var _closeButton;
  var _showRec;
  var _showEval;
  var _initialized = false;
  var _lastWidth;
  var _lastHeight;
  var _lastIncrease;
  var _lastIncreaseW;
  var init = function(options) {
    if(_initialized) {
      return
    }
    _initialized = true;
    _lastWidth = -1;
    _lastHeight = -1;
    _showViewbar = _defaultViewbar();
    _showArrows = true;
    _fsButton = V.FullScreen.canFullScreen();
    _closeButton = false;
    _showRec = V.Recommendations.canShowRecommendations();
    _showEval = V.Recommendations.canShowEvaluateButton();
    if(V.Status.getDevice().mobile) {
      if(!V.Status.isEmbed()) {
        _closeButton = options && options["comeBackUrl"]
      }
    }
    if(!V.Status.getDevice().desktop) {
      _showArrows = false
    }
    if(V.Status.getIsUniqMode()) {
      _showViewbar = false;
      _showArrows = false
    }
    _fsButton = _fsButton && !V.Status.isPreview();
    if(_showViewbar) {
      V.Viewer.updateSlideCounter();
      $("#viewbar").show()
    }else {
      $("#viewbar").hide()
    }
    if(!_showArrows) {
      $("#back_arrow").hide();
      $("#forward_arrow").hide()
    }
    if(V.Status.isPreview()) {
      $("div#viewerpreview").show()
    }
    if(V.Status.isPreviewInsertMode()) {
      $("#selectSlidesBar").show();
      $("#viewbar").css("bottom", $("#selectSlidesBar").height() + "px");
      $("#viewbar").css("border-bottom", "none");
      V.SlidesSelector.init()
    }
    if(options && typeof options.watermarkURL == "string") {
      if(V.Status.isExternalSite() && !V.Status.isPreviewInsertMode()) {
        $("#embedWatermark").parent().attr("href", options.watermarkURL);
        $("#embedWatermark").show()
      }
    }
    if(_showEval) {
      V.Recommendations.showEvaluations()
    }else {
      V.Recommendations.hideEvaluations()
    }
    if(_closeButton) {
      $("button#closeButton").show()
    }
    if(_fsButton) {
      V.FullScreen.enableFullScreen();
      $("#page-fullscreen").show()
    }else {
      $("#page-fullscreen").hide()
    }
    updateInterface();
    V.Text.init()
  };
  var decideIfPageSwitcher = function() {
    if(_showArrows) {
      if(V.Viewer.getPresentationType() === V.Constant.PRESENTATION) {
        if(V.Slides.getCurrentSubslide() !== null) {
          $("#forward_arrow").hide();
          $("#back_arrow").hide()
        }else {
          if(V.Slides.isCurrentFirstSlide()) {
            $("#back_arrow").hide()
          }else {
            $("#back_arrow").show()
          }
          $("#forward_arrow").show()
        }
      }else {
        if(V.Viewer.getPresentationType() === V.Constant.QUIZ_SIMPLE) {
          $("#forward_arrow").hide()
        }
      }
    }
    if(V.Recommendations.isRecVisible()) {
      $("#page-switcher-start").removeClass("disabledarrow");
      $("#page-switcher-end").addClass("disabledarrow")
    }else {
      if(V.Slides.isCurrentFirstSlide()) {
        $("#page-switcher-start").addClass("disabledarrow")
      }else {
        $("#page-switcher-start").removeClass("disabledarrow")
      }
      if(V.Slides.isCurrentLastSlide() && !V.Recommendations.isEnabled()) {
        $("#page-switcher-end").addClass("disabledarrow")
      }else {
        $("#page-switcher-end").removeClass("disabledarrow")
      }
    }
  };
  var _decideIfViewBarShow = function() {
    if(_showViewbar) {
      $("#viewbar").show()
    }else {
      $("#viewbar").hide()
    }
  };
  var _defaultViewbar = function() {
    var presentationType = V.Viewer.getPresentationType();
    var slidesQuantity = V.Slides.getSlidesQuantity();
    if(presentationType === V.Constant.QUIZ_SIMPLE && slidesQuantity === 1) {
      return false
    }else {
      return true
    }
  };
  var updateInterface = function() {
    var cWidth = $(window).width();
    var cHeight = $(window).height();
    if(cWidth === _lastWidth && cHeight === _lastHeight) {
      return
    }
    _lastWidth = cWidth;
    _lastHeight = cHeight;
    _setupSize()
  };
  var _setupSize = function() {
    var viewbarHeight;
    var min_margin_height = 25;
    var min_margin_width = 60;
    if(!_showViewbar) {
      viewbarHeight = 0;
      min_margin_height = 0;
      min_margin_width = 0
    }else {
      if(V.Status.isPreviewInsertMode()) {
        viewbarHeight = 120
      }else {
        viewbarHeight = _getDesiredVieweBarHeight(_lastHeight)
      }
    }
    var height = _lastHeight - viewbarHeight;
    var width = _lastWidth;
    var finalW = 800;
    var finalH = 600;
    var finalWidthMargin;
    var aspectRatio = (width - min_margin_width) / (height - min_margin_height);
    var slidesRatio = 4 / 3;
    if(aspectRatio > slidesRatio) {
      finalH = height - min_margin_height;
      finalW = finalH * slidesRatio;
      var widthMargin = width - finalW;
      if(widthMargin < min_margin_width) {
        finalWidthMargin = min_margin_width;
        var marginWidthToAdd = min_margin_width - widthMargin;
        finalW = finalW - marginWidthToAdd
      }else {
        finalWidthMargin = widthMargin
      }
    }else {
      finalW = width - min_margin_width;
      finalH = finalW / slidesRatio;
      finalWidthMargin = min_margin_width;
      var heightMargin = height - finalH;
      if(heightMargin < min_margin_height) {
        var marginHeightToAdd = min_margin_height - heightMargin;
        finalH = finalH - marginHeightToAdd
      }
    }
    $(".vish_arrow").width(finalWidthMargin / 2 * 0.9);
    if(_showViewbar && !V.Status.isPreviewInsertMode()) {
      $("#viewbar").height(viewbarHeight)
    }
    var topSlides = $(".slides > article");
    var subSlides = $(".slides > article > article");
    var allSlides = $(".slides article");
    $(allSlides).css("height", finalH);
    $(allSlides).css("width", finalW);
    var marginTop = finalH / 2 + viewbarHeight / 2;
    var marginLeft = finalW / 2;
    $(topSlides).css("margin-top", "-" + marginTop + "px");
    $(subSlides).css("margin-top", "-" + finalH / 2 + "px");
    $(allSlides).css("margin-left", "-" + marginLeft + "px");
    var increase = finalH / 600;
    var increaseW = finalW / 800;
    _lastIncrease = increase;
    _lastIncreaseW = increaseW;
    var paddingTopAndBottom = 3 / 100 * finalW;
    var paddingLeftAndRight = 5 / 100 * finalW;
    $(allSlides).css("padding-left", paddingLeftAndRight);
    $(allSlides).css("padding-right", paddingLeftAndRight);
    $(allSlides).css("padding-top", paddingTopAndBottom);
    $(allSlides).css("padding-bottom", paddingTopAndBottom);
    var _closeButtonDimension = 23;
    if(increase <= 1) {
      _closeButtonDimension = _closeButtonDimension * getPonderatedIncrease(increase, 0.7)
    }else {
      _closeButtonDimension = _closeButtonDimension * getPonderatedIncrease(increase, 0.2)
    }
    $("div.close_subslide").css("width", _closeButtonDimension + "px");
    $("div.close_subslide").css("height", _closeButtonDimension + "px");
    if(_showViewbar) {
      $("#page-switcher-start").width($("#page-switcher-start").height());
      $("#page-switcher-end").width($("#page-switcher-end").height());
      $("#page-fullscreen").width($("#page-fullscreen").height());
      if(V.Status.isPreviewInsertMode()) {
        viewbarHeight = $("#viewbar").height()
      }
      var menubarIncreaseFactor = viewbarHeight / 40;
      var slideCounterFontSizeMain = 18 * getPonderatedIncrease(menubarIncreaseFactor, 0.5);
      var slideCounterFontSize = 14 * getPonderatedIncrease(menubarIncreaseFactor, 0.5);
      $("#slide-counter-input").css("font-size", slideCounterFontSizeMain + "px");
      $("#slide-counter-span").css("font-size", slideCounterFontSize + "px");
      $("#slide-counter-input").width(24 * getPonderatedIncrease(menubarIncreaseFactor, 1));
      var slideCounterMarginTop = (viewbarHeight - $("#slide-counter-div").height()) / 2;
      $("#slide-counter-div").css("margin-top", slideCounterMarginTop + "px");
      $("#embedWatermark").width($("#embedWatermark").height() * 2.7)
    }
    decideIfPageSwitcher();
    updateFancyboxAfterSetupSize(increase, increaseW);
    V.Text.aftersetupSize(increase, increaseW);
    V.SnapshotPlayer.aftersetupSize(increase, increaseW);
    V.ObjectPlayer.aftersetupSize(increase, increaseW);
    V.Slideset.afterSetupSize(increase, increaseW);
    V.Quiz.aftersetupSize(increase, increaseW);
    V.Recommendations.aftersetupSize(increase, increaseW)
  };
  var _getDesiredVieweBarHeight = function(windowHeight) {
    var minimumViewBarHeight = 26;
    var maxViewBarHeight = 40;
    var estimatedIncrease = windowHeight / 600;
    var viewBarHeight = 40 * getPonderatedIncrease(estimatedIncrease, 0.7);
    return Math.min(Math.max(viewBarHeight, minimumViewBarHeight), maxViewBarHeight)
  };
  var updateFancyboxAfterSetupSize = function(increase, increaseW) {
    var fOverlay = $("#fancybox-overlay");
    if($(fOverlay).length < 1 || !$(fOverlay).is(":visible")) {
      return
    }
    increase = typeof increase == "number" ? increase : V.ViewerAdapter.getLastIncrease()[0];
    var fwrap = $("#fancybox-wrap");
    var fcontent = $("#fancybox-content");
    var fccontentDivs = $("#" + $(fcontent).attr("id") + " > div");
    var currentSlide = $(".current");
    var paddingTop = $(currentSlide).cssNumber("padding-top");
    var paddingLeft = $(currentSlide).cssNumber("padding-left");
    var paddingRight = $(currentSlide).cssNumber("padding-right");
    var offset = $(currentSlide).offset();
    var _closeButtonDimension = 23;
    if(increase <= 1) {
      _closeButtonDimension = _closeButtonDimension * getPonderatedIncrease(increase, 0.7)
    }else {
      _closeButtonDimension = _closeButtonDimension * getPonderatedIncrease(increase, 0.2)
    }
    var fcClose = $("#fancybox-close");
    $(fcClose).width(_closeButtonDimension + "px");
    $(fcClose).height(_closeButtonDimension + "px");
    $(fcClose).css("padding", "10px");
    $(fcClose).css("padding-left", "4px");
    $(fwrap).css("margin-top", "0px");
    $(fwrap).css("margin-left", "0px");
    $(fwrap).width($(currentSlide).width() + paddingLeft + paddingRight);
    $(fwrap).height($(currentSlide).height() + 2 * paddingTop);
    $(fwrap).css("top", offset.top + "px");
    $(fwrap).css("left", offset.left + "px");
    $(fcontent).width("100%");
    $(fcontent).height("100%");
    $(fccontentDivs).width("100%");
    $(fccontentDivs).height("100%")
  };
  var decideIfCloseButton = function() {
    if(_closeButton) {
      $("#closeButton").show()
    }
  };
  var getDimensionsForResizedButton = function(increase, originalWidth, aspectRatio) {
    var originalWidth = originalWidth || 23;
    var aspectRatio = aspectRatio || 1;
    var _buttonWidth = originalWidth;
    if(increase <= 1) {
      _buttonWidth = _buttonWidth * getPonderatedIncrease(increase, 0.7)
    }else {
      _buttonWidth = _buttonWidth * getPonderatedIncrease(increase, 0.2)
    }
    return{width:_buttonWidth, height:_buttonWidth / aspectRatio}
  };
  var getLastIncrease = function() {
    return[_lastIncrease, _lastIncreaseW]
  };
  var getPonderatedIncrease = function(increase, pFactor) {
    var diff = (increase - 1) * pFactor;
    return 1 + diff
  };
  return{init:init, updateInterface:updateInterface, decideIfPageSwitcher:decideIfPageSwitcher, decideIfCloseButton:decideIfCloseButton, updateFancyboxAfterSetupSize:updateFancyboxAfterSetupSize, getDimensionsForResizedButton:getDimensionsForResizedButton, getPonderatedIncrease:getPonderatedIncrease, getLastIncrease:getLastIncrease}
}(VISH, jQuery);
VISH.VirtualTour = function(V, $, undefined) {
  var initialized = false;
  var virtualTours;
  var gMlLoaded = false;
  var gMlLoading = false;
  var init = function() {
    if(!initialized) {
      initialized = true;
      virtualTours = {};
      _loadEvents()
    }
  };
  var _loadEvents = function() {
    V.EventsNotifier.registerCallback(V.Constant.Event.onSubslideClosed, function(params) {
      var subslideId = params.slideId;
      var slideset = $($("#" + subslideId).parent());
      if($(slideset).attr("type") == V.Constant.VTOUR) {
        var vTourId = $(slideset).attr("id");
        _onCloseSubslide(vTourId)
      }
    })
  };
  var _onCloseSubslide = function(vTourId) {
    var canvas = $("#" + vTourId).find(".map_canvas");
    $(canvas).removeClass("temp_hidden")
  };
  var draw = function(vtJSON) {
    if(!gMlLoaded && !gMlLoading) {
      gMlLoading = true;
      V.Utils.Loader.loadGoogleLibrary("https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places", function() {
        gMlLoading = false;
        gMlLoaded = true;
        var el = document;
        var evt = document.createEvent("Event");
        evt.initEvent("googleMapsLibraryLoadedinVV", true, true);
        el.dispatchEvent(evt)
      })
    }
    if(!gMlLoaded) {
      $(document).on("googleMapsLibraryLoadedinVV", function() {
        draw(vtJSON)
      });
      return
    }
    if(vtJSON.type !== V.Constant.VTOUR) {
      return
    }
    if(typeof virtualTours[vtJSON.id] != "undefined") {
      return
    }
    virtualTours[vtJSON.id] = jQuery.extend({}, vtJSON);
    var canvasId = V.Utils.getId(vtJSON.id + "_canvas");
    var canvas = $("<div id='" + canvasId + "' class='map_canvas' style='height:" + "100%" + "; width:" + "100%" + "'></div>");
    var vtDOM = $("#" + vtJSON.id);
    $(vtDOM).append(canvas);
    V.Utils.addTempShown(vtDOM);
    var center = new google.maps.LatLng(vtJSON.center.lat, vtJSON.center.lng);
    var myOptions = {zoom:parseInt(vtJSON.zoom), center:center, mapTypeId:vtJSON.mapType};
    var map = new google.maps.Map(document.getElementById(canvasId), myOptions);
    virtualTours[vtJSON.id].map = map;
    virtualTours[vtJSON.id].currentCenter = center;
    $(vtJSON.pois).each(function(index, poi) {
      _addMarkerToCoordinates(canvasId, map, poi.lat, poi.lng, poi.slide_id)
    });
    google.maps.event.addListenerOnce(map, "tilesloaded", function() {
      V.Utils.removeTempShown(vtDOM);
      google.maps.event.addListenerOnce(map, "tilesloaded", function() {
      })
    });
    google.maps.event.addDomListener(map, "idle", function() {
    });
    google.maps.event.addDomListener(window, "resize", function() {
    })
  };
  var onEnterSlideset = function(slideset) {
    var vtId = $(slideset).attr("id");
    var canvas = $("#" + vtId).find(".map_canvas");
    $(canvas).show();
    _triggerOnResizeMap(vtId)
  };
  var onLeaveSlideset = function(slideset) {
    var vtId = $(slideset).attr("id");
    virtualTours[vtId].currentCenter = virtualTours[vtId].map.getCenter();
    var canvas = $("#" + vtId).find(".map_canvas");
    $(canvas).hide()
  };
  var _addMarkerToCoordinates = function(canvasId, map, lat, lng, slide_id) {
    return _addMarkerToPosition(canvasId, map, new google.maps.LatLng(lat, lng), slide_id)
  };
  var _addMarkerToPosition = function(canvasId, map, myLatlng, slide_id) {
    var pinImage = new google.maps.MarkerImage(V.ImagesPath + "vicons/marker.png", new google.maps.Size(25, 40), new google.maps.Point(0, 0), new google.maps.Point(10, 34));
    var marker = new google.maps.Marker({position:myLatlng, map:map, draggable:false, icon:pinImage, title:"(" + myLatlng.lat().toFixed(3) + "," + myLatlng.lng().toFixed(3) + ")"});
    google.maps.event.addListener(marker, "click", function(event) {
      setTimeout(function() {
        var canvasDOM = $("#" + canvasId);
        var subslideDOM = $("#" + slide_id);
        if($(subslideDOM).hasClass("show_in_smartcard")) {
          $(canvasDOM).addClass("temp_hidden")
        }
      }, 1500);
      V.Slides.openSubslide(slide_id, true)
    });
    return marker
  };
  var afterSetupSize = function(increase) {
    var currentSlideId = $(V.Slides.getCurrentSlide()).attr("id");
    if(typeof virtualTours[currentSlideId] == "object") {
      virtualTours[currentSlideId].currentCenter = virtualTours[currentSlideId].map.getCenter();
      _triggerOnResizeMap(currentSlideId)
    }
  };
  var _triggerOnResizeMap = function(vtId) {
    var vt = virtualTours[vtId];
    if(typeof vt == "object" && typeof vt.map == "object") {
      google.maps.event.trigger(vt.map, "resize");
      vt.map.setCenter(vt.currentCenter)
    }
  };
  return{init:init, draw:draw, onEnterSlideset:onEnterSlideset, onLeaveSlideset:onLeaveSlideset, afterSetupSize:afterSetupSize}
}(VISH, jQuery);

